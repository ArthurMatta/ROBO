!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.THREE=e.THREE||{})}(this,function(e){"use strict";function t(){}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:0<e?1:+e}),void 0===Function.prototype.name&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}),Object.assign(t.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var i=this._listeners[e];if(void 0!==i){var n=i.indexOf(t);-1!==n&&i.splice(n,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var i=t.slice(0),n=0,r=i.length;n<r;n++)i[n].call(this,e)}}}});var i,n,r,o,a,s,z=0,j=1,V=2,H=1,B=2,F=0,Z=1,Y=2,Re=1,l=2,Ae=0,G=0,W=1,q=2,X=3,K=4,J=5,Pe=100,Le=204,Oe=205,Q=0,ee=1,te=2,ie=3,ne=4,re=5,oe=6,ae=7,U=0,$=1,se=2,le=0,Ie=1,ce=2,he=3,ue=4,de=301,pe=302,fe=303,me=304,ge=305,ve=306,ye=307,De=1e3,ke=1001,Ne=1002,He=1003,Be=1004,Fe=1005,Ue=1006,$e=1008,ze=1009,je=1012,Ve=1014,Ge=1015,We=1016,qe=1020,Xe=1022,Ze=1023,c=Ze,Ye=1026,Ke=1027,h=2300,u=2301,d=2400,p=2401,f=2402,Je=0,m=3e3,g=3001,v=3007,y=3002,b=3004,x=3005,w=3006,_=3200,be=3201,Qe={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:(n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=new Array(36),o=0,function(){for(var e=0;e<36;e++)8===e||13===e||18===e||23===e?r[e]="-":14===e?r[e]="4":(o<=2&&(o=33554432+16777216*Math.random()|0),i=15&o,o>>=4,r[e]=n[19===e?3&i|8:i]);return r.join("")}),clamp:function(e,t,i){return Math.max(t,Math.min(i,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,i,n,r){return n+(e-t)*(r-n)/(i-t)},lerp:function(e,t,i){return(1-i)*e+i*t},smoothstep:function(e,t,i){return e<=t?0:i<=e?1:(e=(e-t)/(i-t))*e*(3-2*e)},smootherstep:function(e,t,i){return e<=t?0:i<=e?1:(e=(e-t)/(i-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*Qe.DEG2RAD},radToDeg:function(e){return e*Qe.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},nearestPowerOfTwo:function(e){return Math.pow(2,Math.round(Math.log(e)/Math.LN2))},nextPowerOfTwo:function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e}};function xe(e,t){this.x=e||0,this.y=t||0}Object.defineProperties(xe.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(xe.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:(a=new xe,s=new xe,function(e,t){return a.set(e,e),s.set(t,t),this.clamp(a,s)}),clampLength:function(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y;return t*t+i*i},distanceToManhattan:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var i=Math.cos(t),n=Math.sin(t),r=this.x-e.x,o=this.y-e.y;return this.x=r*i-o*n+e.x,this.y=r*n+o*i+e.y,this}});var E,T,M,S,C,R,A,P,L,O,I,D,k,N,we,_e,Ee,Te,Me,Se=0;function Ce(e,t,i,n,r,o,a,s,l,c){Object.defineProperty(this,"id",{value:Se++}),this.uuid=Qe.generateUUID(),this.name="",this.image=void 0!==e?e:Ce.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:Ce.DEFAULT_MAPPING,this.wrapS=void 0!==i?i:ke,this.wrapT=void 0!==n?n:ke,this.magFilter=void 0!==r?r:Ue,this.minFilter=void 0!==o?o:$e,this.anisotropy=void 0!==l?l:1,this.format=void 0!==a?a:Ze,this.type=void 0!==s?s:ze,this.offset=new xe(0,0),this.repeat=new xe(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==c?c:m,this.version=0,this.onUpdate=null}function et(e,t,i,n){this.x=e||0,this.y=t||0,this.z=i||0,this.w=void 0!==n?n:1}function tt(e,t,i){this.uuid=Qe.generateUUID(),this.width=e,this.height=t,this.scissor=new et(0,0,e,t),this.scissorTest=!1,this.viewport=new et(0,0,e,t),void 0===(i=i||{}).minFilter&&(i.minFilter=Ue),this.texture=new Ce(void 0,void 0,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0===i.stencilBuffer||i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null}function it(e,t,i){tt.call(this,e,t,i),this.activeCubeFace=0,this.activeMipMapLevel=0}function nt(e,t,i,n){this._x=e||0,this._y=t||0,this._z=i||0,this._w=void 0!==n?n:1}function rt(e,t,i){this.x=e||0,this.y=t||0,this.z=i||0}function ot(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function at(e,t,i,n,r,o,a,s,l,c,h,u){Ce.call(this,null,o,a,s,l,c,n,r,h,u),this.image={data:e,width:t,height:i},this.magFilter=void 0!==l?l:He,this.minFilter=void 0!==c?c:He,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function st(e,t,i,n,r,o,a,s,l,c){Ce.call(this,e=void 0!==e?e:[],t=void 0!==t?t:de,i,n,r,o,a,s,l,c),this.flipY=!1}Ce.DEFAULT_IMAGE=void 0,Ce.DEFAULT_MAPPING=300,Object.defineProperty(Ce.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Ce.prototype,t.prototype,{constructor:Ce,isTexture:!0,clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){if(void 0!==e.textures[this.uuid])return e.textures[this.uuid];var t,i,n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var r=this.image;void 0===r.uuid&&(r.uuid=Qe.generateUUID()),void 0===e.images[r.uuid]&&(e.images[r.uuid]={uuid:r.uuid,url:(t=r,void 0!==t.toDataURL?i=t:((i=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=t.width,i.height=t.height,i.getContext("2d").drawImage(t,0,0,t.width,t.height)),2048<i.width||2048<i.height?i.toDataURL("image/jpeg",.6):i.toDataURL("image/png"))}),n.image=r.uuid}return e.textures[this.uuid]=n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(300===this.mapping){if(e.multiply(this.repeat),e.add(this.offset),e.x<0||1<e.x)switch(this.wrapS){case De:e.x=e.x-Math.floor(e.x);break;case ke:e.x=e.x<0?0:1;break;case Ne:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||1<e.y)switch(this.wrapT){case De:e.y=e.y-Math.floor(e.y);break;case ke:e.y=e.y<0?0:1;break;case Ne:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}this.flipY&&(e.y=1-e.y)}}}),Object.assign(et.prototype,{isVector4:!0,set:function(e,t,i,n){return this.x=e,this.y=t,this.z=i,this.w=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,i=this.y,n=this.z,r=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*n+o[12]*r,this.y=o[1]*t+o[5]*i+o[9]*n+o[13]*r,this.z=o[2]*t+o[6]*i+o[10]*n+o[14]*r,this.w=o[3]*t+o[7]*i+o[11]*n+o[15]*r,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,i,n,r,o=e.elements,a=o[0],s=o[4],l=o[8],c=o[1],h=o[5],u=o[9],d=o[2],p=o[6],f=o[10];if(Math.abs(s-c)<.01&&Math.abs(l-d)<.01&&Math.abs(u-p)<.01){if(Math.abs(s+c)<.1&&Math.abs(l+d)<.1&&Math.abs(u+p)<.1&&Math.abs(a+h+f-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var m=(a+1)/2,g=(h+1)/2,v=(f+1)/2,y=(s+c)/4,b=(l+d)/4,x=(u+p)/4;return g<m&&v<m?r=m<.01?(i=0,n=.707106781):(n=y/(i=Math.sqrt(m)),b/i):v<g?r=g<.01?(n=0,i=.707106781):(i=y/(n=Math.sqrt(g)),x/n):v<.01?(n=i=.707106781,r=0):(i=b/(r=Math.sqrt(v)),n=x/r),this.set(i,n,r,t),this}var w=Math.sqrt((p-u)*(p-u)+(l-d)*(l-d)+(c-s)*(c-s));return Math.abs(w)<.001&&(w=1),this.x=(p-u)/w,this.y=(l-d)/w,this.z=(c-s)/w,this.w=Math.acos((a+h+f-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(e,t){return void 0===E&&(E=new et,T=new et),E.set(e,e,e,e),T.set(t,t,t,t),this.clamp(E,T)},clampLength:function(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,i){return void 0!==i&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),Object.assign(tt.prototype,t.prototype,{isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),((it.prototype=Object.create(tt.prototype)).constructor=it).prototype.isWebGLRenderTargetCube=!0,Object.assign(nt,{slerp:function(e,t,i,n){return i.copy(e).slerp(t,n)},slerpFlat:function(e,t,i,n,r,o,a){var s=i[n+0],l=i[n+1],c=i[n+2],h=i[n+3],u=r[o+0],d=r[o+1],p=r[o+2],f=r[o+3];if(h!==f||s!==u||l!==d||c!==p){var m=1-a,g=s*u+l*d+c*p+h*f,v=0<=g?1:-1,y=1-g*g;if(y>Number.EPSILON){var b=Math.sqrt(y),x=Math.atan2(b,g*v);m=Math.sin(m*x)/b,a=Math.sin(a*x)/b}var w=a*v;if(s=s*m+u*w,l=l*m+d*w,c=c*m+p*w,h=h*m+f*w,m===1-a){var _=1/Math.sqrt(s*s+l*l+c*c+h*h);s*=_,l*=_,c*=_,h*=_}}e[t]=s,e[t+1]=l,e[t+2]=c,e[t+3]=h}}),Object.defineProperties(nt.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this.onChangeCallback()}}}),Object.assign(nt.prototype,{set:function(e,t,i,n){return this._x=e,this._y=t,this._z=i,this._w=n,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var i=e._x,n=e._y,r=e._z,o=e.order,a=Math.cos,s=Math.sin,l=a(i/2),c=a(n/2),h=a(r/2),u=s(i/2),d=s(n/2),p=s(r/2);return"XYZ"===o?(this._x=u*c*h+l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h-u*d*p):"YXZ"===o?(this._x=u*c*h+l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h+u*d*p):"ZXY"===o?(this._x=u*c*h-l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h-u*d*p):"ZYX"===o?(this._x=u*c*h-l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h+u*d*p):"YZX"===o?(this._x=u*c*h+l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h-u*d*p):"XZY"===o&&(this._x=u*c*h-l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h+u*d*p),!1!==t&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var i=t/2,n=Math.sin(i);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(i),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,i=e.elements,n=i[0],r=i[4],o=i[8],a=i[1],s=i[5],l=i[9],c=i[2],h=i[6],u=i[10],d=n+s+u;return 0<d?(t=.5/Math.sqrt(d+1),this._w=.25/t,this._x=(h-l)*t,this._y=(o-c)*t,this._z=(a-r)*t):s<n&&u<n?(t=2*Math.sqrt(1+n-s-u),this._w=(h-l)/t,this._x=.25*t,this._y=(r+a)/t,this._z=(o+c)/t):u<s?(t=2*Math.sqrt(1+s-n-u),this._w=(o-c)/t,this._x=(r+a)/t,this._y=.25*t,this._z=(l+h)/t):(t=2*Math.sqrt(1+u-n-s),this._w=(a-r)/t,this._x=(o+c)/t,this._y=(l+h)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:(S=new rt,function(e,t){return void 0===S&&(S=new rt),(M=e.dot(t)+1)<1e-6?(M=0,Math.abs(e.x)>Math.abs(e.z)?S.set(-e.y,e.x,0):S.set(0,-e.z,e.y)):S.crossVectors(e,t),this._x=S.x,this._y=S.y,this._z=S.z,this._w=M,this.normalize()}),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var i=e._x,n=e._y,r=e._z,o=e._w,a=t._x,s=t._y,l=t._z,c=t._w;return this._x=i*c+o*a+n*l-r*s,this._y=n*c+o*s+r*a-i*l,this._z=r*c+o*l+i*s-n*a,this._w=o*c-i*a-n*s-r*l,this.onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var i=this._x,n=this._y,r=this._z,o=this._w,a=o*e._w+i*e._x+n*e._y+r*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),1<=a)return this._w=o,this._x=i,this._y=n,this._z=r,this;var s=Math.sqrt(1-a*a);if(Math.abs(s)<.001)return this._w=.5*(o+this._w),this._x=.5*(i+this._x),this._y=.5*(n+this._y),this._z=.5*(r+this._z),this;var l=Math.atan2(s,a),c=Math.sin((1-t)*l)/s,h=Math.sin(t*l)/s;return this._w=o*c+this._w*h,this._x=i*c+this._x*h,this._y=n*c+this._y*h,this._z=r*c+this._z*h,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(rt.prototype,{isVector3:!0,set:function(e,t,i){return this.x=e,this.y=t,this.z=i,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:(D=new nt,function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(D.setFromEuler(e))}),applyAxisAngle:(I=new nt,function(e,t){return this.applyQuaternion(I.setFromAxisAngle(e,t))}),applyMatrix3:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6]*n,this.y=r[1]*t+r[4]*i+r[7]*n,this.z=r[2]*t+r[5]*i+r[8]*n,this},applyMatrix4:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements,o=1/(r[3]*t+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*t+r[4]*i+r[8]*n+r[12])*o,this.y=(r[1]*t+r[5]*i+r[9]*n+r[13])*o,this.z=(r[2]*t+r[6]*i+r[10]*n+r[14])*o,this},applyQuaternion:function(e){var t=this.x,i=this.y,n=this.z,r=e.x,o=e.y,a=e.z,s=e.w,l=s*t+o*n-a*i,c=s*i+a*t-r*n,h=s*n+r*i-o*t,u=-r*t-o*i-a*n;return this.x=l*s+u*-r+c*-a-h*-o,this.y=c*s+u*-o+h*-r-l*-a,this.z=h*s+u*-a+l*-o-c*-r,this},project:(O=new ot,function(e){return O.multiplyMatrices(e.projectionMatrix,O.getInverse(e.matrixWorld)),this.applyMatrix4(O)}),unproject:(L=new ot,function(e){return L.multiplyMatrices(e.matrixWorld,L.getInverse(e.projectionMatrix)),this.applyMatrix4(L)}),transformDirection:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[4]*i+r[8]*n,this.y=r[1]*t+r[5]*i+r[9]*n,this.z=r[2]*t+r[6]*i+r[10]*n,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:(A=new rt,P=new rt,function(e,t){return A.set(e,e,e),P.set(t,t,t),this.clamp(A,P)}),clampLength:function(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},cross:function(e,t){if(void 0!==t)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var i=this.x,n=this.y,r=this.z;return this.x=n*e.z-r*e.y,this.y=r*e.x-i*e.z,this.z=i*e.y-n*e.x,this},crossVectors:function(e,t){var i=e.x,n=e.y,r=e.z,o=t.x,a=t.y,s=t.z;return this.x=n*s-r*a,this.y=r*o-i*s,this.z=i*a-n*o,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:(R=new rt,function(e){return R.copy(this).projectOnVector(e),this.sub(R)}),reflect:(C=new rt,function(e){return this.sub(C.copy(e).multiplyScalar(2*this.dot(e)))}),angleTo:function(e){var t=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(Qe.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y,n=this.z-e.z;return t*t+i*i+n*n},distanceToManhattan:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){var t=Math.sin(e.phi)*e.radius;return this.x=t*Math.sin(e.theta),this.y=Math.cos(e.phi)*e.radius,this.z=t*Math.cos(e.theta),this},setFromCylindrical:function(e){return this.x=e.radius*Math.sin(e.theta),this.y=e.y,this.z=e.radius*Math.cos(e.theta),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=n,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}}),Object.assign(ot.prototype,{isMatrix4:!0,set:function(e,t,i,n,r,o,a,s,l,c,h,u,d,p,f,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=i,g[12]=n,g[1]=r,g[5]=o,g[9]=a,g[13]=s,g[2]=l,g[6]=c,g[10]=h,g[14]=u,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new ot).fromArray(this.elements)},copy:function(e){var t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this},copyPosition:function(e){var t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this},extractBasis:function(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this},extractRotation:(Me=new rt,function(e){var t=this.elements,i=e.elements,n=1/Me.setFromMatrixColumn(e,0).length(),r=1/Me.setFromMatrixColumn(e,1).length(),o=1/Me.setFromMatrixColumn(e,2).length();return t[0]=i[0]*n,t[1]=i[1]*n,t[2]=i[2]*n,t[4]=i[4]*r,t[5]=i[5]*r,t[6]=i[6]*r,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,this}),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,i=e.x,n=e.y,r=e.z,o=Math.cos(i),a=Math.sin(i),s=Math.cos(n),l=Math.sin(n),c=Math.cos(r),h=Math.sin(r);if("XYZ"===e.order){var u=o*c,d=o*h,p=a*c,f=a*h;t[0]=s*c,t[4]=-s*h,t[8]=l,t[1]=d+p*l,t[5]=u-f*l,t[9]=-a*s,t[2]=f-u*l,t[6]=p+d*l,t[10]=o*s}else if("YXZ"===e.order){var m=s*c,g=s*h,v=l*c,y=l*h;t[0]=m+y*a,t[4]=v*a-g,t[8]=o*l,t[1]=o*h,t[5]=o*c,t[9]=-a,t[2]=g*a-v,t[6]=y+m*a,t[10]=o*s}else if("ZXY"===e.order){m=s*c,g=s*h,v=l*c,y=l*h;t[0]=m-y*a,t[4]=-o*h,t[8]=v+g*a,t[1]=g+v*a,t[5]=o*c,t[9]=y-m*a,t[2]=-o*l,t[6]=a,t[10]=o*s}else if("ZYX"===e.order){u=o*c,d=o*h,p=a*c,f=a*h;t[0]=s*c,t[4]=p*l-d,t[8]=u*l+f,t[1]=s*h,t[5]=f*l+u,t[9]=d*l-p,t[2]=-l,t[6]=a*s,t[10]=o*s}else if("YZX"===e.order){var b=o*s,x=o*l,w=a*s,_=a*l;t[0]=s*c,t[4]=_-b*h,t[8]=w*h+x,t[1]=h,t[5]=o*c,t[9]=-a*c,t[2]=-l*c,t[6]=x*h+w,t[10]=b-_*h}else if("XZY"===e.order){b=o*s,x=o*l,w=a*s,_=a*l;t[0]=s*c,t[4]=-h,t[8]=l*c,t[1]=b*h+_,t[5]=o*c,t[9]=x*h-w,t[2]=w*h-x,t[6]=a*c,t[10]=_*h+b}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(e){var t=this.elements,i=e._x,n=e._y,r=e._z,o=e._w,a=i+i,s=n+n,l=r+r,c=i*a,h=i*s,u=i*l,d=n*s,p=n*l,f=r*l,m=o*a,g=o*s,v=o*l;return t[0]=1-(d+f),t[4]=h-v,t[8]=u+g,t[1]=h+v,t[5]=1-(c+f),t[9]=p-m,t[2]=u-g,t[6]=p+m,t[10]=1-(c+d),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},lookAt:(_e=new rt,Ee=new rt,Te=new rt,function(e,t,i){var n=this.elements;return Te.subVectors(e,t),0===Te.lengthSq()&&(Te.z=1),Te.normalize(),_e.crossVectors(i,Te),0===_e.lengthSq()&&(1===Math.abs(i.z)?Te.x+=1e-4:Te.z+=1e-4,Te.normalize(),_e.crossVectors(i,Te)),_e.normalize(),Ee.crossVectors(Te,_e),n[0]=_e.x,n[4]=Ee.x,n[8]=Te.x,n[1]=_e.y,n[5]=Ee.y,n[9]=Te.y,n[2]=_e.z,n[6]=Ee.z,n[10]=Te.z,this}),multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var i=e.elements,n=t.elements,r=this.elements,o=i[0],a=i[4],s=i[8],l=i[12],c=i[1],h=i[5],u=i[9],d=i[13],p=i[2],f=i[6],m=i[10],g=i[14],v=i[3],y=i[7],b=i[11],x=i[15],w=n[0],_=n[4],E=n[8],T=n[12],M=n[1],S=n[5],C=n[9],R=n[13],A=n[2],P=n[6],L=n[10],O=n[14],I=n[3],D=n[7],k=n[11],N=n[15];return r[0]=o*w+a*M+s*A+l*I,r[4]=o*_+a*S+s*P+l*D,r[8]=o*E+a*C+s*L+l*k,r[12]=o*T+a*R+s*O+l*N,r[1]=c*w+h*M+u*A+d*I,r[5]=c*_+h*S+u*P+d*D,r[9]=c*E+h*C+u*L+d*k,r[13]=c*T+h*R+u*O+d*N,r[2]=p*w+f*M+m*A+g*I,r[6]=p*_+f*S+m*P+g*D,r[10]=p*E+f*C+m*L+g*k,r[14]=p*T+f*R+m*O+g*N,r[3]=v*w+y*M+b*A+x*I,r[7]=v*_+y*S+b*P+x*D,r[11]=v*E+y*C+b*L+x*k,r[15]=v*T+y*R+b*O+x*N,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:(we=new rt,function(e){for(var t=0,i=e.count;t<i;t++)we.x=e.getX(t),we.y=e.getY(t),we.z=e.getZ(t),we.applyMatrix4(this),e.setXYZ(t,we.x,we.y,we.z);return e}),determinant:function(){var e=this.elements,t=e[0],i=e[4],n=e[8],r=e[12],o=e[1],a=e[5],s=e[9],l=e[13],c=e[2],h=e[6],u=e[10],d=e[14];return e[3]*(+r*s*h-n*l*h-r*a*u+i*l*u+n*a*d-i*s*d)+e[7]*(+t*s*d-t*l*u+r*o*u-n*o*d+n*l*c-r*s*c)+e[11]*(+t*l*h-t*a*d-r*o*h+i*o*d+r*a*c-i*l*c)+e[15]*(-n*a*c-t*s*h+t*a*u+n*o*h-i*o*u+i*s*c)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var i=this.elements,n=e.elements,r=n[0],o=n[1],a=n[2],s=n[3],l=n[4],c=n[5],h=n[6],u=n[7],d=n[8],p=n[9],f=n[10],m=n[11],g=n[12],v=n[13],y=n[14],b=n[15],x=p*y*u-v*f*u+v*h*m-c*y*m-p*h*b+c*f*b,w=g*f*u-d*y*u-g*h*m+l*y*m+d*h*b-l*f*b,_=d*v*u-g*p*u+g*c*m-l*v*m-d*c*b+l*p*b,E=g*p*h-d*v*h-g*c*f+l*v*f+d*c*y-l*p*y,T=r*x+o*w+a*_+s*E;if(0===T){var M="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(!0===t)throw new Error(M);return console.warn(M),this.identity()}var S=1/T;return i[0]=x*S,i[1]=(v*f*s-p*y*s-v*a*m+o*y*m+p*a*b-o*f*b)*S,i[2]=(c*y*s-v*h*s+v*a*u-o*y*u-c*a*b+o*h*b)*S,i[3]=(p*h*s-c*f*s-p*a*u+o*f*u+c*a*m-o*h*m)*S,i[4]=w*S,i[5]=(d*y*s-g*f*s+g*a*m-r*y*m-d*a*b+r*f*b)*S,i[6]=(g*h*s-l*y*s-g*a*u+r*y*u+l*a*b-r*h*b)*S,i[7]=(l*f*s-d*h*s+d*a*u-r*f*u-l*a*m+r*h*m)*S,i[8]=_*S,i[9]=(g*p*s-d*v*s-g*o*m+r*v*m+d*o*b-r*p*b)*S,i[10]=(l*v*s-g*c*s+g*o*u-r*v*u-l*o*b+r*c*b)*S,i[11]=(d*c*s-l*p*s-d*o*u+r*p*u+l*o*m-r*c*m)*S,i[12]=E*S,i[13]=(d*v*a-g*p*a+g*o*f-r*v*f-d*o*y+r*p*y)*S,i[14]=(g*c*a-l*v*a-g*o*h+r*v*h+l*o*y-r*c*y)*S,i[15]=(l*p*a-d*c*a+d*o*h-r*p*h-l*o*f+r*c*f)*S,this},scale:function(e){var t=this.elements,i=e.x,n=e.y,r=e.z;return t[0]*=i,t[4]*=n,t[8]*=r,t[1]*=i,t[5]*=n,t[9]*=r,t[2]*=i,t[6]*=n,t[10]*=r,t[3]*=i,t[7]*=n,t[11]*=r,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,n))},makeTranslation:function(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var i=Math.cos(t),n=Math.sin(t),r=1-i,o=e.x,a=e.y,s=e.z,l=r*o,c=r*a;return this.set(l*o+i,l*a-n*s,l*s+n*a,0,l*a+n*s,c*a+i,c*s-n*o,0,l*s-n*a,c*s+n*o,r*s*s+i,0,0,0,0,1),this},makeScale:function(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this},makeShear:function(e,t,i){return this.set(1,t,i,0,e,1,i,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,i){return this.makeRotationFromQuaternion(t),this.scale(i),this.setPosition(e),this},decompose:(k=new rt,N=new ot,function(e,t,i){var n=this.elements,r=k.set(n[0],n[1],n[2]).length(),o=k.set(n[4],n[5],n[6]).length(),a=k.set(n[8],n[9],n[10]).length();this.determinant()<0&&(r=-r),e.x=n[12],e.y=n[13],e.z=n[14],N.copy(this);var s=1/r,l=1/o,c=1/a;return N.elements[0]*=s,N.elements[1]*=s,N.elements[2]*=s,N.elements[4]*=l,N.elements[5]*=l,N.elements[6]*=l,N.elements[8]*=c,N.elements[9]*=c,N.elements[10]*=c,t.setFromRotationMatrix(N),i.x=r,i.y=o,i.z=a,this}),makePerspective:function(e,t,i,n,r,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*r/(t-e),l=2*r/(i-n),c=(t+e)/(t-e),h=(i+n)/(i-n),u=-(o+r)/(o-r),d=-2*o*r/(o-r);return a[0]=s,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=l,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=u,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(e,t,i,n,r,o){var a=this.elements,s=1/(t-e),l=1/(i-n),c=1/(o-r),h=(t+e)*s,u=(i+n)*l,d=(o+r)*c;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-u,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(e){for(var t=this.elements,i=e.elements,n=0;n<16;n++)if(t[n]!==i[n])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var i=0;i<16;i++)this.elements[i]=e[i+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}),((at.prototype=Object.create(Ce.prototype)).constructor=at).prototype.isDataTexture=!0,((st.prototype=Object.create(Ce.prototype)).constructor=st).prototype.isCubeTexture=!0,Object.defineProperty(st.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});var lt=new Ce,ct=new st;function ht(){this.seq=[],this.map={}}var ut=[],dt=[],pt=new Float32Array(16),ft=new Float32Array(9);function mt(e,t,i){var n=e[0];if(n<=0||0<n)return e;var r=t*i,o=ut[r];if(void 0===o&&(o=new Float32Array(r),ut[r]=o),0!==t){n.toArray(o,0);for(var a=1,s=0;a!==t;++a)s+=i,e[a].toArray(o,s)}return o}function gt(e,t){var i=dt[t];void 0===i&&(i=new Int32Array(t),dt[t]=i);for(var n=0;n!==t;++n)i[n]=e.allocTextureUnit();return i}function vt(e,t){e.uniform1f(this.addr,t)}function yt(e,t){e.uniform1i(this.addr,t)}function bt(e,t){void 0===t.x?e.uniform2fv(this.addr,t):e.uniform2f(this.addr,t.x,t.y)}function xt(e,t){void 0!==t.x?e.uniform3f(this.addr,t.x,t.y,t.z):void 0!==t.r?e.uniform3f(this.addr,t.r,t.g,t.b):e.uniform3fv(this.addr,t)}function wt(e,t){void 0===t.x?e.uniform4fv(this.addr,t):e.uniform4f(this.addr,t.x,t.y,t.z,t.w)}function _t(e,t){e.uniformMatrix2fv(this.addr,!1,t.elements||t)}function Et(e,t){void 0===t.elements?e.uniformMatrix3fv(this.addr,!1,t):(ft.set(t.elements),e.uniformMatrix3fv(this.addr,!1,ft))}function Tt(e,t){void 0===t.elements?e.uniformMatrix4fv(this.addr,!1,t):(pt.set(t.elements),e.uniformMatrix4fv(this.addr,!1,pt))}function Mt(e,t,i){var n=i.allocTextureUnit();e.uniform1i(this.addr,n),i.setTexture2D(t||lt,n)}function St(e,t,i){var n=i.allocTextureUnit();e.uniform1i(this.addr,n),i.setTextureCube(t||ct,n)}function Ct(e,t){e.uniform2iv(this.addr,t)}function Rt(e,t){e.uniform3iv(this.addr,t)}function At(e,t){e.uniform4iv(this.addr,t)}function Pt(e,t){e.uniform1fv(this.addr,t)}function Lt(e,t){e.uniform1iv(this.addr,t)}function Ot(e,t){e.uniform2fv(this.addr,mt(t,this.size,2))}function It(e,t){e.uniform3fv(this.addr,mt(t,this.size,3))}function Dt(e,t){e.uniform4fv(this.addr,mt(t,this.size,4))}function kt(e,t){e.uniformMatrix2fv(this.addr,!1,mt(t,this.size,4))}function Nt(e,t){e.uniformMatrix3fv(this.addr,!1,mt(t,this.size,9))}function Ht(e,t){e.uniformMatrix4fv(this.addr,!1,mt(t,this.size,16))}function Bt(e,t,i){var n=t.length,r=gt(i,n);e.uniform1iv(this.addr,r);for(var o=0;o!==n;++o)i.setTexture2D(t[o]||lt,r[o])}function Ft(e,t,i){var n=t.length,r=gt(i,n);e.uniform1iv(this.addr,r);for(var o=0;o!==n;++o)i.setTextureCube(t[o]||ct,r[o])}function Ut(e,t,i){this.id=e,this.addr=i,this.setValue=function(e){switch(e){case 5126:return vt;case 35664:return bt;case 35665:return xt;case 35666:return wt;case 35674:return _t;case 35675:return Et;case 35676:return Tt;case 35678:case 36198:return Mt;case 35680:return St;case 5124:case 35670:return yt;case 35667:case 35671:return Ct;case 35668:case 35672:return Rt;case 35669:case 35673:return At}}(t.type)}function $t(e,t,i){this.id=e,this.addr=i,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Pt;case 35664:return Ot;case 35665:return It;case 35666:return Dt;case 35674:return kt;case 35675:return Nt;case 35676:return Ht;case 35678:return Bt;case 35680:return Ft;case 5124:case 35670:return Lt;case 35667:case 35671:return Ct;case 35668:case 35672:return Rt;case 35669:case 35673:return At}}(t.type)}function zt(e){this.id=e,ht.call(this)}zt.prototype.setValue=function(e,t){for(var i=this.seq,n=0,r=i.length;n!==r;++n){var o=i[n];o.setValue(e,t[o.id])}};var jt=/([\w\d_]+)(\])?(\[|\.)?/g;function Vt(e,t){e.seq.push(t),e.map[t.id]=t}function Gt(e,t,i){var n=e.name,r=n.length;for(jt.lastIndex=0;;){var o=jt.exec(n),a=jt.lastIndex,s=o[1],l="]"===o[2],c=o[3];if(l&&(s|=0),void 0===c||"["===c&&a+2===r){Vt(i,void 0===c?new Ut(s,e,t):new $t(s,e,t));break}var h=i.map[s];void 0===h&&Vt(i,h=new zt(s)),i=h}}function Wt(e,t,i){ht.call(this),this.renderer=i;for(var n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),r=0;r<n;++r){var o=e.getActiveUniform(t,r),a=o.name;Gt(o,e.getUniformLocation(t,a),this)}}Wt.prototype.setValue=function(e,t,i){var n=this.map[t];void 0!==n&&n.setValue(e,i,this.renderer)},Wt.prototype.setOptional=function(e,t,i){var n=t[i];void 0!==n&&this.setValue(e,i,n)},Wt.upload=function(e,t,i,n){for(var r=0,o=t.length;r!==o;++r){var a=t[r],s=i[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,n)}},Wt.seqWithValue=function(e,t){for(var i=[],n=0,r=e.length;n!==r;++n){var o=e[n];o.id in t&&i.push(o)}return i};var qt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Xt(e,t,i){return void 0===t&&void 0===i?this.set(e):this.setRGB(e,t,i)}Object.assign(Xt.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,i){return this.r=e,this.g=t,this.b=i,this},setHSL:function(){function o(e,t,i){return i<0&&(i+=1),1<i&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+6*(t-e)*(2/3-i):e}return function(e,t,i){if(e=Qe.euclideanModulo(e,1),t=Qe.clamp(t,0,1),i=Qe.clamp(i,0,1),0===t)this.r=this.g=this.b=i;else{var n=i<=.5?i*(1+t):i+t-i*t,r=2*i-n;this.r=o(r,n,e+1/3),this.g=o(r,n,e),this.b=o(r,n,e-1/3)}return this}}(),setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var n,r=i[1],o=i[2];switch(r){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,e(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,e(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(n[1])/360,s=parseInt(n[2],10)/100,l=parseInt(n[3],10)/100;return e(n[5]),this.setHSL(a,s,l)}}}else if(i=/^\#([A-Fa-f0-9]+)$/.exec(t)){var c,h=(c=i[1]).length;if(3===h)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===h)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}t&&0<t.length&&(void 0!==(c=qt[t])?this.setHex(c):console.warn("THREE.Color: Unknown color "+t));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var i=0<t?1/t:1;return this.r=Math.pow(e.r,i),this.g=Math.pow(e.g,i),this.b=Math.pow(e.b,i),this},convertGammaToLinear:function(){var e=this.r,t=this.g,i=this.b;return this.r=e*e,this.g=t*t,this.b=i*i,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){var t,i,n=e||{h:0,s:0,l:0},r=this.r,o=this.g,a=this.b,s=Math.max(r,o,a),l=Math.min(r,o,a),c=(l+s)/2;if(l===s)i=t=0;else{var h=s-l;switch(i=c<=.5?h/(s+l):h/(2-s-l),s){case r:t=(o-a)/h+(o<a?6:0);break;case o:t=(a-r)/h+2;break;case a:t=(r-o)/h+4}t/=6}return n.h=t,n.s=i,n.l=c,n},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,i){var n=this.getHSL();return n.h+=e,n.s+=t,n.l+=i,this.setHSL(n.h,n.s,n.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}});var Zt,Yt,Kt={common:{diffuse:{value:new Xt(15658734)},opacity:{value:1},map:{value:null},offsetRepeat:{value:new et(0,0,1,1)},specularMap:{value:null},alphaMap:{value:null},envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new xe(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Xt(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Xt(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},offsetRepeat:{value:new et(0,0,1,1)}}},Jt={merge:function(e){for(var t={},i=0;i<e.length;i++){var n=this.clone(e[i]);for(var r in n)t[r]=n[r]}return t},clone:function(e){var t={};for(var i in e)for(var n in t[i]={},e[i]){var r=e[i][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?t[i][n]=r.clone():Array.isArray(r)?t[i][n]=r.slice():t[i][n]=r}return t}},Qt={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat theta = acos( dot( N, V ) );\n\tvec2 uv = vec2(\n\t\tsqrt( saturate( roughness ) ),\n\t\tsaturate( theta / ( 0.5 * PI ) ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.86267 + (0.49788 + 0.01436 * y ) * y;\n\tfloat b = 3.45068 + (4.18814 + y) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = (x > 0.0) ? v : 0.5 * inversesqrt( 1.0 - x * x ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transpose( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tvec3 result = vec3( LTC_ClippedSphereFormFactor( vectorFormFactor ) );\n\treturn result;\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t\t\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\t\tvec4 plane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transpose( const in mat3 v ) {\n\tmat3 tmp;\n\ttmp[0] = vec3(v[0].x, v[1].x, v[2].x);\n\ttmp[1] = vec3(v[0].y, v[1].y, v[2].y);\n\ttmp[2] = vec3(v[0].z, v[1].z, v[2].z);\n\treturn tmp;\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = asin( flipNormal * reflectVec.y ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltcMat;\tuniform sampler2D ltcMag;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = saturate( reflectVec.y * 0.5 + 0.5 );\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tfloat norm = texture2D( ltcMag, uv ).a;\n\t\tvec4 t = texture2D( ltcMat, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3(   1,   0, t.y ),\n\t\t\tvec3(   0, t.z,   0 ),\n\t\t\tvec3( t.w,   0, t.x )\n\t\t);\n\t\treflectedLight.directSpecular += lightColor * material.specularColor * norm * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_template:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_flip:"#ifdef DOUBLE_SIDED\n\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n#else\n\tfloat flipNormal = 1.0;\n#endif\n",normal_fragment:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal ) * flipNormal;\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 1.0 - 2.0 * rgb.xyz;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"uniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n#include <common>\n#include <packing>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = packDepthToRGBA( length( vWorldPosition.xyz - lightPos.xyz ) / 1000.0 );\n}\n",distanceRGBA_vert:"varying vec4 vWorldPosition;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"uniform float opacity;\n#include <common>\n#include <packing>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( 0.0, 0.0, 0.0, opacity * ( 1.0 - getShadowMask() ) );\n}\n",shadow_vert:"#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n"},ei={basic:{uniforms:Jt.merge([Kt.common,Kt.aomap,Kt.lightmap,Kt.fog]),vertexShader:Qt.meshbasic_vert,fragmentShader:Qt.meshbasic_frag},lambert:{uniforms:Jt.merge([Kt.common,Kt.aomap,Kt.lightmap,Kt.emissivemap,Kt.fog,Kt.lights,{emissive:{value:new Xt(0)}}]),vertexShader:Qt.meshlambert_vert,fragmentShader:Qt.meshlambert_frag},phong:{uniforms:Jt.merge([Kt.common,Kt.aomap,Kt.lightmap,Kt.emissivemap,Kt.bumpmap,Kt.normalmap,Kt.displacementmap,Kt.gradientmap,Kt.fog,Kt.lights,{emissive:{value:new Xt(0)},specular:{value:new Xt(1118481)},shininess:{value:30}}]),vertexShader:Qt.meshphong_vert,fragmentShader:Qt.meshphong_frag},standard:{uniforms:Jt.merge([Kt.common,Kt.aomap,Kt.lightmap,Kt.emissivemap,Kt.bumpmap,Kt.normalmap,Kt.displacementmap,Kt.roughnessmap,Kt.metalnessmap,Kt.fog,Kt.lights,{emissive:{value:new Xt(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Qt.meshphysical_vert,fragmentShader:Qt.meshphysical_frag},points:{uniforms:Jt.merge([Kt.points,Kt.fog]),vertexShader:Qt.points_vert,fragmentShader:Qt.points_frag},dashed:{uniforms:Jt.merge([Kt.common,Kt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Qt.linedashed_vert,fragmentShader:Qt.linedashed_frag},depth:{uniforms:Jt.merge([Kt.common,Kt.displacementmap]),vertexShader:Qt.depth_vert,fragmentShader:Qt.depth_frag},normal:{uniforms:Jt.merge([Kt.common,Kt.bumpmap,Kt.normalmap,Kt.displacementmap,{opacity:{value:1}}]),vertexShader:Qt.normal_vert,fragmentShader:Qt.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Qt.cube_vert,fragmentShader:Qt.cube_frag},equirect:{uniforms:{tEquirect:{value:null},tFlip:{value:-1}},vertexShader:Qt.equirect_vert,fragmentShader:Qt.equirect_frag},distanceRGBA:{uniforms:{lightPos:{value:new rt}},vertexShader:Qt.distanceRGBA_vert,fragmentShader:Qt.distanceRGBA_frag}};function ti(e,t){this.min=void 0!==e?e:new xe(1/0,1/0),this.max=void 0!==t?t:new xe(-1/0,-1/0)}function ii(y,b){var x,w,s,_,E,T,M,S,C=y.context,R=y.state;function A(){var e,t,i,n,r,o=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),a=new Uint16Array([0,1,2,0,2,3]);x=C.createBuffer(),w=C.createBuffer(),C.bindBuffer(C.ARRAY_BUFFER,x),C.bufferData(C.ARRAY_BUFFER,o,C.STATIC_DRAW),C.bindBuffer(C.ELEMENT_ARRAY_BUFFER,w),C.bufferData(C.ELEMENT_ARRAY_BUFFER,a,C.STATIC_DRAW),M=C.createTexture(),S=C.createTexture(),R.bindTexture(C.TEXTURE_2D,M),C.texImage2D(C.TEXTURE_2D,0,C.RGB,16,16,0,C.RGB,C.UNSIGNED_BYTE,null),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_S,C.CLAMP_TO_EDGE),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_T,C.CLAMP_TO_EDGE),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MAG_FILTER,C.NEAREST),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MIN_FILTER,C.NEAREST),R.bindTexture(C.TEXTURE_2D,S),C.texImage2D(C.TEXTURE_2D,0,C.RGBA,16,16,0,C.RGBA,C.UNSIGNED_BYTE,null),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_S,C.CLAMP_TO_EDGE),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_T,C.CLAMP_TO_EDGE),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MAG_FILTER,C.NEAREST),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MIN_FILTER,C.NEAREST),s={vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if ( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if ( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if ( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},e=s,t=C.createProgram(),i=C.createShader(C.FRAGMENT_SHADER),n=C.createShader(C.VERTEX_SHADER),r="precision "+y.getPrecision()+" float;\n",C.shaderSource(i,r+e.fragmentShader),C.shaderSource(n,r+e.vertexShader),C.compileShader(i),C.compileShader(n),C.attachShader(t,i),C.attachShader(t,n),C.linkProgram(t),_=t,E={vertex:C.getAttribLocation(_,"position"),uv:C.getAttribLocation(_,"uv")},T={renderType:C.getUniformLocation(_,"renderType"),map:C.getUniformLocation(_,"map"),occlusionMap:C.getUniformLocation(_,"occlusionMap"),opacity:C.getUniformLocation(_,"opacity"),color:C.getUniformLocation(_,"color"),scale:C.getUniformLocation(_,"scale"),rotation:C.getUniformLocation(_,"rotation"),screenPosition:C.getUniformLocation(_,"screenPosition")}}this.render=function(e,t,i){if(0!==b.length){var n=new rt,r=i.w/i.z,o=.5*i.z,a=.5*i.w,s=16/i.w,l=new xe(s*r,s),c=new rt(1,1,0),h=new xe(1,1),u=new ti;u.min.set(i.x,i.y),u.max.set(i.x+(i.z-16),i.y+(i.w-16)),void 0===_&&A(),C.useProgram(_),R.initAttributes(),R.enableAttribute(E.vertex),R.enableAttribute(E.uv),R.disableUnusedAttributes(),C.uniform1i(T.occlusionMap,0),C.uniform1i(T.map,1),C.bindBuffer(C.ARRAY_BUFFER,x),C.vertexAttribPointer(E.vertex,2,C.FLOAT,!1,16,0),C.vertexAttribPointer(E.uv,2,C.FLOAT,!1,16,8),C.bindBuffer(C.ELEMENT_ARRAY_BUFFER,w),R.disable(C.CULL_FACE),R.buffers.depth.setMask(!1);for(var d=0,p=b.length;d<p;d++){s=16/i.w,l.set(s*r,s);var f=b[d];if(n.set(f.matrixWorld.elements[12],f.matrixWorld.elements[13],f.matrixWorld.elements[14]),n.applyMatrix4(t.matrixWorldInverse),n.applyMatrix4(t.projectionMatrix),c.copy(n),h.x=i.x+c.x*o+o-8,h.y=i.y+c.y*a+a-8,!0===u.containsPoint(h)){R.activeTexture(C.TEXTURE0),R.bindTexture(C.TEXTURE_2D,null),R.activeTexture(C.TEXTURE1),R.bindTexture(C.TEXTURE_2D,M),C.copyTexImage2D(C.TEXTURE_2D,0,C.RGB,h.x,h.y,16,16,0),C.uniform1i(T.renderType,0),C.uniform2f(T.scale,l.x,l.y),C.uniform3f(T.screenPosition,c.x,c.y,c.z),R.disable(C.BLEND),R.enable(C.DEPTH_TEST),C.drawElements(C.TRIANGLES,6,C.UNSIGNED_SHORT,0),R.activeTexture(C.TEXTURE0),R.bindTexture(C.TEXTURE_2D,S),C.copyTexImage2D(C.TEXTURE_2D,0,C.RGBA,h.x,h.y,16,16,0),C.uniform1i(T.renderType,1),R.disable(C.DEPTH_TEST),R.activeTexture(C.TEXTURE1),R.bindTexture(C.TEXTURE_2D,M),C.drawElements(C.TRIANGLES,6,C.UNSIGNED_SHORT,0),f.positionScreen.copy(c),f.customUpdateCallback?f.customUpdateCallback(f):f.updateLensFlares(),C.uniform1i(T.renderType,2),R.enable(C.BLEND);for(var m=0,g=f.lensFlares.length;m<g;m++){var v=f.lensFlares[m];.001<v.opacity&&.001<v.scale&&(c.x=v.x,c.y=v.y,c.z=v.z,s=v.size*v.scale/i.w,l.x=s*r,l.y=s,C.uniform3f(T.screenPosition,c.x,c.y,c.z),C.uniform2f(T.scale,l.x,l.y),C.uniform1f(T.rotation,v.rotation),C.uniform1f(T.opacity,v.opacity),C.uniform3f(T.color,v.color.r,v.color.g,v.color.b),R.setBlending(v.blending,v.blendEquation,v.blendSrc,v.blendDst),y.setTexture2D(v.texture,1),C.drawElements(C.TRIANGLES,6,C.UNSIGNED_SHORT,0))}}}R.enable(C.CULL_FACE),R.enable(C.DEPTH_TEST),R.buffers.depth.setMask(!0),y.resetGLState()}}}function ni(u,d){var p,f,m,g,v,y,b=u.context,x=u.state,w=new rt,_=new nt,E=new rt;function T(){var e,t,i,n=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),r=new Uint16Array([0,1,2,0,2,3]);p=b.createBuffer(),f=b.createBuffer(),b.bindBuffer(b.ARRAY_BUFFER,p),b.bufferData(b.ARRAY_BUFFER,n,b.STATIC_DRAW),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,f),b.bufferData(b.ELEMENT_ARRAY_BUFFER,r,b.STATIC_DRAW),e=b.createProgram(),t=b.createShader(b.VERTEX_SHADER),i=b.createShader(b.FRAGMENT_SHADER),b.shaderSource(t,["precision "+u.getPrecision()+" float;","#define SHADER_NAME SpriteMaterial","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n")),b.shaderSource(i,["precision "+u.getPrecision()+" float;","#define SHADER_NAME SpriteMaterial","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")),b.compileShader(t),b.compileShader(i),b.attachShader(e,t),b.attachShader(e,i),b.linkProgram(e),m=e,g={position:b.getAttribLocation(m,"position"),uv:b.getAttribLocation(m,"uv")},v={uvOffset:b.getUniformLocation(m,"uvOffset"),uvScale:b.getUniformLocation(m,"uvScale"),rotation:b.getUniformLocation(m,"rotation"),scale:b.getUniformLocation(m,"scale"),color:b.getUniformLocation(m,"color"),map:b.getUniformLocation(m,"map"),opacity:b.getUniformLocation(m,"opacity"),modelViewMatrix:b.getUniformLocation(m,"modelViewMatrix"),projectionMatrix:b.getUniformLocation(m,"projectionMatrix"),fogType:b.getUniformLocation(m,"fogType"),fogDensity:b.getUniformLocation(m,"fogDensity"),fogNear:b.getUniformLocation(m,"fogNear"),fogFar:b.getUniformLocation(m,"fogFar"),fogColor:b.getUniformLocation(m,"fogColor"),alphaTest:b.getUniformLocation(m,"alphaTest")};var o=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");o.width=8,o.height=8;var a=o.getContext("2d");a.fillStyle="white",a.fillRect(0,0,8,8),(y=new Ce(o)).needsUpdate=!0}function M(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:t.id-e.id}this.render=function(e,t){if(0!==d.length){void 0===m&&T(),b.useProgram(m),x.initAttributes(),x.enableAttribute(g.position),x.enableAttribute(g.uv),x.disableUnusedAttributes(),x.disable(b.CULL_FACE),x.enable(b.BLEND),b.bindBuffer(b.ARRAY_BUFFER,p),b.vertexAttribPointer(g.position,2,b.FLOAT,!1,16,0),b.vertexAttribPointer(g.uv,2,b.FLOAT,!1,16,8),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,f),b.uniformMatrix4fv(v.projectionMatrix,!1,t.projectionMatrix.elements),x.activeTexture(b.TEXTURE0),b.uniform1i(v.map,0);var i=0,n=0,r=e.fog;r?(b.uniform3f(v.fogColor,r.color.r,r.color.g,r.color.b),r.isFog?(b.uniform1f(v.fogNear,r.near),b.uniform1f(v.fogFar,r.far),b.uniform1i(v.fogType,1),n=i=1):r.isFogExp2&&(b.uniform1f(v.fogDensity,r.density),b.uniform1i(v.fogType,2),n=i=2)):(b.uniform1i(v.fogType,0),n=i=0);for(var o=0,a=d.length;o<a;o++){(l=d[o]).modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,l.matrixWorld),l.z=-l.modelViewMatrix.elements[14]}d.sort(M);var s=[];for(o=0,a=d.length;o<a;o++){var l,c=(l=d[o]).material;if(!1!==c.visible){l.onBeforeRender(u,e,t,void 0,c,void 0),b.uniform1f(v.alphaTest,c.alphaTest),b.uniformMatrix4fv(v.modelViewMatrix,!1,l.modelViewMatrix.elements),l.matrixWorld.decompose(w,_,E),s[0]=E.x,s[1]=E.y;var h=0;e.fog&&c.fog&&(h=n),i!==h&&(b.uniform1i(v.fogType,h),i=h),null!==c.map?(b.uniform2f(v.uvOffset,c.map.offset.x,c.map.offset.y),b.uniform2f(v.uvScale,c.map.repeat.x,c.map.repeat.y)):(b.uniform2f(v.uvOffset,0,0),b.uniform2f(v.uvScale,1,1)),b.uniform1f(v.opacity,c.opacity),b.uniform3f(v.color,c.color.r,c.color.g,c.color.b),b.uniform1f(v.rotation,c.rotation),b.uniform2fv(v.scale,s),x.setBlending(c.blending,c.blendEquation,c.blendSrc,c.blendDst,c.blendEquationAlpha,c.blendSrcAlpha,c.blendDstAlpha,c.premultipliedAlpha),x.buffers.depth.setTest(c.depthTest),x.buffers.depth.setMask(c.depthWrite),c.map?u.setTexture2D(c.map,0):u.setTexture2D(y,0),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0),l.onAfterRender(u,e,t,void 0,c,void 0)}}x.enable(b.CULL_FACE),u.resetGLState()}}}ei.physical={uniforms:Jt.merge([ei.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Qt.meshphysical_vert,fragmentShader:Qt.meshphysical_frag},Object.assign(ti.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:(Yt=new xe,function(e,t){var i=Yt.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){var t=e||new xe;return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){var t=e||new xe;return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return(t||new xe).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return(t||new xe).copy(e).clamp(this.min,this.max)},distanceToPoint:(Zt=new xe,function(e){return Zt.copy(e).clamp(this.min,this.max).sub(e).length()}),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var ri,oi,ai,si,li,ci,hi,ui,di,pi,fi,mi,gi,vi,yi,bi,xi,wi,_i,Ei=0;function Ti(){Object.defineProperty(this,"id",{value:Ei++}),this.uuid=Qe.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=W,this.side=F,this.shading=l,this.vertexColors=Ae,this.opacity=1,this.transparent=!1,this.blendSrc=Le,this.blendDst=Oe,this.blendEquation=Pe,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=ie,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.needsUpdate=!0}function Mi(e){Ti.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},(this.index0AttributeName=void 0)!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function Si(e){Ti.call(this),this.type="MeshDepthMaterial",this.depthPacking=_,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(e)}function Ci(e,t){this.min=void 0!==e?e:new rt(1/0,1/0,1/0),this.max=void 0!==t?t:new rt(-1/0,-1/0,-1/0)}function Ri(e,t){this.center=void 0!==e?e:new rt,this.radius=void 0!==t?t:0}function Ai(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function Pi(e,t){this.normal=void 0!==e?e:new rt(1,0,0),this.constant=void 0!==t?t:0}function Li(e,t,i,n,r,o){this.planes=[void 0!==e?e:new Pi,void 0!==t?t:new Pi,void 0!==i?i:new Pi,void 0!==n?n:new Pi,void 0!==r?r:new Pi,void 0!==o?o:new Pi]}function Oi(y,e,m,t){var b=y.context,x=y.state,w=new Li,_=new ot,E=e.shadows,T=new xe,M=new xe(t.maxTextureSize,t.maxTextureSize),S=new rt,C=new rt,g=1,v=2,i=1+(g|v),R=new Array(i),A=new Array(i),P={},L=[new rt(1,0,0),new rt(-1,0,0),new rt(0,0,1),new rt(0,0,-1),new rt(0,1,0),new rt(0,-1,0)],O=[new rt(0,1,0),new rt(0,1,0),new rt(0,1,0),new rt(0,1,0),new rt(0,0,1),new rt(0,0,-1)],I=[new et,new et,new et,new et,new et,new et],n=new Si;n.depthPacking=be,n.clipping=!0;for(var r=ei.distanceRGBA,o=Jt.clone(r.uniforms),a=0;a!==i;++a){var s=0!=(a&g),l=0!=(a&v),c=n.clone();c.morphTargets=s,c.skinning=l,R[a]=c;var h=new Mi({defines:{USE_SHADOWMAP:""},uniforms:o,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,morphTargets:s,skinning:l,clipping:!0});A[a]=h}var D=this;function k(e,t,i,n){var r=e.geometry,o=null,a=R,s=e.customDepthMaterial;if(i&&(a=A,s=e.customDistanceMaterial),s)o=s;else{var l=!1;t.morphTargets&&(r&&r.isBufferGeometry?l=r.morphAttributes&&r.morphAttributes.position&&0<r.morphAttributes.position.length:r&&r.isGeometry&&(l=r.morphTargets&&0<r.morphTargets.length)),e.isSkinnedMesh&&!1===t.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e);var c=e.isSkinnedMesh&&t.skinning,h=0;l&&(h|=g),c&&(h|=v),o=a[h]}if(y.localClippingEnabled&&!0===t.clipShadows&&0!==t.clippingPlanes.length){var u=o.uuid,d=t.uuid,p=P[u];void 0===p&&(p={},P[u]=p);var f=p[d];void 0===f&&(f=o.clone(),p[d]=f),o=f}o.visible=t.visible,o.wireframe=t.wireframe;var m=t.side;return D.renderSingleSided&&m==Y&&(m=F),D.renderReverseSided&&(m===F?m=Z:m===Z&&(m=F)),o.side=m,o.clipShadows=t.clipShadows,o.clippingPlanes=t.clippingPlanes,o.wireframeLinewidth=t.wireframeLinewidth,o.linewidth=t.linewidth,i&&void 0!==o.uniforms.lightPos&&o.uniforms.lightPos.value.copy(n),o}function N(e,t,i,n){if(!1!==e.visible){if(e.layers.test(t.layers)&&(e.isMesh||e.isLine||e.isPoints)&&e.castShadow&&(!e.frustumCulled||w.intersectsObject(e))){e.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,e.matrixWorld);var r=m.update(e),o=e.material;if(Array.isArray(o))for(var a=r.groups,s=0,l=a.length;s<l;s++){var c=a[s],h=o[c.materialIndex];if(h&&h.visible){var u=k(e,h,n,C);y.renderBufferDirect(i,null,r,u,e,c)}}else if(o.visible){u=k(e,o,n,C);y.renderBufferDirect(i,null,r,u,e,null)}}for(var d=e.children,p=0,f=d.length;p<f;p++)N(d[p],t,i,n)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=H,this.renderReverseSided=!0,this.renderSingleSided=!0,this.render=function(e,t){if(!1!==D.enabled&&(!1!==D.autoUpdate||!1!==D.needsUpdate)&&0!==E.length){var i;x.disable(b.BLEND),x.buffers.color.setClear(1,1,1,1),x.buffers.depth.setTest(!0),x.setScissorTest(!1);for(var n=0,r=E.length;n<r;n++){var o=E[n],a=o.shadow,s=o&&o.isPointLight;if(void 0!==a){var l=a.camera;if(T.copy(a.mapSize),T.min(M),s){var c=T.x,h=T.y;I[0].set(2*c,h,c,h),I[1].set(0,h,c,h),I[2].set(3*c,h,c,h),I[3].set(c,h,c,h),I[4].set(3*c,0,c,h),I[5].set(c,0,c,h),T.x*=4,T.y*=2}if(null===a.map){var u={minFilter:He,magFilter:He,format:Ze};a.map=new tt(T.x,T.y,u),a.map.texture.name=o.name+".shadowMap",l.updateProjectionMatrix()}a.isSpotLightShadow&&a.update(o);var d=a.map,p=a.matrix;C.setFromMatrixPosition(o.matrixWorld),l.position.copy(C),s?(i=6,p.makeTranslation(-C.x,-C.y,-C.z)):(i=1,S.setFromMatrixPosition(o.target.matrixWorld),l.lookAt(S),l.updateMatrixWorld(),p.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),p.multiply(l.projectionMatrix),p.multiply(l.matrixWorldInverse)),y.setRenderTarget(d),y.clear();for(var f=0;f<i;f++){if(s){S.copy(l.position),S.add(L[f]),l.up.copy(O[f]),l.lookAt(S),l.updateMatrixWorld();var m=I[f];x.viewport(m)}_.multiplyMatrices(l.projectionMatrix,l.matrixWorldInverse),w.setFromMatrix(_),N(e,t,l,s)}}else console.warn("THREE.WebGLShadowMap:",o,"has no shadow.")}var g=y.getClearColor(),v=y.getClearAlpha();y.setClearColor(g,v),D.needsUpdate=!1}}}function Ii(l){var c={};return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),c[e.uuid]},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);var t=c[e.uuid];t&&(l.deleteBuffer(t.buffer),delete c[e.uuid])},update:function(e,t){e.isInterleavedBufferAttribute&&(e=e.data);var i,n,r,o,a,s=c[e.uuid];void 0===s?c[e.uuid]=function(e,t){var i=e.array,n=e.dynamic?l.DYNAMIC_DRAW:l.STATIC_DRAW,r=l.createBuffer();l.bindBuffer(t,r),l.bufferData(t,i,n),e.onUploadCallback();var o=l.FLOAT;return i instanceof Float32Array?o=l.FLOAT:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?o=l.UNSIGNED_SHORT:i instanceof Int16Array?o=l.SHORT:i instanceof Uint32Array?o=l.UNSIGNED_INT:i instanceof Int32Array?o=l.INT:i instanceof Int8Array?o=l.BYTE:i instanceof Uint8Array&&(o=l.UNSIGNED_BYTE),{buffer:r,type:o,bytesPerElement:i.BYTES_PER_ELEMENT,version:e.version}}(e,t):s.version<e.version&&(i=s.buffer,r=t,o=(n=e).array,a=n.updateRange,l.bindBuffer(r,i),!1===n.dynamic?l.bufferData(r,o,l.STATIC_DRAW):-1===a.count?l.bufferSubData(r,0,o):0===a.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(l.bufferSubData(r,a.offset*o.BYTES_PER_ELEMENT,o.subarray(a.offset,a.offset+a.count)),a.count=-1),s.version=e.version)}}}function Di(e,t,i,n){this._x=e||0,this._y=t||0,this._z=i||0,this._order=n||Di.DefaultOrder}function ki(){this.mask=1}Object.assign(Ti.prototype,t.prototype,{isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var i=e[t];if(void 0!==i){var n=this[t];void 0!==n?n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[t]="overdraw"===t?Number(i):i:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e;t&&(e={textures:{},images:{}});var i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function n(e){var t=[];for(var i in e){var n=e[i];delete n.metadata,t.push(n)}return t}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearCoat&&(i.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(i.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,i.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(i.size=this.size),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==W&&(i.blending=this.blending),this.shading!==l&&(i.shading=this.shading),this.side!==F&&(i.side=this.side),this.vertexColors!==Ae&&(i.vertexColors=this.vertexColors),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,0<this.alphaTest&&(i.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),1<this.wireframeLinewidth&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),i.skinning=this.skinning,i.morphTargets=this.morphTargets,i.dithering=this.dithering,t){var r=n(e.textures),o=n(e.images);0<r.length&&(i.textures=r),0<o.length&&(i.images=o)}return i},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.shading=e.shading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.overdraw=e.overdraw,this.visible=e.visible,this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,i=null;if(null!==t){var n=t.length;i=new Array(n);for(var r=0;r!==n;++r)i[r]=t[r].clone()}return this.clippingPlanes=i,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),((Mi.prototype=Object.create(Ti.prototype)).constructor=Mi).prototype.isShaderMaterial=!0,Mi.prototype.copy=function(e){return Ti.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Jt.clone(e.uniforms),this.defines=e.defines,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},Mi.prototype.toJSON=function(e){var t=Ti.prototype.toJSON.call(this,e);return t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t},((Si.prototype=Object.create(Ti.prototype)).constructor=Si).prototype.isMeshDepthMaterial=!0,Si.prototype.copy=function(e){return Ti.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},Object.assign(Ci.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,i=1/0,n=1/0,r=-1/0,o=-1/0,a=-1/0,s=0,l=e.length;s<l;s+=3){var c=e[s],h=e[s+1],u=e[s+2];c<t&&(t=c),h<i&&(i=h),u<n&&(n=u),r<c&&(r=c),o<h&&(o=h),a<u&&(a=u)}return this.min.set(t,i,n),this.max.set(r,o,a),this},setFromBufferAttribute:function(e){for(var t=1/0,i=1/0,n=1/0,r=-1/0,o=-1/0,a=-1/0,s=0,l=e.count;s<l;s++){var c=e.getX(s),h=e.getY(s),u=e.getZ(s);c<t&&(t=c),h<i&&(i=h),u<n&&(n=u),r<c&&(r=c),o<h&&(o=h),a<u&&(a=u)}return this.min.set(t,i,n),this.max.set(r,o,a),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:(ci=new rt,function(e,t){var i=ci.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}),setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){var t=e||new rt;return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){var t=e||new rt;return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:(li=new rt,function(e){var a=this;return e.updateMatrixWorld(!0),e.traverse(function(e){var t,i,n=e.geometry;if(void 0!==n)if(n.isGeometry){var r=n.vertices;for(t=0,i=r.length;t<i;t++)li.copy(r[t]),li.applyMatrix4(e.matrixWorld),a.expandByPoint(li)}else if(n.isBufferGeometry){var o=n.attributes.position;if(void 0!==o)for(t=0,i=o.count;t<i;t++)li.fromBufferAttribute(o,t).applyMatrix4(e.matrixWorld),a.expandByPoint(li)}}),this}),containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return(t||new rt).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:(si=new rt,function(e){return this.clampPoint(e.center,si),si.distanceToSquared(e.center)<=e.radius*e.radius}),intersectsPlane:function(e){var t,i;return i=0<e.normal.x?(t=e.normal.x*this.min.x,e.normal.x*this.max.x):(t=e.normal.x*this.max.x,e.normal.x*this.min.x),0<e.normal.y?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),0<e.normal.z?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=e.constant&&i>=e.constant},clampPoint:function(e,t){return(t||new rt).copy(e).clamp(this.min,this.max)},distanceToPoint:(ai=new rt,function(e){return ai.copy(e).clamp(this.min,this.max).sub(e).length()}),getBoundingSphere:(oi=new rt,function(e){var t=e||new Ri;return this.getCenter(t.center),t.radius=.5*this.getSize(oi).length(),t}),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:(ri=[new rt,new rt,new rt,new rt,new rt,new rt,new rt,new rt],function(e){return this.isEmpty()||(ri[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ri[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ri[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ri[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ri[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ri[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ri[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ri[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ri)),this}),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(Ri.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:(hi=new Ci,function(e,t){var i=this.center;void 0!==t?i.copy(t):hi.setFromPoints(e).getCenter(i);for(var n=0,r=0,o=e.length;r<o;r++)n=Math.max(n,i.distanceToSquared(e[r]));return this.radius=Math.sqrt(n),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(this.center.dot(e.normal)-e.constant)<=this.radius},clampPoint:function(e,t){var i=this.center.distanceToSquared(e),n=t||new rt;return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},getBoundingBox:function(e){var t=e||new Ci;return t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.assign(Ai.prototype,{isMatrix3:!0,set:function(e,t,i,n,r,o,a,s,l){var c=this.elements;return c[0]=e,c[1]=n,c[2]=a,c[3]=t,c[4]=r,c[5]=s,c[6]=i,c[7]=o,c[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:(ui=new rt,function(e){for(var t=0,i=e.count;t<i;t++)ui.x=e.getX(t),ui.y=e.getY(t),ui.z=e.getZ(t),ui.applyMatrix3(this),e.setXYZ(t,ui.x,ui.y,ui.z);return e}),multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var i=e.elements,n=t.elements,r=this.elements,o=i[0],a=i[3],s=i[6],l=i[1],c=i[4],h=i[7],u=i[2],d=i[5],p=i[8],f=n[0],m=n[3],g=n[6],v=n[1],y=n[4],b=n[7],x=n[2],w=n[5],_=n[8];return r[0]=o*f+a*v+s*x,r[3]=o*m+a*y+s*w,r[6]=o*g+a*b+s*_,r[1]=l*f+c*v+h*x,r[4]=l*m+c*y+h*w,r[7]=l*g+c*b+h*_,r[2]=u*f+d*v+p*x,r[5]=u*m+d*y+p*w,r[8]=u*g+d*b+p*_,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],o=e[4],a=e[5],s=e[6],l=e[7],c=e[8];return t*o*c-t*a*l-i*r*c+i*a*s+n*r*l-n*o*s},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3.getInverse no longer takes a Matrix4 argument.");var i=e.elements,n=this.elements,r=i[0],o=i[1],a=i[2],s=i[3],l=i[4],c=i[5],h=i[6],u=i[7],d=i[8],p=d*l-c*u,f=c*h-d*s,m=u*s-l*h,g=r*p+o*f+a*m;if(0===g){var v="THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0";if(!0===t)throw new Error(v);return console.warn(v),this.identity()}var y=1/g;return n[0]=p*y,n[1]=(a*u-d*o)*y,n[2]=(c*o-a*l)*y,n[3]=f*y,n[4]=(d*r-a*h)*y,n[5]=(a*s-c*r)*y,n[6]=m*y,n[7]=(o*h-u*r)*y,n[8]=(l*r-o*s)*y,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},equals:function(e){for(var t=this.elements,i=e.elements,n=0;n<9;n++)if(t[n]!==i[n])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var i=0;i<9;i++)this.elements[i]=e[i+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}}),Object.assign(Pi.prototype,{set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,i,n){return this.normal.set(e,t,i),this.constant=n,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:(mi=new rt,gi=new rt,function(e,t,i){var n=mi.subVectors(i,t).cross(gi.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return this.orthoPoint(e,t).sub(e).negate()},orthoPoint:function(e,t){var i=this.distanceToPoint(e);return(t||new rt).copy(this.normal).multiplyScalar(i)},intersectLine:(fi=new rt,function(e,t){var i=t||new rt,n=e.delta(fi),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?i.copy(e.start):void 0;var o=-(e.start.dot(this.normal)+this.constant)/r;return o<0||1<o?void 0:i.copy(n).multiplyScalar(o).add(e.start)}),intersectsLine:function(e){var t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&0<i||i<0&&0<t},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return(e||new rt).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:(di=new rt,pi=new Ai,function(e,t){var i=this.coplanarPoint(di).applyMatrix4(e),n=t||pi.getNormalMatrix(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}),translate:function(e){return this.constant=this.constant-e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}),Object.assign(Li.prototype,{set:function(e,t,i,n,r,o){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(n),a[4].copy(r),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,i=0;i<6;i++)t[i].copy(e.planes[i]);return this},setFromMatrix:function(e){var t=this.planes,i=e.elements,n=i[0],r=i[1],o=i[2],a=i[3],s=i[4],l=i[5],c=i[6],h=i[7],u=i[8],d=i[9],p=i[10],f=i[11],m=i[12],g=i[13],v=i[14],y=i[15];return t[0].setComponents(a-n,h-s,f-u,y-m).normalize(),t[1].setComponents(a+n,h+s,f+u,y+m).normalize(),t[2].setComponents(a+r,h+l,f+d,y+g).normalize(),t[3].setComponents(a-r,h-l,f-d,y-g).normalize(),t[4].setComponents(a-o,h-c,f-p,y-v).normalize(),t[5].setComponents(a+o,h+c,f+p,y+v).normalize(),this},intersectsObject:(xi=new Ri,function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),xi.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(xi)}),intersectsSprite:(bi=new Ri,function(e){return bi.center.set(0,0,0),bi.radius=.7071067811865476,bi.applyMatrix4(e.matrixWorld),this.intersectsSphere(bi)}),intersectsSphere:function(e){for(var t=this.planes,i=e.center,n=-e.radius,r=0;r<6;r++){if(t[r].distanceToPoint(i)<n)return!1}return!0},intersectsBox:(vi=new rt,yi=new rt,function(e){for(var t=this.planes,i=0;i<6;i++){var n=t[i];vi.x=0<n.normal.x?e.min.x:e.max.x,yi.x=0<n.normal.x?e.max.x:e.min.x,vi.y=0<n.normal.y?e.min.y:e.max.y,yi.y=0<n.normal.y?e.max.y:e.min.y,vi.z=0<n.normal.z?e.min.z:e.max.z,yi.z=0<n.normal.z?e.max.z:e.min.z;var r=n.distanceToPoint(vi),o=n.distanceToPoint(yi);if(r<0&&o<0)return!1}return!0}),containsPoint:function(e){for(var t=this.planes,i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}}),Di.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Di.DefaultOrder="XYZ",Object.defineProperties(Di.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this.onChangeCallback()}}}),Object.assign(Di.prototype,{isEuler:!0,set:function(e,t,i,n){return this._x=e,this._y=t,this._z=i,this._order=n||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,i){var n=Qe.clamp,r=e.elements,o=r[0],a=r[4],s=r[8],l=r[1],c=r[5],h=r[9],u=r[2],d=r[6],p=r[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(n(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-h,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(d,c),this._z=0)):"YXZ"===t?(this._x=Math.asin(-n(h,-1,1)),Math.abs(h)<.99999?(this._y=Math.atan2(s,p),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-u,o),this._z=0)):"ZXY"===t?(this._x=Math.asin(n(d,-1,1)),Math.abs(d)<.99999?(this._y=Math.atan2(-u,p),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(l,o))):"ZYX"===t?(this._y=Math.asin(-n(u,-1,1)),Math.abs(u)<.99999?(this._x=Math.atan2(d,p),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-a,c))):"YZX"===t?(this._z=Math.asin(n(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-h,c),this._y=Math.atan2(-u,o)):(this._x=0,this._y=Math.atan2(s,p))):"XZY"===t?(this._z=Math.asin(-n(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(d,c),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-h,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==i&&this.onChangeCallback(),this},setFromQuaternion:(_i=new ot,function(e,t,i){return _i.makeRotationFromQuaternion(e),this.setFromRotationMatrix(_i,t,i)}),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:(wi=new nt,function(e){return wi.setFromEuler(this),this.setFromQuaternion(wi,e)}),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new rt(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(ki.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},test:function(e){return 0!=(this.mask&e.mask)}});var Ni,Hi,Bi,Fi,Ui,$i,zi,ji,Vi,Gi,Wi,qi,Xi,Zi,Yi,Ki,Ji,Qi=0;function en(){Object.defineProperty(this,"id",{value:Qi++}),this.uuid=Qe.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=en.DefaultUp.clone();var e=new rt,t=new Di,i=new nt,n=new rt(1,1,1);t.onChange(function(){i.setFromEuler(t,!1)}),i.onChange(function(){t.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:e},rotation:{enumerable:!0,value:t},quaternion:{enumerable:!0,value:i},scale:{enumerable:!0,value:n},modelViewMatrix:{value:new ot},normalMatrix:{value:new Ai}}),this.matrix=new ot,this.matrixWorld=new ot,this.matrixAutoUpdate=en.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new ki,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function tn(){en.call(this),this.type="Camera",this.matrixWorldInverse=new ot,this.projectionMatrix=new ot}function nn(e,t,i,n,r,o){tn.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=n,this.near=void 0!==r?r:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function rn(e,t,i,n){tn.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==i?i:.1,this.far=void 0!==n?n:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function on(e,t,i,n,r,o){this.a=e,this.b=t,this.c=i,this.normal=n&&n.isVector3?n:new rt,this.vertexNormals=Array.isArray(n)?n:[],this.color=r&&r.isColor?r:new Xt,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==o?o:0}en.DefaultUp=new rt(0,1,0),en.DefaultMatrixAutoUpdate=!0,Object.assign(en.prototype,t.prototype,{isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:(Ki=new nt,function(e,t){return Ki.setFromAxisAngle(e,t),this.quaternion.multiply(Ki),this}),rotateX:(Yi=new rt(1,0,0),function(e){return this.rotateOnAxis(Yi,e)}),rotateY:(Zi=new rt(0,1,0),function(e){return this.rotateOnAxis(Zi,e)}),rotateZ:(Xi=new rt(0,0,1),function(e){return this.rotateOnAxis(Xi,e)}),translateOnAxis:(qi=new rt,function(e,t){return qi.copy(e).applyQuaternion(this.quaternion),this.position.add(qi.multiplyScalar(t)),this}),translateX:(Wi=new rt(1,0,0),function(e){return this.translateOnAxis(Wi,e)}),translateY:(Gi=new rt(0,1,0),function(e){return this.translateOnAxis(Gi,e)}),translateZ:(Vi=new rt(0,0,1),function(e){return this.translateOnAxis(Vi,e)}),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:(ji=new ot,function(e){return e.applyMatrix4(ji.getInverse(this.matrixWorld))}),lookAt:(zi=new ot,function(e){this.isCamera?zi.lookAt(this.position,e,this.up):zi.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(zi)}),add:function(e){if(1<arguments.length){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",e):e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this},remove:function(e){if(1<arguments.length){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var i=this.children.indexOf(e);return-1!==i&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(i,1)),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var i=0,n=this.children.length;i<n;i++){var r=this.children[i].getObjectByProperty(e,t);if(void 0!==r)return r}},getWorldPosition:function(e){var t=e||new rt;return this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:(Ui=new rt,$i=new rt,function(e){var t=e||new nt;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(Ui,t,$i),t}),getWorldRotation:(Fi=new nt,function(e){var t=e||new Di;return this.getWorldQuaternion(Fi),t.setFromQuaternion(Fi,this.rotation.order,!1)}),getWorldScale:(Hi=new rt,Bi=new nt,function(e){var t=e||new rt;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(Hi,Bi,t),t}),getWorldDirection:(Ni=new nt,function(e){var t=e||new rt;return this.getWorldQuaternion(Ni),t.set(0,0,1).applyQuaternion(Ni)}),raycast:function(){},traverse:function(e){e(this);for(var t=this.children,i=0,n=t.length;i<n;i++)t[i].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,i=0,n=t.length;i<n;i++)t[i].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e=!(this.matrixWorldNeedsUpdate=!1));for(var t=this.children,i=0,n=t.length;i<n;i++)t[i].updateMatrixWorld(e)},toJSON:function(i){var e=void 0===i||""===i,t={};e&&(i={geometries:{},materials:{},textures:{},images:{}},t.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var n={};function r(e,t){return void 0===e[t.uuid]&&(e[t.uuid]=t.toJSON(i)),t.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),n.matrix=this.matrix.toArray(),void 0!==this.geometry&&(n.geometry=r(i.geometries,this.geometry)),void 0!==this.material)if(Array.isArray(this.material)){for(var o=[],a=0,s=this.material.length;a<s;a++)o.push(r(i.materials,this.material[a]));n.material=o}else n.material=r(i.materials,this.material);if(0<this.children.length){n.children=[];for(a=0;a<this.children.length;a++)n.children.push(this.children[a].toJSON(i).object)}if(e){var l=d(i.geometries),c=d(i.materials),h=d(i.textures),u=d(i.images);0<l.length&&(t.geometries=l),0<c.length&&(t.materials=c),0<h.length&&(t.textures=h),0<u.length&&(t.images=u)}return t.object=n,t;function d(e){var t=[];for(var i in e){var n=e[i];delete n.metadata,t.push(n)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var i=0;i<e.children.length;i++){var n=e.children[i];this.add(n.clone())}return this}}),tn.prototype=Object.assign(Object.create(en.prototype),{constructor:tn,isCamera:!0,copy:function(e,t){return en.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this},getWorldDirection:(Ji=new nt,function(e){var t=e||new rt;return this.getWorldQuaternion(Ji),t.set(0,0,-1).applyQuaternion(Ji)}),updateMatrixWorld:function(e){en.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),nn.prototype=Object.assign(Object.create(tn.prototype),{constructor:nn,isOrthographicCamera:!0,copy:function(e,t){return tn.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,i,n,r,o){this.view={fullWidth:e,fullHeight:t,offsetX:i,offsetY:n,width:r,height:o},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2,r=i-e,o=i+e,a=n+t,s=n-t;if(null!==this.view){var l=this.zoom/(this.view.width/this.view.fullWidth),c=this.zoom/(this.view.height/this.view.fullHeight),h=(this.right-this.left)/this.view.width,u=(this.top-this.bottom)/this.view.height;o=(r+=h*(this.view.offsetX/l))+h*(this.view.width/l),s=(a-=u*(this.view.offsetY/c))-u*(this.view.height/c)}this.projectionMatrix.makeOrthographic(r,o,a,s,this.near,this.far)},toJSON:function(e){var t=en.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),rn.prototype=Object.assign(Object.create(tn.prototype),{constructor:rn,isPerspectiveCamera:!0,copy:function(e,t){return tn.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*Qe.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*Qe.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*Qe.RAD2DEG*Math.atan(Math.tan(.5*Qe.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,i,n,r,o){this.aspect=e/t,this.view={fullWidth:e,fullHeight:t,offsetX:i,offsetY:n,width:r,height:o},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*Qe.DEG2RAD*this.fov)/this.zoom,i=2*t,n=this.aspect*i,r=-.5*n,o=this.view;if(null!==o){var a=o.fullWidth,s=o.fullHeight;r+=o.offsetX*n/a,t-=o.offsetY*i/s,n*=o.width/a,i*=o.height/s}var l=this.filmOffset;0!==l&&(r+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+n,t,t-i,e,this.far)},toJSON:function(e){var t=en.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),Object.assign(on.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,i=e.vertexNormals.length;t<i;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,i=e.vertexColors.length;t<i;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});var an,sn,ln,cn,hn,un,dn,pn,fn,mn,gn,vn,yn,bn,xn,wn,_n,En,Tn,Mn,Sn,Cn,Rn,An,Pn,Ln,On,In,Dn,kn,Nn,Hn,Bn,Fn,Un,$n,zn,jn,Vn=0;function Gn(){return Vn++}function Wn(){Object.defineProperty(this,"id",{value:Gn()}),this.uuid=Qe.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function qn(e,t,i){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=Qe.generateUUID(),this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===i,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function Xn(e,t){qn.call(this,new Int8Array(e),t)}function Zn(e,t){qn.call(this,new Uint8Array(e),t)}function Yn(e,t){qn.call(this,new Uint8ClampedArray(e),t)}function Kn(e,t){qn.call(this,new Int16Array(e),t)}function Jn(e,t){qn.call(this,new Uint16Array(e),t)}function Qn(e,t){qn.call(this,new Int32Array(e),t)}function er(e,t){qn.call(this,new Uint32Array(e),t)}function tr(e,t){qn.call(this,new Float32Array(e),t)}function ir(e,t){qn.call(this,new Float64Array(e),t)}function nr(){this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function rr(e){if(0===e.length)return-1/0;for(var t=e[0],i=1,n=e.length;i<n;++i)e[i]>t&&(t=e[i]);return t}function or(){Object.defineProperty(this,"id",{value:Gn()}),this.uuid=Qe.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}function ar(e,t,i,n,r,o){Wn.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:n,heightSegments:r,depthSegments:o},this.fromBufferGeometry(new sr(e,t,i,n,r,o)),this.mergeVertices()}function sr(e,t,i,n,r,o){or.call(this),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:n,heightSegments:r,depthSegments:o};var A=this;n=Math.floor(n)||1,r=Math.floor(r)||1,o=Math.floor(o)||1;var P=[],L=[],O=[],I=[],D=0,k=0;function a(e,t,i,n,r,o,a,s,l,c,h){var u,d,p=o/l,f=a/c,m=o/2,g=a/2,v=s/2,y=l+1,b=c+1,x=0,w=0,_=new rt;for(d=0;d<b;d++){var E=d*f-g;for(u=0;u<y;u++){var T=u*p-m;_[e]=T*n,_[t]=E*r,_[i]=v,L.push(_.x,_.y,_.z),_[e]=0,_[t]=0,_[i]=0<s?1:-1,O.push(_.x,_.y,_.z),I.push(u/l),I.push(1-d/c),x+=1}}for(d=0;d<c;d++)for(u=0;u<l;u++){var M=D+u+y*d,S=D+u+y*(d+1),C=D+(u+1)+y*(d+1),R=D+(u+1)+y*d;P.push(M,S,R),P.push(S,C,R),w+=6}A.addGroup(k,w,h),k+=w,D+=x}a("z","y","x",-1,-1,i,t,e,o,r,0),a("z","y","x",1,-1,i,t,-e,o,r,1),a("x","z","y",1,1,e,i,t,n,o,2),a("x","z","y",1,-1,e,i,-t,n,o,3),a("x","y","z",1,-1,e,t,i,n,r,4),a("x","y","z",-1,-1,e,t,-i,n,r,5),this.setIndex(P),this.addAttribute("position",new tr(L,3)),this.addAttribute("normal",new tr(O,3)),this.addAttribute("uv",new tr(I,2))}function lr(e,t,i,n){Wn.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:n},this.fromBufferGeometry(new cr(e,t,i,n)),this.mergeVertices()}function cr(e,t,i,n){or.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:n};var r,o,a=e/2,s=t/2,l=Math.floor(i)||1,c=Math.floor(n)||1,h=l+1,u=c+1,d=e/l,p=t/c,f=[],m=[],g=[],v=[];for(o=0;o<u;o++){var y=o*p-s;for(r=0;r<h;r++){var b=r*d-a;m.push(b,-y,0),g.push(0,0,1),v.push(r/l),v.push(1-o/c)}}for(o=0;o<c;o++)for(r=0;r<l;r++){var x=r+h*o,w=r+h*(o+1),_=r+1+h*(o+1),E=r+1+h*o;f.push(x,w,E),f.push(w,_,E)}this.setIndex(f),this.addAttribute("position",new tr(m,3)),this.addAttribute("normal",new tr(g,3)),this.addAttribute("uv",new tr(v,2))}function hr(e){Ti.call(this),this.type="MeshBasicMaterial",this.color=new Xt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=U,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function ur(e,t){this.origin=void 0!==e?e:new rt,this.direction=void 0!==t?t:new rt}function dr(e,t){this.start=void 0!==e?e:new rt,this.end=void 0!==t?t:new rt}function pr(e,t,i){this.a=void 0!==e?e:new rt,this.b=void 0!==t?t:new rt,this.c=void 0!==i?i:new rt}function fr(e,t){en.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new or,this.material=void 0!==t?t:new hr({color:16777215*Math.random()}),this.drawMode=Je,this.updateMorphTargets()}function mr(r,i,o,n){var a,s,l,c,h=new Xt(0),u=0;function d(e,t){i.buffers.color.setClear(e.r,e.g,e.b,t,n)}return{getClearColor:function(){return h},setClearColor:function(e,t){h.set(e),d(h,u=void 0!==t?t:1)},getClearAlpha:function(){return u},setClearAlpha:function(e){d(h,u=e)},render:function(e,t,i){var n=e.background;null===n?d(h,u):n&&n.isColor&&(d(n,1),i=!0),(r.autoClear||i)&&r.clear(r.autoClearColor,r.autoClearDepth,r.autoClearStencil),n&&n.isCubeTexture?(void 0===l&&(l=new rn,c=new fr(new sr(5,5,5),new Mi({uniforms:ei.cube.uniforms,vertexShader:ei.cube.vertexShader,fragmentShader:ei.cube.fragmentShader,side:Z,depthTest:!1,depthWrite:!1,fog:!1}))),l.projectionMatrix.copy(t.projectionMatrix),l.matrixWorld.extractRotation(t.matrixWorld),l.matrixWorldInverse.getInverse(l.matrixWorld),c.material.uniforms.tCube.value=n,c.modelViewMatrix.multiplyMatrices(l.matrixWorldInverse,c.matrixWorld),o.update(c),r.renderBufferDirect(l,null,c.geometry,c.material,c,null)):n&&n.isTexture&&(void 0===a&&(a=new nn(-1,1,1,-1,0,1),s=new fr(new cr(2,2),new hr({depthTest:!1,depthWrite:!1,fog:!1}))),s.material.map=n,o.update(s),r.renderBufferDirect(a,null,s.geometry,s.material,s,null))}}}function gr(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program&&t.program&&e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function vr(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function yr(){var l=[],c=-1,h=[],u=-1;return{opaque:l,transparent:h,init:function(){u=c=-1},push:function(e,t,i,n,r){var o,a;a=i.transparent?(o=h,++u):(o=l,++c);var s=o[a];s?(s.id=e.id,s.object=e,s.geometry=t,s.material=i,s.program=i.program,s.renderOrder=e.renderOrder,s.z=n,s.group=r):(s={id:e.id,object:e,geometry:t,material:i,program:i.program,renderOrder:e.renderOrder,z:n,group:r},o.push(s))},finish:function(){l.length=c+1,h.length=u+1},sort:function(){l.sort(gr),h.sort(vr)}}}function br(){var r={};return{get:function(e,t){var i=e.id+","+t.id,n=r[i];return void 0===n&&(n=new yr,r[i]=n),n},dispose:function(){r={}}}}function xr(r,o,a){var s,l,c;this.setMode=function(e){s=e},this.setIndex=function(e){l=e.type,c=e.bytesPerElement},this.render=function(e,t){r.drawElements(s,t,l,e*c),a.calls++,a.vertices+=t,s===r.TRIANGLES&&(a.faces+=t/3)},this.renderInstances=function(e,t,i){var n=o.get("ANGLE_instanced_arrays");null!==n?(n.drawElementsInstancedANGLE(s,i,l,t*c,e.maxInstancedCount),a.calls++,a.vertices+=i*e.maxInstancedCount,s===r.TRIANGLES&&(a.faces+=e.maxInstancedCount*i/3)):console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}function wr(o,a,s){var l;this.setMode=function(e){l=e},this.render=function(e,t){o.drawArrays(l,e,t),s.calls++,s.vertices+=t,l===o.TRIANGLES&&(s.faces+=t/3)},this.renderInstances=function(e,t,i){var n=a.get("ANGLE_instanced_arrays");if(null!==n){var r=e.attributes.position;r.isInterleavedBufferAttribute?(i=r.data.count,n.drawArraysInstancedANGLE(l,0,i,e.maxInstancedCount)):n.drawArraysInstancedANGLE(l,t,i,e.maxInstancedCount),s.calls++,s.vertices+=i*e.maxInstancedCount,l===o.TRIANGLES&&(s.faces+=e.maxInstancedCount*i/3)}else console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}function _r(u,d,o){var a={},p={};function s(e){var t=e.target,i=a[t.id];for(var n in null!==i.index&&d.remove(i.index),i.attributes)d.remove(i.attributes[n]);t.removeEventListener("dispose",s),delete a[t.id];var r=p[t.id];r&&(d.remove(r),delete p[t.id]),(r=p[i.id])&&(d.remove(r),delete p[i.id]),o.geometries--}return{get:function(e,t){var i=a[t.id];return i||(t.addEventListener("dispose",s),t.isBufferGeometry?i=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new or).setFromObject(e)),i=t._bufferGeometry),a[t.id]=i,o.geometries++,i)},update:function(e){var t=e.index,i=e.attributes;for(var n in null!==t&&d.update(t,u.ELEMENT_ARRAY_BUFFER),i)d.update(i[n],u.ARRAY_BUFFER);var r=e.morphAttributes;for(var n in r)for(var o=r[n],a=0,s=o.length;a<s;a++)d.update(o[a],u.ARRAY_BUFFER)},getWireframeAttribute:function(e){var t=p[e.id];if(t)return t;var i,n=[],r=e.index,o=e.attributes;if(null!==r)for(var a=0,s=(i=r.array).length;a<s;a+=3){var l=i[a+0],c=i[a+1],h=i[a+2];n.push(l,c,c,h,h,l)}else for(a=0,s=(i=o.position.array).length/3-1;a<s;a+=3)l=a+0,c=a+1,h=a+2,n.push(l,c,c,h,h,l);return t=new(65535<rr(n)?er:Jn)(n,1),d.update(t,u.ELEMENT_ARRAY_BUFFER),p[e.id]=t}}}function Er(){var i={};return{get:function(e){if(void 0!==i[e.id])return i[e.id];var t;switch(e.type){case"DirectionalLight":t={direction:new rt,color:new Xt,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new xe};break;case"SpotLight":t={position:new rt,direction:new rt,color:new Xt,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new xe};break;case"PointLight":t={position:new rt,color:new Xt,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new xe};break;case"HemisphereLight":t={direction:new rt,skyColor:new Xt,groundColor:new Xt};break;case"RectAreaLight":t={color:new Xt,position:new rt,halfWidth:new rt,halfHeight:new rt}}return i[e.id]=t}}}function Tr(e,r,o){var a={};return{update:function(e){var t=o.frame,i=e.geometry,n=r.get(e,i);return a[n.id]!==t&&(i.isGeometry&&n.updateFromObject(e),r.update(n),a[n.id]=t),n},clear:function(){a={}}}}function Mr(e,t,i){var n=e.createShader(t);return e.shaderSource(n,i),e.compileShader(n),!1===e.getShaderParameter(n,e.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(n)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",t===e.VERTEX_SHADER?"vertex":"fragment",e.getShaderInfoLog(n),function(e){for(var t=e.split("\n"),i=0;i<t.length;i++)t[i]=i+1+": "+t[i];return t.join("\n")}(i)),n}Object.assign(Wn.prototype,t.prototype,{isGeometry:!0,applyMatrix:function(e){for(var t=(new Ai).getNormalMatrix(e),i=0,n=this.vertices.length;i<n;i++){this.vertices[i].applyMatrix4(e)}for(i=0,n=this.faces.length;i<n;i++){var r=this.faces[i];r.normal.applyMatrix3(t).normalize();for(var o=0,a=r.vertexNormals.length;o<a;o++)r.vertexNormals[o].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:(un=new ot,function(e){return un.makeRotationX(e),this.applyMatrix(un),this}),rotateY:(hn=new ot,function(e){return hn.makeRotationY(e),this.applyMatrix(hn),this}),rotateZ:(cn=new ot,function(e){return cn.makeRotationZ(e),this.applyMatrix(cn),this}),translate:(ln=new ot,function(e,t,i){return ln.makeTranslation(e,t,i),this.applyMatrix(ln),this}),scale:(sn=new ot,function(e,t,i){return sn.makeScale(e,t,i),this.applyMatrix(sn),this}),lookAt:(an=new en,function(e){an.lookAt(e),an.updateMatrix(),this.applyMatrix(an.matrix)}),fromBufferGeometry:function(e){var o=this,t=null!==e.index?e.index.array:void 0,i=e.attributes,n=i.position.array,a=void 0!==i.normal?i.normal.array:void 0,s=void 0!==i.color?i.color.array:void 0,l=void 0!==i.uv?i.uv.array:void 0,c=void 0!==i.uv2?i.uv2.array:void 0;void 0!==c&&(this.faceVertexUvs[1]=[]);for(var h=[],u=[],d=[],r=0,p=0;r<n.length;r+=3,p+=2)o.vertices.push(new rt(n[r],n[r+1],n[r+2])),void 0!==a&&h.push(new rt(a[r],a[r+1],a[r+2])),void 0!==s&&o.colors.push(new Xt(s[r],s[r+1],s[r+2])),void 0!==l&&u.push(new xe(l[p],l[p+1])),void 0!==c&&d.push(new xe(c[p],c[p+1]));function f(e,t,i,n){var r=new on(e,t,i,void 0!==a?[h[e].clone(),h[t].clone(),h[i].clone()]:[],void 0!==s?[o.colors[e].clone(),o.colors[t].clone(),o.colors[i].clone()]:[],n);o.faces.push(r),void 0!==l&&o.faceVertexUvs[0].push([u[e].clone(),u[t].clone(),u[i].clone()]),void 0!==c&&o.faceVertexUvs[1].push([d[e].clone(),d[t].clone(),d[i].clone()])}var m=e.groups;if(0<m.length)for(r=0;r<m.length;r++)for(var g=m[r],v=g.start,y=(p=v,v+g.count);p<y;p+=3)void 0!==t?f(t[p],t[p+1],t[p+2],g.materialIndex):f(p,p+1,p+2,g.materialIndex);else if(void 0!==t)for(r=0;r<t.length;r+=3)f(t[r],t[r+1],t[r+2]);else for(r=0;r<n.length/3;r+=3)f(r,r+1,r+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var e=this.boundingBox.getCenter().negate();return this.translate(e.x,e.y,e.z),e},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,i=0===t?1:1/t,n=new ot;return n.set(i,0,0,-i*e.x,0,i,0,-i*e.y,0,0,i,-i*e.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var e=new rt,t=new rt,i=0,n=this.faces.length;i<n;i++){var r=this.faces[i],o=this.vertices[r.a],a=this.vertices[r.b],s=this.vertices[r.c];e.subVectors(s,a),t.subVectors(o,a),e.cross(t),e.normalize(),r.normal.copy(e)}},computeVertexNormals:function(e){var t,i,n,r,o,a;for(void 0===e&&(e=!0),a=new Array(this.vertices.length),t=0,i=this.vertices.length;t<i;t++)a[t]=new rt;if(e){var s,l,c,h=new rt,u=new rt;for(n=0,r=this.faces.length;n<r;n++)o=this.faces[n],s=this.vertices[o.a],l=this.vertices[o.b],c=this.vertices[o.c],h.subVectors(c,l),u.subVectors(s,l),h.cross(u),a[o.a].add(h),a[o.b].add(h),a[o.c].add(h)}else for(this.computeFaceNormals(),n=0,r=this.faces.length;n<r;n++)a[(o=this.faces[n]).a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(t=0,i=this.vertices.length;t<i;t++)a[t].normalize();for(n=0,r=this.faces.length;n<r;n++){var d=(o=this.faces[n]).vertexNormals;3===d.length?(d[0].copy(a[o.a]),d[1].copy(a[o.b]),d[2].copy(a[o.c])):(d[0]=a[o.a].clone(),d[1]=a[o.b].clone(),d[2]=a[o.c].clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,i;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var n=(i=this.faces[e]).vertexNormals;3===n.length?(n[0].copy(i.normal),n[1].copy(i.normal),n[2].copy(i.normal)):(n[0]=i.normal.clone(),n[1]=i.normal.clone(),n[2]=i.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,i,n,r;for(i=0,n=this.faces.length;i<n;i++)for((r=this.faces[i]).__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),e=0,t=r.vertexNormals.length;e<t;e++)r.__originalVertexNormals[e]?r.__originalVertexNormals[e].copy(r.vertexNormals[e]):r.__originalVertexNormals[e]=r.vertexNormals[e].clone();var o=new Wn;for(o.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var a=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(i=0,n=this.faces.length;i<n;i++)l=new rt,c={a:new rt,b:new rt,c:new rt},a.push(l),s.push(c)}var l,c,h=this.morphNormals[e];for(o.vertices=this.morphTargets[e].vertices,o.computeFaceNormals(),o.computeVertexNormals(),i=0,n=this.faces.length;i<n;i++)r=this.faces[i],l=h.faceNormals[i],c=h.vertexNormals[i],l.copy(r.normal),c.a.copy(r.vertexNormals[0]),c.b.copy(r.vertexNormals[1]),c.c.copy(r.vertexNormals[2])}for(i=0,n=this.faces.length;i<n;i++)(r=this.faces[i]).normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeLineDistances:function(){for(var e=0,t=this.vertices,i=0,n=t.length;i<n;i++)0<i&&(e+=t[i].distanceTo(t[i-1])),this.lineDistances[i]=e},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Ci),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Ri),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,i){if(e&&e.isGeometry){var n,r=this.vertices.length,o=this.vertices,a=e.vertices,s=this.faces,l=e.faces,c=this.faceVertexUvs[0],h=e.faceVertexUvs[0],u=this.colors,d=e.colors;void 0===i&&(i=0),void 0!==t&&(n=(new Ai).getNormalMatrix(t));for(var p=0,f=a.length;p<f;p++){var m=a[p].clone();void 0!==t&&m.applyMatrix4(t),o.push(m)}for(p=0,f=d.length;p<f;p++)u.push(d[p].clone());for(p=0,f=l.length;p<f;p++){var g,v,y,b=l[p],x=b.vertexNormals,w=b.vertexColors;(g=new on(b.a+r,b.b+r,b.c+r)).normal.copy(b.normal),void 0!==n&&g.normal.applyMatrix3(n).normalize();for(var _=0,E=x.length;_<E;_++)v=x[_].clone(),void 0!==n&&v.applyMatrix3(n).normalize(),g.vertexNormals.push(v);g.color.copy(b.color);for(_=0,E=w.length;_<E;_++)y=w[_],g.vertexColors.push(y.clone());g.materialIndex=b.materialIndex+i,s.push(g)}for(p=0,f=h.length;p<f;p++){var T=h[p],M=[];if(void 0!==T){for(_=0,E=T.length;_<E;_++)M.push(T[_].clone());c.push(M)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e,t,i,n,r,o,a,s,l={},c=[],h=[],u=Math.pow(10,4);for(i=0,n=this.vertices.length;i<n;i++)e=this.vertices[i],void 0===l[t=Math.round(e.x*u)+"_"+Math.round(e.y*u)+"_"+Math.round(e.z*u)]?(l[t]=i,c.push(this.vertices[i]),h[i]=c.length-1):h[i]=h[l[t]];var d=[];for(i=0,n=this.faces.length;i<n;i++){(r=this.faces[i]).a=h[r.a],r.b=h[r.b],r.c=h[r.c],o=[r.a,r.b,r.c];for(var p=0;p<3;p++)if(o[p]===o[(p+1)%3]){d.push(i);break}}for(i=d.length-1;0<=i;i--){var f=d[i];for(this.faces.splice(f,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(f,1)}var m=this.vertices.length-c.length;return this.vertices=c,m},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,i=0;i<t;i++)e[i]._id=i;e.sort(function(e,t){return e.materialIndex-t.materialIndex});var n,r,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];o&&o.length===t&&(n=[]),a&&a.length===t&&(r=[]);for(i=0;i<t;i++){var s=e[i]._id;n&&n.push(o[s]),r&&r.push(a[s])}n&&(this.faceVertexUvs[0]=n),r&&(this.faceVertexUvs[1]=r)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var i in t)void 0!==t[i]&&(e[i]=t[i]);return e}for(var n=[],r=0;r<this.vertices.length;r++){var o=this.vertices[r];n.push(o.x,o.y,o.z)}var a=[],s=[],l={},c=[],h={},u=[],d={};for(r=0;r<this.faces.length;r++){var p=this.faces[r],f=void 0!==this.faceVertexUvs[0][r],m=0<p.normal.length(),g=0<p.vertexNormals.length,v=1!==p.color.r||1!==p.color.g||1!==p.color.b,y=0<p.vertexColors.length,b=0;if(b=E(b=E(b=E(b=E(b=E(b=E(b=E(b=E(b,0,0),1,!0),2,!1),3,f),4,m),5,g),6,v),7,y),a.push(b),a.push(p.a,p.b,p.c),a.push(p.materialIndex),f){var x=this.faceVertexUvs[0][r];a.push(S(x[0]),S(x[1]),S(x[2]))}if(m&&a.push(T(p.normal)),g){var w=p.vertexNormals;a.push(T(w[0]),T(w[1]),T(w[2]))}if(v&&a.push(M(p.color)),y){var _=p.vertexColors;a.push(M(_[0]),M(_[1]),M(_[2]))}}function E(e,t,i){return i?e|1<<t:e&~(1<<t)}function T(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==l[t]||(l[t]=s.length/3,s.push(e.x,e.y,e.z)),l[t]}function M(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==h[t]||(h[t]=c.length,c.push(e.getHex())),h[t]}function S(e){var t=e.x.toString()+e.y.toString();return void 0!==d[t]||(d[t]=u.length/2,u.push(e.x,e.y)),d[t]}return e.data={},e.data.vertices=n,e.data.normals=s,0<c.length&&(e.data.colors=c),0<u.length&&(e.data.uvs=[u]),e.data.faces=a,e},clone:function(){return(new Wn).copy(this)},copy:function(e){var t,i,n,r,o,a;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var s=e.vertices;for(t=0,i=s.length;t<i;t++)this.vertices.push(s[t].clone());var l=e.colors;for(t=0,i=l.length;t<i;t++)this.colors.push(l[t].clone());var c=e.faces;for(t=0,i=c.length;t<i;t++)this.faces.push(c[t].clone());for(t=0,i=e.faceVertexUvs.length;t<i;t++){var h=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),n=0,r=h.length;n<r;n++){var u=h[n],d=[];for(o=0,a=u.length;o<a;o++){var p=u[o];d.push(p.clone())}this.faceVertexUvs[t].push(d)}}var f=e.morphTargets;for(t=0,i=f.length;t<i;t++){var m={};if(m.name=f[t].name,void 0!==f[t].vertices)for(m.vertices=[],n=0,r=f[t].vertices.length;n<r;n++)m.vertices.push(f[t].vertices[n].clone());if(void 0!==f[t].normals)for(m.normals=[],n=0,r=f[t].normals.length;n<r;n++)m.normals.push(f[t].normals[n].clone());this.morphTargets.push(m)}var g=e.morphNormals;for(t=0,i=g.length;t<i;t++){var v={};if(void 0!==g[t].vertexNormals)for(v.vertexNormals=[],n=0,r=g[t].vertexNormals.length;n<r;n++){var y=g[t].vertexNormals[n],b={};b.a=y.a.clone(),b.b=y.b.clone(),b.c=y.c.clone(),v.vertexNormals.push(b)}if(void 0!==g[t].faceNormals)for(v.faceNormals=[],n=0,r=g[t].faceNormals.length;n<r;n++)v.faceNormals.push(g[t].faceNormals[n].clone());this.morphNormals.push(v)}var x=e.skinWeights;for(t=0,i=x.length;t<i;t++)this.skinWeights.push(x[t].clone());var w=e.skinIndices;for(t=0,i=w.length;t<i;t++)this.skinIndices.push(w[t].clone());var _=e.lineDistances;for(t=0,i=_.length;t<i;t++)this.lineDistances.push(_[t]);var E=e.boundingBox;null!==E&&(this.boundingBox=E.clone());var T=e.boundingSphere;return null!==T&&(this.boundingSphere=T.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(qn.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(qn.prototype,{isBufferAttribute:!0,setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==e?e.length/this.itemSize:0,this.array=e},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(e,t,i){e*=this.itemSize,i*=t.itemSize;for(var n=0,r=this.itemSize;n<r;n++)this.array[e+n]=t.array[i+n];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,i=0,n=0,r=e.length;n<r;n++){var o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),o=new Xt),t[i++]=o.r,t[i++]=o.g,t[i++]=o.b}return this},copyIndicesArray:function(e){for(var t=this.array,i=0,n=0,r=e.length;n<r;n++){var o=e[n];t[i++]=o.a,t[i++]=o.b,t[i++]=o.c}return this},copyVector2sArray:function(e){for(var t=this.array,i=0,n=0,r=e.length;n<r;n++){var o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),o=new xe),t[i++]=o.x,t[i++]=o.y}return this},copyVector3sArray:function(e){for(var t=this.array,i=0,n=0,r=e.length;n<r;n++){var o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),o=new rt),t[i++]=o.x,t[i++]=o.y,t[i++]=o.z}return this},copyVector4sArray:function(e){for(var t=this.array,i=0,n=0,r=e.length;n<r;n++){var o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),o=new et),t[i++]=o.x,t[i++]=o.y,t[i++]=o.z,t[i++]=o.w}return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this},setXYZ:function(e,t,i,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this},setXYZW:function(e,t,i,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this.array[e+3]=r,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),(Xn.prototype=Object.create(qn.prototype)).constructor=Xn,(Zn.prototype=Object.create(qn.prototype)).constructor=Zn,(Yn.prototype=Object.create(qn.prototype)).constructor=Yn,(Kn.prototype=Object.create(qn.prototype)).constructor=Kn,(Jn.prototype=Object.create(qn.prototype)).constructor=Jn,(Qn.prototype=Object.create(qn.prototype)).constructor=Qn,(er.prototype=Object.create(qn.prototype)).constructor=er,(tr.prototype=Object.create(qn.prototype)).constructor=tr,(ir.prototype=Object.create(qn.prototype)).constructor=ir,Object.assign(nr.prototype,{computeGroups:function(e){for(var t,i=[],n=void 0,r=e.faces,o=0;o<r.length;o++){var a=r[o];a.materialIndex!==n&&(n=a.materialIndex,void 0!==t&&(t.count=3*o-t.start,i.push(t)),t={start:3*o,materialIndex:n})}void 0!==t&&(t.count=3*o-t.start,i.push(t)),this.groups=i},fromGeometry:function(e){var t,i=e.faces,n=e.vertices,r=e.faceVertexUvs,o=r[0]&&0<r[0].length,a=r[1]&&0<r[1].length,s=e.morphTargets,l=s.length;if(0<l){t=[];for(var c=0;c<l;c++)t[c]=[];this.morphTargets.position=t}var h,u=e.morphNormals,d=u.length;if(0<d){h=[];for(c=0;c<d;c++)h[c]=[];this.morphTargets.normal=h}var p=e.skinIndices,f=e.skinWeights,m=p.length===n.length,g=f.length===n.length;for(c=0;c<i.length;c++){var v=i[c];this.vertices.push(n[v.a],n[v.b],n[v.c]);var y=v.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var b=v.normal;this.normals.push(b,b,b)}var x,w=v.vertexColors;if(3===w.length)this.colors.push(w[0],w[1],w[2]);else{var _=v.color;this.colors.push(_,_,_)}if(!0===o)void 0!==(x=r[0][c])?this.uvs.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",c),this.uvs.push(new xe,new xe,new xe));if(!0===a)void 0!==(x=r[1][c])?this.uvs2.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",c),this.uvs2.push(new xe,new xe,new xe));for(var E=0;E<l;E++){var T=s[E].vertices;t[E].push(T[v.a],T[v.b],T[v.c])}for(E=0;E<d;E++){var M=u[E].vertexNormals[c];h[E].push(M.a,M.b,M.c)}m&&this.skinIndices.push(p[v.a],p[v.b],p[v.c]),g&&this.skinWeights.push(f[v.a],f[v.b],f[v.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}}),or.MaxIndex=65535,Object.assign(or.prototype,t.prototype,{isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(65535<rr(e)?er:Jn)(e,1):this.index=e},addAttribute:function(e,t){return t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(t)):(this.attributes[e]=t,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(e,new qn(t,arguments[2])))},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,i){this.groups.push({start:e,count:t,materialIndex:void 0!==i?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToBufferAttribute(t),t.needsUpdate=!0);var i=this.attributes.normal;void 0!==i&&((new Ai).getNormalMatrix(e).applyToBufferAttribute(i),i.needsUpdate=!0);return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:(bn=new ot,function(e){return bn.makeRotationX(e),this.applyMatrix(bn),this}),rotateY:(yn=new ot,function(e){return yn.makeRotationY(e),this.applyMatrix(yn),this}),rotateZ:(vn=new ot,function(e){return vn.makeRotationZ(e),this.applyMatrix(vn),this}),translate:(gn=new ot,function(e,t,i){return gn.makeTranslation(e,t,i),this.applyMatrix(gn),this}),scale:(mn=new ot,function(e,t,i){return mn.makeScale(e,t,i),this.applyMatrix(mn),this}),lookAt:(fn=new en,function(e){fn.lookAt(e),fn.updateMatrix(),this.applyMatrix(fn.matrix)}),center:function(){this.computeBoundingBox();var e=this.boundingBox.getCenter().negate();return this.translate(e.x,e.y,e.z),e},setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var i=new tr(3*t.vertices.length,3),n=new tr(3*t.colors.length,3);if(this.addAttribute("position",i.copyVector3sArray(t.vertices)),this.addAttribute("color",n.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var r=new tr(t.lineDistances.length,1);this.addAttribute("lineDistance",r.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},updateFromObject:function(e){var t,i=e.geometry;if(e.isMesh){var n=i.__directGeometry;if(!0===i.elementsNeedUpdate&&(n=void 0,i.elementsNeedUpdate=!1),void 0===n)return this.fromGeometry(i);n.verticesNeedUpdate=i.verticesNeedUpdate,n.normalsNeedUpdate=i.normalsNeedUpdate,n.colorsNeedUpdate=i.colorsNeedUpdate,n.uvsNeedUpdate=i.uvsNeedUpdate,n.groupsNeedUpdate=i.groupsNeedUpdate,i.verticesNeedUpdate=!1,i.normalsNeedUpdate=!1,i.colorsNeedUpdate=!1,i.uvsNeedUpdate=!1,i.groupsNeedUpdate=!1,i=n}return!0===i.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(i.vertices),t.needsUpdate=!0),i.verticesNeedUpdate=!1),!0===i.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(i.normals),t.needsUpdate=!0),i.normalsNeedUpdate=!1),!0===i.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(i.colors),t.needsUpdate=!0),i.colorsNeedUpdate=!1),i.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(i.uvs),t.needsUpdate=!0),i.uvsNeedUpdate=!1),i.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(i.lineDistances),t.needsUpdate=!0),i.lineDistancesNeedUpdate=!1),i.groupsNeedUpdate&&(i.computeGroups(e.geometry),this.groups=i.groups,i.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new nr).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.addAttribute("position",new qn(t,3).copyVector3sArray(e.vertices)),0<e.normals.length){var i=new Float32Array(3*e.normals.length);this.addAttribute("normal",new qn(i,3).copyVector3sArray(e.normals))}if(0<e.colors.length){var n=new Float32Array(3*e.colors.length);this.addAttribute("color",new qn(n,3).copyColorsArray(e.colors))}if(0<e.uvs.length){var r=new Float32Array(2*e.uvs.length);this.addAttribute("uv",new qn(r,2).copyVector2sArray(e.uvs))}if(0<e.uvs2.length){var o=new Float32Array(2*e.uvs2.length);this.addAttribute("uv2",new qn(o,2).copyVector2sArray(e.uvs2))}if(0<e.indices.length){var a=new(65535<rr(e.indices)?Uint32Array:Uint16Array)(3*e.indices.length);this.setIndex(new qn(a,1).copyIndicesArray(e.indices))}for(var s in this.groups=e.groups,e.morphTargets){for(var l=[],c=e.morphTargets[s],h=0,u=c.length;h<u;h++){var d=c[h],p=new tr(3*d.length,3);l.push(p.copyVector3sArray(d))}this.morphAttributes[s]=l}if(0<e.skinIndices.length){var f=new tr(4*e.skinIndices.length,4);this.addAttribute("skinIndex",f.copyVector4sArray(e.skinIndices))}if(0<e.skinWeights.length){var m=new tr(4*e.skinWeights.length,4);this.addAttribute("skinWeight",m.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Ci);var e=this.attributes.position;void 0!==e?this.boundingBox.setFromBufferAttribute(e):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:(dn=new Ci,pn=new rt,function(){null===this.boundingSphere&&(this.boundingSphere=new Ri);var e=this.attributes.position;if(e){var t=this.boundingSphere.center;dn.setFromBufferAttribute(e),dn.getCenter(t);for(var i=0,n=0,r=e.count;n<r;n++)pn.x=e.getX(n),pn.y=e.getY(n),pn.z=e.getZ(n),i=Math.max(i,t.distanceToSquared(pn));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes,i=this.groups;if(t.position){var n=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new qn(new Float32Array(n.length),3));else for(var r=t.normal.array,o=0,a=r.length;o<a;o++)r[o]=0;var s,l,c,h=t.normal.array,u=new rt,d=new rt,p=new rt,f=new rt,m=new rt;if(e){var g=e.array;0===i.length&&this.addGroup(0,g.length);for(var v=0,y=i.length;v<y;++v){var b=i[v],x=b.start;for(o=x,a=x+b.count;o<a;o+=3)s=3*g[o+0],l=3*g[o+1],c=3*g[o+2],u.fromArray(n,s),d.fromArray(n,l),p.fromArray(n,c),f.subVectors(p,d),m.subVectors(u,d),f.cross(m),h[s]+=f.x,h[s+1]+=f.y,h[s+2]+=f.z,h[l]+=f.x,h[l+1]+=f.y,h[l+2]+=f.z,h[c]+=f.x,h[c+1]+=f.y,h[c+2]+=f.z}}else for(o=0,a=n.length;o<a;o+=9)u.fromArray(n,o),d.fromArray(n,o+3),p.fromArray(n,o+6),f.subVectors(p,d),m.subVectors(u,d),f.cross(m),h[o]=f.x,h[o+1]=f.y,h[o+2]=f.z,h[o+3]=f.x,h[o+4]=f.y,h[o+5]=f.z,h[o+6]=f.x,h[o+7]=f.y,h[o+8]=f.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0);var i=this.attributes;for(var n in i)if(void 0!==e.attributes[n])for(var r=i[n].array,o=e.attributes[n],a=o.array,s=0,l=o.itemSize*t;s<a.length;s++,l++)r[l]=a[s];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){for(var e,t,i,n,r=this.attributes.normal,o=0,a=r.count;o<a;o++)e=r.getX(o),t=r.getY(o),i=r.getZ(o),n=1/Math.sqrt(e*e+t*t+i*i),r.setXYZ(o,e*n,t*n,i*n)},toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new or,t=this.index.array,i=this.attributes;for(var n in i){for(var r=i[n],o=r.array,a=r.itemSize,s=new o.constructor(t.length*a),l=0,c=0,h=0,u=t.length;h<u;h++){l=t[h]*a;for(var d=0;d<a;d++)s[c++]=o[l++]}e.addAttribute(n,new qn(s,a))}return e},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var i in t)void 0!==t[i]&&(e[i]=t[i]);return e}e.data={attributes:{}};var n=this.index;if(null!==n){var r=Array.prototype.slice.call(n.array);e.data.index={type:n.array.constructor.name,array:r}}var o=this.attributes;for(var i in o){var a=o[i];r=Array.prototype.slice.call(a.array);e.data.attributes[i]={itemSize:a.itemSize,type:a.array.constructor.name,array:r,normalized:a.normalized}}var s=this.groups;0<s.length&&(e.data.groups=JSON.parse(JSON.stringify(s)));var l=this.boundingSphere;return null!==l&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e},clone:function(){return(new or).copy(this)},copy:function(e){var t,i,n;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var r=e.index;null!==r&&this.setIndex(r.clone());var o=e.attributes;for(t in o){var a=o[t];this.addAttribute(t,a.clone())}var s=e.morphAttributes;for(t in s){var l=[],c=s[t];for(i=0,n=c.length;i<n;i++)l.push(c[i].clone());this.morphAttributes[t]=l}var h=e.groups;for(i=0,n=h.length;i<n;i++){var u=h[i];this.addGroup(u.start,u.count,u.materialIndex)}var d=e.boundingBox;null!==d&&(this.boundingBox=d.clone());var p=e.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),(ar.prototype=Object.create(Wn.prototype)).constructor=ar,(sr.prototype=Object.create(or.prototype)).constructor=sr,(lr.prototype=Object.create(Wn.prototype)).constructor=lr,(cr.prototype=Object.create(or.prototype)).constructor=cr,((hr.prototype=Object.create(Ti.prototype)).constructor=hr).prototype.isMeshBasicMaterial=!0,hr.prototype.copy=function(e){return Ti.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},Object.assign(ur.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return(t||new rt).copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:(Pn=new rt,function(e){return this.origin.copy(this.at(e,Pn)),this}),closestPointToPoint:function(e,t){var i=t||new rt;i.subVectors(e,this.origin);var n=i.dot(this.direction);return n<0?i.copy(this.origin):i.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:(An=new rt,function(e){var t=An.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(An.copy(this.direction).multiplyScalar(t).add(this.origin),An.distanceToSquared(e))}),distanceSqToSegment:(Sn=new rt,Cn=new rt,Rn=new rt,function(e,t,i,n){Sn.copy(e).add(t).multiplyScalar(.5),Cn.copy(t).sub(e).normalize(),Rn.copy(this.origin).sub(Sn);var r,o,a,s,l=.5*e.distanceTo(t),c=-this.direction.dot(Cn),h=Rn.dot(this.direction),u=-Rn.dot(Cn),d=Rn.lengthSq(),p=Math.abs(1-c*c);if(0<p)if(o=c*h-u,s=l*p,0<=(r=c*u-h))if(-s<=o)if(o<=s){var f=1/p;a=(r*=f)*(r+c*(o*=f)+2*h)+o*(c*r+o+2*u)+d}else o=l,a=-(r=Math.max(0,-(c*o+h)))*r+o*(o+2*u)+d;else o=-l,a=-(r=Math.max(0,-(c*o+h)))*r+o*(o+2*u)+d;else a=o<=-s?-(r=Math.max(0,-(-c*l+h)))*r+(o=0<r?-l:Math.min(Math.max(-l,-u),l))*(o+2*u)+d:o<=s?(r=0,(o=Math.min(Math.max(-l,-u),l))*(o+2*u)+d):-(r=Math.max(0,-(c*l+h)))*r+(o=0<r?l:Math.min(Math.max(-l,-u),l))*(o+2*u)+d;else o=0<c?-l:l,a=-(r=Math.max(0,-(c*o+h)))*r+o*(o+2*u)+d;return i&&i.copy(this.direction).multiplyScalar(r).add(this.origin),n&&n.copy(Cn).multiplyScalar(o).add(Sn),a}),intersectSphere:(Mn=new rt,function(e,t){Mn.subVectors(e.center,this.origin);var i=Mn.dot(this.direction),n=Mn.dot(Mn)-i*i,r=e.radius*e.radius;if(r<n)return null;var o=Math.sqrt(r-n),a=i-o,s=i+o;return a<0&&s<0?null:a<0?this.at(s,t):this.at(a,t)}),intersectsSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var i=-(this.origin.dot(e.normal)+e.constant)/t;return 0<=i?i:null},intersectPlane:function(e,t){var i=this.distanceToPlane(e);return null===i?null:this.at(i,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){var i,n,r,o,a,s,l=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,u=this.origin;return n=0<=l?(i=(e.min.x-u.x)*l,(e.max.x-u.x)*l):(i=(e.max.x-u.x)*l,(e.min.x-u.x)*l),(o=0<=c?(r=(e.min.y-u.y)*c,(e.max.y-u.y)*c):(r=(e.max.y-u.y)*c,(e.min.y-u.y)*c))<i||n<r?null:((i<r||i!=i)&&(i=r),(o<n||n!=n)&&(n=o),(s=0<=h?(a=(e.min.z-u.z)*h,(e.max.z-u.z)*h):(a=(e.max.z-u.z)*h,(e.min.z-u.z)*h))<i||n<a?null:((i<a||i!=i)&&(i=a),(s<n||n!=n)&&(n=s),n<0?null:this.at(0<=i?i:n,t)))},intersectsBox:(Tn=new rt,function(e){return null!==this.intersectBox(e,Tn)}),intersectTriangle:(xn=new rt,wn=new rt,_n=new rt,En=new rt,function(e,t,i,n,r){wn.subVectors(t,e),_n.subVectors(i,e),En.crossVectors(wn,_n);var o,a=this.direction.dot(En);if(0<a){if(n)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}xn.subVectors(this.origin,e);var s=o*this.direction.dot(_n.crossVectors(xn,_n));if(s<0)return null;var l=o*this.direction.dot(wn.cross(xn));if(l<0)return null;if(a<s+l)return null;var c=-o*xn.dot(En);return c<0?null:this.at(c/a,r)}),applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}),Object.assign(dr.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return(e||new rt).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return(e||new rt).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){var i=t||new rt;return this.delta(i).multiplyScalar(e).add(this.start)},closestPointToPointParameter:(Ln=new rt,On=new rt,function(e,t){Ln.subVectors(e,this.start),On.subVectors(this.end,this.start);var i=On.dot(On),n=On.dot(Ln)/i;return t&&(n=Qe.clamp(n,0,1)),n}),closestPointToPoint:function(e,t,i){var n=this.closestPointToPointParameter(e,t),r=i||new rt;return this.delta(r).multiplyScalar(n).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Object.assign(pr,{normal:(Hn=new rt,function(e,t,i,n){var r=n||new rt;r.subVectors(i,t),Hn.subVectors(e,t),r.cross(Hn);var o=r.lengthSq();return 0<o?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}),barycoordFromPoint:(Dn=new rt,kn=new rt,Nn=new rt,function(e,t,i,n,r){Dn.subVectors(n,t),kn.subVectors(i,t),Nn.subVectors(e,t);var o=Dn.dot(Dn),a=Dn.dot(kn),s=Dn.dot(Nn),l=kn.dot(kn),c=kn.dot(Nn),h=o*l-a*a,u=r||new rt;if(0===h)return u.set(-2,-1,-1);var d=1/h,p=(l*s-a*c)*d,f=(o*c-a*s)*d;return u.set(1-p-f,f,p)}),containsPoint:(In=new rt,function(e,t,i,n){var r=pr.barycoordFromPoint(e,t,i,n,In);return 0<=r.x&&0<=r.y&&r.x+r.y<=1})}),Object.assign(pr.prototype,{set:function(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this},setFromPointsAndIndices:function(e,t,i,n){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},area:(zn=new rt,jn=new rt,function(){return zn.subVectors(this.c,this.b),jn.subVectors(this.a,this.b),.5*zn.cross(jn).length()}),midpoint:function(e){return(e||new rt).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return pr.normal(this.a,this.b,this.c,e)},plane:function(e){return(e||new Pi).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,t){return pr.barycoordFromPoint(e,this.a,this.b,this.c,t)},containsPoint:function(e){return pr.containsPoint(e,this.a,this.b,this.c)},closestPointToPoint:(Bn=new Pi,Fn=[new dr,new dr,new dr],Un=new rt,$n=new rt,function(e,t){var i=t||new rt,n=1/0;if(Bn.setFromCoplanarPoints(this.a,this.b,this.c),Bn.projectPoint(e,Un),!0===this.containsPoint(Un))i.copy(Un);else{Fn[0].set(this.a,this.b),Fn[1].set(this.b,this.c),Fn[2].set(this.c,this.a);for(var r=0;r<Fn.length;r++){Fn[r].closestPointToPoint(Un,!0,$n);var o=Un.distanceToSquared($n);o<n&&(n=o,i.copy($n))}}return i}),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}),fr.prototype=Object.assign(Object.create(en.prototype),{constructor:fr,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return en.prototype.copy.call(this,e),this.drawMode=e.drawMode,this},updateMorphTargets:function(){var e,t,i,n=this.geometry;if(n.isBufferGeometry){var r=n.morphAttributes,o=Object.keys(r);if(0<o.length){var a=r[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=a.length;e<t;e++)i=a[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=e}}else{var s=n.morphTargets;if(void 0!==s&&0<s.length)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=s.length;e<t;e++)i=s[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=e}},raycast:function(){var I=new ot,D=new ur,k=new Ri,N=new rt,H=new rt,B=new rt,F=new rt,U=new rt,$=new rt,z=new xe,j=new xe,V=new xe,s=new rt,G=new rt,c=new rt;function W(e,t,i,n,r,o,a){return pr.barycoordFromPoint(e,t,i,n,s),r.multiplyScalar(s.x),o.multiplyScalar(s.y),a.multiplyScalar(s.z),r.add(o).add(a),r.clone()}function q(e,t,i,n,r,o,a){var s=e.material;if(null===(s.side===Z?i.intersectTriangle(o,r,n,!0,a):i.intersectTriangle(n,r,o,s.side!==Y,a)))return null;c.copy(a),c.applyMatrix4(e.matrixWorld);var l=t.ray.origin.distanceTo(c);return l<t.near||l>t.far?null:{distance:l,point:c.clone(),object:e}}function X(e,t,i,n,r,o,a,s){N.fromBufferAttribute(n,o),H.fromBufferAttribute(n,a),B.fromBufferAttribute(n,s);var l=q(e,t,i,N,H,B,G);return l&&(r&&(z.fromBufferAttribute(r,o),j.fromBufferAttribute(r,a),V.fromBufferAttribute(r,s),l.uv=W(G,N,H,B,z,j,V)),l.face=new on(o,a,s,pr.normal(N,H,B)),l.faceIndex=o),l}return function(e,t){var i,n=this.geometry,r=this.material,o=this.matrixWorld;if(void 0!==r&&(null===n.boundingSphere&&n.computeBoundingSphere(),k.copy(n.boundingSphere),k.applyMatrix4(o),!1!==e.ray.intersectsSphere(k)&&(I.getInverse(o),D.copy(e.ray).applyMatrix4(I),null===n.boundingBox||!1!==D.intersectsBox(n.boundingBox))))if(n.isBufferGeometry){var a,s,l,c,h,u=n.index,d=n.attributes.position,p=n.attributes.uv;if(null!==u)for(c=0,h=u.count;c<h;c+=3)a=u.getX(c),s=u.getX(c+1),l=u.getX(c+2),(i=X(this,e,D,d,p,a,s,l))&&(i.faceIndex=Math.floor(c/3),t.push(i));else for(c=0,h=d.count;c<h;c+=3)(i=X(this,e,D,d,p,a=c,s=c+1,l=c+2))&&(i.index=a,t.push(i))}else if(n.isGeometry){var f,m,g,v,y=Array.isArray(r),b=n.vertices,x=n.faces,w=n.faceVertexUvs[0];0<w.length&&(v=w);for(var _=0,E=x.length;_<E;_++){var T=x[_],M=y?r[T.materialIndex]:r;if(void 0!==M){if(f=b[T.a],m=b[T.b],g=b[T.c],!0===M.morphTargets){var S=n.morphTargets,C=this.morphTargetInfluences;N.set(0,0,0),H.set(0,0,0),B.set(0,0,0);for(var R=0,A=S.length;R<A;R++){var P=C[R];if(0!==P){var L=S[R].vertices;N.addScaledVector(F.subVectors(L[T.a],f),P),H.addScaledVector(U.subVectors(L[T.b],m),P),B.addScaledVector($.subVectors(L[T.c],g),P)}}N.add(f),H.add(m),B.add(g),f=N,m=H,g=B}if(i=q(this,e,D,f,m,g,G)){if(v&&v[_]){var O=v[_];z.copy(O[0]),j.copy(O[1]),V.copy(O[2]),i.uv=W(G,f,m,g,z,j,V)}i.face=T,i.faceIndex=_,t.push(i)}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Sr,Cr,Rr,Ar,Pr,Lr,Or,Ir,Dr,kr,Nr,Hr,Br,Fr,Ur=0;function $r(e){switch(e){case m:return["Linear","( value )"];case g:return["sRGB","( value )"];case y:return["RGBE","( value )"];case b:return["RGBM","( value, 7.0 )"];case x:return["RGBM","( value, 16.0 )"];case w:return["RGBD","( value, 256.0 )"];case v:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+e)}}function zr(e,t){var i=$r(t);return"vec4 "+e+"( vec4 value ) { return "+i[0]+"ToLinear"+i[1]+"; }"}function jr(e){return""!==e}function Vr(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function Gr(e){return e.replace(/^[ \t]*#include +<([\w\d.]+)>/gm,function(e,t){var i=Qt[t];if(void 0===i)throw new Error("Can not resolve #include <"+t+">");return Gr(i)})}function Wr(e){return e.replace(/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(e,t,i,n){for(var r="",o=parseInt(t);o<parseInt(i);o++)r+=n.replace(/\[ i \]/g,"[ "+o+" ]");return r})}function qr(e,t,i,n,r){var o=e.context,a=i.extensions,s=i.defines,l=n.vertexShader,c=n.fragmentShader,h="SHADOWMAP_TYPE_BASIC";r.shadowMapType===H?h="SHADOWMAP_TYPE_PCF":r.shadowMapType===B&&(h="SHADOWMAP_TYPE_PCF_SOFT");var u="ENVMAP_TYPE_CUBE",d="ENVMAP_MODE_REFLECTION",p="ENVMAP_BLENDING_MULTIPLY";if(r.envMap){switch(i.envMap.mapping){case de:case pe:u="ENVMAP_TYPE_CUBE";break;case ve:case ye:u="ENVMAP_TYPE_CUBE_UV";break;case fe:case me:u="ENVMAP_TYPE_EQUIREC";break;case ge:u="ENVMAP_TYPE_SPHERE"}switch(i.envMap.mapping){case pe:case me:d="ENVMAP_MODE_REFRACTION"}switch(i.combine){case U:p="ENVMAP_BLENDING_MULTIPLY";break;case $:p="ENVMAP_BLENDING_MIX";break;case se:p="ENVMAP_BLENDING_ADD"}}var f,m,g,v,y,b,x,w,_=0<e.gammaFactor?e.gammaFactor:1,E=(f=a,m=r,g=e.extensions,[(f=f||{}).derivatives||m.envMapCubeUV||m.bumpMap||m.normalMap||m.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(f.fragDepth||m.logarithmicDepthBuffer)&&g.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",f.drawBuffers&&g.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(f.shaderTextureLOD||m.envMap)&&g.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(jr).join("\n")),T=function(e){var t=[];for(var i in e){var n=e[i];!1!==n&&t.push("#define "+i+" "+n)}return t.join("\n")}(s),M=o.createProgram();y=i.isRawShaderMaterial?(v=[T,"\n"].filter(jr).join("\n"),[E,T,"\n"].filter(jr).join("\n")):(v=["precision "+r.precision+" float;","precision "+r.precision+" int;","#define SHADER_NAME "+n.name,T,r.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+_,"#define MAX_BONES "+r.maxBones,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+d:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.vertexColors?"#define USE_COLOR":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.useVertexTexture?"#define BONE_TEXTURE":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&!1===r.flatShading?"#define USE_MORPHNORMALS":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+r.numClippingPlanes,r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+h:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&e.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(jr).join("\n"),[E,"precision "+r.precision+" float;","precision "+r.precision+" int;","#define SHADER_NAME "+n.name,T,r.alphaTest?"#define ALPHATEST "+r.alphaTest:"","#define GAMMA_FACTOR "+_,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+u:"",r.envMap?"#define "+d:"",r.envMap?"#define "+p:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.vertexColors?"#define USE_COLOR":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+r.numClippingPlanes,"#define UNION_CLIPPING_PLANES "+(r.numClippingPlanes-r.numClipIntersection),r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+h:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&e.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",r.envMap&&e.extensions.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",r.toneMapping!==le?"#define TONE_MAPPING":"",r.toneMapping!==le?Qt.tonemapping_pars_fragment:"",r.toneMapping!==le?function(e,t){var i;switch(t){case Ie:i="Linear";break;case ce:i="Reinhard";break;case he:i="Uncharted2";break;case ue:i="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.outputEncoding||r.mapEncoding||r.envMapEncoding||r.emissiveMapEncoding?Qt.encodings_pars_fragment:"",r.mapEncoding?zr("mapTexelToLinear",r.mapEncoding):"",r.envMapEncoding?zr("envMapTexelToLinear",r.envMapEncoding):"",r.emissiveMapEncoding?zr("emissiveMapTexelToLinear",r.emissiveMapEncoding):"",r.outputEncoding?(b="linearToOutputTexel",x=r.outputEncoding,w=$r(x),"vec4 "+b+"( vec4 value ) { return LinearTo"+w[0]+w[1]+"; }"):"",r.depthPacking?"#define DEPTH_PACKING "+i.depthPacking:"","\n"].filter(jr).join("\n")),l=Vr(l=Gr(l),r),c=Vr(c=Gr(c),r),i.isShaderMaterial||(l=Wr(l),c=Wr(c));var S=v+l,C=y+c,R=Mr(o,o.VERTEX_SHADER,S),A=Mr(o,o.FRAGMENT_SHADER,C);o.attachShader(M,R),o.attachShader(M,A),void 0!==i.index0AttributeName?o.bindAttribLocation(M,0,i.index0AttributeName):!0===r.morphTargets&&o.bindAttribLocation(M,0,"position"),o.linkProgram(M);var P,L,O=o.getProgramInfoLog(M),I=o.getShaderInfoLog(R),D=o.getShaderInfoLog(A),k=!0,N=!0;return!1===o.getProgramParameter(M,o.LINK_STATUS)?(k=!1,console.error("THREE.WebGLProgram: shader error: ",o.getError(),"gl.VALIDATE_STATUS",o.getProgramParameter(M,o.VALIDATE_STATUS),"gl.getProgramInfoLog",O,I,D)):""!==O?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",O):""!==I&&""!==D||(N=!1),N&&(this.diagnostics={runnable:k,material:i,programLog:O,vertexShader:{log:I,prefix:v},fragmentShader:{log:D,prefix:y}}),o.deleteShader(R),o.deleteShader(A),this.getUniforms=function(){return void 0===P&&(P=new Wt(o,M,e)),P},this.getAttributes=function(){return void 0===L&&(L=function(e,t,i){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<r;o++){var a=e.getActiveAttrib(t,o).name;n[a]=e.getAttribLocation(t,a)}return n}(o,M)),L},this.destroy=function(){o.deleteProgram(M),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=Ur++,this.code=t,this.usedTimes=1,this.program=M,this.vertexShader=R,this.fragmentShader=A,this}function Xr(h,u){var l=[],d={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},o=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function p(e,t){var i;return e?e.isTexture?i=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),i=e.texture.encoding):i=m,i===m&&t&&(i=v),i}this.getParameters=function(e,t,i,n,r,o){var a=d[e.type],s=o.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(u.floatVertexTextures)return 1024;var i=u.maxVertexUniforms,n=Math.floor((i-20)/4),r=Math.min(n,t.length);return r<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+r+"."),0):r}(o):0,l=h.getPrecision();null!==e.precision&&(l=u.getMaxPrecision(e.precision))!==e.precision&&console.warn("THREE.WebGLProgram.getParameters:",e.precision,"not supported, using",l,"instead.");var c=h.getRenderTarget();return{shaderID:a,precision:l,supportsVertexTextures:u.vertexTextures,outputEncoding:p(c?c.texture:null,h.gammaOutput),map:!!e.map,mapEncoding:p(e.map,h.gammaInput),envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,envMapEncoding:p(e.envMap,h.gammaInput),envMapCubeUV:!!e.envMap&&(e.envMap.mapping===ve||e.envMap.mapping===ye),lightMap:!!e.lightMap,aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,emissiveMapEncoding:p(e.emissiveMap,h.gammaInput),bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,gradientMap:!!e.gradientMap,combine:e.combine,vertexColors:e.vertexColors,fog:!!i,useFog:e.fog,fogExp:i&&i.isFogExp2,flatShading:e.shading===Re,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:u.logarithmicDepthBuffer,skinning:e.skinning&&0<s,maxBones:s,useVertexTexture:u.floatVertexTextures,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:h.maxMorphTargets,maxMorphNormals:h.maxMorphNormals,numDirLights:t.directional.length,numPointLights:t.point.length,numSpotLights:t.spot.length,numRectAreaLights:t.rectArea.length,numHemiLights:t.hemi.length,numClippingPlanes:n,numClipIntersection:r,dithering:e.dithering,shadowMapEnabled:h.shadowMap.enabled&&o.receiveShadow&&0<t.shadows.length,shadowMapType:h.shadowMap.type,toneMapping:h.toneMapping,physicallyCorrectLights:h.physicallyCorrectLights,premultipliedAlpha:e.premultipliedAlpha,alphaTest:e.alphaTest,doubleSided:e.side===Y,flipSided:e.side===Z,depthPacking:void 0!==e.depthPacking&&e.depthPacking}},this.getProgramCode=function(e,t){var i=[];if(t.shaderID?i.push(t.shaderID):(i.push(e.fragmentShader),i.push(e.vertexShader)),void 0!==e.defines)for(var n in e.defines)i.push(n),i.push(e.defines[n]);for(var r=0;r<o.length;r++)i.push(t[o[r]]);return i.push(e.onBeforeCompile.toString()),i.push(h.gammaOutput),i.join()},this.acquireProgram=function(e,t,i,n){for(var r,o=0,a=l.length;o<a;o++){var s=l[o];if(s.code===n){++(r=s).usedTimes;break}}return void 0===r&&(r=new qr(h,n,e,t,i),l.push(r)),r},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=l.indexOf(e);l[t]=l[l.length-1],l.pop(),e.destroy()}},this.programs=l}function Zr(f,r,m,g,v,y,b){var p="undefined"!=typeof WebGL2RenderingContext&&f instanceof WebGL2RenderingContext;function x(e,t){if(e.width>t||e.height>t){var i=t/Math.max(e.width,e.height),n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return n.width=Math.floor(e.width*i),n.height=Math.floor(e.height*i),n.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,n.width,n.height),console.warn("THREE.WebGLRenderer: image is too big ("+e.width+"x"+e.height+"). Resized to "+n.width+"x"+n.height,e),n}return e}function w(e){return Qe.isPowerOfTwo(e.width)&&Qe.isPowerOfTwo(e.height)}function _(e,t){return e.generateMipmaps&&t&&e.minFilter!==He&&e.minFilter!==Ue}function o(e){return e===He||e===Be||e===Fe?f.NEAREST:f.LINEAR}function E(e){var t=e.target;t.removeEventListener("dispose",E),function(e){var t=g.get(e);if(e.image&&t.__image__webglTextureCube)f.deleteTexture(t.__image__webglTextureCube);else{if(void 0===t.__webglInit)return;f.deleteTexture(t.__webglTexture)}g.remove(e)}(t),b.textures--}function a(e){var t=e.target;t.removeEventListener("dispose",a),function(e){var t=g.get(e),i=g.get(e.texture);if(!e)return;void 0!==i.__webglTexture&&f.deleteTexture(i.__webglTexture);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLRenderTargetCube)for(var n=0;n<6;n++)f.deleteFramebuffer(t.__webglFramebuffer[n]),t.__webglDepthbuffer&&f.deleteRenderbuffer(t.__webglDepthbuffer[n]);else f.deleteFramebuffer(t.__webglFramebuffer),t.__webglDepthbuffer&&f.deleteRenderbuffer(t.__webglDepthbuffer);g.remove(e.texture),g.remove(e)}(t),b.textures--}function s(e,t){var i=g.get(e);if(0<e.version&&i.__version!==e.version){var n=e.image;if(void 0===n)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",e);else{if(!1!==n.complete)return void function(e,t,i){void 0===e.__webglInit&&(e.__webglInit=!0,t.addEventListener("dispose",E),e.__webglTexture=f.createTexture(),b.textures++);m.activeTexture(f.TEXTURE0+i),m.bindTexture(f.TEXTURE_2D,e.__webglTexture),f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,t.flipY),f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),f.pixelStorei(f.UNPACK_ALIGNMENT,t.unpackAlignment);var n=x(t.image,v.maxTextureSize);r=t,(r.wrapS!==ke||r.wrapT!==ke||r.minFilter!==He&&r.minFilter!==Ue)&&!1===w(n)&&(n=function(e){if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement){var t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return t.width=Qe.nearestPowerOfTwo(e.width),t.height=Qe.nearestPowerOfTwo(e.height),t.getContext("2d").drawImage(e,0,0,t.width,t.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+e.width+"x"+e.height+"). Resized to "+t.width+"x"+t.height,e),t}return e}(n));var r;var o=w(n),a=y(t.format),s=y(t.type);T(f.TEXTURE_2D,t,o);var l,c=t.mipmaps;if(t.isDepthTexture){var h=f.DEPTH_COMPONENT;if(t.type===Ge){if(!p)throw new Error("Float Depth Texture only supported in WebGL2.0");h=f.DEPTH_COMPONENT32F}else p&&(h=f.DEPTH_COMPONENT16);t.format===Ye&&h===f.DEPTH_COMPONENT&&t.type!==je&&t.type!==Ve&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),t.type=je,s=y(t.type)),t.format===Ke&&(h=f.DEPTH_STENCIL,t.type!==qe&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),t.type=qe,s=y(t.type))),m.texImage2D(f.TEXTURE_2D,0,h,n.width,n.height,0,a,s,null)}else if(t.isDataTexture)if(0<c.length&&o){for(var u=0,d=c.length;u<d;u++)l=c[u],m.texImage2D(f.TEXTURE_2D,u,a,l.width,l.height,0,a,s,l.data);t.generateMipmaps=!1}else m.texImage2D(f.TEXTURE_2D,0,a,n.width,n.height,0,a,s,n.data);else if(t.isCompressedTexture)for(var u=0,d=c.length;u<d;u++)l=c[u],t.format!==Ze&&t.format!==Xe?-1<m.getCompressedTextureFormats().indexOf(a)?m.compressedTexImage2D(f.TEXTURE_2D,u,a,l.width,l.height,0,l.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):m.texImage2D(f.TEXTURE_2D,u,a,l.width,l.height,0,a,s,l.data);else if(0<c.length&&o){for(var u=0,d=c.length;u<d;u++)l=c[u],m.texImage2D(f.TEXTURE_2D,u,a,a,s,l);t.generateMipmaps=!1}else m.texImage2D(f.TEXTURE_2D,0,a,a,s,n);_(t,o)&&f.generateMipmap(f.TEXTURE_2D);e.__version=t.version,t.onUpdate&&t.onUpdate(t)}(i,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",e)}}m.activeTexture(f.TEXTURE0+t),m.bindTexture(f.TEXTURE_2D,i.__webglTexture)}function T(e,t,i){var n;if(i?(f.texParameteri(e,f.TEXTURE_WRAP_S,y(t.wrapS)),f.texParameteri(e,f.TEXTURE_WRAP_T,y(t.wrapT)),f.texParameteri(e,f.TEXTURE_MAG_FILTER,y(t.magFilter)),f.texParameteri(e,f.TEXTURE_MIN_FILTER,y(t.minFilter))):(f.texParameteri(e,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(e,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),t.wrapS===ke&&t.wrapT===ke||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",t),f.texParameteri(e,f.TEXTURE_MAG_FILTER,o(t.magFilter)),f.texParameteri(e,f.TEXTURE_MIN_FILTER,o(t.minFilter)),t.minFilter!==He&&t.minFilter!==Ue&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",t)),n=r.get("EXT_texture_filter_anisotropic")){if(t.type===Ge&&null===r.get("OES_texture_float_linear"))return;if(t.type===We&&null===r.get("OES_texture_half_float_linear"))return;(1<t.anisotropy||g.get(t).__currentAnisotropy)&&(f.texParameterf(e,n.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,v.getMaxAnisotropy())),g.get(t).__currentAnisotropy=t.anisotropy)}}function l(e,t,i,n){var r=y(t.texture.format),o=y(t.texture.type);m.texImage2D(n,0,r,t.width,t.height,0,r,o,null),f.bindFramebuffer(f.FRAMEBUFFER,e),f.framebufferTexture2D(f.FRAMEBUFFER,i,n,g.get(t.texture).__webglTexture,0),f.bindFramebuffer(f.FRAMEBUFFER,null)}function c(e,t){f.bindRenderbuffer(f.RENDERBUFFER,e),t.depthBuffer&&!t.stencilBuffer?(f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT16,t.width,t.height),f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.RENDERBUFFER,e)):t.depthBuffer&&t.stencilBuffer?(f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_STENCIL,t.width,t.height),f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_STENCIL_ATTACHMENT,f.RENDERBUFFER,e)):f.renderbufferStorage(f.RENDERBUFFER,f.RGBA4,t.width,t.height),f.bindRenderbuffer(f.RENDERBUFFER,null)}function h(e){var t=g.get(e),i=!0===e.isWebGLRenderTargetCube;if(e.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,t){if(t&&t.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported!");if(f.bindFramebuffer(f.FRAMEBUFFER,e),!t.depthTexture||!t.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");g.get(t.depthTexture).__webglTexture&&t.depthTexture.image.width===t.width&&t.depthTexture.image.height===t.height||(t.depthTexture.image.width=t.width,t.depthTexture.image.height=t.height,t.depthTexture.needsUpdate=!0),s(t.depthTexture,0);var i=g.get(t.depthTexture).__webglTexture;if(t.depthTexture.format===Ye)f.framebufferTexture2D(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.TEXTURE_2D,i,0);else{if(t.depthTexture.format!==Ke)throw new Error("Unknown depthTexture format");f.framebufferTexture2D(f.FRAMEBUFFER,f.DEPTH_STENCIL_ATTACHMENT,f.TEXTURE_2D,i,0)}}(t.__webglFramebuffer,e)}else if(i){t.__webglDepthbuffer=[];for(var n=0;n<6;n++)f.bindFramebuffer(f.FRAMEBUFFER,t.__webglFramebuffer[n]),t.__webglDepthbuffer[n]=f.createRenderbuffer(),c(t.__webglDepthbuffer[n],e)}else f.bindFramebuffer(f.FRAMEBUFFER,t.__webglFramebuffer),t.__webglDepthbuffer=f.createRenderbuffer(),c(t.__webglDepthbuffer,e);f.bindFramebuffer(f.FRAMEBUFFER,null)}this.setTexture2D=s,this.setTextureCube=function(e,t){var i=g.get(e);if(6===e.image.length)if(0<e.version&&i.__version!==e.version){i.__image__webglTextureCube||(e.addEventListener("dispose",E),i.__image__webglTextureCube=f.createTexture(),b.textures++),m.activeTexture(f.TEXTURE0+t),m.bindTexture(f.TEXTURE_CUBE_MAP,i.__image__webglTextureCube),f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var n=e&&e.isCompressedTexture,r=e.image[0]&&e.image[0].isDataTexture,o=[],a=0;a<6;a++)o[a]=n||r?r?e.image[a].image:e.image[a]:x(e.image[a],v.maxCubemapSize);var s=w(o[0]),l=y(e.format),c=y(e.type);for(T(f.TEXTURE_CUBE_MAP,e,s),a=0;a<6;a++)if(n)for(var h,u=o[a].mipmaps,d=0,p=u.length;d<p;d++)h=u[d],e.format!==Ze&&e.format!==Xe?-1<m.getCompressedTextureFormats().indexOf(l)?m.compressedTexImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X+a,d,l,h.width,h.height,0,h.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):m.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X+a,d,l,h.width,h.height,0,l,c,h.data);else r?m.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X+a,0,l,o[a].width,o[a].height,0,l,c,o[a].data):m.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X+a,0,l,l,c,o[a]);_(e,s)&&f.generateMipmap(f.TEXTURE_CUBE_MAP),i.__version=e.version,e.onUpdate&&e.onUpdate(e)}else m.activeTexture(f.TEXTURE0+t),m.bindTexture(f.TEXTURE_CUBE_MAP,i.__image__webglTextureCube)},this.setTextureCubeDynamic=function(e,t){m.activeTexture(f.TEXTURE0+t),m.bindTexture(f.TEXTURE_CUBE_MAP,g.get(e).__webglTexture)},this.setupRenderTarget=function(e){var t=g.get(e),i=g.get(e.texture);e.addEventListener("dispose",a),i.__webglTexture=f.createTexture(),b.textures++;var n=!0===e.isWebGLRenderTargetCube,r=w(e);if(n){t.__webglFramebuffer=[];for(var o=0;o<6;o++)t.__webglFramebuffer[o]=f.createFramebuffer()}else t.__webglFramebuffer=f.createFramebuffer();if(n){for(m.bindTexture(f.TEXTURE_CUBE_MAP,i.__webglTexture),T(f.TEXTURE_CUBE_MAP,e.texture,r),o=0;o<6;o++)l(t.__webglFramebuffer[o],e,f.COLOR_ATTACHMENT0,f.TEXTURE_CUBE_MAP_POSITIVE_X+o);_(e.texture,r)&&f.generateMipmap(f.TEXTURE_CUBE_MAP),m.bindTexture(f.TEXTURE_CUBE_MAP,null)}else m.bindTexture(f.TEXTURE_2D,i.__webglTexture),T(f.TEXTURE_2D,e.texture,r),l(t.__webglFramebuffer,e,f.COLOR_ATTACHMENT0,f.TEXTURE_2D),_(e.texture,r)&&f.generateMipmap(f.TEXTURE_2D),m.bindTexture(f.TEXTURE_2D,null);e.depthBuffer&&h(e)},this.updateRenderTargetMipmap=function(e){var t=e.texture;if(_(t,w(e))){var i=e.isWebGLRenderTargetCube?f.TEXTURE_CUBE_MAP:f.TEXTURE_2D,n=g.get(t).__webglTexture;m.bindTexture(i,n),f.generateMipmap(i),m.bindTexture(i,null)}}}function Yr(){var n={};return{get:function(e){var t=e.uuid,i=n[t];return void 0===i&&(i={},n[t]=i),i},remove:function(e){delete n[e.uuid]},clear:function(){n={}}}}function Kr(h,i,l){var t=new function(){var t=!1,o=new et,i=null,a=new et;return{setMask:function(e){i===e||t||(h.colorMask(e,e,e,e),i=e)},setLocked:function(e){t=e},setClear:function(e,t,i,n,r){!0===r&&(e*=n,t*=n,i*=n),o.set(e,t,i,n),!1===a.equals(o)&&(h.clearColor(e,t,i,n),a.copy(o))},reset:function(){t=!1,i=null,a.set(0,0,0,1)}}},n=new function(){var t=!1,i=null,n=null,r=null;return{setTest:function(e){e?k(h.DEPTH_TEST):N(h.DEPTH_TEST)},setMask:function(e){i===e||t||(h.depthMask(e),i=e)},setFunc:function(e){if(n!==e){if(e)switch(e){case Q:h.depthFunc(h.NEVER);break;case ee:h.depthFunc(h.ALWAYS);break;case te:h.depthFunc(h.LESS);break;case ie:h.depthFunc(h.LEQUAL);break;case ne:h.depthFunc(h.EQUAL);break;case re:h.depthFunc(h.GEQUAL);break;case oe:h.depthFunc(h.GREATER);break;case ae:h.depthFunc(h.NOTEQUAL);break;default:h.depthFunc(h.LEQUAL)}else h.depthFunc(h.LEQUAL);n=e}},setLocked:function(e){t=e},setClear:function(e){r!==e&&(h.clearDepth(e),r=e)},reset:function(){t=!1,r=n=i=null}}},r=new function(){var t=!1,i=null,n=null,r=null,o=null,a=null,s=null,l=null,c=null;return{setTest:function(e){e?k(h.STENCIL_TEST):N(h.STENCIL_TEST)},setMask:function(e){i===e||t||(h.stencilMask(e),i=e)},setFunc:function(e,t,i){n===e&&r===t&&o===i||(h.stencilFunc(e,t,i),n=e,r=t,o=i)},setOp:function(e,t,i){a===e&&s===t&&l===i||(h.stencilOp(e,t,i),a=e,s=t,l=i)},setLocked:function(e){t=e},setClear:function(e){c!==e&&(h.clearStencil(e),c=e)},reset:function(){t=!1,c=l=s=a=o=r=n=i=null}}},e=h.getParameter(h.MAX_VERTEX_ATTRIBS),o=new Uint8Array(e),a=new Uint8Array(e),s=new Uint8Array(e),c={},u=null,d=null,p=null,f=null,m=null,g=null,v=null,y=null,b=!1,x=null,w=null,_=null,E=null,T=null,M=null,S=h.getParameter(h.MAX_COMBINED_TEXTURE_IMAGE_UNITS),C=parseFloat(/^WebGL\ ([0-9])/.exec(h.getParameter(h.VERSION))[1]),R=1<=parseFloat(C),A=null,P={},L=new et,O=new et;function I(e,t,i){var n=new Uint8Array(4),r=h.createTexture();h.bindTexture(e,r),h.texParameteri(e,h.TEXTURE_MIN_FILTER,h.NEAREST),h.texParameteri(e,h.TEXTURE_MAG_FILTER,h.NEAREST);for(var o=0;o<i;o++)h.texImage2D(t+o,0,h.RGBA,1,1,0,h.RGBA,h.UNSIGNED_BYTE,n);return r}var D={};function k(e){!0!==c[e]&&(h.enable(e),c[e]=!0)}function N(e){!1!==c[e]&&(h.disable(e),c[e]=!1)}function H(e,t,i,n,r,o,a,s){e!==G?k(h.BLEND):N(h.BLEND),e===J||e===d&&s===b||(e===q?s?(h.blendEquationSeparate(h.FUNC_ADD,h.FUNC_ADD),h.blendFuncSeparate(h.ONE,h.ONE,h.ONE,h.ONE)):(h.blendEquation(h.FUNC_ADD),h.blendFunc(h.SRC_ALPHA,h.ONE)):e===X?s?(h.blendEquationSeparate(h.FUNC_ADD,h.FUNC_ADD),h.blendFuncSeparate(h.ZERO,h.ZERO,h.ONE_MINUS_SRC_COLOR,h.ONE_MINUS_SRC_ALPHA)):(h.blendEquation(h.FUNC_ADD),h.blendFunc(h.ZERO,h.ONE_MINUS_SRC_COLOR)):e===K?s?(h.blendEquationSeparate(h.FUNC_ADD,h.FUNC_ADD),h.blendFuncSeparate(h.ZERO,h.SRC_COLOR,h.ZERO,h.SRC_ALPHA)):(h.blendEquation(h.FUNC_ADD),h.blendFunc(h.ZERO,h.SRC_COLOR)):s?(h.blendEquationSeparate(h.FUNC_ADD,h.FUNC_ADD),h.blendFuncSeparate(h.ONE,h.ONE_MINUS_SRC_ALPHA,h.ONE,h.ONE_MINUS_SRC_ALPHA)):(h.blendEquationSeparate(h.FUNC_ADD,h.FUNC_ADD),h.blendFuncSeparate(h.SRC_ALPHA,h.ONE_MINUS_SRC_ALPHA,h.ONE,h.ONE_MINUS_SRC_ALPHA)),d=e,b=s),e===J?(r=r||t,o=o||i,a=a||n,t===p&&r===g||(h.blendEquationSeparate(l(t),l(r)),p=t,g=r),i===f&&n===m&&o===v&&a===y||(h.blendFuncSeparate(l(i),l(n),l(o),l(a)),f=i,m=n,v=o,y=a)):y=v=g=m=f=p=null}function B(e){x!==e&&(e?h.frontFace(h.CW):h.frontFace(h.CCW),x=e)}function F(e){e!==z?(k(h.CULL_FACE),e!==w&&(e===j?h.cullFace(h.BACK):e===V?h.cullFace(h.FRONT):h.cullFace(h.FRONT_AND_BACK))):N(h.CULL_FACE),w=e}function U(e,t,i){e?(k(h.POLYGON_OFFSET_FILL),E===t&&T===i||(h.polygonOffset(t,i),E=t,T=i)):N(h.POLYGON_OFFSET_FILL)}function $(e){void 0===e&&(e=h.TEXTURE0+S-1),A!==e&&(h.activeTexture(e),A=e)}return D[h.TEXTURE_2D]=I(h.TEXTURE_2D,h.TEXTURE_2D,1),D[h.TEXTURE_CUBE_MAP]=I(h.TEXTURE_CUBE_MAP,h.TEXTURE_CUBE_MAP_POSITIVE_X,6),{buffers:{color:t,depth:n,stencil:r},init:function(){t.setClear(0,0,0,1),n.setClear(1),r.setClear(0),k(h.DEPTH_TEST),n.setFunc(ie),B(!1),F(j),k(h.CULL_FACE),k(h.BLEND),H(W)},initAttributes:function(){for(var e=0,t=o.length;e<t;e++)o[e]=0},enableAttribute:function(e){o[e]=1,0===a[e]&&(h.enableVertexAttribArray(e),a[e]=1),0!==s[e]&&(i.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(e,0),s[e]=0)},enableAttributeAndDivisor:function(e,t){o[e]=1,0===a[e]&&(h.enableVertexAttribArray(e),a[e]=1),s[e]!==t&&(i.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(e,t),s[e]=t)},disableUnusedAttributes:function(){for(var e=0,t=a.length;e!==t;++e)a[e]!==o[e]&&(h.disableVertexAttribArray(e),a[e]=0)},enable:k,disable:N,getCompressedTextureFormats:function(){if(null===u&&(u=[],i.get("WEBGL_compressed_texture_pvrtc")||i.get("WEBGL_compressed_texture_s3tc")||i.get("WEBGL_compressed_texture_etc1")))for(var e=h.getParameter(h.COMPRESSED_TEXTURE_FORMATS),t=0;t<e.length;t++)u.push(e[t]);return u},setBlending:H,setMaterial:function(e){e.side===Y?N(h.CULL_FACE):k(h.CULL_FACE),B(e.side===Z),!0===e.transparent?H(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha):H(G),n.setFunc(e.depthFunc),n.setTest(e.depthTest),n.setMask(e.depthWrite),t.setMask(e.colorWrite),U(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:B,setCullFace:F,setLineWidth:function(e){e!==_&&(R&&h.lineWidth(e),_=e)},setPolygonOffset:U,getScissorTest:function(){return M},setScissorTest:function(e){(M=e)?k(h.SCISSOR_TEST):N(h.SCISSOR_TEST)},activeTexture:$,bindTexture:function(e,t){null===A&&$();var i=P[A];void 0===i&&(i={type:void 0,texture:void 0},P[A]=i),i.type===e&&i.texture===t||(h.bindTexture(e,t||D[e]),i.type=e,i.texture=t)},compressedTexImage2D:function(){try{h.compressedTexImage2D.apply(h,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{h.texImage2D.apply(h,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(e){!1===L.equals(e)&&(h.scissor(e.x,e.y,e.z,e.w),L.copy(e))},viewport:function(e){!1===O.equals(e)&&(h.viewport(e.x,e.y,e.z,e.w),O.copy(e))},reset:function(){for(var e=0;e<a.length;e++)1===a[e]&&(h.disableVertexAttribArray(e),a[e]=0);c={},P={},w=x=d=A=u=null,t.reset(),n.reset(),r.reset()}}}function Jr(t,i,e){var n;function r(e){if("highp"===e){if(0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision)return"highp";e="mediump"}return"mediump"===e&&0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision?"mediump":"lowp"}var o=void 0!==e.precision?e.precision:"highp",a=r(o);a!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",a,"instead."),o=a);var s=!0===e.logarithmicDepthBuffer&&!!i.get("EXT_frag_depth"),l=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),c=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),h=t.getParameter(t.MAX_TEXTURE_SIZE),u=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),d=t.getParameter(t.MAX_VERTEX_ATTRIBS),p=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),f=t.getParameter(t.MAX_VARYING_VECTORS),m=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),g=0<c,v=!!i.get("OES_texture_float");return{getMaxAnisotropy:function(){if(void 0!==n)return n;var e=i.get("EXT_texture_filter_anisotropic");return n=null!==e?t.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:r,precision:o,logarithmicDepthBuffer:s,maxTextures:l,maxVertexTextures:c,maxTextureSize:h,maxCubemapSize:u,maxAttributes:d,maxVertexUniforms:p,maxVaryings:f,maxFragmentUniforms:m,vertexTextures:g,floatFragmentTextures:v,floatVertexTextures:g&&v}}function Qr(e){rn.call(this),this.cameras=e||[]}function eo(n){var r=this,a=null,s=null;"VRFrameData"in window&&(s=new window.VRFrameData);var l=new ot,c=new ot,h=new ot,u=new rn;u.bounds=new et(0,0,.5,1),u.layers.enable(1);var d=new rn;d.bounds=new et(.5,0,.5,1),d.layers.enable(2);var o,p,f=new Qr([u,d]);f.layers.enable(1),f.layers.enable(2),window.addEventListener("vrdisplaypresentchange",function(){if(a.isPresenting){var e=a.getEyeParameters("left"),t=e.renderWidth,i=e.renderHeight;p=n.getPixelRatio(),o=n.getSize(),n.setDrawingBufferSize(2*t,i,1)}else r.enabled&&n.setDrawingBufferSize(o.width,o.height,p)},!1),this.enabled=!1,this.standing=!1,this.getDevice=function(){return a},this.setDevice=function(e){void 0!==e&&(a=e)},this.getCamera=function(e){if(null===a)return e;a.depthNear=e.near,a.depthFar=e.far,a.getFrameData(s);var t=s.pose;null!==t.position?e.position.fromArray(t.position):e.position.set(0,0,0),null!==t.orientation&&e.quaternion.fromArray(t.orientation),e.updateMatrixWorld();var i=a.stageParameters;if(this.standing&&i&&(c.fromArray(i.sittingToStandingTransform),h.getInverse(c),e.matrixWorld.multiply(c),e.matrixWorldInverse.multiply(h)),!1===a.isPresenting)return e;f.matrixWorld.copy(e.matrixWorld),f.matrixWorldInverse.copy(e.matrixWorldInverse),u.matrixWorldInverse.fromArray(s.leftViewMatrix),d.matrixWorldInverse.fromArray(s.rightViewMatrix),this.standing&&i&&(u.matrixWorldInverse.multiply(h),d.matrixWorldInverse.multiply(h));var n=e.parent;null!==n&&(l.getInverse(n.matrixWorld),u.matrixWorldInverse.multiply(l),d.matrixWorldInverse.multiply(l)),u.matrixWorld.getInverse(u.matrixWorldInverse),d.matrixWorld.getInverse(d.matrixWorldInverse),u.projectionMatrix.fromArray(s.leftProjectionMatrix),d.projectionMatrix.fromArray(s.rightProjectionMatrix),f.projectionMatrix.copy(u.projectionMatrix);var r=a.getLayers();if(r.length){var o=r[0];null!==o.leftBounds&&4===o.leftBounds.length&&u.bounds.fromArray(o.leftBounds),null!==o.rightBounds&&4===o.rightBounds.length&&d.bounds.fromArray(o.rightBounds)}return f},this.getStandingMatrix=function(){return c},this.submitFrame=function(){a&&a.isPresenting&&a.submitFrame()}}function to(i){var n={};return{get:function(e){if(void 0!==n[e])return n[e];var t;switch(e){case"WEBGL_depth_texture":t=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":t=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":t=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":t=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":t=i.getExtension("WEBGL_compressed_texture_etc1");break;default:t=i.getExtension(e)}return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),n[e]=t}}}function io(){var h=this,u=null,d=0,p=!1,f=!1,m=new Pi,g=new Ai,v={value:null,needsUpdate:!1};function y(){v.value!==u&&(v.value=u,v.needsUpdate=0<d),h.numPlanes=d,h.numIntersection=0}function b(e,t,i,n){var r=null!==e?e.length:0,o=null;if(0!==r){if(o=v.value,!0!==n||null===o){var a=i+4*r,s=t.matrixWorldInverse;g.getNormalMatrix(s),(null===o||o.length<a)&&(o=new Float32Array(a));for(var l=0,c=i;l!==r;++l,c+=4)m.copy(e[l]).applyMatrix4(s,g),m.normal.toArray(o,c),o[c+3]=m.constant}v.value=o,v.needsUpdate=!0}return h.numPlanes=r,o}this.uniform=v,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,i){var n=0!==e.length||t||0!==d||p;return p=t,u=b(e,i,0),d=e.length,n},this.beginShadows=function(){f=!0,b(null)},this.endShadows=function(){f=!1,y()},this.setState=function(e,t,i,n,r,o){if(!p||null===e||0===e.length||f&&!i)f?b(null):y();else{var a=f?0:d,s=4*a,l=r.clippingState||null;v.value=l,l=b(e,n,s,o);for(var c=0;c!==s;++c)l[c]=u[c];r.clippingState=l,this.numIntersection=t?this.numPlanes:0,this.numPlanes+=a}}}function no(e){console.log("THREE.WebGLRenderer","86");var r=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),t=void 0!==e.context?e.context:null,i=void 0!==e.alpha&&e.alpha,n=void 0===e.depth||e.depth,o=void 0===e.stencil||e.stencil,a=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,p=[],f=null,P=new Float32Array(8),m=[],g=[];this.domElement=r,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=Ie,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var L,O=this,I=null,c=null,u=null,D=-1,k="",N=null,H=null,h=new et,d=null,v=new et,B=0,x=r.width,F=r.height,U=1,y=new et(0,0,x,F),b=!1,w=new et(0,0,x,F),_=new Li,$=new io,z=!1,j=!1,E=new ot,V=new rt,T=new ot,M=new ot,G={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],shadows:[]},S={geometries:0,textures:0},C={frame:0,calls:0,vertices:0,faces:0,points:0};this.info={render:C,memory:S,programs:null};try{var R={alpha:i,depth:n,stencil:o,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:l};if(null===(L=t||r.getContext("webgl",R)||r.getContext("experimental-webgl",R)))throw null!==r.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";void 0===L.getShaderPrecisionFormat&&(L.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),r.addEventListener("webglcontextlost",me,!1)}catch(e){console.error("THREE.WebGLRenderer: "+e)}var W=new to(L);W.get("WEBGL_depth_texture"),W.get("OES_texture_float"),W.get("OES_texture_float_linear"),W.get("OES_texture_half_float"),W.get("OES_texture_half_float_linear"),W.get("OES_standard_derivatives"),W.get("ANGLE_instanced_arrays"),W.get("OES_element_index_uint")&&(or.MaxIndex=4294967296);var q=new Jr(L,W,e),X=new Kr(L,W,Ce),Z=new Yr,A=new Zr(L,W,X,Z,q,Ce,S),Y=new Ii(L),K=new _r(L,Y,S),J=new Tr(L,K,C),Q=new Xr(this,q),ee=new Er,te=new br,ie=new mr(this,X,J,s),ne=new eo(this);this.info.programs=Q.programs;var re=new wr(L,W,C),oe=new xr(L,W,C);function ae(){return null===c?U:1}function se(){X.init(),X.scissor(h.copy(y).multiplyScalar(U)),X.viewport(v.copy(w).multiplyScalar(U))}function le(){N=I=null,k="",D=-1,X.reset()}se(),this.context=L,this.capabilities=q,this.extensions=W,this.properties=Z,this.renderLists=te,this.state=X,this.vr=ne;var ce=new Oi(this,G,J,q);this.shadowMap=ce;var he,ue,de,pe=new ni(this,m),fe=new ii(this,g);function me(e){e.preventDefault(),le(),se(),Z.clear(),J.clear()}function ge(e){var t,i=e.target;i.removeEventListener("dispose",ge),ve(t=i),Z.remove(t)}function ve(e){var t=Z.get(e).program;(e.program=void 0)!==t&&Q.releaseProgram(t)}function ye(e,t){return Math.abs(t[0])-Math.abs(e[0])}function be(e,t,i,n){for(var r=0,o=e.length;r<o;r++){var a=e[r],s=a.object,l=a.geometry,c=void 0===n?a.material:n,h=a.group;if(i.isArrayCamera)for(var u=(H=i).cameras,d=0,p=u.length;d<p;d++){var f=u[d];if(s.layers.test(f.layers)){var m=f.bounds,g=m.x*x,v=m.y*F,y=m.z*x,b=m.w*F;O.setViewport(g,v,y,b),O.setScissor(g,v,y,b),O.setScissorTest(!0),xe(s,t,f,l,c,h)}}else H=null,xe(s,t,i,l,c,h)}}function xe(e,t,i,n,r,o){if(e.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.onBeforeRender(O,t,i,n,r,o),e.isImmediateRenderObject){X.setMaterial(r);var a=_e(i,t.fog,r,e);k="",s=a,l=r,e.render(function(e){O.renderBufferImmediate(e,s,l)})}else O.renderBufferDirect(i,t.fog,n,r,e,o);var s,l;e.onAfterRender(O,t,i,n,r,o)}function we(e,t,i){var n=Z.get(e),r=Q.getParameters(e,G,t,$.numPlanes,$.numIntersection,i),o=Q.getProgramCode(e,r),a=n.program,s=!0;if(void 0===a)e.addEventListener("dispose",ge);else if(a.code!==o)ve(e);else{if(void 0!==r.shaderID)return;s=!1}if(s){if(r.shaderID){var l=ei[r.shaderID];n.shader={name:e.type,uniforms:Jt.clone(l.uniforms),vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}}else n.shader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.onBeforeCompile(n.shader),a=Q.acquireProgram(e,n.shader,r,o),n.program=a,e.program=a}var c=a.getAttributes();if(e.morphTargets)for(var h=e.numSupportedMorphTargets=0;h<O.maxMorphTargets;h++)0<=c["morphTarget"+h]&&e.numSupportedMorphTargets++;if(e.morphNormals)for(h=e.numSupportedMorphNormals=0;h<O.maxMorphNormals;h++)0<=c["morphNormal"+h]&&e.numSupportedMorphNormals++;var u=n.shader.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(n.numClippingPlanes=$.numPlanes,n.numIntersection=$.numIntersection,u.clippingPlanes=$.uniform),n.fog=t,n.lightsHash=G.hash,e.lights&&(u.ambientLightColor.value=G.ambient,u.directionalLights.value=G.directional,u.spotLights.value=G.spot,u.rectAreaLights.value=G.rectArea,u.pointLights.value=G.point,u.hemisphereLights.value=G.hemi,u.directionalShadowMap.value=G.directionalShadowMap,u.directionalShadowMatrix.value=G.directionalShadowMatrix,u.spotShadowMap.value=G.spotShadowMap,u.spotShadowMatrix.value=G.spotShadowMatrix,u.pointShadowMap.value=G.pointShadowMap,u.pointShadowMatrix.value=G.pointShadowMatrix);var d=n.program.getUniforms(),p=Wt.seqWithValue(d.seq,u);n.uniformsList=p}function _e(e,t,i,n){B=0;var r=Z.get(i);if(z&&(j||e!==N)){var o=e===N&&i.id===D;$.setState(i.clippingPlanes,i.clipIntersection,i.clipShadows,e,r,o)}!1===i.needsUpdate&&(void 0===r.program?i.needsUpdate=!0:i.fog&&r.fog!==t?i.needsUpdate=!0:i.lights&&r.lightsHash!==G.hash?i.needsUpdate=!0:void 0===r.numClippingPlanes||r.numClippingPlanes===$.numPlanes&&r.numIntersection===$.numIntersection||(i.needsUpdate=!0)),i.needsUpdate&&(we(i,t,n),i.needsUpdate=!1);var a,s,l,c,h,u,d,p,f,m,g,v,y=!1,b=!1,x=!1,w=r.program,_=w.getUniforms(),E=r.shader.uniforms;if(w.id!==I&&(L.useProgram(w.program),I=w.id,x=b=y=!0),i.id!==D&&(D=i.id,b=!0),y||e!==N){if(_.setValue(L,"projectionMatrix",e.projectionMatrix),q.logarithmicDepthBuffer&&_.setValue(L,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),N!==(H||e)&&(N=H||e,x=b=!0),i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshStandardMaterial||i.envMap){var T=_.map.cameraPosition;void 0!==T&&T.setValue(L,V.setFromMatrixPosition(e.matrixWorld))}(i.isMeshPhongMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.skinning)&&_.setValue(L,"viewMatrix",e.matrixWorldInverse)}if(i.skinning){_.setOptional(L,n,"bindMatrix"),_.setOptional(L,n,"bindMatrixInverse");var M=n.skeleton;if(M){var S=M.bones;if(q.floatVertexTextures){if(void 0===M.boneTexture){var C=Math.sqrt(4*S.length);C=Qe.nextPowerOfTwo(Math.ceil(C)),C=Math.max(C,4);var R=new Float32Array(C*C*4);R.set(M.boneMatrices);var A=new at(R,C,C,Ze,Ge);M.boneMatrices=R,M.boneTexture=A,M.boneTextureSize=C}_.setValue(L,"boneTexture",M.boneTexture),_.setValue(L,"boneTextureSize",M.boneTextureSize)}else _.setOptional(L,M,"boneMatrices")}}return b&&(_.setValue(L,"toneMappingExposure",O.toneMappingExposure),_.setValue(L,"toneMappingWhitePoint",O.toneMappingWhitePoint),i.lights&&(v=x,(g=E).ambientLightColor.needsUpdate=v,g.directionalLights.needsUpdate=v,g.pointLights.needsUpdate=v,g.spotLights.needsUpdate=v,g.rectAreaLights.needsUpdate=v,g.hemisphereLights.needsUpdate=v),t&&i.fog&&(m=t,(f=E).fogColor.value=m.color,m.isFog?(f.fogNear.value=m.near,f.fogFar.value=m.far):m.isFogExp2&&(f.fogDensity.value=m.density)),(i.isMeshBasicMaterial||i.isMeshLambertMaterial||i.isMeshPhongMaterial||i.isMeshStandardMaterial||i.isMeshNormalMaterial||i.isMeshDepthMaterial)&&function(e,t){e.opacity.value=t.opacity,e.diffuse.value=t.color,t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity);e.map.value=t.map,e.specularMap.value=t.specularMap,e.alphaMap.value=t.alphaMap,t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity);t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity);var i;t.map?i=t.map:t.specularMap?i=t.specularMap:t.displacementMap?i=t.displacementMap:t.normalMap?i=t.normalMap:t.bumpMap?i=t.bumpMap:t.roughnessMap?i=t.roughnessMap:t.metalnessMap?i=t.metalnessMap:t.alphaMap?i=t.alphaMap:t.emissiveMap&&(i=t.emissiveMap);if(void 0!==i){i.isWebGLRenderTarget&&(i=i.texture);var n=i.offset,r=i.repeat;e.offsetRepeat.value.set(n.x,n.y,r.x,r.y)}e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap&&t.envMap.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio}(E,i),i.isLineBasicMaterial?Ee(E,i):i.isLineDashedMaterial?(Ee(E,i),p=i,(d=E).dashSize.value=p.dashSize,d.totalSize.value=p.dashSize+p.gapSize,d.scale.value=p.scale):i.isPointsMaterial?function(e,t){if(e.diffuse.value=t.color,e.opacity.value=t.opacity,e.size.value=t.size*U,e.scale.value=.5*F,e.map.value=t.map,null!==t.map){var i=t.map.offset,n=t.map.repeat;e.offsetRepeat.value.set(i.x,i.y,n.x,n.y)}}(E,i):i.isMeshLambertMaterial?(h=E,(u=i).emissiveMap&&(h.emissiveMap.value=u.emissiveMap)):i.isMeshToonMaterial?(Te(l=E,c=i),c.gradientMap&&(l.gradientMap.value=c.gradientMap)):i.isMeshPhongMaterial?Te(E,i):i.isMeshPhysicalMaterial?(s=i,(a=E).clearCoat.value=s.clearCoat,a.clearCoatRoughness.value=s.clearCoatRoughness,Me(a,s)):i.isMeshStandardMaterial?Me(E,i):i.isMeshDepthMaterial?i.displacementMap&&(E.displacementMap.value=i.displacementMap,E.displacementScale.value=i.displacementScale,E.displacementBias.value=i.displacementBias):i.isMeshNormalMaterial&&function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale);t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale));t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(E,i),void 0!==E.ltcMat&&(E.ltcMat.value=Kt.LTC_MAT_TEXTURE),void 0!==E.ltcMag&&(E.ltcMag.value=Kt.LTC_MAG_TEXTURE),Wt.upload(L,r.uniformsList,E,O)),_.setValue(L,"modelViewMatrix",n.modelViewMatrix),_.setValue(L,"normalMatrix",n.normalMatrix),_.setValue(L,"modelMatrix",n.matrixWorld),w}function Ee(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}function Te(e,t){e.specular.value=t.specular,e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function Me(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}function Se(e,t){var i,n,r,o,a,s,l,c,h=0,u=0,d=0,p=t.matrixWorldInverse,f=0,m=0,g=0,v=0,y=0;for(i=0,n=e.length;i<n;i++)if(a=(r=e[i]).color,s=r.intensity,l=r.distance,c=r.shadow&&r.shadow.map?r.shadow.map.texture:null,r.isAmbientLight)h+=a.r*s,u+=a.g*s,d+=a.b*s;else if(r.isDirectionalLight){(b=ee.get(r)).color.copy(r.color).multiplyScalar(r.intensity),b.direction.setFromMatrixPosition(r.matrixWorld),V.setFromMatrixPosition(r.target.matrixWorld),b.direction.sub(V),b.direction.transformDirection(p),b.shadow=r.castShadow,r.castShadow&&(o=r.shadow,b.shadowBias=o.bias,b.shadowRadius=o.radius,b.shadowMapSize=o.mapSize),G.directionalShadowMap[f]=c,G.directionalShadowMatrix[f]=r.shadow.matrix,G.directional[f]=b,f++}else if(r.isSpotLight){(b=ee.get(r)).position.setFromMatrixPosition(r.matrixWorld),b.position.applyMatrix4(p),b.color.copy(a).multiplyScalar(s),b.distance=l,b.direction.setFromMatrixPosition(r.matrixWorld),V.setFromMatrixPosition(r.target.matrixWorld),b.direction.sub(V),b.direction.transformDirection(p),b.coneCos=Math.cos(r.angle),b.penumbraCos=Math.cos(r.angle*(1-r.penumbra)),b.decay=0===r.distance?0:r.decay,b.shadow=r.castShadow,r.castShadow&&(o=r.shadow,b.shadowBias=o.bias,b.shadowRadius=o.radius,b.shadowMapSize=o.mapSize),G.spotShadowMap[g]=c,G.spotShadowMatrix[g]=r.shadow.matrix,G.spot[g]=b,g++}else if(r.isRectAreaLight){(b=ee.get(r)).color.copy(a).multiplyScalar(s/(r.width*r.height)),b.position.setFromMatrixPosition(r.matrixWorld),b.position.applyMatrix4(p),M.identity(),T.copy(r.matrixWorld),T.premultiply(p),M.extractRotation(T),b.halfWidth.set(.5*r.width,0,0),b.halfHeight.set(0,.5*r.height,0),b.halfWidth.applyMatrix4(M),b.halfHeight.applyMatrix4(M),G.rectArea[v]=b,v++}else if(r.isPointLight){(b=ee.get(r)).position.setFromMatrixPosition(r.matrixWorld),b.position.applyMatrix4(p),b.color.copy(r.color).multiplyScalar(r.intensity),b.distance=r.distance,b.decay=0===r.distance?0:r.decay,b.shadow=r.castShadow,r.castShadow&&(o=r.shadow,b.shadowBias=o.bias,b.shadowRadius=o.radius,b.shadowMapSize=o.mapSize),G.pointShadowMap[m]=c,G.pointShadowMatrix[m]=r.shadow.matrix,G.point[m]=b,m++}else if(r.isHemisphereLight){var b;(b=ee.get(r)).direction.setFromMatrixPosition(r.matrixWorld),b.direction.transformDirection(p),b.direction.normalize(),b.skyColor.copy(r.color).multiplyScalar(s),b.groundColor.copy(r.groundColor).multiplyScalar(s),G.hemi[y]=b,y++}G.ambient[0]=h,G.ambient[1]=u,G.ambient[2]=d,G.directional.length=f,G.spot.length=g,G.rectArea.length=v,G.point.length=m,G.hemi.length=y,G.hash=f+","+m+","+g+","+v+","+y+","+G.shadows.length}function Ce(e){var t;if(e===De)return L.REPEAT;if(e===ke)return L.CLAMP_TO_EDGE;if(e===Ne)return L.MIRRORED_REPEAT;if(e===He)return L.NEAREST;if(e===Be)return L.NEAREST_MIPMAP_NEAREST;if(e===Fe)return L.NEAREST_MIPMAP_LINEAR;if(e===Ue)return L.LINEAR;if(1007===e)return L.LINEAR_MIPMAP_NEAREST;if(e===$e)return L.LINEAR_MIPMAP_LINEAR;if(e===ze)return L.UNSIGNED_BYTE;if(1017===e)return L.UNSIGNED_SHORT_4_4_4_4;if(1018===e)return L.UNSIGNED_SHORT_5_5_5_1;if(1019===e)return L.UNSIGNED_SHORT_5_6_5;if(1010===e)return L.BYTE;if(1011===e)return L.SHORT;if(e===je)return L.UNSIGNED_SHORT;if(1013===e)return L.INT;if(e===Ve)return L.UNSIGNED_INT;if(e===Ge)return L.FLOAT;if(e===We&&null!==(t=W.get("OES_texture_half_float")))return t.HALF_FLOAT_OES;if(1021===e)return L.ALPHA;if(e===Xe)return L.RGB;if(e===Ze)return L.RGBA;if(1024===e)return L.LUMINANCE;if(1025===e)return L.LUMINANCE_ALPHA;if(e===Ye)return L.DEPTH_COMPONENT;if(e===Ke)return L.DEPTH_STENCIL;if(e===Pe)return L.FUNC_ADD;if(101===e)return L.FUNC_SUBTRACT;if(102===e)return L.FUNC_REVERSE_SUBTRACT;if(200===e)return L.ZERO;if(201===e)return L.ONE;if(202===e)return L.SRC_COLOR;if(203===e)return L.ONE_MINUS_SRC_COLOR;if(e===Le)return L.SRC_ALPHA;if(e===Oe)return L.ONE_MINUS_SRC_ALPHA;if(206===e)return L.DST_ALPHA;if(207===e)return L.ONE_MINUS_DST_ALPHA;if(208===e)return L.DST_COLOR;if(209===e)return L.ONE_MINUS_DST_COLOR;if(210===e)return L.SRC_ALPHA_SATURATE;if((2001===e||2002===e||2003===e||2004===e)&&null!==(t=W.get("WEBGL_compressed_texture_s3tc"))){if(2001===e)return t.COMPRESSED_RGB_S3TC_DXT1_EXT;if(2002===e)return t.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(2003===e)return t.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(2004===e)return t.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((2100===e||2101===e||2102===e||2103===e)&&null!==(t=W.get("WEBGL_compressed_texture_pvrtc"))){if(2100===e)return t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(2101===e)return t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(2102===e)return t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(2103===e)return t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(2151===e&&null!==(t=W.get("WEBGL_compressed_texture_etc1")))return t.COMPRESSED_RGB_ETC1_WEBGL;if((103===e||104===e)&&null!==(t=W.get("EXT_blend_minmax"))){if(103===e)return t.MIN_EXT;if(104===e)return t.MAX_EXT}return e===qe&&null!==(t=W.get("WEBGL_depth_texture"))?t.UNSIGNED_INT_24_8_WEBGL:0}this.getContext=function(){return L},this.getContextAttributes=function(){return L.getContextAttributes()},this.forceContextLoss=function(){var e=W.get("WEBGL_lose_context");e&&e.loseContext()},this.getMaxAnisotropy=function(){return q.getMaxAnisotropy()},this.getPrecision=function(){return q.precision},this.getPixelRatio=function(){return U},this.setPixelRatio=function(e){void 0!==e&&(U=e,this.setSize(x,F,!1))},this.getSize=function(){return{width:x,height:F}},this.setSize=function(e,t,i){var n=ne.getDevice();n&&n.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(x=e,F=t,r.width=e*U,r.height=t*U,!1!==i&&(r.style.width=e+"px",r.style.height=t+"px"),this.setViewport(0,0,e,t))},this.getDrawingBufferSize=function(){return{width:x*U,height:F*U}},this.setDrawingBufferSize=function(e,t,i){x=e,F=t,U=i,r.width=e*i,r.height=t*i,this.setViewport(0,0,e,t)},this.setViewport=function(e,t,i,n){w.set(e,F-t-n,i,n),X.viewport(v.copy(w).multiplyScalar(U))},this.setScissor=function(e,t,i,n){y.set(e,F-t-n,i,n),X.scissor(h.copy(y).multiplyScalar(U))},this.setScissorTest=function(e){X.setScissorTest(b=e)},this.getClearColor=ie.getClearColor,this.setClearColor=ie.setClearColor,this.getClearAlpha=ie.getClearAlpha,this.setClearAlpha=ie.setClearAlpha,this.clear=function(e,t,i){var n=0;(void 0===e||e)&&(n|=L.COLOR_BUFFER_BIT),(void 0===t||t)&&(n|=L.DEPTH_BUFFER_BIT),(void 0===i||i)&&(n|=L.STENCIL_BUFFER_BIT),L.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(e,t,i,n){this.setRenderTarget(e),this.clear(t,i,n)},this.resetGLState=le,this.dispose=function(){r.removeEventListener("webglcontextlost",me,!1),te.dispose()},this.renderBufferImmediate=function(e,t,i){X.initAttributes();var n=Z.get(e);e.hasPositions&&!n.position&&(n.position=L.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=L.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=L.createBuffer()),e.hasColors&&!n.color&&(n.color=L.createBuffer());var r=t.getAttributes();if(e.hasPositions&&(L.bindBuffer(L.ARRAY_BUFFER,n.position),L.bufferData(L.ARRAY_BUFFER,e.positionArray,L.DYNAMIC_DRAW),X.enableAttribute(r.position),L.vertexAttribPointer(r.position,3,L.FLOAT,!1,0,0)),e.hasNormals){if(L.bindBuffer(L.ARRAY_BUFFER,n.normal),!i.isMeshPhongMaterial&&!i.isMeshStandardMaterial&&!i.isMeshNormalMaterial&&i.shading===Re)for(var o=0,a=3*e.count;o<a;o+=9){var s=e.normalArray,l=(s[o+0]+s[o+3]+s[o+6])/3,c=(s[o+1]+s[o+4]+s[o+7])/3,h=(s[o+2]+s[o+5]+s[o+8])/3;s[o+0]=l,s[o+1]=c,s[o+2]=h,s[o+3]=l,s[o+4]=c,s[o+5]=h,s[o+6]=l,s[o+7]=c,s[o+8]=h}L.bufferData(L.ARRAY_BUFFER,e.normalArray,L.DYNAMIC_DRAW),X.enableAttribute(r.normal),L.vertexAttribPointer(r.normal,3,L.FLOAT,!1,0,0)}e.hasUvs&&i.map&&(L.bindBuffer(L.ARRAY_BUFFER,n.uv),L.bufferData(L.ARRAY_BUFFER,e.uvArray,L.DYNAMIC_DRAW),X.enableAttribute(r.uv),L.vertexAttribPointer(Y.uv,2,L.FLOAT,!1,0,0)),e.hasColors&&i.vertexColors!==Ae&&(L.bindBuffer(L.ARRAY_BUFFER,n.color),L.bufferData(L.ARRAY_BUFFER,e.colorArray,L.DYNAMIC_DRAW),X.enableAttribute(r.color),L.vertexAttribPointer(r.color,3,L.FLOAT,!1,0,0)),X.disableUnusedAttributes(),L.drawArrays(L.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,i,n,r,o){X.setMaterial(n);var a=_e(e,t,n,r),s=i.id+"_"+a.id+"_"+(!0===n.wireframe),l=!1;s!==k&&(k=s,l=!0);var c=r.morphTargetInfluences;if(void 0!==c){for(var h=[],u=0,d=c.length;u<d;u++){var p=c[u];h.push([p,u])}h.sort(ye),8<h.length&&(h.length=8);var f=i.morphAttributes;for(u=0,d=h.length;u<d;u++){p=h[u];if(P[u]=p[0],0!==p[0]){var m=p[1];!0===n.morphTargets&&f.position&&i.addAttribute("morphTarget"+u,f.position[m]),!0===n.morphNormals&&f.normal&&i.addAttribute("morphNormal"+u,f.normal[m])}else!0===n.morphTargets&&i.removeAttribute("morphTarget"+u),!0===n.morphNormals&&i.removeAttribute("morphNormal"+u)}u=h.length;for(var g=P.length;u<g;u++)P[u]=0;a.getUniforms().setValue(L,"morphTargetInfluences",P),l=!0}m=i.index;var v,y=i.attributes.position,b=1;!0===n.wireframe&&(m=K.getWireframeAttribute(i),b=2);var x=re;null!==m&&(v=Y.get(m),(x=oe).setIndex(v)),l&&(!function(e,t,i,n){if(i&&i.isInstancedBufferGeometry&&null===W.get("ANGLE_instanced_arrays"))return console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");void 0===n&&(n=0);X.initAttributes();var r=i.attributes,o=t.getAttributes(),a=e.defaultAttributeValues;for(var s in o){var l=o[s];if(0<=l){var c=r[s];if(void 0!==c){var h=c.normalized,u=c.itemSize,d=Y.get(c),p=d.buffer,f=d.type,m=d.bytesPerElement;if(c.isInterleavedBufferAttribute){var g=c.data,v=g.stride,y=c.offset;g&&g.isInstancedInterleavedBuffer?(X.enableAttributeAndDivisor(l,g.meshPerAttribute),void 0===i.maxInstancedCount&&(i.maxInstancedCount=g.meshPerAttribute*g.count)):X.enableAttribute(l),L.bindBuffer(L.ARRAY_BUFFER,p),L.vertexAttribPointer(l,u,f,h,v*m,(n*v+y)*m)}else c.isInstancedBufferAttribute?(X.enableAttributeAndDivisor(l,c.meshPerAttribute),void 0===i.maxInstancedCount&&(i.maxInstancedCount=c.meshPerAttribute*c.count)):X.enableAttribute(l),L.bindBuffer(L.ARRAY_BUFFER,p),L.vertexAttribPointer(l,u,f,h,0,n*u*m)}else if(void 0!==a){var b=a[s];if(void 0!==b)switch(b.length){case 2:L.vertexAttrib2fv(l,b);break;case 3:L.vertexAttrib3fv(l,b);break;case 4:L.vertexAttrib4fv(l,b);break;default:L.vertexAttrib1fv(l,b)}}}}X.disableUnusedAttributes()}(n,a,i),null!==m&&L.bindBuffer(L.ELEMENT_ARRAY_BUFFER,v.buffer));var w=0;null!==m?w=m.count:void 0!==y&&(w=y.count);var _=i.drawRange.start*b,E=i.drawRange.count*b,T=null!==o?o.start*b:0,M=null!==o?o.count*b:1/0,S=Math.max(_,T),C=Math.min(w,_+E,T+M)-1,R=Math.max(0,C-S+1);if(0!==R){if(r.isMesh)if(!0===n.wireframe)X.setLineWidth(n.wireframeLinewidth*ae()),x.setMode(L.LINES);else switch(r.drawMode){case Je:x.setMode(L.TRIANGLES);break;case 1:x.setMode(L.TRIANGLE_STRIP);break;case 2:x.setMode(L.TRIANGLE_FAN)}else if(r.isLine){var A=n.linewidth;void 0===A&&(A=1),X.setLineWidth(A*ae()),r.isLineSegments?x.setMode(L.LINES):r.isLineLoop?x.setMode(L.LINE_LOOP):x.setMode(L.LINE_STRIP)}else r.isPoints&&x.setMode(L.POINTS);i&&i.isInstancedBufferGeometry?0<i.maxInstancedCount&&x.renderInstances(i,S,R):x.render(S,R)}},this.compile=function(i,e){p=[],i.traverse(function(e){e.isLight&&p.push(e)}),Se(p,e),i.traverse(function(e){if(e.material)if(Array.isArray(e.material))for(var t=0;t<e.material.length;t++)we(e.material[t],i.fog,e);else we(e.material,i.fog,e)})},this.animate=function(t){(ne.getDevice()||window).requestAnimationFrame(function e(){t(),(ne.getDevice()||window).requestAnimationFrame(e)})},this.render=function(e,t,i,n){if(t&&t.isCamera){k="",D=-1,!(N=null)===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),ne.enabled&&(t=ne.getCamera(t)),E.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),_.setFromMatrix(E),p.length=0,m.length=0,g.length=0,j=this.localClippingEnabled,z=$.init(this.clippingPlanes,j,t),(f=te.get(e,t)).init(),function e(t,i,n){if(!t.visible)return;var r=t.layers.test(i.layers);if(r)if(t.isLight)p.push(t);else if(t.isSprite)t.frustumCulled&&!_.intersectsSprite(t)||m.push(t);else if(t.isLensFlare)g.push(t);else if(t.isImmediateRenderObject)n&&V.setFromMatrixPosition(t.matrixWorld).applyMatrix4(E),f.push(t,null,t.material,V.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||_.intersectsObject(t))){n&&V.setFromMatrixPosition(t.matrixWorld).applyMatrix4(E);var o=J.update(t),a=t.material;if(Array.isArray(a))for(var s=o.groups,l=0,c=s.length;l<c;l++){var h=s[l],u=a[h.materialIndex];u&&u.visible&&f.push(t,o,u,V.z,h)}else a.visible&&f.push(t,o,a,V.z,null)}var d=t.children;for(var l=0,c=d.length;l<c;l++)e(d[l],i,n)}(e,t,O.sortObjects),f.finish(),!0===O.sortObjects&&f.sort(),z&&$.beginShadows(),function(e){for(var t=0,i=0,n=e.length;i<n;i++){var r=e[i];r.castShadow&&(G.shadows[t]=r,t++)}G.shadows.length=t}(p),ce.render(e,t),Se(p,t),z&&$.endShadows(),C.frame++,C.calls=0,C.vertices=0,C.faces=0,void(C.points=0)===i&&(i=null),this.setRenderTarget(i),ie.render(e,t,n);var r=f.opaque,o=f.transparent;if(e.overrideMaterial){var a=e.overrideMaterial;r.length&&be(r,e,t,a),o.length&&be(o,e,t,a)}else r.length&&be(r,e,t),o.length&&be(o,e,t);pe.render(e,t),fe.render(e,t,v),i&&A.updateRenderTargetMipmap(i),X.buffers.depth.setTest(!0),X.buffers.depth.setMask(!0),X.buffers.color.setMask(!0),t.isArrayCamera&&O.setScissorTest(!1),ne.enabled&&ne.submitFrame()}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFaceCulling=function(e,t){X.setCullFace(e),X.setFlipSided(0===t)},this.allocTextureUnit=function(){var e=B;return e>=q.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+e+" texture units while this GPU supports only "+q.maxTextures),B+=1,e},this.setTexture2D=(he=!1,function(e,t){e&&e.isWebGLRenderTarget&&(he||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),he=!0),e=e.texture),A.setTexture2D(e,t)}),this.setTexture=(ue=!1,function(e,t){ue||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),ue=!0),A.setTexture2D(e,t)}),this.setTextureCube=(de=!1,function(e,t){e&&e.isWebGLRenderTargetCube&&(de||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),de=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?A.setTextureCube(e,t):A.setTextureCubeDynamic(e,t)}),this.getRenderTarget=function(){return c},this.setRenderTarget=function(e){(c=e)&&void 0===Z.get(e).__webglFramebuffer&&A.setupRenderTarget(e);var t,i=e&&e.isWebGLRenderTargetCube;if(e){var n=Z.get(e);t=i?n.__webglFramebuffer[e.activeCubeFace]:n.__webglFramebuffer,h.copy(e.scissor),d=e.scissorTest,v.copy(e.viewport)}else t=null,h.copy(y).multiplyScalar(U),d=b,v.copy(w).multiplyScalar(U);if(u!==t&&(L.bindFramebuffer(L.FRAMEBUFFER,t),u=t),X.scissor(h),X.setScissorTest(d),X.viewport(v),i){var r=Z.get(e.texture);L.framebufferTexture2D(L.FRAMEBUFFER,L.COLOR_ATTACHMENT0,L.TEXTURE_CUBE_MAP_POSITIVE_X+e.activeCubeFace,r.__webglTexture,e.activeMipMapLevel)}},this.readRenderTargetPixels=function(e,t,i,n,r,o){if(e&&e.isWebGLRenderTarget){var a=Z.get(e).__webglFramebuffer;if(a){var s=!1;a!==u&&(L.bindFramebuffer(L.FRAMEBUFFER,a),s=!0);try{var l=e.texture,c=l.format,h=l.type;if(c!==Ze&&Ce(c)!==L.getParameter(L.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(h===ze||Ce(h)===L.getParameter(L.IMPLEMENTATION_COLOR_READ_TYPE)||h===Ge&&(W.get("OES_texture_float")||W.get("WEBGL_color_buffer_float"))||h===We&&W.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");L.checkFramebufferStatus(L.FRAMEBUFFER)===L.FRAMEBUFFER_COMPLETE?0<=t&&t<=e.width-n&&0<=i&&i<=e.height-r&&L.readPixels(t,i,n,r,Ce(c),Ce(h),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&L.bindFramebuffer(L.FRAMEBUFFER,u)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")}}function ro(e,t){this.name="",this.color=new Xt(e),this.density=void 0!==t?t:25e-5}function oo(e,t,i){this.name="",this.color=new Xt(e),this.near=void 0!==t?t:1,this.far=void 0!==i?i:1e3}function ao(){en.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function so(e,t,i,n,r){en.call(this),this.lensFlares=[],this.positionScreen=new rt,(this.customUpdateCallback=void 0)!==e&&this.add(e,t,i,n,r)}function lo(e){Ti.call(this),this.type="SpriteMaterial",this.color=new Xt(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(e)}function co(e){en.call(this),this.type="Sprite",this.material=void 0!==e?e:new lo}function ho(){en.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function uo(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var i=0,n=this.bones.length;i<n;i++)this.boneInverses.push(new ot)}}function po(){en.call(this),this.type="Bone"}function fo(e,t){fr.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new ot,this.bindMatrixInverse=new ot;var i=new uo(this.initBones());this.bind(i,this.matrixWorld),this.normalizeSkinWeights()}function mo(e){Ti.call(this),this.type="LineBasicMaterial",this.color=new Xt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(e)}function go(e,t,i){if(1===i)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new vo(e,t);en.call(this),this.type="Line",this.geometry=void 0!==e?e:new or,this.material=void 0!==t?t:new mo({color:16777215*Math.random()})}function vo(e,t){go.call(this,e,t),this.type="LineSegments"}function yo(e,t){go.call(this,e,t),this.type="LineLoop"}function bo(e){Ti.call(this),this.type="PointsMaterial",this.color=new Xt(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(e)}function xo(e,t){en.call(this),this.type="Points",this.geometry=void 0!==e?e:new or,this.material=void 0!==t?t:new bo({color:16777215*Math.random()})}function wo(){en.call(this),this.type="Group"}function _o(t,e,i,n,r,o,a,s,l){Ce.call(this,t,e,i,n,r,o,a,s,l),this.generateMipmaps=!1;var c=this;!function e(){requestAnimationFrame(e),t.readyState>=t.HAVE_CURRENT_DATA&&(c.needsUpdate=!0)}()}function Eo(e,t,i,n,r,o,a,s,l,c,h,u){Ce.call(this,null,o,a,s,l,c,n,r,h,u),this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function To(e,t,i,n,r,o,a,s,l){Ce.call(this,e,t,i,n,r,o,a,s,l),this.needsUpdate=!0}function Mo(e,t,i,n,r,o,a,s,l,c){if((c=void 0!==c?c:Ye)!==Ye&&c!==Ke)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&c===Ye&&(i=je),void 0===i&&c===Ke&&(i=qe),Ce.call(this,null,n,r,o,a,s,c,i,l),this.image={width:e,height:t},this.magFilter=void 0!==a?a:He,this.minFilter=void 0!==s?s:He,this.flipY=!1,this.generateMipmaps=!1}function So(e){or.call(this),this.type="WireframeGeometry";var t,i,n,r,o,a,s,l,c,h,u=[],d=[0,0],p={},f=["a","b","c"];if(e&&e.isGeometry){var m=e.faces;for(t=0,n=m.length;t<n;t++){var g=m[t];for(i=0;i<3;i++)s=g[f[i]],l=g[f[(i+1)%3]],d[0]=Math.min(s,l),d[1]=Math.max(s,l),void 0===p[c=d[0]+","+d[1]]&&(p[c]={index1:d[0],index2:d[1]})}for(c in p)a=p[c],h=e.vertices[a.index1],u.push(h.x,h.y,h.z),h=e.vertices[a.index2],u.push(h.x,h.y,h.z)}else if(e&&e.isBufferGeometry){var v,y,b,x,w,_;if(h=new rt,null!==e.index){for(v=e.attributes.position,y=e.index,0===(b=e.groups).length&&(b=[{start:0,count:y.count,materialIndex:0}]),r=0,o=b.length;r<o;++r)for(n=(t=(x=b[r]).start)+x.count;t<n;t+=3)for(i=0;i<3;i++)s=y.getX(t+i),l=y.getX(t+(i+1)%3),d[0]=Math.min(s,l),d[1]=Math.max(s,l),void 0===p[c=d[0]+","+d[1]]&&(p[c]={index1:d[0],index2:d[1]});for(c in p)a=p[c],h.fromBufferAttribute(v,a.index1),u.push(h.x,h.y,h.z),h.fromBufferAttribute(v,a.index2),u.push(h.x,h.y,h.z)}else for(t=0,n=(v=e.attributes.position).count/3;t<n;t++)for(i=0;i<3;i++)w=3*t+i,h.fromBufferAttribute(v,w),u.push(h.x,h.y,h.z),_=3*t+(i+1)%3,h.fromBufferAttribute(v,_),u.push(h.x,h.y,h.z)}this.addAttribute("position",new tr(u,3))}function Co(e,t,i){Wn.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:i},this.fromBufferGeometry(new Ro(e,t,i)),this.mergeVertices()}function Ro(e,t,i){or.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:i};var n,r,o=[],a=[],s=[],l=[],c=new rt,h=new rt,u=new rt,d=new rt,p=new rt,f=t+1;for(n=0;n<=i;n++){var m=n/i;for(r=0;r<=t;r++){var g=r/t;h=e(g,m,h),a.push(h.x,h.y,h.z),0<=g-1e-5?(u=e(g-1e-5,m,u),d.subVectors(h,u)):(u=e(g+1e-5,m,u),d.subVectors(u,h)),0<=m-1e-5?(u=e(g,m-1e-5,u),p.subVectors(h,u)):(u=e(g,m+1e-5,u),p.subVectors(u,h)),c.crossVectors(d,p).normalize(),s.push(c.x,c.y,c.z),l.push(g,m)}}for(n=0;n<i;n++)for(r=0;r<t;r++){var v=n*f+r,y=n*f+r+1,b=(n+1)*f+r+1,x=(n+1)*f+r;o.push(v,y,x),o.push(y,b,x)}this.setIndex(o),this.addAttribute("position",new tr(a,3)),this.addAttribute("normal",new tr(s,3)),this.addAttribute("uv",new tr(l,2))}function Ao(e,t,i,n){Wn.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:n},this.fromBufferGeometry(new Po(e,t,i,n)),this.mergeVertices()}function Po(n,o,e,t){or.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:n,indices:o,radius:e,detail:t},e=e||1;var h=[],u=[];function a(e,t,i,n){var r,o,a=Math.pow(2,n),s=[];for(r=0;r<=a;r++){s[r]=[];var l=e.clone().lerp(i,r/a),c=t.clone().lerp(i,r/a),h=a-r;for(o=0;o<=h;o++)s[r][o]=0===o&&r===a?l:l.clone().lerp(c,o/h)}for(r=0;r<a;r++)for(o=0;o<2*(a-r)-1;o++){var u=Math.floor(o/2);o%2==0?(d(s[r][u+1]),d(s[r+1][u]),d(s[r][u])):(d(s[r][u+1]),d(s[r+1][u+1]),d(s[r+1][u]))}}function d(e){h.push(e.x,e.y,e.z)}function s(e,t){var i=3*e;t.x=n[i+0],t.y=n[i+1],t.z=n[i+2]}function p(e,t,i,n){n<0&&1===e.x&&(u[t]=e.x-1),0===i.x&&0===i.z&&(u[t]=n/2/Math.PI+.5)}function f(e){return Math.atan2(e.z,-e.x)}!function(e){for(var t=new rt,i=new rt,n=new rt,r=0;r<o.length;r+=3)s(o[r+0],t),s(o[r+1],i),s(o[r+2],n),a(t,i,n,e)}(t=t||0),function(e){for(var t=new rt,i=0;i<h.length;i+=3)t.x=h[i+0],t.y=h[i+1],t.z=h[i+2],t.normalize().multiplyScalar(e),h[i+0]=t.x,h[i+1]=t.y,h[i+2]=t.z}(e),function(){for(var e=new rt,t=0;t<h.length;t+=3){e.x=h[t+0],e.y=h[t+1],e.z=h[t+2];var i=f(e)/2/Math.PI+.5,n=(r=e,Math.atan2(-r.y,Math.sqrt(r.x*r.x+r.z*r.z))/Math.PI+.5);u.push(i,1-n)}var r;(function(){for(var e=new rt,t=new rt,i=new rt,n=new rt,r=new xe,o=new xe,a=new xe,s=0,l=0;s<h.length;s+=9,l+=6){e.set(h[s+0],h[s+1],h[s+2]),t.set(h[s+3],h[s+4],h[s+5]),i.set(h[s+6],h[s+7],h[s+8]),r.set(u[l+0],u[l+1]),o.set(u[l+2],u[l+3]),a.set(u[l+4],u[l+5]),n.copy(e).add(t).add(i).divideScalar(3);var c=f(n);p(r,l+0,e,c),p(o,l+2,t,c),p(a,l+4,i,c)}})(),function(){for(var e=0;e<u.length;e+=6){var t=u[e+0],i=u[e+2],n=u[e+4],r=Math.max(t,i,n),o=Math.min(t,i,n);.9<r&&o<.1&&(t<.2&&(u[e+0]+=1),i<.2&&(u[e+2]+=1),n<.2&&(u[e+4]+=1))}}()}(),this.addAttribute("position",new tr(h,3)),this.addAttribute("normal",new tr(h.slice(),3)),this.addAttribute("uv",new tr(u,2)),0===t?this.computeVertexNormals():this.normalizeNormals()}function Lo(e,t){Wn.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Oo(e,t)),this.mergeVertices()}function Oo(e,t){Po.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Io(e,t){Wn.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Do(e,t)),this.mergeVertices()}function Do(e,t){Po.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function ko(e,t){Wn.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new No(e,t)),this.mergeVertices()}function No(e,t){var i=(1+Math.sqrt(5))/2;Po.call(this,[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Ho(e,t){Wn.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Bo(e,t)),this.mergeVertices()}function Bo(e,t){var i=(1+Math.sqrt(5))/2,n=1/i;Po.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Fo(e,t,i,n,r,o){Wn.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:n,closed:r},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");var a=new Uo(e,t,i,n,r);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function Uo(s,l,c,h,e){or.call(this),this.type="TubeBufferGeometry",this.parameters={path:s,tubularSegments:l,radius:c,radialSegments:h,closed:e},l=l||64,c=c||1,h=h||8,e=e||!1;var u=s.computeFrenetFrames(l,e);this.tangents=u.tangents,this.normals=u.normals,this.binormals=u.binormals;var r,d,p=new rt,f=new rt,t=new xe,m=[],g=[],i=[],o=[];function n(e){var t=s.getPointAt(e/l),i=u.normals[e],n=u.binormals[e];for(d=0;d<=h;d++){var r=d/h*Math.PI*2,o=Math.sin(r),a=-Math.cos(r);f.x=a*i.x+o*n.x,f.y=a*i.y+o*n.y,f.z=a*i.z+o*n.z,f.normalize(),g.push(f.x,f.y,f.z),p.x=t.x+c*f.x,p.y=t.y+c*f.y,p.z=t.z+c*f.z,m.push(p.x,p.y,p.z)}}!function(){for(r=0;r<l;r++)n(r);n(!1===e?l:0),function(){for(r=0;r<=l;r++)for(d=0;d<=h;d++)t.x=r/l,t.y=d/h,i.push(t.x,t.y)}(),function(){for(d=1;d<=l;d++)for(r=1;r<=h;r++){var e=(h+1)*(d-1)+(r-1),t=(h+1)*d+(r-1),i=(h+1)*d+r,n=(h+1)*(d-1)+r;o.push(e,t,n),o.push(t,i,n)}}()}(),this.setIndex(o),this.addAttribute("position",new tr(m,3)),this.addAttribute("normal",new tr(g,3)),this.addAttribute("uv",new tr(i,2))}function $o(e,t,i,n,r,o,a){Wn.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:n,p:r,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new zo(e,t,i,n,r,o)),this.mergeVertices()}function zo(e,t,i,n,r,o){or.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:n,p:r,q:o},e=e||100,t=t||40,i=Math.floor(i)||64,n=Math.floor(n)||8,r=r||2,o=o||3;var a,s,l=[],c=[],h=[],u=[],d=new rt,p=new rt,f=new rt,m=new rt,g=new rt,v=new rt,y=new rt;for(a=0;a<=i;++a){var b=a/i*r*Math.PI*2;for(C(b,r,o,e,f),C(b+.01,r,o,e,m),v.subVectors(m,f),y.addVectors(m,f),g.crossVectors(v,y),y.crossVectors(g,v),g.normalize(),y.normalize(),s=0;s<=n;++s){var x=s/n*Math.PI*2,w=-t*Math.cos(x),_=t*Math.sin(x);d.x=f.x+(w*y.x+_*g.x),d.y=f.y+(w*y.y+_*g.y),d.z=f.z+(w*y.z+_*g.z),c.push(d.x,d.y,d.z),p.subVectors(d,f).normalize(),h.push(p.x,p.y,p.z),u.push(a/i),u.push(s/n)}}for(s=1;s<=i;s++)for(a=1;a<=n;a++){var E=(n+1)*(s-1)+(a-1),T=(n+1)*s+(a-1),M=(n+1)*s+a,S=(n+1)*(s-1)+a;l.push(E,T,S),l.push(T,M,S)}function C(e,t,i,n,r){var o=Math.cos(e),a=Math.sin(e),s=i/t*e,l=Math.cos(s);r.x=n*(2+l)*.5*o,r.y=n*(2+l)*a*.5,r.z=n*Math.sin(s)*.5}this.setIndex(l),this.addAttribute("position",new tr(c,3)),this.addAttribute("normal",new tr(h,3)),this.addAttribute("uv",new tr(u,2))}function jo(e,t,i,n,r){Wn.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:n,arc:r},this.fromBufferGeometry(new Vo(e,t,i,n,r)),this.mergeVertices()}function Vo(e,t,i,n,r){or.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:n,arc:r},e=e||100,t=t||40,i=Math.floor(i)||8,n=Math.floor(n)||6,r=r||2*Math.PI;var o,a,s=[],l=[],c=[],h=[],u=new rt,d=new rt,p=new rt;for(o=0;o<=i;o++)for(a=0;a<=n;a++){var f=a/n*r,m=o/i*Math.PI*2;d.x=(e+t*Math.cos(m))*Math.cos(f),d.y=(e+t*Math.cos(m))*Math.sin(f),d.z=t*Math.sin(m),l.push(d.x,d.y,d.z),u.x=e*Math.cos(f),u.y=e*Math.sin(f),p.subVectors(d,u).normalize(),c.push(p.x,p.y,p.z),h.push(a/n),h.push(o/i)}for(o=1;o<=i;o++)for(a=1;a<=n;a++){var g=(n+1)*o+a-1,v=(n+1)*(o-1)+a-1,y=(n+1)*(o-1)+a,b=(n+1)*o+a;s.push(g,v,b),s.push(v,y,b)}this.setIndex(s),this.addAttribute("position",new tr(l,3)),this.addAttribute("normal",new tr(c,3)),this.addAttribute("uv",new tr(h,2))}Qr.prototype=Object.assign(Object.create(rn.prototype),{constructor:Qr,isArrayCamera:!0}),ro.prototype.isFogExp2=!0,ro.prototype.clone=function(){return new ro(this.color.getHex(),this.density)},ro.prototype.toJSON=function(e){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},oo.prototype.isFog=!0,oo.prototype.clone=function(){return new oo(this.color.getHex(),this.near,this.far)},oo.prototype.toJSON=function(e){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},ao.prototype=Object.assign(Object.create(en.prototype),{constructor:ao,copy:function(e,t){return en.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=en.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}),so.prototype=Object.assign(Object.create(en.prototype),{constructor:so,isLensFlare:!0,copy:function(e){en.prototype.copy.call(this,e),this.positionScreen.copy(e.positionScreen),this.customUpdateCallback=e.customUpdateCallback;for(var t=0,i=e.lensFlares.length;t<i;t++)this.lensFlares.push(e.lensFlares[t]);return this},add:function(e,t,i,n,r,o){void 0===t&&(t=-1),void 0===i&&(i=0),void 0===o&&(o=1),void 0===r&&(r=new Xt(16777215)),void 0===n&&(n=W),i=Math.min(i,Math.max(0,i)),this.lensFlares.push({texture:e,size:t,distance:i,x:0,y:0,z:0,scale:1,rotation:0,opacity:o,color:r,blending:n})},updateLensFlares:function(){var e,t,i=this.lensFlares.length,n=2*-this.positionScreen.x,r=2*-this.positionScreen.y;for(e=0;e<i;e++)(t=this.lensFlares[e]).x=this.positionScreen.x+n*t.distance,t.y=this.positionScreen.y+r*t.distance,t.wantedRotation=t.x*Math.PI*.25,t.rotation+=.25*(t.wantedRotation-t.rotation)}}),((lo.prototype=Object.create(Ti.prototype)).constructor=lo).prototype.isSpriteMaterial=!0,lo.prototype.copy=function(e){return Ti.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this},co.prototype=Object.assign(Object.create(en.prototype),{constructor:co,isSprite:!0,raycast:(Sr=new rt,Cr=new rt,Rr=new rt,function(e,t){Cr.setFromMatrixPosition(this.matrixWorld),e.ray.closestPointToPoint(Cr,Sr),Rr.setFromMatrixScale(this.matrixWorld);var i=Rr.x*Rr.y/4;if(!(Cr.distanceToSquared(Sr)>i)){var n=e.ray.origin.distanceTo(Sr);n<e.near||n>e.far||t.push({distance:n,point:Sr.clone(),face:null,object:this})}}),clone:function(){return new this.constructor(this.material).copy(this)}}),ho.prototype=Object.assign(Object.create(en.prototype),{constructor:ho,copy:function(e){en.prototype.copy.call(this,e,!1);for(var t=e.levels,i=0,n=t.length;i<n;i++){var r=t[i];this.addLevel(r.object.clone(),r.distance)}return this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var i=this.levels,n=0;n<i.length&&!(t<i[n].distance);n++);i.splice(n,0,{distance:t,object:e}),this.add(e)},getObjectForDistance:function(e){for(var t=this.levels,i=1,n=t.length;i<n&&!(e<t[i].distance);i++);return t[i-1].object},raycast:(Lr=new rt,function(e,t){Lr.setFromMatrixPosition(this.matrixWorld);var i=e.ray.origin.distanceTo(Lr);this.getObjectForDistance(i).raycast(e,t)}),update:(Ar=new rt,Pr=new rt,function(e){var t=this.levels;if(1<t.length){Ar.setFromMatrixPosition(e.matrixWorld),Pr.setFromMatrixPosition(this.matrixWorld);var i=Ar.distanceTo(Pr);t[0].object.visible=!0;for(var n=1,r=t.length;n<r&&i>=t[n].distance;n++)t[n-1].object.visible=!1,t[n].object.visible=!0;for(;n<r;n++)t[n].object.visible=!1}}),toJSON:function(e){var t=en.prototype.toJSON.call(this,e);t.object.levels=[];for(var i=this.levels,n=0,r=i.length;n<r;n++){var o=i[n];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}),Object.assign(uo.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var i=new ot;this.bones[e]&&i.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(i)}},pose:function(){var e,t,i;for(t=0,i=this.bones.length;t<i;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,i=this.bones.length;t<i;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:(Or=new ot,Ir=new ot,function(){for(var e=this.bones,t=this.boneInverses,i=this.boneMatrices,n=this.boneTexture,r=0,o=e.length;r<o;r++){var a=e[r]?e[r].matrixWorld:Ir;Or.multiplyMatrices(a,t[r]),Or.toArray(i,16*r)}void 0!==n&&(n.needsUpdate=!0)}),clone:function(){return new uo(this.bones,this.boneInverses)}}),po.prototype=Object.assign(Object.create(en.prototype),{constructor:po,isBone:!0}),fo.prototype=Object.assign(Object.create(fr.prototype),{constructor:fo,isSkinnedMesh:!0,initBones:function(){var e,t,i,n,r=[];if(this.geometry&&void 0!==this.geometry.bones){for(i=0,n=this.geometry.bones.length;i<n;i++)t=this.geometry.bones[i],e=new po,r.push(e),e.name=t.name,e.position.fromArray(t.pos),e.quaternion.fromArray(t.rotq),void 0!==t.scl&&e.scale.fromArray(t.scl);for(i=0,n=this.geometry.bones.length;i<n;i++)-1!==(t=this.geometry.bones[i]).parent&&null!==t.parent&&void 0!==r[t.parent]?r[t.parent].add(r[i]):this.add(r[i])}return this.updateMatrixWorld(!0),r},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var e,t;if(this.geometry&&this.geometry.isGeometry)for(t=0;t<this.geometry.skinWeights.length;t++){var i=this.geometry.skinWeights[t];(e=1/i.lengthManhattan())!==1/0?i.multiplyScalar(e):i.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var n=new et,r=this.geometry.attributes.skinWeight;for(t=0;t<r.count;t++)n.x=r.getX(t),n.y=r.getY(t),n.z=r.getZ(t),n.w=r.getW(t),(e=1/n.lengthManhattan())!==1/0?n.multiplyScalar(e):n.set(1,0,0,0),r.setXYZW(t,n.x,n.y,n.z,n.w)}},updateMatrixWorld:function(e){fr.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),((mo.prototype=Object.create(Ti.prototype)).constructor=mo).prototype.isLineBasicMaterial=!0,mo.prototype.copy=function(e){return Ti.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},go.prototype=Object.assign(Object.create(en.prototype),{constructor:go,isLine:!0,raycast:(Dr=new ot,kr=new ur,Nr=new Ri,function(e,t){var i=e.linePrecision,n=i*i,r=this.geometry,o=this.matrixWorld;if(null===r.boundingSphere&&r.computeBoundingSphere(),Nr.copy(r.boundingSphere),Nr.applyMatrix4(o),!1!==e.ray.intersectsSphere(Nr)){Dr.getInverse(o),kr.copy(e.ray).applyMatrix4(Dr);var a=new rt,s=new rt,l=new rt,c=new rt,h=this&&this.isLineSegments?2:1;if(r.isBufferGeometry){var u=r.index,d=r.attributes.position.array;if(null!==u)for(var p=u.array,f=0,m=p.length-1;f<m;f+=h){var g=p[f],v=p[f+1];a.fromArray(d,3*g),s.fromArray(d,3*v),n<kr.distanceSqToSegment(a,s,c,l)||(c.applyMatrix4(this.matrixWorld),(x=e.ray.origin.distanceTo(c))<e.near||x>e.far||t.push({distance:x,point:l.clone().applyMatrix4(this.matrixWorld),index:f,face:null,faceIndex:null,object:this}))}else for(f=0,m=d.length/3-1;f<m;f+=h)a.fromArray(d,3*f),s.fromArray(d,3*f+3),n<kr.distanceSqToSegment(a,s,c,l)||(c.applyMatrix4(this.matrixWorld),(x=e.ray.origin.distanceTo(c))<e.near||x>e.far||t.push({distance:x,point:l.clone().applyMatrix4(this.matrixWorld),index:f,face:null,faceIndex:null,object:this}))}else if(r.isGeometry){var y=r.vertices,b=y.length;for(f=0;f<b-1;f+=h){var x;n<kr.distanceSqToSegment(y[f],y[f+1],c,l)||(c.applyMatrix4(this.matrixWorld),(x=e.ray.origin.distanceTo(c))<e.near||x>e.far||t.push({distance:x,point:l.clone().applyMatrix4(this.matrixWorld),index:f,face:null,faceIndex:null,object:this}))}}}}),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),vo.prototype=Object.assign(Object.create(go.prototype),{constructor:vo,isLineSegments:!0}),yo.prototype=Object.assign(Object.create(go.prototype),{constructor:yo,isLineLoop:!0}),((bo.prototype=Object.create(Ti.prototype)).constructor=bo).prototype.isPointsMaterial=!0,bo.prototype.copy=function(e){return Ti.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this},xo.prototype=Object.assign(Object.create(en.prototype),{constructor:xo,isPoints:!0,raycast:(Hr=new ot,Br=new ur,Fr=new Ri,function(o,a){var s=this,e=this.geometry,l=this.matrixWorld,t=o.params.Points.threshold;if(null===e.boundingSphere&&e.computeBoundingSphere(),Fr.copy(e.boundingSphere),Fr.applyMatrix4(l),Fr.radius+=t,!1!==o.ray.intersectsSphere(Fr)){Hr.getInverse(l),Br.copy(o.ray).applyMatrix4(Hr);var i=t/((this.scale.x+this.scale.y+this.scale.z)/3),c=i*i,n=new rt;if(e.isBufferGeometry){var r=e.index,h=e.attributes.position.array;if(null!==r)for(var u=r.array,d=0,p=u.length;d<p;d++){var f=u[d];n.fromArray(h,3*f),v(n,f)}else{d=0;for(var m=h.length/3;d<m;d++)n.fromArray(h,3*d),v(n,d)}}else{var g=e.vertices;for(d=0,m=g.length;d<m;d++)v(g[d],d)}}function v(e,t){var i=Br.distanceSqToPoint(e);if(i<c){var n=Br.closestPointToPoint(e);n.applyMatrix4(l);var r=o.ray.origin.distanceTo(n);if(r<o.near||r>o.far)return;a.push({distance:r,distanceToRay:Math.sqrt(i),point:n.clone(),index:t,face:null,object:s})}}}),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),wo.prototype=Object.assign(Object.create(en.prototype),{constructor:wo}),(_o.prototype=Object.create(Ce.prototype)).constructor=_o,((Eo.prototype=Object.create(Ce.prototype)).constructor=Eo).prototype.isCompressedTexture=!0,(To.prototype=Object.create(Ce.prototype)).constructor=To,((Mo.prototype=Object.create(Ce.prototype)).constructor=Mo).prototype.isDepthTexture=!0,(So.prototype=Object.create(or.prototype)).constructor=So,(Co.prototype=Object.create(Wn.prototype)).constructor=Co,(Ro.prototype=Object.create(or.prototype)).constructor=Ro,(Ao.prototype=Object.create(Wn.prototype)).constructor=Ao,(Po.prototype=Object.create(or.prototype)).constructor=Po,(Lo.prototype=Object.create(Wn.prototype)).constructor=Lo,(Oo.prototype=Object.create(Po.prototype)).constructor=Oo,(Io.prototype=Object.create(Wn.prototype)).constructor=Io,(Do.prototype=Object.create(Po.prototype)).constructor=Do,(ko.prototype=Object.create(Wn.prototype)).constructor=ko,(No.prototype=Object.create(Po.prototype)).constructor=No,(Ho.prototype=Object.create(Wn.prototype)).constructor=Ho,(Bo.prototype=Object.create(Po.prototype)).constructor=Bo,(Fo.prototype=Object.create(Wn.prototype)).constructor=Fo,(Uo.prototype=Object.create(or.prototype)).constructor=Uo,($o.prototype=Object.create(Wn.prototype)).constructor=$o,(zo.prototype=Object.create(or.prototype)).constructor=zo,(jo.prototype=Object.create(Wn.prototype)).constructor=jo,(Vo.prototype=Object.create(or.prototype)).constructor=Vo;var Go={area:function(e){for(var t=e.length,i=0,n=t-1,r=0;r<t;n=r++)i+=e[n].x*e[r].y-e[r].x*e[n].y;return.5*i},triangulate:function(){function g(e,t,i,n,r,o){var a,s,l,c,h,u,d,p,f,m,g,v,y,b,x,w,_;if(s=e[o[t]].x,l=e[o[t]].y,c=e[o[i]].x,h=e[o[i]].y,u=e[o[n]].x,(c-s)*((d=e[o[n]].y)-l)-(h-l)*(u-s)<=0)return!1;for(m=u-c,g=d-h,v=s-u,y=l-d,b=c-s,x=h-l,a=0;a<r;a++)if(p=e[o[a]].x,f=e[o[a]].y,!(p===s&&f===l||p===c&&f===h||p===u&&f===d)&&(w=b*(f-l)-x*(p-s),_=v*(f-d)-y*(p-u),m*(f-h)-g*(p-c)>=-Number.EPSILON&&_>=-Number.EPSILON&&w>=-Number.EPSILON))return!1;return!0}return function(e,t){var i=e.length;if(i<3)return null;var n,r,o,a=[],s=[],l=[];if(0<Go.area(e))for(r=0;r<i;r++)s[r]=r;else for(r=0;r<i;r++)s[r]=i-1-r;var c=i,h=2*c;for(r=c-1;2<c;){if(h--<=0)return console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()"),t?l:a;if(c<=(n=r)&&(n=0),c<=(r=n+1)&&(r=0),c<=(o=r+1)&&(o=0),g(e,n,r,o,c,s)){var u,d,p,f,m;for(u=s[n],d=s[r],p=s[o],a.push([e[u],e[d],e[p]]),l.push([s[n],s[r],s[o]]),m=(f=r)+1;m<c;f++,m++)s[f]=s[m];h=2*--c}}return t?l:a}}(),triangulateShape:function(e,t){function i(e){var t=e.length;2<t&&e[t-1].equals(e[0])&&e.pop()}function M(e,t,i){return e.x!==t.x?e.x<t.x?e.x<=i.x&&i.x<=t.x:t.x<=i.x&&i.x<=e.x:e.y<t.y?e.y<=i.y&&i.y<=t.y:t.y<=i.y&&i.y<=e.y}function T(e,t,i,n,r){var o=t.x-e.x,a=t.y-e.y,s=n.x-i.x,l=n.y-i.y,c=e.x-i.x,h=e.y-i.y,u=a*s-o*l,d=a*c-o*h;if(Math.abs(u)>Number.EPSILON){var p;if(0<u){if(d<0||u<d)return[];if((p=l*c-s*h)<0||u<p)return[]}else{if(0<d||d<u)return[];if(0<(p=l*c-s*h)||p<u)return[]}if(0===p)return!r||0!==d&&d!==u?[e]:[];if(p===u)return!r||0!==d&&d!==u?[t]:[];if(0===d)return[i];if(d===u)return[n];var f=p/u;return[{x:e.x+f*o,y:e.y+f*a}]}if(0!==d||l*c!=s*h)return[];var m,g,v,y,b,x,w,_,E=0===o&&0===a,T=0===s&&0===l;return E&&T?e.x!==i.x||e.y!==i.y?[]:[e]:E?M(i,n,e)?[e]:[]:T?M(e,t,i)?[i]:[]:(_=0!==o?(y=e.x<t.x?(v=(m=e).x,(g=t).x):(v=(m=t).x,(g=e).x),i.x<n.x?(w=(b=i).x,(x=n).x):(w=(b=n).x,(x=i).x)):(y=e.y<t.y?(v=(m=e).y,(g=t).y):(v=(m=t).y,(g=e).y),i.y<n.y?(w=(b=i).y,(x=n).y):(w=(b=n).y,(x=i).y)),v<=w?y<w?[]:y===w?r?[]:[b]:y<=_?[b,g]:[b,x]:_<v?[]:v===_?r?[]:[m]:y<=_?[m,g]:[m,x])}function S(e,t,i,n){var r=t.x-e.x,o=t.y-e.y,a=i.x-e.x,s=i.y-e.y,l=n.x-e.x,c=n.y-e.y,h=r*s-o*a,u=r*c-o*l;if(Math.abs(h)>Number.EPSILON){var d=l*s-c*a;return 0<h?0<=u&&0<=d:0<=u||0<=d}return 0<u}i(e),t.forEach(i);for(var n,r,o,a,s,l,c={},h=e.concat(),u=0,d=t.length;u<d;u++)Array.prototype.push.apply(h,t[u]);for(n=0,r=h.length;n<r;n++)void 0!==c[s=h[n].x+":"+h[n].y]&&console.warn("THREE.ShapeUtils: Duplicate point",s,n),c[s]=n;var p=function(e,a){var c,h=e.concat();function t(e,t){var i=h.length-1,n=e-1;n<0&&(n=i);var r=e+1;i<r&&(r=0);var o=S(h[e],h[n],h[r],c[t]);if(!o)return!1;var a=c.length-1,s=t-1;s<0&&(s=a);var l=t+1;return a<l&&(l=0),!!(o=S(c[t],c[s],c[l],h[e]))}function i(e,t){var i,n;for(i=0;i<h.length;i++)if(n=i+1,n%=h.length,0<T(e,t,h[i],h[n],!0).length)return!0;return!1}var s=[];function n(e,t){var i,n,r,o;for(i=0;i<s.length;i++)for(n=a[s[i]],r=0;r<n.length;r++)if(o=r+1,o%=n.length,0<T(e,t,n[r],n[o],!0).length)return!0;return!1}for(var r,o,l,u,d,p,f,m,g,v,y=[],b=0,x=a.length;b<x;b++)s.push(b);for(var w=0,_=2*s.length;0<s.length;){if(--_<0){console.log("Infinite Loop! Holes left:"+s.length+", Probably Hole outside Shape!");break}for(o=w;o<h.length;o++){for(l=h[o],r=-1,b=0;b<s.length;b++)if(d=s[b],void 0===y[p=l.x+":"+l.y+":"+d]){c=a[d];for(var E=0;E<c.length;E++)if(u=c[E],t(o,E)&&!i(l,u)&&!n(l,u)){r=E,s.splice(b,1),f=h.slice(0,o+1),m=h.slice(o),g=c.slice(r),v=c.slice(0,r+1),h=f.concat(g).concat(v).concat(m),w=o;break}if(0<=r)break;y[p]=!0}if(0<=r)break}}return h}(e,t),f=Go.triangulate(p,!1);for(n=0,r=f.length;n<r;n++)for(a=f[n],o=0;o<3;o++)void 0!==(l=c[s=a[o].x+":"+a[o].y])&&(a[o]=l);return f.concat()},isClockWise:function(e){return Go.area(e)<0}};function Wo(e,t){Wn.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new qo(e,t)),this.mergeVertices()}function qo(e,t){void 0!==e&&(or.call(this),this.type="ExtrudeBufferGeometry",e=Array.isArray(e)?e:[e],this.addShapeList(e,t),this.computeVertexNormals())}function Xo(e,t){Wn.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new Zo(e,t)),this.mergeVertices()}function Zo(e,t){var i=(t=t||{}).font;if(!i||!i.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Wn;var n=i.generateShapes(e,t.size,t.curveSegments);t.amount=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),qo.call(this,n,t),this.type="TextBufferGeometry"}function Yo(e,t,i,n,r,o,a){Wn.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:n,phiLength:r,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new Ko(e,t,i,n,r,o,a)),this.mergeVertices()}function Ko(e,t,i,n,r,o,a){or.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:n,phiLength:r,thetaStart:o,thetaLength:a},e=e||50,t=Math.max(3,Math.floor(t)||8),i=Math.max(2,Math.floor(i)||6),n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var s,l,c=(o=void 0!==o?o:0)+(a=void 0!==a?a:Math.PI),h=0,u=[],d=new rt,p=new rt,f=[],m=[],g=[],v=[];for(l=0;l<=i;l++){var y=[],b=l/i;for(s=0;s<=t;s++){var x=s/t;d.x=-e*Math.cos(n+x*r)*Math.sin(o+b*a),d.y=e*Math.cos(o+b*a),d.z=e*Math.sin(n+x*r)*Math.sin(o+b*a),m.push(d.x,d.y,d.z),p.set(d.x,d.y,d.z).normalize(),g.push(p.x,p.y,p.z),v.push(x,1-b),y.push(h++)}u.push(y)}for(l=0;l<i;l++)for(s=0;s<t;s++){var w=u[l][s+1],_=u[l][s],E=u[l+1][s],T=u[l+1][s+1];(0!==l||0<o)&&f.push(w,_,T),(l!==i-1||c<Math.PI)&&f.push(_,E,T)}this.setIndex(f),this.addAttribute("position",new tr(m,3)),this.addAttribute("normal",new tr(g,3)),this.addAttribute("uv",new tr(v,2))}function Jo(e,t,i,n,r,o){Wn.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:n,thetaStart:r,thetaLength:o},this.fromBufferGeometry(new Qo(e,t,i,n,r,o)),this.mergeVertices()}function Qo(e,t,i,n,r,o){or.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:n,thetaStart:r,thetaLength:o},e=e||20,t=t||50,r=void 0!==r?r:0,o=void 0!==o?o:2*Math.PI,i=void 0!==i?Math.max(3,i):8;var a,s,l,c=[],h=[],u=[],d=[],p=e,f=(t-e)/(n=void 0!==n?Math.max(1,n):1),m=new rt,g=new xe;for(s=0;s<=n;s++){for(l=0;l<=i;l++)a=r+l/i*o,m.x=p*Math.cos(a),m.y=p*Math.sin(a),h.push(m.x,m.y,m.z),u.push(0,0,1),g.x=(m.x/t+1)/2,g.y=(m.y/t+1)/2,d.push(g.x,g.y);p+=f}for(s=0;s<n;s++){var v=s*(i+1);for(l=0;l<i;l++){var y=a=l+v,b=a+i+1,x=a+i+2,w=a+1;c.push(y,b,w),c.push(b,x,w)}}this.setIndex(c),this.addAttribute("position",new tr(h,3)),this.addAttribute("normal",new tr(u,3)),this.addAttribute("uv",new tr(d,2))}function ea(e,t,i,n){Wn.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:n},this.fromBufferGeometry(new ta(e,t,i,n)),this.mergeVertices()}function ta(e,t,i,n){or.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:n},t=Math.floor(t)||12,i=i||0,n=n||2*Math.PI,n=Qe.clamp(n,0,2*Math.PI);var r,o,a,s=[],l=[],c=[],h=1/t,u=new rt,d=new xe;for(o=0;o<=t;o++){var p=i+o*h*n,f=Math.sin(p),m=Math.cos(p);for(a=0;a<=e.length-1;a++)u.x=e[a].x*f,u.y=e[a].y,u.z=e[a].x*m,l.push(u.x,u.y,u.z),d.x=o/t,d.y=a/(e.length-1),c.push(d.x,d.y)}for(o=0;o<t;o++)for(a=0;a<e.length-1;a++){var g=r=a+o*e.length,v=r+e.length,y=r+e.length+1,b=r+1;s.push(g,v,b),s.push(v,y,b)}if(this.setIndex(s),this.addAttribute("position",new tr(l,3)),this.addAttribute("uv",new tr(c,2)),this.computeVertexNormals(),n===2*Math.PI){var x=this.attributes.normal.array,w=new rt,_=new rt,E=new rt;for(r=t*e.length*3,a=o=0;o<e.length;o++,a+=3)w.x=x[a+0],w.y=x[a+1],w.z=x[a+2],_.x=x[r+a+0],_.y=x[r+a+1],_.z=x[r+a+2],E.addVectors(w,_).normalize(),x[a+0]=x[r+a+0]=E.x,x[a+1]=x[r+a+1]=E.y,x[a+2]=x[r+a+2]=E.z}}function ia(e,t){Wn.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new na(e,t)),this.mergeVertices()}function na(e,f){or.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:f},f=f||12;var m=[],g=[],v=[],y=[],t=0,b=0;if(!1===Array.isArray(e))n(e);else for(var i=0;i<e.length;i++)n(e[i]),this.addGroup(t,b,i),t+=b,b=0;function n(e){var t,i,n,r=g.length/3,o=e.extractPoints(f),a=o.shape,s=o.holes;if(!1===Go.isClockWise(a))for(a=a.reverse(),t=0,i=s.length;t<i;t++)n=s[t],!0===Go.isClockWise(n)&&(s[t]=n.reverse());var l=Go.triangulateShape(a,s);for(t=0,i=s.length;t<i;t++)n=s[t],a=a.concat(n);for(t=0,i=a.length;t<i;t++){var c=a[t];g.push(c.x,c.y,0),v.push(0,0,1),y.push(c.x,c.y)}for(t=0,i=l.length;t<i;t++){var h=l[t],u=h[0]+r,d=h[1]+r,p=h[2]+r;m.push(u,d,p),b+=3}}this.setIndex(m),this.addAttribute("position",new tr(g,3)),this.addAttribute("normal",new tr(v,3)),this.addAttribute("uv",new tr(y,2))}function ra(e,t){or.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;var i,n,r,o,a=[],s=Math.cos(Qe.DEG2RAD*t),l=[0,0],c={},h=["a","b","c"];e.isBufferGeometry?(o=new Wn).fromBufferGeometry(e):o=e.clone(),o.mergeVertices(),o.computeFaceNormals();for(var u=o.vertices,d=o.faces,p=0,f=d.length;p<f;p++)for(var m=d[p],g=0;g<3;g++)i=m[h[g]],n=m[h[(g+1)%3]],l[0]=Math.min(i,n),l[1]=Math.max(i,n),void 0===c[r=l[0]+","+l[1]]?c[r]={index1:l[0],index2:l[1],face1:p,face2:void 0}:c[r].face2=p;for(r in c){var v=c[r];if(void 0===v.face2||d[v.face1].normal.dot(d[v.face2].normal)<=s){var y=u[v.index1];a.push(y.x,y.y,y.z),y=u[v.index2],a.push(y.x,y.y,y.z)}}this.addAttribute("position",new tr(a,3))}function oa(e,t,i,n,r,o,a,s){Wn.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:n,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new aa(e,t,i,n,r,o,a,s)),this.mergeVertices()}function aa(v,y,b,x,w,e,_,E){or.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:v,radiusBottom:y,height:b,radialSegments:x,heightSegments:w,openEnded:e,thetaStart:_,thetaLength:E};var T=this;v=void 0!==v?v:20,y=void 0!==y?y:20,b=void 0!==b?b:100,x=Math.floor(x)||8,w=Math.floor(w)||1,e=void 0!==e&&e,_=void 0!==_?_:0,E=void 0!==E?E:2*Math.PI;var M=[],S=[],C=[],R=[],A=0,P=[],L=b/2,O=0;function t(e){var t,i,n,r=new xe,o=new rt,a=0,s=!0===e?v:y,l=!0===e?1:-1;for(i=A,t=1;t<=x;t++)S.push(0,L*l,0),C.push(0,l,0),R.push(.5,.5),A++;for(n=A,t=0;t<=x;t++){var c=t/x*E+_,h=Math.cos(c),u=Math.sin(c);o.x=s*u,o.y=L*l,o.z=s*h,S.push(o.x,o.y,o.z),C.push(0,l,0),r.x=.5*h+.5,r.y=.5*u*l+.5,R.push(r.x,r.y),A++}for(t=0;t<x;t++){var d=i+t,p=n+t;!0===e?M.push(p,p+1,d):M.push(p+1,p,d),a+=3}T.addGroup(O,a,!0===e?1:2),O+=a}!function(){var e,t,i=new rt,n=new rt,r=0,o=(y-v)/b;for(t=0;t<=w;t++){var a=[],s=t/w,l=s*(y-v)+v;for(e=0;e<=x;e++){var c=e/x,h=c*E+_,u=Math.sin(h),d=Math.cos(h);n.x=l*u,n.y=-s*b+L,n.z=l*d,S.push(n.x,n.y,n.z),i.set(u,o,d).normalize(),C.push(i.x,i.y,i.z),R.push(c,1-s),a.push(A++)}P.push(a)}for(e=0;e<x;e++)for(t=0;t<w;t++){var p=P[t][e],f=P[t+1][e],m=P[t+1][e+1],g=P[t][e+1];M.push(p,f,g),M.push(f,m,g),r+=6}T.addGroup(O,r,0),O+=r}(),!1===e&&(0<v&&t(!0),0<y&&t(!1)),this.setIndex(M),this.addAttribute("position",new tr(S,3)),this.addAttribute("normal",new tr(C,3)),this.addAttribute("uv",new tr(R,2))}function sa(e,t,i,n,r,o,a){oa.call(this,0,e,t,i,n,r,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:o,thetaLength:a}}function la(e,t,i,n,r,o,a){aa.call(this,0,e,t,i,n,r,o,a),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:o,thetaLength:a}}function ca(e,t,i,n){Wn.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:n},this.fromBufferGeometry(new ha(e,t,i,n)),this.mergeVertices()}function ha(e,t,i,n){or.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:n},e=e||50,t=void 0!==t?Math.max(3,t):8,i=void 0!==i?i:0,n=void 0!==n?n:2*Math.PI;var r,o,a=[],s=[],l=[],c=[],h=new rt,u=new xe;for(s.push(0,0,0),l.push(0,0,1),c.push(.5,.5),o=0,r=3;o<=t;o++,r+=3){var d=i+o/t*n;h.x=e*Math.cos(d),h.y=e*Math.sin(d),s.push(h.x,h.y,h.z),l.push(0,0,1),u.x=(s[r]/e+1)/2,u.y=(s[r+1]/e+1)/2,c.push(u.x,u.y)}for(r=1;r<=t;r++)a.push(r,r+1,0);this.setIndex(a),this.addAttribute("position",new tr(s,3)),this.addAttribute("normal",new tr(l,3)),this.addAttribute("uv",new tr(c,2))}(Wo.prototype=Object.create(Wn.prototype)).constructor=Wo,((qo.prototype=Object.create(or.prototype)).constructor=qo).prototype.getArrays=function(){var e=this.getAttribute("position"),t=e?Array.prototype.slice.call(e.array):[],i=this.getAttribute("uv"),n=i?Array.prototype.slice.call(i.array):[],r=this.index;return{position:t,uv:n,index:r?Array.prototype.slice.call(r.array):[]}},qo.prototype.addShapeList=function(e,t){var i=e.length;t.arrays=this.getArrays();for(var n=0;n<i;n++){var r=e[n];this.addShape(r,t)}this.setIndex(t.arrays.index),this.addAttribute("position",new tr(t.arrays.position,3)),this.addAttribute("uv",new tr(t.arrays.uv,2))},qo.prototype.addShape=function(e,n){var t,i,r,o,a,s,l,c,h=n.arrays?n.arrays:this.getArrays(),u=h.position,d=h.index,p=h.uv,f=[],m=void 0!==n.amount?n.amount:100,g=void 0!==n.bevelThickness?n.bevelThickness:6,v=void 0!==n.bevelSize?n.bevelSize:g-2,y=void 0!==n.bevelSegments?n.bevelSegments:3,b=void 0===n.bevelEnabled||n.bevelEnabled,x=void 0!==n.curveSegments?n.curveSegments:12,w=void 0!==n.steps?n.steps:1,_=n.extrudePath,E=!1,T=void 0!==n.UVGenerator?n.UVGenerator:Wo.WorldUVGenerator;_&&(t=_.getSpacedPoints(w),b=!(E=!0),i=void 0!==n.frames?n.frames:_.computeFrenetFrames(w,!1),r=new rt,o=new rt,a=new rt),b||(v=g=y=0);var M=this,S=e.extractPoints(x),C=S.shape,R=S.holes;if(!Go.isClockWise(C))for(C=C.reverse(),l=0,c=R.length;l<c;l++)s=R[l],Go.isClockWise(s)&&(R[l]=s.reverse());var A=Go.triangulateShape(C,R),P=C;for(l=0,c=R.length;l<c;l++)s=R[l],C=C.concat(s);function L(e,t,i){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(i).add(e)}var O,I,D,k,N,H,B=C.length,F=A.length;function U(e,t,i){var n,r,o,a=e.x-t.x,s=e.y-t.y,l=i.x-e.x,c=i.y-e.y,h=a*a+s*s,u=a*c-s*l;if(Math.abs(u)>Number.EPSILON){var d=Math.sqrt(h),p=Math.sqrt(l*l+c*c),f=t.x-s/d,m=t.y+a/d,g=((i.x-c/p-f)*c-(i.y+l/p-m)*l)/(a*c-s*l),v=(n=f+a*g-e.x)*n+(r=m+s*g-e.y)*r;if(v<=2)return new xe(n,r);o=Math.sqrt(v/2)}else{var y=!1;a>Number.EPSILON?l>Number.EPSILON&&(y=!0):a<-Number.EPSILON?l<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(c)&&(y=!0),o=y?(n=-s,r=a,Math.sqrt(h)):(n=a,r=s,Math.sqrt(h/2))}return new xe(n/o,r/o)}for(var $=[],z=0,j=P.length,V=j-1,G=z+1;z<j;z++,V++,G++)V===j&&(V=0),G===j&&(G=0),$[z]=U(P[z],P[V],P[G]);var W,q,X=[],Z=$.concat();for(l=0,c=R.length;l<c;l++){for(s=R[l],W=[],z=0,V=(j=s.length)-1,G=z+1;z<j;z++,V++,G++)V===j&&(V=0),G===j&&(G=0),W[z]=U(s[z],s[V],s[G]);X.push(W),Z=Z.concat(W)}for(O=0;O<y;O++){for(D=O/y,k=g*Math.cos(D*Math.PI/2),I=v*Math.sin(D*Math.PI/2),z=0,j=P.length;z<j;z++)K((N=L(P[z],$[z],I)).x,N.y,-k);for(l=0,c=R.length;l<c;l++)for(s=R[l],W=X[l],z=0,j=s.length;z<j;z++)K((N=L(s[z],W[z],I)).x,N.y,-k)}for(I=v,z=0;z<B;z++)N=b?L(C[z],Z[z],I):C[z],E?(o.copy(i.normals[0]).multiplyScalar(N.x),r.copy(i.binormals[0]).multiplyScalar(N.y),a.copy(t[0]).add(o).add(r),K(a.x,a.y,a.z)):K(N.x,N.y,0);for(q=1;q<=w;q++)for(z=0;z<B;z++)N=b?L(C[z],Z[z],I):C[z],E?(o.copy(i.normals[q]).multiplyScalar(N.x),r.copy(i.binormals[q]).multiplyScalar(N.y),a.copy(t[q]).add(o).add(r),K(a.x,a.y,a.z)):K(N.x,N.y,m/w*q);for(O=y-1;0<=O;O--){for(D=O/y,k=g*Math.cos(D*Math.PI/2),I=v*Math.sin(D*Math.PI/2),z=0,j=P.length;z<j;z++)K((N=L(P[z],$[z],I)).x,N.y,m+k);for(l=0,c=R.length;l<c;l++)for(s=R[l],W=X[l],z=0,j=s.length;z<j;z++)N=L(s[z],W[z],I),E?K(N.x,N.y+t[w-1].y,t[w-1].x+k):K(N.x,N.y,m+k)}function Y(e,t){var i,n;for(z=e.length;0<=--z;){(n=(i=z)-1)<0&&(n=e.length-1);var r=0,o=w+2*y;for(r=0;r<o;r++){var a=B*r,s=B*(r+1);Q(t+i+a,t+n+a,t+n+s,t+i+s,e,r,o,i,n)}}}function K(e,t,i){f.push(e),f.push(t),f.push(i)}function J(e,t,i){ee(e),ee(t),ee(i);var n=u.length/3,r=T.generateTopUV(M,u,n-3,n-2,n-1);te(r[0]),te(r[1]),te(r[2])}function Q(e,t,i,n,r,o,a,s,l){ee(e),ee(t),ee(n),ee(t),ee(i),ee(n);var c=u.length/3,h=T.generateSideWallUV(M,u,c-6,c-3,c-2,c-1);te(h[0]),te(h[1]),te(h[3]),te(h[1]),te(h[2]),te(h[3])}function ee(e){d.push(u.length/3),u.push(f[3*e+0]),u.push(f[3*e+1]),u.push(f[3*e+2])}function te(e){p.push(e.x),p.push(e.y)}!function(){var e=u.length/3;if(b){var t=0,i=B*t;for(z=0;z<F;z++)J((H=A[z])[2]+i,H[1]+i,H[0]+i);for(i=B*(t=w+2*y),z=0;z<F;z++)J((H=A[z])[0]+i,H[1]+i,H[2]+i)}else{for(z=0;z<F;z++)J((H=A[z])[2],H[1],H[0]);for(z=0;z<F;z++)J((H=A[z])[0]+B*w,H[1]+B*w,H[2]+B*w)}M.addGroup(e,u.length/3-e,void 0!==n.material?n.material:0)}(),function(){var e=u.length/3,t=0;for(Y(P,t),t+=P.length,l=0,c=R.length;l<c;l++)Y(s=R[l],t),t+=s.length;M.addGroup(e,u.length/3-e,void 0!==n.extrudeMaterial?n.extrudeMaterial:1)}(),n.arrays||(this.setIndex(d),this.addAttribute("position",new tr(u,3)),this.addAttribute("uv",new tr(n.arrays.uv,2)))},Wo.WorldUVGenerator={generateTopUV:function(e,t,i,n,r){var o=t[3*i],a=t[3*i+1],s=t[3*n],l=t[3*n+1],c=t[3*r],h=t[3*r+1];return[new xe(o,a),new xe(s,l),new xe(c,h)]},generateSideWallUV:function(e,t,i,n,r,o){var a=t[3*i],s=t[3*i+1],l=t[3*i+2],c=t[3*n],h=t[3*n+1],u=t[3*n+2],d=t[3*r],p=t[3*r+1],f=t[3*r+2],m=t[3*o],g=t[3*o+1],v=t[3*o+2];return Math.abs(s-h)<.01?[new xe(a,1-l),new xe(c,1-u),new xe(d,1-f),new xe(m,1-v)]:[new xe(s,1-l),new xe(h,1-u),new xe(p,1-f),new xe(g,1-v)]}},(Xo.prototype=Object.create(Wn.prototype)).constructor=Xo,(Zo.prototype=Object.create(qo.prototype)).constructor=Zo,(Yo.prototype=Object.create(Wn.prototype)).constructor=Yo,(Ko.prototype=Object.create(or.prototype)).constructor=Ko,(Jo.prototype=Object.create(Wn.prototype)).constructor=Jo,(Qo.prototype=Object.create(or.prototype)).constructor=Qo,(ea.prototype=Object.create(Wn.prototype)).constructor=ea,(ta.prototype=Object.create(or.prototype)).constructor=ta,(ia.prototype=Object.create(Wn.prototype)).constructor=ia,(na.prototype=Object.create(or.prototype)).constructor=na,(ra.prototype=Object.create(or.prototype)).constructor=ra,(oa.prototype=Object.create(Wn.prototype)).constructor=oa,(aa.prototype=Object.create(or.prototype)).constructor=aa,(sa.prototype=Object.create(oa.prototype)).constructor=sa,(la.prototype=Object.create(aa.prototype)).constructor=la,(ca.prototype=Object.create(Wn.prototype)).constructor=ca,(ha.prototype=Object.create(or.prototype)).constructor=ha;var ua=Object.freeze({WireframeGeometry:So,ParametricGeometry:Co,ParametricBufferGeometry:Ro,TetrahedronGeometry:Lo,TetrahedronBufferGeometry:Oo,OctahedronGeometry:Io,OctahedronBufferGeometry:Do,IcosahedronGeometry:ko,IcosahedronBufferGeometry:No,DodecahedronGeometry:Ho,DodecahedronBufferGeometry:Bo,PolyhedronGeometry:Ao,PolyhedronBufferGeometry:Po,TubeGeometry:Fo,TubeBufferGeometry:Uo,TorusKnotGeometry:$o,TorusKnotBufferGeometry:zo,TorusGeometry:jo,TorusBufferGeometry:Vo,TextGeometry:Xo,TextBufferGeometry:Zo,SphereGeometry:Yo,SphereBufferGeometry:Ko,RingGeometry:Jo,RingBufferGeometry:Qo,PlaneGeometry:lr,PlaneBufferGeometry:cr,LatheGeometry:ea,LatheBufferGeometry:ta,ShapeGeometry:ia,ShapeBufferGeometry:na,ExtrudeGeometry:Wo,ExtrudeBufferGeometry:qo,EdgesGeometry:ra,ConeGeometry:sa,ConeBufferGeometry:la,CylinderGeometry:oa,CylinderBufferGeometry:aa,CircleGeometry:ca,CircleBufferGeometry:ha,BoxGeometry:ar,BoxBufferGeometry:sr});function da(e){Mi.call(this,{uniforms:Jt.merge([Kt.lights,{opacity:{value:1}}]),vertexShader:Qt.shadow_vert,fragmentShader:Qt.shadow_frag}),this.lights=!0,this.transparent=!0,Object.defineProperties(this,{opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(e){this.uniforms.opacity.value=e}}}),this.setValues(e)}function pa(e){Mi.call(this,e),this.type="RawShaderMaterial"}function fa(e){Ti.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Xt(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function ma(e){fa.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(e)}function ga(e){Ti.call(this),this.type="MeshPhongMaterial",this.color=new Xt(16777215),this.specular=new Xt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=U,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function va(e){ga.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function ya(e){Ti.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function ba(e){Ti.call(this),this.type="MeshLambertMaterial",this.color=new Xt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=U,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function xa(e){Ti.call(this),this.type="LineDashedMaterial",this.color=new Xt(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.lights=!1,this.setValues(e)}((da.prototype=Object.create(Mi.prototype)).constructor=da).prototype.isShadowMaterial=!0,((pa.prototype=Object.create(Mi.prototype)).constructor=pa).prototype.isRawShaderMaterial=!0,((fa.prototype=Object.create(Ti.prototype)).constructor=fa).prototype.isMeshStandardMaterial=!0,fa.prototype.copy=function(e){return Ti.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((ma.prototype=Object.create(fa.prototype)).constructor=ma).prototype.isMeshPhysicalMaterial=!0,ma.prototype.copy=function(e){return fa.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},((ga.prototype=Object.create(Ti.prototype)).constructor=ga).prototype.isMeshPhongMaterial=!0,ga.prototype.copy=function(e){return Ti.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((va.prototype=Object.create(ga.prototype)).constructor=va).prototype.isMeshToonMaterial=!0,va.prototype.copy=function(e){return ga.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},((ya.prototype=Object.create(Ti.prototype)).constructor=ya).prototype.isMeshNormalMaterial=!0,ya.prototype.copy=function(e){return Ti.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((ba.prototype=Object.create(Ti.prototype)).constructor=ba).prototype.isMeshLambertMaterial=!0,ba.prototype.copy=function(e){return Ti.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((xa.prototype=Object.create(Ti.prototype)).constructor=xa).prototype.isLineDashedMaterial=!0,xa.prototype.copy=function(e){return Ti.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var wa=Object.freeze({ShadowMaterial:da,SpriteMaterial:lo,RawShaderMaterial:pa,ShaderMaterial:Mi,PointsMaterial:bo,MeshPhysicalMaterial:ma,MeshStandardMaterial:fa,MeshPhongMaterial:ga,MeshToonMaterial:va,MeshNormalMaterial:ya,MeshLambertMaterial:ba,MeshDepthMaterial:Si,MeshBasicMaterial:hr,LineDashedMaterial:xa,LineBasicMaterial:mo,Material:Ti}),_a={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function Ea(e,t,i){var n=this,r=!1,o=0,a=0;this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(e){a++,!1===r&&void 0!==n.onStart&&n.onStart(e,o,a),r=!0},this.itemEnd=function(e){o++,void 0!==n.onProgress&&n.onProgress(e,o,a),o===a&&(r=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(e){void 0!==n.onError&&n.onError(e)}}var Ta=new Ea;function Ma(e){this.manager=void 0!==e?e:Ta}function Sa(e){this.manager=void 0!==e?e:Ta,this._parser=null}function Ca(e){this.manager=void 0!==e?e:Ta,this._parser=null}function Ra(e){this.manager=void 0!==e?e:Ta}function Aa(e){this.manager=void 0!==e?e:Ta}function Pa(e){this.manager=void 0!==e?e:Ta}function La(e,t){en.call(this),this.type="Light",this.color=new Xt(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function Oa(e,t,i){La.call(this,e,i),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(en.DefaultUp),this.updateMatrix(),this.groundColor=new Xt(t)}function Ia(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new xe(512,512),this.map=null,this.matrix=new ot}function Da(){Ia.call(this,new rn(50,1,.5,500))}function ka(e,t,i,n,r,o){La.call(this,e,t),this.type="SpotLight",this.position.copy(en.DefaultUp),this.updateMatrix(),this.target=new en,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==i?i:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==o?o:1,this.shadow=new Da}function Na(e,t,i,n){La.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==i?i:0,this.decay=void 0!==n?n:1,this.shadow=new Ia(new rn(90,1,.5,500))}function Ha(){Ia.call(this,new nn(-5,5,5,-5,.5,500))}function Ba(e,t){La.call(this,e,t),this.type="DirectionalLight",this.position.copy(en.DefaultUp),this.updateMatrix(),this.target=new en,this.shadow=new Ha}function Fa(e,t){La.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function Ua(e,t,i,n){La.call(this,e,t),this.type="RectAreaLight",this.position.set(0,1,0),this.updateMatrix(),this.width=void 0!==i?i:10,this.height=void 0!==n?n:10}Object.assign(Ma.prototype,{load:function(i,n,t,r){void 0===i&&(i=""),void 0!==this.path&&(i=this.path+i);var o=this,e=_a.get(i);if(void 0!==e)return o.manager.itemStart(i),setTimeout(function(){n&&n(e),o.manager.itemEnd(i)},0),e;var a=i.match(/^data:(.*?)(;base64)?,(.*)$/);if(a){var s=a[1],l=!!a[2],c=a[3];c=window.decodeURIComponent(c),l&&(c=window.atob(c));try{var h,u=(this.responseType||"").toLowerCase();switch(u){case"arraybuffer":case"blob":h=new ArrayBuffer(c.length);for(var d=new Uint8Array(h),p=0;p<c.length;p++)d[p]=c.charCodeAt(p);"blob"===u&&(h=new Blob([h],{type:s}));break;case"document":var f=new DOMParser;h=f.parseFromString(c,s);break;case"json":h=JSON.parse(c);break;default:h=c}window.setTimeout(function(){n&&n(h),o.manager.itemEnd(i)},0)}catch(e){window.setTimeout(function(){r&&r(e),o.manager.itemEnd(i),o.manager.itemError(i)},0)}}else{var m=new XMLHttpRequest;for(var g in m.open("GET",i,!0),m.addEventListener("load",function(e){var t=e.target.response;_a.add(i,t),200===this.status?(n&&n(t),o.manager.itemEnd(i)):0===this.status?(console.warn("THREE.FileLoader: HTTP Status 0 received."),n&&n(t),o.manager.itemEnd(i)):(r&&r(e),o.manager.itemEnd(i),o.manager.itemError(i))},!1),void 0!==t&&m.addEventListener("progress",function(e){t(e)},!1),m.addEventListener("error",function(e){r&&r(e),o.manager.itemEnd(i),o.manager.itemError(i)},!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(g,this.requestHeader[g]);m.send(null)}return o.manager.itemStart(i),m},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Object.assign(Sa.prototype,{load:function(e,o,t,n){var a=this,s=[],l=new Eo;l.image=s;var r=new Ma(this.manager);function i(i){r.load(e[i],function(e){var t=a._parser(e,!0);s[i]={width:t.width,height:t.height,format:t.format,mipmaps:t.mipmaps},6===(c+=1)&&(1===t.mipmapCount&&(l.minFilter=Ue),l.format=t.format,l.needsUpdate=!0,o&&o(l))},t,n)}if(r.setPath(this.path),r.setResponseType("arraybuffer"),Array.isArray(e))for(var c=0,h=0,u=e.length;h<u;++h)i(h);else r.load(e,function(e){var t=a._parser(e,!0);if(t.isCubemap)for(var i=t.mipmaps.length/t.mipmapCount,n=0;n<i;n++){s[n]={mipmaps:[]};for(var r=0;r<t.mipmapCount;r++)s[n].mipmaps.push(t.mipmaps[n*t.mipmapCount+r]),s[n].format=t.format,s[n].width=t.width,s[n].height=t.height}else l.image.width=t.width,l.image.height=t.height,l.mipmaps=t.mipmaps;1===t.mipmapCount&&(l.minFilter=Ue),l.format=t.format,l.needsUpdate=!0,o&&o(l)},t,n);return l},setPath:function(e){return this.path=e,this}}),Object.assign(Ca.prototype,{load:function(e,i,t,n){var r=this,o=new at,a=new Ma(this.manager);return a.setResponseType("arraybuffer"),a.load(e,function(e){var t=r._parser(e);t&&(void 0!==t.image?o.image=t.image:void 0!==t.data&&(o.image.width=t.width,o.image.height=t.height,o.image.data=t.data),o.wrapS=void 0!==t.wrapS?t.wrapS:ke,o.wrapT=void 0!==t.wrapT?t.wrapT:ke,o.magFilter=void 0!==t.magFilter?t.magFilter:Ue,o.minFilter=void 0!==t.minFilter?t.minFilter:$e,o.anisotropy=void 0!==t.anisotropy?t.anisotropy:1,void 0!==t.format&&(o.format=t.format),void 0!==t.type&&(o.type=t.type),void 0!==t.mipmaps&&(o.mipmaps=t.mipmaps),1===t.mipmapCount&&(o.minFilter=Ue),o.needsUpdate=!0,i&&i(o,t))},t,n),o}}),Object.assign(Ra.prototype,{load:function(t,e,i,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t);var r=this,o=_a.get(t);if(void 0!==o)return r.manager.itemStart(t),setTimeout(function(){e&&e(o),r.manager.itemEnd(t)},0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");return a.addEventListener("load",function(){_a.add(t,this),e&&e(this),r.manager.itemEnd(t)},!1),a.addEventListener("error",function(e){n&&n(e),r.manager.itemEnd(t),r.manager.itemError(t)},!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),r.manager.itemStart(t),a.src=t,a},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Aa.prototype,{load:function(e,i,t,n){var r=new st,o=new Ra(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;function s(t){o.load(e[t],function(e){r.images[t]=e,6===++a&&(r.needsUpdate=!0,i&&i(r))},void 0,n)}for(var l=0;l<e.length;++l)s(l);return r},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Pa.prototype,{load:function(t,i,e,n){var r=new Ra(this.manager);r.setCrossOrigin(this.crossOrigin),r.setPath(this.path);var o=new Ce;return o.image=r.load(t,function(){var e=0<t.search(/\.(jpg|jpeg)$/)||0===t.search(/^data\:image\/jpeg/);o.format=e?Xe:Ze,o.needsUpdate=!0,void 0!==i&&i(o)},e,n),o},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),La.prototype=Object.assign(Object.create(en.prototype),{constructor:La,isLight:!0,copy:function(e){return en.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=en.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),Oa.prototype=Object.assign(Object.create(La.prototype),{constructor:Oa,isHemisphereLight:!0,copy:function(e){return La.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(Ia.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),Da.prototype=Object.assign(Object.create(Ia.prototype),{constructor:Da,isSpotLightShadow:!0,update:function(e){var t=this.camera,i=2*Qe.RAD2DEG*e.angle,n=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;i===t.fov&&n===t.aspect&&r===t.far||(t.fov=i,t.aspect=n,t.far=r,t.updateProjectionMatrix())}}),ka.prototype=Object.assign(Object.create(La.prototype),{constructor:ka,isSpotLight:!0,copy:function(e){return La.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Na.prototype=Object.assign(Object.create(La.prototype),{constructor:Na,isPointLight:!0,copy:function(e){return La.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),Ha.prototype=Object.assign(Object.create(Ia.prototype),{constructor:Ha}),Ba.prototype=Object.assign(Object.create(La.prototype),{constructor:Ba,isDirectionalLight:!0,copy:function(e){return La.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Fa.prototype=Object.assign(Object.create(La.prototype),{constructor:Fa,isAmbientLight:!0}),Ua.prototype=Object.assign(Object.create(La.prototype),{constructor:Ua,isRectAreaLight:!0,copy:function(e){return La.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=La.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}});var $a,za={arraySlice:function(e,t,i){return za.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==i?i:e.length)):e.slice(t,i)},convertArray:function(e,t,i){return!e||!i&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(i){for(var e=i.length,t=new Array(e),n=0;n!==e;++n)t[n]=n;return t.sort(function(e,t){return i[e]-i[t]}),t},sortedArray:function(e,t,i){for(var n=e.length,r=new e.constructor(n),o=0,a=0;a!==n;++o)for(var s=i[o]*t,l=0;l!==t;++l)r[a++]=e[s+l];return r},flattenJSON:function(e,t,i,n){for(var r=1,o=e[0];void 0!==o&&void 0===o[n];)o=e[r++];if(void 0!==o){var a=o[n];if(void 0!==a)if(Array.isArray(a))for(;void 0!==(a=o[n])&&(t.push(o.time),i.push.apply(i,a)),void 0!==(o=e[r++]););else if(void 0!==a.toArray)for(;void 0!==(a=o[n])&&(t.push(o.time),a.toArray(i,i.length)),void 0!==(o=e[r++]););else for(;void 0!==(a=o[n])&&(t.push(o.time),i.push(a)),void 0!==(o=e[r++]););}}};function ja(e,t,i,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new t.constructor(i),this.sampleValues=t,this.valueSize=i}function Va(e,t,i,n){ja.call(this,e,t,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Ga(e,t,i,n){ja.call(this,e,t,i,n)}function Wa(e,t,i,n){ja.call(this,e,t,i,n)}function qa(e,t,i,n){if(void 0===e)throw new Error("track name is undefined");if(void 0===t||0===t.length)throw new Error("no keyframes in track named "+e);this.name=e,this.times=za.convertArray(t,this.TimeBufferType),this.values=za.convertArray(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation),this.validate(),this.optimize()}function Xa(e,t,i,n){qa.call(this,e,t,i,n)}function Za(e,t,i,n){ja.call(this,e,t,i,n)}function Ya(e,t,i,n){qa.call(this,e,t,i,n)}function Ka(e,t,i,n){qa.call(this,e,t,i,n)}function Ja(e,t,i,n){qa.call(this,e,t,i,n)}function Qa(e,t,i){qa.call(this,e,t,i)}function es(e,t,i,n){qa.call(this,e,t,i,n)}function ts(e,t,i,n){qa.apply(this,arguments)}function is(e,t,i){this.name=e,this.tracks=i,this.duration=void 0!==t?t:-1,this.uuid=Qe.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}function ns(e){this.manager=void 0!==e?e:Ta,this.textures={}}function rs(e){this.manager=void 0!==e?e:Ta}Object.assign(ja.prototype,{evaluate:function(e){var t=this.parameterPositions,i=this._cachedIndex,n=t[i],r=t[i-1];e:{t:{var o;i:{n:if(!(e<n)){for(var a=i+2;;){if(void 0===n){if(e<r)break n;return i=t.length,this._cachedIndex=i,this.afterEnd_(i-1,e,r)}if(i===a)break;if(r=n,e<(n=t[++i]))break t}o=t.length;break i}if(r<=e)break e;var s=t[1];e<s&&(i=2,r=s);for(a=i-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,e,n);if(i===a)break;if(n=r,(r=t[--i-1])<=e)break t}o=i,i=0}for(;i<o;){var l=i+o>>>1;e<t[l]?o=l:i=l+1}if(n=t[i],void 0===(r=t[i-1]))return this._cachedIndex=0,this.beforeStart_(0,e,n);if(void 0===n)return i=t.length,this._cachedIndex=i,this.afterEnd_(i-1,r,e)}this._cachedIndex=i,this.intervalChanged_(i,r,n)}return this.interpolate_(i,r,e,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=e*n,o=0;o!==n;++o)t[o]=i[r+o];return t},interpolate_:function(e,t,i,n){throw new Error("call to abstract method")},intervalChanged_:function(e,t,i){}}),Object.assign(ja.prototype,{beforeStart_:ja.prototype.copySampleValue_,afterEnd_:ja.prototype.copySampleValue_}),Va.prototype=Object.assign(Object.create(ja.prototype),{constructor:Va,DefaultSettings_:{endingStart:d,endingEnd:d},intervalChanged_:function(e,t,i){var n=this.parameterPositions,r=e-2,o=e+1,a=n[r],s=n[o];if(void 0===a)switch(this.getSettings_().endingStart){case p:r=e,a=2*t-i;break;case f:a=t+n[r=n.length-2]-n[r+1];break;default:r=e,a=i}if(void 0===s)switch(this.getSettings_().endingEnd){case p:o=e,s=2*i-t;break;case f:s=i+n[o=1]-n[0];break;default:o=e-1,s=t}var l=.5*(i-t),c=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(s-i),this._offsetPrev=r*c,this._offsetNext=o*c},interpolate_:function(e,t,i,n){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,l=s-a,c=this._offsetPrev,h=this._offsetNext,u=this._weightPrev,d=this._weightNext,p=(i-t)/(n-t),f=p*p,m=f*p,g=-u*m+2*u*f-u*p,v=(1+u)*m+(-1.5-2*u)*f+(-.5+u)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,b=d*m-d*f,x=0;x!==a;++x)r[x]=g*o[c+x]+v*o[l+x]+y*o[s+x]+b*o[h+x];return r}}),Ga.prototype=Object.assign(Object.create(ja.prototype),{constructor:Ga,interpolate_:function(e,t,i,n){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,l=s-a,c=(i-t)/(n-t),h=1-c,u=0;u!==a;++u)r[u]=o[l+u]*h+o[s+u]*c;return r}}),Wa.prototype=Object.assign(Object.create(ja.prototype),{constructor:Wa,interpolate_:function(e,t,i,n){return this.copySampleValue_(e-1)}}),$a={TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:u,InterpolantFactoryMethodDiscrete:function(e){return new Wa(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Ga(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Va(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case h:t=this.InterpolantFactoryMethodDiscrete;break;case u:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0!==t)this.createInterpolant=t;else{var i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrackPrototype:",i)}},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return h;case this.InterpolantFactoryMethodLinear:return u;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,i=0,n=t.length;i!==n;++i)t[i]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,i=0,n=t.length;i!==n;++i)t[i]*=e;return this},trim:function(e,t){for(var i=this.times,n=i.length,r=0,o=n-1;r!==n&&i[r]<e;)++r;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==r||o!==n){o<=r&&(r=(o=Math.max(o,1))-1);var a=this.getValueSize();this.times=za.arraySlice(i,r,o),this.values=za.arraySlice(this.values,r*a,o*a)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrackPrototype: Invalid value size in track.",this),e=!1);var i=this.times,n=this.values,r=i.length;0===r&&(console.error("THREE.KeyframeTrackPrototype: Track is empty.",this),e=!1);for(var o=null,a=0;a!==r;a++){var s=i[a];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrackPrototype: Time is not a valid number.",this,a,s),e=!1;break}if(null!==o&&s<o){console.error("THREE.KeyframeTrackPrototype: Out of order keys.",this,a,s,o),e=!1;break}o=s}if(void 0!==n&&za.isTypedArray(n)){a=0;for(var l=n.length;a!==l;++a){var c=n[a];if(isNaN(c)){console.error("THREE.KeyframeTrackPrototype: Value is not a valid number.",this,a,c),e=!1;break}}}return e},optimize:function(){for(var e=this.times,t=this.values,i=this.getValueSize(),n=2302===this.getInterpolation(),r=1,o=e.length-1,a=1;a<o;++a){var s=!1,l=e[a];if(l!==e[a+1]&&(1!==a||l!==l[0]))if(n)s=!0;else for(var c=a*i,h=c-i,u=c+i,d=0;d!==i;++d){var p=t[c+d];if(p!==t[h+d]||p!==t[u+d]){s=!0;break}}if(s){if(a!==r){e[r]=e[a];var f=a*i,m=r*i;for(d=0;d!==i;++d)t[m+d]=t[f+d]}++r}}if(0<o){e[r]=e[o];for(f=o*i,m=r*i,d=0;d!==i;++d)t[m+d]=t[f+d];++r}return r!==e.length&&(this.times=za.arraySlice(e,0,r),this.values=za.arraySlice(t,0,r*i)),this}},Xa.prototype=Object.assign(Object.create($a),{constructor:Xa,ValueTypeName:"vector"}),Za.prototype=Object.assign(Object.create(ja.prototype),{constructor:Za,interpolate_:function(e,t,i,n){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,l=(i-t)/(n-t),c=s+a;s!==c;s+=4)nt.slerpFlat(r,0,o,s-a,o,s,l);return r}}),Ya.prototype=Object.assign(Object.create($a),{constructor:Ya,ValueTypeName:"quaternion",DefaultInterpolation:u,InterpolantFactoryMethodLinear:function(e){return new Za(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),Ka.prototype=Object.assign(Object.create($a),{constructor:Ka,ValueTypeName:"number"}),Ja.prototype=Object.assign(Object.create($a),{constructor:Ja,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:h,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Qa.prototype=Object.assign(Object.create($a),{constructor:Qa,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:h,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),es.prototype=Object.assign(Object.create($a),{constructor:es,ValueTypeName:"color"}),(ts.prototype=$a).constructor=ts,Object.assign(ts,{parse:function(e){if(void 0===e.type)throw new Error("track type undefined, can not parse");var t=ts._getTrackTypeForValueTypeName(e.type);if(void 0===e.times){var i=[],n=[];za.flattenJSON(e.keys,i,n,"value"),e.times=i,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)},toJSON:function(e){var t,i=e.constructor;if(void 0!==i.toJSON)t=i.toJSON(e);else{t={name:e.name,times:za.convertArray(e.times,Array),values:za.convertArray(e.values,Array)};var n=e.getInterpolation();n!==e.DefaultInterpolation&&(t.interpolation=n)}return t.type=e.ValueTypeName,t},_getTrackTypeForValueTypeName:function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ka;case"vector":case"vector2":case"vector3":case"vector4":return Xa;case"color":return es;case"quaternion":return Ya;case"bool":case"boolean":return Qa;case"string":return Ja}throw new Error("Unsupported typeName: "+e)}}),Object.assign(is,{parse:function(e){for(var t=[],i=e.tracks,n=1/(e.fps||1),r=0,o=i.length;r!==o;++r)t.push(ts.parse(i[r]).scale(n));return new is(e.name,e.duration,t)},toJSON:function(e){for(var t=[],i=e.tracks,n={name:e.name,duration:e.duration,tracks:t},r=0,o=i.length;r!==o;++r)t.push(ts.toJSON(i[r]));return n},CreateFromMorphTargetSequence:function(e,t,i,n){for(var r=t.length,o=[],a=0;a<r;a++){var s=[],l=[];s.push((a+r-1)%r,a,(a+1)%r),l.push(0,1,0);var c=za.getKeyframeOrder(s);s=za.sortedArray(s,1,c),l=za.sortedArray(l,1,c),n||0!==s[0]||(s.push(r),l.push(l[0])),o.push(new Ka(".morphTargetInfluences["+t[a].name+"]",s,l).scale(1/i))}return new is(e,-1,o)},findByName:function(e,t){var i=e;if(!Array.isArray(e)){var n=e;i=n.geometry&&n.geometry.animations||n.animations}for(var r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null},CreateClipsFromMorphTargetSequences:function(e,t,i){for(var n={},r=/^([\w-]*?)([\d]+)$/,o=0,a=e.length;o<a;o++){var s=e[o],l=s.name.match(r);if(l&&1<l.length){var c=n[u=l[1]];c||(n[u]=c=[]),c.push(s)}}var h=[];for(var u in n)h.push(is.CreateFromMorphTargetSequence(u,n[u],t,i));return h},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var i=function(e,t,i,n,r){if(0!==i.length){var o=[],a=[];za.flattenJSON(i,o,a,n),0!==o.length&&r.push(new e(t,o,a))}},n=[],r=e.name||"default",o=e.length||-1,a=e.fps||30,s=e.hierarchy||[],l=0;l<s.length;l++){var c=s[l].keys;if(c&&0!==c.length)if(c[0].morphTargets){for(var h={},u=0;u<c.length;u++)if(c[u].morphTargets)for(var d=0;d<c[u].morphTargets.length;d++)h[c[u].morphTargets[d]]=-1;for(var p in h){var f=[],m=[];for(d=0;d!==c[u].morphTargets.length;++d){var g=c[u];f.push(g.time),m.push(g.morphTarget===p?1:0)}n.push(new Ka(".morphTargetInfluence["+p+"]",f,m))}o=h.length*(a||1)}else{var v=".bones["+t[l].name+"]";i(Xa,v+".position",c,"pos",n),i(Ya,v+".quaternion",c,"rot",n),i(Xa,v+".scale",c,"scl",n)}}return 0===n.length?null:new is(r,o,n)}}),Object.assign(is.prototype,{resetDuration:function(){for(var e=0,t=0,i=this.tracks.length;t!==i;++t){var n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}this.duration=e},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}}),Object.assign(ns.prototype,{load:function(e,t,i,n){var r=this;new Ma(r.manager).load(e,function(e){t(r.parse(JSON.parse(e)))},i,n)},setTextures:function(e){this.textures=e},parse:function(e){var t=this.textures;function i(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var n=new wa[e.type];if(void 0!==e.uuid&&(n.uuid=e.uuid),void 0!==e.name&&(n.name=e.name),void 0!==e.color&&n.color.setHex(e.color),void 0!==e.roughness&&(n.roughness=e.roughness),void 0!==e.metalness&&(n.metalness=e.metalness),void 0!==e.emissive&&n.emissive.setHex(e.emissive),void 0!==e.specular&&n.specular.setHex(e.specular),void 0!==e.shininess&&(n.shininess=e.shininess),void 0!==e.clearCoat&&(n.clearCoat=e.clearCoat),void 0!==e.clearCoatRoughness&&(n.clearCoatRoughness=e.clearCoatRoughness),void 0!==e.uniforms&&(n.uniforms=e.uniforms),void 0!==e.vertexShader&&(n.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(n.fragmentShader=e.fragmentShader),void 0!==e.vertexColors&&(n.vertexColors=e.vertexColors),void 0!==e.fog&&(n.fog=e.fog),void 0!==e.shading&&(n.shading=e.shading),void 0!==e.blending&&(n.blending=e.blending),void 0!==e.side&&(n.side=e.side),void 0!==e.opacity&&(n.opacity=e.opacity),void 0!==e.transparent&&(n.transparent=e.transparent),void 0!==e.alphaTest&&(n.alphaTest=e.alphaTest),void 0!==e.depthTest&&(n.depthTest=e.depthTest),void 0!==e.depthWrite&&(n.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(n.colorWrite=e.colorWrite),void 0!==e.wireframe&&(n.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(n.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(n.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(n.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.skinning&&(n.skinning=e.skinning),void 0!==e.morphTargets&&(n.morphTargets=e.morphTargets),void 0!==e.size&&(n.size=e.size),void 0!==e.sizeAttenuation&&(n.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(n.map=i(e.map)),void 0!==e.alphaMap&&(n.alphaMap=i(e.alphaMap),n.transparent=!0),void 0!==e.bumpMap&&(n.bumpMap=i(e.bumpMap)),void 0!==e.bumpScale&&(n.bumpScale=e.bumpScale),void 0!==e.normalMap&&(n.normalMap=i(e.normalMap)),void 0!==e.normalScale){var r=e.normalScale;!1===Array.isArray(r)&&(r=[r,r]),n.normalScale=(new xe).fromArray(r)}return void 0!==e.displacementMap&&(n.displacementMap=i(e.displacementMap)),void 0!==e.displacementScale&&(n.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(n.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(n.roughnessMap=i(e.roughnessMap)),void 0!==e.metalnessMap&&(n.metalnessMap=i(e.metalnessMap)),void 0!==e.emissiveMap&&(n.emissiveMap=i(e.emissiveMap)),void 0!==e.emissiveIntensity&&(n.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(n.specularMap=i(e.specularMap)),void 0!==e.envMap&&(n.envMap=i(e.envMap)),void 0!==e.reflectivity&&(n.reflectivity=e.reflectivity),void 0!==e.lightMap&&(n.lightMap=i(e.lightMap)),void 0!==e.lightMapIntensity&&(n.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(n.aoMap=i(e.aoMap)),void 0!==e.aoMapIntensity&&(n.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(n.gradientMap=i(e.gradientMap)),n}}),Object.assign(rs.prototype,{load:function(e,t,i,n){var r=this;new Ma(r.manager).load(e,function(e){t(r.parse(JSON.parse(e)))},i,n)},parse:function(e){var t=new or,i=e.data.index;if(void 0!==i){var n=new hs[i.type](i.array);t.setIndex(new qn(n,1))}var r=e.data.attributes;for(var o in r){var a=r[o];n=new hs[a.type](a.array);t.addAttribute(o,new qn(n,a.itemSize,a.normalized))}var s=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==s)for(var l=0,c=s.length;l!==c;++l){var h=s[l];t.addGroup(h.start,h.count,h.materialIndex)}var u=e.data.boundingSphere;if(void 0!==u){var d=new rt;void 0!==u.center&&d.fromArray(u.center),t.boundingSphere=new Ri(d,u.radius)}return t}});var os,as,ss,ls,cs,hs={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function us(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}function ds(e){"boolean"==typeof e&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=void 0!==e?e:Ta,this.withCredentials=!1}function ps(e){this.manager=void 0!==e?e:Ta,this.texturePath=""}us.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=this.handlers,i=0,n=t.length;i<n;i+=2){var r=t[i],o=t[i+1];if(r.test(e))return o}return null}},Object.assign(us.prototype,{crossOrigin:void 0,extractUrlBase:function(e){var t=e.split("/");return 1===t.length?"./":(t.pop(),t.join("/")+"/")},initMaterials:function(e,t,i){for(var n=[],r=0;r<e.length;++r)n[r]=this.createMaterial(e[r],t,i);return n},createMaterial:(os={NoBlending:G,NormalBlending:W,AdditiveBlending:q,SubtractiveBlending:X,MultiplyBlending:K,CustomBlending:J},as=new Xt,ss=new Pa,ls=new ns,function(e,c,h){var u={};function t(e,t,i,n,r){var o,a=c+e,s=us.Handlers.get(a);o=null!==s?s.load(a):(ss.setCrossOrigin(h),ss.load(a)),void 0!==t&&(o.repeat.fromArray(t),1!==t[0]&&(o.wrapS=De),1!==t[1]&&(o.wrapT=De)),void 0!==i&&o.offset.fromArray(i),void 0!==n&&("repeat"===n[0]&&(o.wrapS=De),"mirror"===n[0]&&(o.wrapS=Ne),"repeat"===n[1]&&(o.wrapT=De),"mirror"===n[1]&&(o.wrapT=Ne)),void 0!==r&&(o.anisotropy=r);var l=Qe.generateUUID();return u[l]=o,l}var i={uuid:Qe.generateUUID(),type:"MeshLambertMaterial"};for(var n in e){var r=e[n];switch(n){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":i.name=r;break;case"blending":i.blending=os[r];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",n,"is no longer supported.");break;case"colorDiffuse":i.color=as.fromArray(r).getHex();break;case"colorSpecular":i.specular=as.fromArray(r).getHex();break;case"colorEmissive":i.emissive=as.fromArray(r).getHex();break;case"specularCoef":i.shininess=r;break;case"shading":"basic"===r.toLowerCase()&&(i.type="MeshBasicMaterial"),"phong"===r.toLowerCase()&&(i.type="MeshPhongMaterial"),"standard"===r.toLowerCase()&&(i.type="MeshStandardMaterial");break;case"mapDiffuse":i.map=t(r,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":i.emissiveMap=t(r,e.mapEmissiveRepeat,e.mapEmissiveOffset,e.mapEmissiveWrap,e.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":i.lightMap=t(r,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":i.aoMap=t(r,e.mapAORepeat,e.mapAOOffset,e.mapAOWrap,e.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":i.bumpMap=t(r,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy);break;case"mapBumpScale":i.bumpScale=r;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":i.normalMap=t(r,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy);break;case"mapNormalFactor":i.normalScale=[r,r];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":i.specularMap=t(r,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":i.metalnessMap=t(r,e.mapMetalnessRepeat,e.mapMetalnessOffset,e.mapMetalnessWrap,e.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":i.roughnessMap=t(r,e.mapRoughnessRepeat,e.mapRoughnessOffset,e.mapRoughnessWrap,e.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":i.alphaMap=t(r,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":i.side=Z;break;case"doubleSided":i.side=Y;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),i.opacity=r;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":i[n]=r;break;case"vertexColors":!0===r&&(i.vertexColors=2),"face"===r&&(i.vertexColors=1);break;default:console.error("THREE.Loader.createMaterial: Unsupported",n,r)}}return"MeshBasicMaterial"===i.type&&delete i.emissive,"MeshPhongMaterial"!==i.type&&delete i.specular,i.opacity<1&&(i.transparent=!0),ls.setTextures(u),ls.parse(i)})}),Object.assign(ds.prototype,{load:function(o,a,e,t){var s=this,l=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:us.prototype.extractUrlBase(o),i=new Ma(this.manager);i.setWithCredentials(this.withCredentials),i.load(o,function(e){var t=JSON.parse(e),i=t.metadata;if(void 0!==i){var n=i.type;if(void 0!==n){if("object"===n.toLowerCase())return void console.error("THREE.JSONLoader: "+o+" should be loaded with THREE.ObjectLoader instead.");if("scene"===n.toLowerCase())return void console.error("THREE.JSONLoader: "+o+" should be loaded with THREE.SceneLoader instead.")}}var r=s.parse(t,l);a(r.geometry,r.materials)},e,t)},setTexturePath:function(e){this.texturePath=e},parse:function(e,t){void 0!==e.data&&(e=e.data),void 0!==e.scale?e.scale=1/e.scale:e.scale=1;var i=new Wn;return function(e,t){function i(e,t){return e&1<<t}var n,r,o,a,s,l,c,h,u,d,p,f,m,g,v,y,b,x,w,_,E,T,M,S,C,R=e.faces,A=e.vertices,P=e.normals,L=e.colors,O=e.scale,I=0;if(void 0!==e.uvs){for(n=0;n<e.uvs.length;n++)e.uvs[n].length&&I++;for(n=0;n<I;n++)t.faceVertexUvs[n]=[]}for(a=0,s=A.length;a<s;)(x=new rt).x=A[a++]*O,x.y=A[a++]*O,x.z=A[a++]*O,t.vertices.push(x);for(a=0,s=R.length;a<s;)if(p=i(d=R[a++],0),f=i(d,1),m=i(d,3),g=i(d,4),v=i(d,5),y=i(d,6),b=i(d,7),p){if((_=new on).a=R[a],_.b=R[a+1],_.c=R[a+3],(E=new on).a=R[a+1],E.b=R[a+2],E.c=R[a+3],a+=4,f&&(u=R[a++],_.materialIndex=u,E.materialIndex=u),o=t.faces.length,m)for(n=0;n<I;n++)for(S=e.uvs[n],t.faceVertexUvs[n][o]=[],t.faceVertexUvs[n][o+1]=[],r=0;r<4;r++)C=new xe(S[2*(h=R[a++])],S[2*h+1]),2!==r&&t.faceVertexUvs[n][o].push(C),0!==r&&t.faceVertexUvs[n][o+1].push(C);if(g&&(c=3*R[a++],_.normal.set(P[c++],P[c++],P[c]),E.normal.copy(_.normal)),v)for(n=0;n<4;n++)c=3*R[a++],M=new rt(P[c++],P[c++],P[c]),2!==n&&_.vertexNormals.push(M),0!==n&&E.vertexNormals.push(M);if(y&&(T=L[l=R[a++]],_.color.setHex(T),E.color.setHex(T)),b)for(n=0;n<4;n++)T=L[l=R[a++]],2!==n&&_.vertexColors.push(new Xt(T)),0!==n&&E.vertexColors.push(new Xt(T));t.faces.push(_),t.faces.push(E)}else{if((w=new on).a=R[a++],w.b=R[a++],w.c=R[a++],f&&(u=R[a++],w.materialIndex=u),o=t.faces.length,m)for(n=0;n<I;n++)for(S=e.uvs[n],t.faceVertexUvs[n][o]=[],r=0;r<3;r++)C=new xe(S[2*(h=R[a++])],S[2*h+1]),t.faceVertexUvs[n][o].push(C);if(g&&(c=3*R[a++],w.normal.set(P[c++],P[c++],P[c])),v)for(n=0;n<3;n++)c=3*R[a++],M=new rt(P[c++],P[c++],P[c]),w.vertexNormals.push(M);if(y&&(l=R[a++],w.color.setHex(L[l])),b)for(n=0;n<3;n++)l=R[a++],w.vertexColors.push(new Xt(L[l]));t.faces.push(w)}}(e,i),function(e,t){var i=void 0!==e.influencesPerVertex?e.influencesPerVertex:2;if(e.skinWeights)for(var n=0,r=e.skinWeights.length;n<r;n+=i){var o=e.skinWeights[n],a=1<i?e.skinWeights[n+1]:0,s=2<i?e.skinWeights[n+2]:0,l=3<i?e.skinWeights[n+3]:0;t.skinWeights.push(new et(o,a,s,l))}if(e.skinIndices)for(n=0,r=e.skinIndices.length;n<r;n+=i){var c=e.skinIndices[n],h=1<i?e.skinIndices[n+1]:0,u=2<i?e.skinIndices[n+2]:0,d=3<i?e.skinIndices[n+3]:0;t.skinIndices.push(new et(c,h,u,d))}t.bones=e.bones,t.bones&&0<t.bones.length&&(t.skinWeights.length!==t.skinIndices.length||t.skinIndices.length!==t.vertices.length)&&console.warn("When skinning, number of vertices ("+t.vertices.length+"), skinIndices ("+t.skinIndices.length+"), and skinWeights ("+t.skinWeights.length+") should match.")}(e,i),function(e,t){var i=e.scale;if(void 0!==e.morphTargets)for(var n=0,r=e.morphTargets.length;n<r;n++){t.morphTargets[n]={},t.morphTargets[n].name=e.morphTargets[n].name,t.morphTargets[n].vertices=[];for(var o=t.morphTargets[n].vertices,a=e.morphTargets[n].vertices,s=0,l=a.length;s<l;s+=3){var c=new rt;c.x=a[s]*i,c.y=a[s+1]*i,c.z=a[s+2]*i,o.push(c)}}if(void 0!==e.morphColors&&0<e.morphColors.length){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');var h=t.faces,u=e.morphColors[0].colors;for(n=0,r=h.length;n<r;n++)h[n].color.fromArray(u,3*n)}}(e,i),function(e,t){var i=[],n=[];void 0!==e.animation&&n.push(e.animation),void 0!==e.animations&&(e.animations.length?n=n.concat(e.animations):n.push(e.animations));for(var r=0;r<n.length;r++){var o=is.parseAnimation(n[r],t.bones);o&&i.push(o)}if(t.morphTargets){var a=is.CreateClipsFromMorphTargetSequences(t.morphTargets,10);i=i.concat(a)}0<i.length&&(t.animations=i)}(e,i),i.computeFaceNormals(),i.computeBoundingSphere(),void 0===e.materials||0===e.materials.length?{geometry:i}:{geometry:i,materials:us.prototype.initMaterials(e.materials,t,this.crossOrigin)}}}),Object.assign(ps.prototype,{load:function(n,r,e,o){""===this.texturePath&&(this.texturePath=n.substring(0,n.lastIndexOf("/")+1));var a=this;new Ma(a.manager).load(n,function(e){var t=null;try{t=JSON.parse(e)}catch(e){return void 0!==o&&o(e),void console.error("THREE:ObjectLoader: Can't parse "+n+".",e.message)}var i=t.metadata;void 0!==i&&void 0!==i.type&&"geometry"!==i.type.toLowerCase()?a.parse(t,r):console.error("THREE.ObjectLoader: Can't load "+n+". Use THREE.JSONLoader instead.")},e,o)},setTexturePath:function(e){this.texturePath=e},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e,t){var i=this.parseGeometries(e.geometries),n=this.parseImages(e.images,function(){void 0!==t&&t(a)}),r=this.parseTextures(e.textures,n),o=this.parseMaterials(e.materials,r),a=this.parseObject(e.object,i,o);return e.animations&&(a.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(a),a},parseGeometries:function(e){var t={};if(void 0!==e)for(var i=new ds,n=new rs,r=0,o=e.length;r<o;r++){var a,s=e[r];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new ua[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new ua[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new ua[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new ua[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new ua[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new ua[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"IcosahedronGeometry":case"OctahedronGeometry":case"TetrahedronGeometry":a=new ua[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new ua[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new ua[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new ua[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"LatheGeometry":case"LatheBufferGeometry":a=new ua[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"BufferGeometry":a=n.parse(s);break;case"Geometry":a=i.parse(s,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),t[s.uuid]=a}return t},parseMaterials:function(e,t){var i={};if(void 0!==e){var n=new ns;n.setTextures(t);for(var r=0,o=e.length;r<o;r++){var a=e[r];if("MultiMaterial"===a.type){for(var s=[],l=0;l<a.materials.length;l++)s.push(n.parse(a.materials[l]));i[a.uuid]=s}else i[a.uuid]=n.parse(a)}}return i},parseAnimations:function(e){for(var t=[],i=0;i<e.length;i++){var n=is.parse(e[i]);t.push(n)}return t},parseImages:function(e,t){var i=this,n={};function r(e){return i.manager.itemStart(e),o.load(e,function(){i.manager.itemEnd(e)},void 0,function(){i.manager.itemEnd(e),i.manager.itemError(e)})}if(void 0!==e&&0<e.length){var o=new Ra(new Ea(t));o.setCrossOrigin(this.crossOrigin);for(var a=0,s=e.length;a<s;a++){var l=e[a],c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url)?l.url:i.texturePath+l.url;n[l.uuid]=r(c)}}return n},parseTextures:function(e,t){function i(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var n={};if(void 0!==e)for(var r=0,o=e.length;r<o;r++){var a=e[r];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===t[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);var s=new Ce(t[a.image]);s.needsUpdate=!0,s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),void 0!==a.mapping&&(s.mapping=i(a.mapping,fs)),void 0!==a.offset&&s.offset.fromArray(a.offset),void 0!==a.repeat&&s.repeat.fromArray(a.repeat),void 0!==a.wrap&&(s.wrapS=i(a.wrap[0],ms),s.wrapT=i(a.wrap[1],ms)),void 0!==a.minFilter&&(s.minFilter=i(a.minFilter,gs)),void 0!==a.magFilter&&(s.magFilter=i(a.magFilter,gs)),void 0!==a.anisotropy&&(s.anisotropy=a.anisotropy),void 0!==a.flipY&&(s.flipY=a.flipY),n[a.uuid]=s}return n},parseObject:(cs=new ot,function(e,t,o){var i;function n(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function r(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],i=0,n=e.length;i<n;i++){var r=e[i];void 0===o[r]&&console.warn("THREE.ObjectLoader: Undefined material",r),t.push(o[r])}return t}return void 0===o[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),o[e]}}switch(e.type){case"Scene":i=new ao,void 0!==e.background&&Number.isInteger(e.background)&&(i.background=new Xt(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?i.fog=new oo(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(i.fog=new ro(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":i=new rn(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(i.focus=e.focus),void 0!==e.zoom&&(i.zoom=e.zoom),void 0!==e.filmGauge&&(i.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(i.filmOffset=e.filmOffset),void 0!==e.view&&(i.view=Object.assign({},e.view));break;case"OrthographicCamera":i=new nn(e.left,e.right,e.top,e.bottom,e.near,e.far);break;case"AmbientLight":i=new Fa(e.color,e.intensity);break;case"DirectionalLight":i=new Ba(e.color,e.intensity);break;case"PointLight":i=new Na(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":i=new Ua(e.color,e.intensity,e.width,e.height);break;case"SpotLight":i=new ka(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":i=new Oa(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var a=n(e.geometry),s=r(e.material);i=a.bones&&0<a.bones.length?new fo(a,s):new fr(a,s);break;case"LOD":i=new ho;break;case"Line":i=new go(n(e.geometry),r(e.material),e.mode);break;case"LineLoop":i=new yo(n(e.geometry),r(e.material));break;case"LineSegments":i=new vo(n(e.geometry),r(e.material));break;case"PointCloud":case"Points":i=new xo(n(e.geometry),r(e.material));break;case"Sprite":i=new co(r(e.material));break;case"Group":i=new wo;break;default:i=new en}if(i.uuid=e.uuid,void 0!==e.name&&(i.name=e.name),void 0!==e.matrix?(cs.fromArray(e.matrix),cs.decompose(i.position,i.quaternion,i.scale)):(void 0!==e.position&&i.position.fromArray(e.position),void 0!==e.rotation&&i.rotation.fromArray(e.rotation),void 0!==e.quaternion&&i.quaternion.fromArray(e.quaternion),void 0!==e.scale&&i.scale.fromArray(e.scale)),void 0!==e.castShadow&&(i.castShadow=e.castShadow),void 0!==e.receiveShadow&&(i.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(i.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(i.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&i.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(i.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.children)for(var l in e.children)i.add(this.parseObject(e.children[l],t,o));if("LOD"===e.type)for(var c=e.levels,h=0;h<c.length;h++){var u=c[h];void 0!==(l=i.getObjectByProperty("uuid",u.object))&&i.addLevel(l,u.distance)}return i})});var fs={UVMapping:300,CubeReflectionMapping:de,CubeRefractionMapping:pe,EquirectangularReflectionMapping:fe,EquirectangularRefractionMapping:me,SphericalReflectionMapping:ge,CubeUVReflectionMapping:ve,CubeUVRefractionMapping:ye},ms={RepeatWrapping:De,ClampToEdgeWrapping:ke,MirroredRepeatWrapping:Ne},gs={NearestFilter:He,NearestMipMapNearestFilter:Be,NearestMipMapLinearFilter:Fe,LinearFilter:Ue,LinearMipMapNearestFilter:1007,LinearMipMapLinearFilter:$e};function vs(e,t,i,n,r){var o=.5*(n-t),a=.5*(r-i),s=e*e;return(2*i-2*n+o+a)*(e*s)+(-3*i+3*n-2*o-a)*s+o*e+i}function ys(e,t,i,n){return(a=1-e)*a*t+2*(1-(o=e))*o*i+(r=e)*r*n;var r,o,a}function bs(e,t,i,n,r){return(c=1-e)*c*c*t+3*(l=1-(s=e))*l*s*i+3*(1-(a=e))*a*a*n+(o=e)*o*o*r;var o,a,s,l,c}function xs(){this.arcLengthDivisions=200}function ws(e,t){xs.call(this),this.v1=e,this.v2=t}function _s(){xs.call(this),this.curves=[],this.autoClose=!1}function Es(e,t,i,n,r,o,a,s){xs.call(this),this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=n,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=a,this.aRotation=s||0}function Ts(e){xs.call(this),this.points=void 0===e?[]:e}function Ms(e,t,i,n){xs.call(this),this.v0=e,this.v1=t,this.v2=i,this.v3=n}function Ss(e,t,i){xs.call(this),this.v0=e,this.v1=t,this.v2=i}Object.assign(xs.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e){var t=this.getUtoTmapping(e);return this.getPoint(t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],i=0;i<=e;i++)t.push(this.getPoint(i/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,i,n=[],r=this.getPoint(0),o=0;for(n.push(0),i=1;i<=e;i++)o+=(t=this.getPoint(i/e)).distanceTo(r),n.push(o),r=t;return this.cacheArcLengths=n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var i,n=this.getLengths(),r=0,o=n.length;i=t||e*n[o-1];for(var a,s=0,l=o-1;s<=l;)if((a=n[r=Math.floor(s+(l-s)/2)]-i)<0)s=r+1;else{if(!(0<a)){l=r;break}l=r-1}if(n[r=l]===i)return r/(o-1);var c=n[r];return(r+(i-c)/(n[r+1]-c))/(o-1)},getTangent:function(e){var t=e-1e-4,i=e+1e-4;t<0&&(t=0),1<i&&(i=1);var n=this.getPoint(t);return this.getPoint(i).clone().sub(n).normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var i,n,r,o=new rt,a=[],s=[],l=[],c=new rt,h=new ot;for(i=0;i<=e;i++)n=i/e,a[i]=this.getTangentAt(n),a[i].normalize();s[0]=new rt,l[0]=new rt;var u=Number.MAX_VALUE,d=Math.abs(a[0].x),p=Math.abs(a[0].y),f=Math.abs(a[0].z);for(d<=u&&(u=d,o.set(1,0,0)),p<=u&&(u=p,o.set(0,1,0)),f<=u&&o.set(0,0,1),c.crossVectors(a[0],o).normalize(),s[0].crossVectors(a[0],c),l[0].crossVectors(a[0],s[0]),i=1;i<=e;i++)s[i]=s[i-1].clone(),l[i]=l[i-1].clone(),c.crossVectors(a[i-1],a[i]),c.length()>Number.EPSILON&&(c.normalize(),r=Math.acos(Qe.clamp(a[i-1].dot(a[i]),-1,1)),s[i].applyMatrix4(h.makeRotationAxis(c,r))),l[i].crossVectors(a[i],s[i]);if(!0===t)for(r=Math.acos(Qe.clamp(s[0].dot(s[e]),-1,1)),r/=e,0<a[0].dot(c.crossVectors(s[0],s[e]))&&(r=-r),i=1;i<=e;i++)s[i].applyMatrix4(h.makeRotationAxis(a[i],r*i)),l[i].crossVectors(a[i],s[i]);return{tangents:a,normals:s,binormals:l}}}),((ws.prototype=Object.create(xs.prototype)).constructor=ws).prototype.isLineCurve=!0,ws.prototype.getPoint=function(e){if(1===e)return this.v2.clone();var t=this.v2.clone().sub(this.v1);return t.multiplyScalar(e).add(this.v1),t},ws.prototype.getPointAt=function(e){return this.getPoint(e)},ws.prototype.getTangent=function(e){return this.v2.clone().sub(this.v1).normalize()},_s.prototype=Object.assign(Object.create(xs.prototype),{constructor:_s,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new ws(t,e))},getPoint:function(e){for(var t=e*this.getLength(),i=this.getCurveLengths(),n=0;n<i.length;){if(i[n]>=t){var r=i[n]-t,o=this.curves[n],a=o.getLength(),s=0===a?0:1-r/a;return o.getPointAt(s)}n++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,i=0,n=this.curves.length;i<n;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,i=[],n=0,r=this.curves;n<r.length;n++)for(var o=r[n],a=o&&o.isEllipseCurve?2*e:o&&o.isLineCurve?1:o&&o.isSplineCurve?e*o.points.length:e,s=o.getPoints(a),l=0;l<s.length;l++){var c=s[l];t&&t.equals(c)||(i.push(c),t=c)}return this.autoClose&&1<i.length&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i},createPointsGeometry:function(e){var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){for(var t=new Wn,i=0,n=e.length;i<n;i++){var r=e[i];t.vertices.push(new rt(r.x,r.y,r.z||0))}return t}}),((Es.prototype=Object.create(xs.prototype)).constructor=Es).prototype.isEllipseCurve=!0,Es.prototype.getPoint=function(e){for(var t=2*Math.PI,i=this.aEndAngle-this.aStartAngle,n=Math.abs(i)<Number.EPSILON;i<0;)i+=t;for(;t<i;)i-=t;i<Number.EPSILON&&(i=n?0:t),!0!==this.aClockwise||n||(i===t?i=-t:i-=t);var r=this.aStartAngle+e*i,o=this.aX+this.xRadius*Math.cos(r),a=this.aY+this.yRadius*Math.sin(r);if(0!==this.aRotation){var s=Math.cos(this.aRotation),l=Math.sin(this.aRotation),c=o-this.aX,h=a-this.aY;o=c*s-h*l+this.aX,a=c*l+h*s+this.aY}return new xe(o,a)},((Ts.prototype=Object.create(xs.prototype)).constructor=Ts).prototype.isSplineCurve=!0,Ts.prototype.getPoint=function(e){var t=this.points,i=(t.length-1)*e,n=Math.floor(i),r=i-n,o=t[0===n?n:n-1],a=t[n],s=t[n>t.length-2?t.length-1:n+1],l=t[n>t.length-3?t.length-1:n+2];return new xe(vs(r,o.x,a.x,s.x,l.x),vs(r,o.y,a.y,s.y,l.y))},((Ms.prototype=Object.create(xs.prototype)).constructor=Ms).prototype.getPoint=function(e){var t=this.v0,i=this.v1,n=this.v2,r=this.v3;return new xe(bs(e,t.x,i.x,n.x,r.x),bs(e,t.y,i.y,n.y,r.y))},((Ss.prototype=Object.create(xs.prototype)).constructor=Ss).prototype.getPoint=function(e){var t=this.v0,i=this.v1,n=this.v2;return new xe(ys(e,t.x,i.x,n.x),ys(e,t.y,i.y,n.y))};var Cs,Rs=Object.assign(Object.create(_s.prototype),{fromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var i=new ws(this.currentPoint.clone(),new xe(e,t));this.curves.push(i),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,i,n){var r=new Ss(this.currentPoint.clone(),new xe(e,t),new xe(i,n));this.curves.push(r),this.currentPoint.set(i,n)},bezierCurveTo:function(e,t,i,n,r,o){var a=new Ms(this.currentPoint.clone(),new xe(e,t),new xe(i,n),new xe(r,o));this.curves.push(a),this.currentPoint.set(r,o)},splineThru:function(e){var t=new Ts([this.currentPoint.clone()].concat(e));this.curves.push(t),this.currentPoint.copy(e[e.length-1])},arc:function(e,t,i,n,r,o){var a=this.currentPoint.x,s=this.currentPoint.y;this.absarc(e+a,t+s,i,n,r,o)},absarc:function(e,t,i,n,r,o){this.absellipse(e,t,i,i,n,r,o)},ellipse:function(e,t,i,n,r,o,a,s){var l=this.currentPoint.x,c=this.currentPoint.y;this.absellipse(e+l,t+c,i,n,r,o,a,s)},absellipse:function(e,t,i,n,r,o,a,s){var l=new Es(e,t,i,n,r,o,a,s);if(0<this.curves.length){var c=l.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(l);var h=l.getPoint(1);this.currentPoint.copy(h)}});function As(e){_s.call(this),this.currentPoint=new xe,e&&this.fromPoints(e)}function Ps(){As.apply(this,arguments),this.holes=[]}function Ls(){this.subPaths=[],this.currentPath=null}function Os(e){this.data=e}function Is(e){this.manager=void 0!==e?e:Ta}(As.prototype=Rs).constructor=As,Ps.prototype=Object.assign(Object.create(Rs),{constructor:Ps,getPointsHoles:function(e){for(var t=[],i=0,n=this.holes.length;i<n;i++)t[i]=this.holes[i].getPoints(e);return t},extractAllPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},extractPoints:function(e){return this.extractAllPoints(e)}}),Object.assign(Ls.prototype,{moveTo:function(e,t){this.currentPath=new As,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,i,n){this.currentPath.quadraticCurveTo(e,t,i,n)},bezierCurveTo:function(e,t,i,n,r,o){this.currentPath.bezierCurveTo(e,t,i,n,r,o)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function i(e){for(var t=[],i=0,n=e.length;i<n;i++){var r=e[i],o=new Ps;o.curves=r.curves,t.push(o)}return t}function n(e,t){for(var i=t.length,n=!1,r=i-1,o=0;o<i;r=o++){var a=t[r],s=t[o],l=s.x-a.x,c=s.y-a.y;if(Math.abs(c)>Number.EPSILON){if(c<0&&(a=t[o],l=-l,s=t[r],c=-c),e.y<a.y||e.y>s.y)continue;if(e.y===a.y){if(e.x===a.x)return!0}else{var h=c*(e.x-a.x)-l*(e.y-a.y);if(0===h)return!0;if(h<0)continue;n=!n}}else{if(e.y!==a.y)continue;if(s.x<=e.x&&e.x<=a.x||a.x<=e.x&&e.x<=s.x)return!0}}return n}var r=Go.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===t)return i(o);var a,s,l,c=[];if(1===o.length)return s=o[0],(l=new Ps).curves=s.curves,c.push(l),c;var h=!r(o[0].getPoints());h=e?!h:h;var u,d,p=[],f=[],m=[],g=0;f[g]=void 0,m[g]=[];for(var v=0,y=o.length;v<y;v++)a=r(u=(s=o[v]).getPoints()),(a=e?!a:a)?(!h&&f[g]&&g++,f[g]={s:new Ps,p:u},f[g].s.curves=s.curves,h&&g++,m[g]=[]):m[g].push({h:s,p:u[0]});if(!f[0])return i(o);if(1<f.length){for(var b=!1,x=[],w=0,_=f.length;w<_;w++)p[w]=[];for(w=0,_=f.length;w<_;w++)for(var E=m[w],T=0;T<E.length;T++){for(var M=E[T],S=!0,C=0;C<f.length;C++)n(M.p,f[C].p)&&(w!==C&&x.push({froms:w,tos:C,hole:T}),S?(S=!1,p[C].push(M)):b=!0);S&&p[w].push(M)}0<x.length&&(b||(m=p))}v=0;for(var R=f.length;v<R;v++){l=f[v].s,c.push(l);for(var A=0,P=(d=m[v]).length;A<P;A++)l.holes.push(d[A].h)}return c}}),Object.assign(Os.prototype,{isFont:!0,generateShapes:function(e,h,E){function u(e,t,i,n){var r=T.glyphs[e]||T.glyphs["?"];if(r){var o,a,s,l,c,h,u,d,p,f,m,g=new Ls,v=[];if(r.o)for(var y=r._cachedOutline||(r._cachedOutline=r.o.split(" ")),b=0,x=y.length;b<x;){switch(y[b++]){case"m":o=y[b++]*t+i,a=y[b++]*t+n,g.moveTo(o,a);break;case"l":o=y[b++]*t+i,a=y[b++]*t+n,g.lineTo(o,a);break;case"q":if(s=y[b++]*t+i,l=y[b++]*t+n,u=y[b++]*t+i,d=y[b++]*t+n,g.quadraticCurveTo(u,d,s,l),m=v[v.length-1]){c=m.x,h=m.y;for(var w=1;w<=E;w++){ys(_=w/E,c,u,s),ys(_,h,d,l)}}break;case"b":if(s=y[b++]*t+i,l=y[b++]*t+n,u=y[b++]*t+i,d=y[b++]*t+n,p=y[b++]*t+i,f=y[b++]*t+n,g.bezierCurveTo(u,d,p,f,s,l),m=v[v.length-1]){c=m.x,h=m.y;for(w=1;w<=E;w++){var _;bs(_=w/E,c,u,p,s),bs(_,h,d,f,l)}}}}return{offsetX:r.ha*t,path:g}}}void 0===h&&(h=100),void 0===E&&(E=4);for(var T=this.data,t=function(e){for(var t=String(e).split(""),i=h/T.resolution,n=(T.boundingBox.yMax-T.boundingBox.yMin+T.underlineThickness)*i,r=0,o=0,a=[],s=0;s<t.length;s++){var l=t[s];if("\n"===l)r=0,o-=n;else{var c=u(l,i,r,o);r+=c.offsetX,a.push(c.path)}}return a}(e),i=[],n=0,r=t.length;n<r;n++)Array.prototype.push.apply(i,t[n].toShapes());return i}}),Object.assign(Is.prototype,{load:function(e,n,t,i){var r=this;new Ma(this.manager).load(e,function(t){var i;try{i=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),i=JSON.parse(t.substring(65,t.length-2))}var e=r.parse(i);n&&n(e)},t,i)},parse:function(e){return new Os(e)}});var Ds,ks,Ns,Hs,Bs,Fs,Us,$s,zs,js,Vs,Gs,Ws,qs,Xs,Zs,Ys,Ks,Js,Qs,el,tl,il,nl,rl,ol,al,sl,ll,cl,hl,ul,dl,pl,fl,ml,gl,vl,yl,bl={getContext:function(){return void 0===Cs&&(Cs=new(window.AudioContext||window.webkitAudioContext)),Cs},setContext:function(e){Cs=e}};function xl(e){this.manager=void 0!==e?e:Ta}function wl(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new rn,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new rn,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function _l(e,t,i){en.call(this),this.type="CubeCamera";var r=new rn(90,1,e,t);r.up.set(0,-1,0),r.lookAt(new rt(1,0,0)),this.add(r);var o=new rn(90,1,e,t);o.up.set(0,-1,0),o.lookAt(new rt(-1,0,0)),this.add(o);var a=new rn(90,1,e,t);a.up.set(0,0,1),a.lookAt(new rt(0,1,0)),this.add(a);var s=new rn(90,1,e,t);s.up.set(0,0,-1),s.lookAt(new rt(0,-1,0)),this.add(s);var l=new rn(90,1,e,t);l.up.set(0,-1,0),l.lookAt(new rt(0,0,1)),this.add(l);var c=new rn(90,1,e,t);c.up.set(0,-1,0),c.lookAt(new rt(0,0,-1)),this.add(c);var n={format:Xe,magFilter:Ue,minFilter:Ue};this.renderTarget=new it(i,i,n),this.renderTarget.texture.name="CubeCamera",this.updateCubeMap=function(e,t){null===this.parent&&this.updateMatrixWorld();var i=this.renderTarget,n=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,i.activeCubeFace=0,e.render(t,r,i),i.activeCubeFace=1,e.render(t,o,i),i.activeCubeFace=2,e.render(t,a,i),i.activeCubeFace=3,e.render(t,s,i),i.activeCubeFace=4,e.render(t,l,i),i.texture.generateMipmaps=n,i.activeCubeFace=5,e.render(t,c,i),e.setRenderTarget(null)}}function El(){en.call(this),this.type="AudioListener",this.context=bl.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function Tl(e){en.call(this),this.type="Audio",this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function Ml(e){Tl.call(this,e),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function Sl(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function Cl(e,t,i){this.binding=e,this.valueSize=i;var n,r=Float64Array;switch(t){case"quaternion":n=this._slerp;break;case"string":case"bool":r=Array,n=this._select;break;default:n=this._lerp}this.buffer=new r(4*i),this._mixBufferRegion=n,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function Rl(e,t,i){var n=i||Al.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}function Al(e,t,i){this.path=t,this.parsedPath=i||Al.parseTrackName(t),this.node=Al.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function Pl(e){this.uuid=Qe.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var i=0,n=arguments.length;i!==n;++i)t[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}function Ll(e,t,i){this._mixer=e,this._clip=t,this._localRoot=i||null;for(var n=t.tracks,r=n.length,o=new Array(r),a={endingStart:d,endingEnd:d},s=0;s!==r;++s){var l=n[s].createInterpolant(null);(o[s]=l).settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(r),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Ol(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Il(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function Dl(){or.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function kl(e,t,i,n){this.uuid=Qe.generateUUID(),this.data=e,this.itemSize=t,this.offset=i,this.normalized=!0===n}function Nl(e,t){this.uuid=Qe.generateUUID(),this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function Hl(e,t,i){Nl.call(this,e,t),this.meshPerAttribute=i||1}function Bl(e,t,i){qn.call(this,e,t),this.meshPerAttribute=i||1}function Fl(e,t,i,n){this.ray=new ur(e,t),this.near=i||0,this.far=n||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Ul(e,t){return e.distance-t.distance}function $l(e,t,i,n){if(!1!==e.visible&&(e.raycast(t,i),!0===n))for(var r=e.children,o=0,a=r.length;o<a;o++)$l(r[o],t,i,!0)}function zl(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function jl(e,t,i){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==i?i:0,this}function Vl(e,t,i){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==i?i:0,this}function Gl(e,t){fr.call(this,e,t),this.animationsMap={},this.animationsList=[];var i=this.geometry.morphTargets.length,n=i-1,r=i/1;this.createAnimation("__default",0,n,r),this.setAnimationWeight("__default",1)}function Wl(e){en.call(this),this.material=e,this.render=function(e){}}function ql(e,t,i,n){this.object=e,this.size=void 0!==t?t:1;var r=void 0!==i?i:16711680,o=void 0!==n?n:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=3*s.faces.length:s&&s.isBufferGeometry&&(a=s.attributes.normal.count);var l=new or,c=new tr(2*a*3,3);l.addAttribute("position",c),vo.call(this,l,new mo({color:r,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Xl(e){en.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;for(var t=new or,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],n=0,r=1;n<32;n++,r++){var o=n/32*Math.PI*2,a=r/32*Math.PI*2;i.push(Math.cos(o),Math.sin(o),1,Math.cos(a),Math.sin(a),1)}t.addAttribute("position",new tr(i,3));var s=new mo({fog:!1});this.cone=new vo(t,s),this.add(this.cone),this.update()}function Zl(e){for(var t=function e(t){var i=[];t&&t.isBone&&i.push(t);for(var n=0;n<t.children.length;n++)i.push.apply(i,e(t.children[n]));return i}(e),i=new or,n=[],r=[],o=new Xt(0,0,1),a=new Xt(0,1,0),s=0;s<t.length;s++){var l=t[s];l.parent&&l.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),r.push(o.r,o.g,o.b),r.push(a.r,a.g,a.b))}i.addAttribute("position",new tr(n,3)),i.addAttribute("color",new tr(r,3));var c=new mo({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0});vo.call(this,i,c),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.onBeforeRender()}function Yl(e,t){this.light=e,this.light.updateMatrixWorld();var i=new Ko(t,4,2),n=new hr({wireframe:!0,fog:!1});n.color.copy(this.light.color),fr.call(this,i,n),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1}function Kl(e){en.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;var t=new mo({color:e.color}),i=new or;i.addAttribute("position",new qn(new Float32Array(15),3)),this.add(new go(i,t)),this.update()}function Jl(e,t){en.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;var i=new Do(t);i.rotateY(.5*Math.PI);var n=new hr({vertexColors:2,wireframe:!0}),r=i.getAttribute("position"),o=new Float32Array(3*r.count);i.addAttribute("color",new qn(o,3)),this.add(new fr(i,n)),this.update()}function Ql(e,t,i,n){e=e||10,t=t||10,i=new Xt(void 0!==i?i:4473924),n=new Xt(void 0!==n?n:8947848);for(var r=t/2,o=e/t,a=e/2,s=[],l=[],c=0,h=0,u=-a;c<=t;c++,u+=o){s.push(-a,0,u,a,0,u),s.push(u,0,-a,u,0,a);var d=c===r?i:n;d.toArray(l,h),h+=3,d.toArray(l,h),h+=3,d.toArray(l,h),h+=3,d.toArray(l,h),h+=3}var p=new or;p.addAttribute("position",new tr(s,3)),p.addAttribute("color",new tr(l,3));var f=new mo({vertexColors:2});vo.call(this,p,f)}function ec(e,t,i,n,r,o){e=e||10,t=t||16,i=i||8,n=n||64,r=new Xt(void 0!==r?r:4473924),o=new Xt(void 0!==o?o:8947848);var a,s,l,c,h,u,d,p=[],f=[];for(c=0;c<=t;c++)l=c/t*(2*Math.PI),a=Math.sin(l)*e,s=Math.cos(l)*e,p.push(0,0,0),p.push(a,0,s),d=1&c?r:o,f.push(d.r,d.g,d.b),f.push(d.r,d.g,d.b);for(c=0;c<=i;c++)for(d=1&c?r:o,u=e-e/i*c,h=0;h<n;h++)l=h/n*(2*Math.PI),a=Math.sin(l)*u,s=Math.cos(l)*u,p.push(a,0,s),f.push(d.r,d.g,d.b),l=(h+1)/n*(2*Math.PI),a=Math.sin(l)*u,s=Math.cos(l)*u,p.push(a,0,s),f.push(d.r,d.g,d.b);var m=new or;m.addAttribute("position",new tr(p,3)),m.addAttribute("color",new tr(f,3));var g=new mo({vertexColors:2});vo.call(this,m,g)}function tc(e,t,i,n){this.object=e,this.size=void 0!==t?t:1;var r=void 0!==i?i:16776960,o=void 0!==n?n:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var l=new or,c=new tr(2*a*3,3);l.addAttribute("position",c),vo.call(this,l,new mo({color:r,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function ic(e,t){en.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,void 0===t&&(t=1);var i=new or;i.addAttribute("position",new tr([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var n=new mo({fog:!1});this.add(new go(i,n)),(i=new or).addAttribute("position",new tr([0,0,0,0,0,1],3)),this.add(new go(i,n)),this.update()}function nc(e){var t=new or,i=new mo({color:16777215,vertexColors:1}),n=[],r=[],o={},a=new Xt(16755200),s=new Xt(16711680),l=new Xt(43775),c=new Xt(16777215),h=new Xt(3355443);function u(e,t,i){d(e,i),d(t,i)}function d(e,t){n.push(0,0,0),r.push(t.r,t.g,t.b),void 0===o[e]&&(o[e]=[]),o[e].push(n.length/3-1)}u("n1","n2",a),u("n2","n4",a),u("n4","n3",a),u("n3","n1",a),u("f1","f2",a),u("f2","f4",a),u("f4","f3",a),u("f3","f1",a),u("n1","f1",a),u("n2","f2",a),u("n3","f3",a),u("n4","f4",a),u("p","n1",s),u("p","n2",s),u("p","n3",s),u("p","n4",s),u("u1","u2",l),u("u2","u3",l),u("u3","u1",l),u("c","t",c),u("p","c",h),u("cn1","cn2",h),u("cn3","cn4",h),u("cf1","cf2",h),u("cf3","cf4",h),t.addAttribute("position",new tr(n,3)),t.addAttribute("color",new tr(r,3)),vo.call(this,t,i),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function rc(e,t){this.object=e,void 0===t&&(t=16776960);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),r=new or;r.setIndex(new qn(i,1)),r.addAttribute("position",new qn(n,3)),vo.call(this,r,new mo({color:t})),this.matrixAutoUpdate=!1,this.update()}function oc(e,t,i,n,r,o){en.call(this),void 0===n&&(n=16776960),void 0===i&&(i=1),void 0===r&&(r=.2*i),void 0===o&&(o=.2*r),void 0===ml&&((ml=new or).addAttribute("position",new tr([0,0,0,0,1,0],3)),(gl=new aa(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new go(ml,new mo({color:n})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new fr(gl,new hr({color:n})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,r,o)}function ac(e){var t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=new or;i.addAttribute("position",new tr(t,3)),i.addAttribute("color",new tr([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var n=new mo({vertexColors:2});vo.call(this,i,n)}function sc(){var r=0,o=0,a=0,s=0;function c(e,t,i,n){a=-3*(r=e)+3*t-2*(o=i)-n,s=2*e-2*t+i+n}return{initCatmullRom:function(e,t,i,n,r){c(t,i,r*(i-e),r*(n-t))},initNonuniformCatmullRom:function(e,t,i,n,r,o,a){var s=(t-e)/r-(i-e)/(r+o)+(i-t)/o,l=(i-t)/o-(n-t)/(o+a)+(n-i)/a;c(t,i,s*=o,l*=o)},calc:function(e){var t=e*e;return r+o*e+a*t+s*(t*e)}}}Object.assign(xl.prototype,{load:function(e,t,i,n){var r=new Ma(this.manager);r.setResponseType("arraybuffer"),r.load(e,function(e){bl.getContext().decodeAudioData(e,function(e){t(e)})},i,n)}}),Object.assign(wl.prototype,{update:(zs=new ot,js=new ot,function(e){if(Ds!==this||ks!==e.focus||Ns!==e.fov||Hs!==e.aspect*this.aspect||Bs!==e.near||Fs!==e.far||Us!==e.zoom||$s!==this.eyeSep){Ds=this,ks=e.focus,Ns=e.fov,Hs=e.aspect*this.aspect,Bs=e.near,Fs=e.far,Us=e.zoom;var t,i,n=e.projectionMatrix.clone(),r=($s=this.eyeSep/2)*Bs/ks,o=Bs*Math.tan(Qe.DEG2RAD*Ns*.5)/Us;js.elements[12]=-$s,zs.elements[12]=$s,t=-o*Hs+r,i=o*Hs+r,n.elements[0]=2*Bs/(i-t),n.elements[8]=(i+t)/(i-t),this.cameraL.projectionMatrix.copy(n),t=-o*Hs-r,i=o*Hs-r,n.elements[0]=2*Bs/(i-t),n.elements[8]=(i+t)/(i-t),this.cameraR.projectionMatrix.copy(n)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(js),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(zs)})}),(_l.prototype=Object.create(en.prototype)).constructor=_l,El.prototype=Object.assign(Object.create(en.prototype),{constructor:El,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(e){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){this.gain.gain.value=e},updateMatrixWorld:(Vs=new rt,Gs=new nt,Ws=new rt,qs=new rt,function(e){en.prototype.updateMatrixWorld.call(this,e);var t=this.context.listener,i=this.up;this.matrixWorld.decompose(Vs,Gs,Ws),qs.set(0,0,-1).applyQuaternion(Gs),t.positionX?(t.positionX.setValueAtTime(Vs.x,this.context.currentTime),t.positionY.setValueAtTime(Vs.y,this.context.currentTime),t.positionZ.setValueAtTime(Vs.z,this.context.currentTime),t.forwardX.setValueAtTime(qs.x,this.context.currentTime),t.forwardY.setValueAtTime(qs.y,this.context.currentTime),t.forwardZ.setValueAtTime(qs.z,this.context.currentTime),t.upX.setValueAtTime(i.x,this.context.currentTime),t.upY.setValueAtTime(i.y,this.context.currentTime),t.upZ.setValueAtTime(i.z,this.context.currentTime)):(t.setPosition(Vs.x,Vs.y,Vs.z),t.setOrientation(qs.x,qs.y,qs.z,i.x,i.y,i.z))})}),Tl.prototype=Object.assign(Object.create(en.prototype),{constructor:Tl,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),e.playbackRate.setValueAtTime(this.playbackRate,this.startTime),e.start(0,this.startTime),this.isPlaying=!0,this.source=e,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.startTime=this.context.currentTime,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.startTime=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.value=e,this}}),Ml.prototype=Object.assign(Object.create(Tl.prototype),{constructor:Ml,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){this.panner.refDistance=e},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){this.panner.rolloffFactor=e},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){this.panner.distanceModel=e},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){this.panner.maxDistance=e},updateMatrixWorld:(Xs=new rt,function(e){en.prototype.updateMatrixWorld.call(this,e),Xs.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(Xs.x,Xs.y,Xs.z)})}),Object.assign(Sl.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),i=0;i<t.length;i++)e+=t[i];return e/t.length}}),Object.assign(Cl.prototype,{accumulate:function(e,t){var i=this.buffer,n=this.valueSize,r=e*n+n,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==n;++a)i[r+a]=i[a];o=t}else{var s=t/(o+=t);this._mixBufferRegion(i,r,0,s,n)}this.cumulativeWeight=o},apply:function(e){var t=this.valueSize,i=this.buffer,n=e*t+t,r=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,r<1){var a=3*t;this._mixBufferRegion(i,n,a,1-r,t)}for(var s=t,l=t+t;s!==l;++s)if(i[s]!==i[s+t]){o.setValue(i,n);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,i=this.valueSize,n=3*i;e.getValue(t,n);for(var r=i,o=n;r!==o;++r)t[r]=t[n+r%i];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,i,n,r){if(.5<=n)for(var o=0;o!==r;++o)e[t+o]=e[i+o]},_slerp:function(e,t,i,n){nt.slerpFlat(e,t,e,t,e,i,n)},_lerp:function(e,t,i,n,r){for(var o=1-n,a=0;a!==r;++a){var s=t+a;e[s]=e[s]*o+e[i+a]*n}}}),Object.assign(Rl.prototype,{getValue:function(e,t){this.bind();var i=this._targetGroup.nCachedObjects_,n=this._bindings[i];void 0!==n&&n.getValue(e,t)},setValue:function(e,t){for(var i=this._bindings,n=this._targetGroup.nCachedObjects_,r=i.length;n!==r;++n)i[n].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}),Object.assign(Al,{Composite:Rl,create:function(e,t,i){return e&&e.isAnimationObjectGroup?new Al.Composite(e,t,i):new Al(e,t,i)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(/[^\w-]/g,"")},parseTrackName:(Zs=new RegExp("^"+/((?:[\w-]+[\/:])*)/.source+/([\w-\.]+)?/.source+/(?:\.([\w-]+)(?:\[(.+)\])?)?/.source+/\.([\w-]+)(?:\[(.+)\])?/.source+"$"),Ys=["material","materials","bones"],function(e){var t=Zs.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=i.nodeName&&i.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){var r=i.nodeName.substring(n+1);-1!==Ys.indexOf(r)&&(i.nodeName=i.nodeName.substring(0,n),i.objectName=r)}if(null===i.propertyName||0===i.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}),findNode:function(e,r){if(!r||""===r||"root"===r||"."===r||-1===r||r===e.name||r===e.uuid)return e;if(e.skeleton){var t=function(e){for(var t=0;t<e.bones.length;t++){var i=e.bones[t];if(i.name===r)return i}return null}(e.skeleton);if(t)return t}if(e.children){var o=function(e){for(var t=0;t<e.length;t++){var i=e[t];if(i.name===r||i.uuid===r)return i;var n=o(i.children);if(n)return n}return null},i=o(e.children);if(i)return i}return null}}),Object.assign(Al.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)e[t++]=i[n]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.node[this.propertyName]=e[t]},function(e,t){this.node[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.node[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=e[t++]},function(e,t){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,i=t.objectName,n=t.propertyName,r=t.propertyIndex;if(e||(e=Al.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(i){var o=t.objectIndex;switch(i){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var a=0;a<e.length;a++)if(e[a].name===o){o=a;break}break;default:if(void 0===e[i])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[i]}if(void 0!==o){if(void 0===e[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[o]}}var s=e[n];if(void 0!==s){var l=this.Versioning.None;void 0!==e.needsUpdate?(l=this.Versioning.NeedsUpdate,this.targetObject=e):void 0!==e.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=e);var c=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===n){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(e.geometry.morphAttributes.position[a].name===r){r=a;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(a=0;a<this.node.geometry.morphTargets.length;a++)if(e.geometry.morphTargets[a].name===r){r=a;break}}}c=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(c=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}else{var h=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+n+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Al.prototype,{_getValue_unbound:Al.prototype.getValue,_setValue_unbound:Al.prototype.setValue}),Object.assign(Pl.prototype,{isAnimationObjectGroup:!0,add:function(e){for(var t=this._objects,i=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,o=this._paths,a=this._parsedPaths,s=this._bindings,l=s.length,c=0,h=arguments.length;c!==h;++c){var u=arguments[c],d=u.uuid,p=r[d],f=void 0;if(void 0===p){p=i++,r[d]=p,t.push(u);for(var m=0,g=l;m!==g;++m)s[m].push(new Al(u,o[m],a[m]))}else if(p<n){f=t[p];var v=--n,y=t[v];t[r[y.uuid]=p]=y,t[r[d]=v]=u;for(m=0,g=l;m!==g;++m){var b=s[m],x=b[v],w=b[p];b[p]=x,void 0===w&&(w=new Al(u,o[m],a[m])),b[v]=w}}else t[p]!==f&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(e){for(var t=this._objects,i=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,o=r.length,a=0,s=arguments.length;a!==s;++a){var l=arguments[a],c=l.uuid,h=n[c];if(void 0!==h&&i<=h){var u=i++,d=t[u];t[n[d.uuid]=h]=d,t[n[c]=u]=l;for(var p=0,f=o;p!==f;++p){var m=r[p],g=m[u],v=m[h];m[h]=g,m[u]=v}}}this.nCachedObjects_=i},uncache:function(e){for(var t=this._objects,i=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,o=this._bindings,a=o.length,s=0,l=arguments.length;s!==l;++s){var c=arguments[s].uuid,h=r[c];if(void 0!==h)if(delete r[c],h<n){var u=--n,d=t[u],p=t[y=--i];t[r[d.uuid]=h]=d,t[r[p.uuid]=u]=p,t.pop();for(var f=0,m=a;f!==m;++f){var g=(b=o[f])[u],v=b[y];b[h]=g,b[u]=v,b.pop()}}else{var y;t[r[(p=t[y=--i]).uuid]=h]=p,t.pop();for(f=0,m=a;f!==m;++f){var b;(b=o[f])[h]=b[y],b.pop()}}}this.nCachedObjects_=n},subscribe_:function(e,t){var i=this._bindingsIndicesByPath,n=i[e],r=this._bindings;if(void 0!==n)return r[n];var o=this._paths,a=this._parsedPaths,s=this._objects,l=s.length,c=this.nCachedObjects_,h=new Array(l);n=r.length,i[e]=n,o.push(e),a.push(t),r.push(h);for(var u=c,d=s.length;u!==d;++u){var p=s[u];h[u]=new Al(p,e,t)}return h},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,i=t[e];if(void 0!==i){var n=this._paths,r=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];o[t[e[a]]=i]=s,o.pop(),r[i]=r[a],r.pop(),n[i]=n[a],n.pop()}}}),Object.assign(Ll.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){var n=this._clip.duration,r=e._clip.duration,o=r/n,a=n/r;e.warp(1,o,t),this.warp(a,1,t)}return this},crossFadeTo:function(e,t,i){return e.crossFadeFrom(this,t,i)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,i){var n=this._mixer,r=n.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=n._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,l=o.sampleValues;return s[0]=r,s[1]=r+i,l[0]=e/a,l[1]=t/a,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,i,n){if(this.enabled){var r=this._startTime;if(null!==r){var o=(e-r)*i;if(o<0||0===i)return;this._startTime=null,t=i*o}t*=this._updateTimeScale(e);var a=this._updateTime(t),s=this._updateWeight(e);if(0<s)for(var l=this._interpolants,c=this._propertyBindings,h=0,u=l.length;h!==u;++h)l[h].evaluate(a),c[h].accumulate(n,s)}else this._updateWeight(e)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var i=this._weightInterpolant;if(null!==i){var n=i.evaluate(e)[0];t*=n,e>i.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var i=this._timeScaleInterpolant;if(null!==i)t*=i.evaluate(e)[0],e>i.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t},_updateTime:function(e){var t=this.time+e;if(0===e)return t;var i=this._clip.duration,n=this.loop,r=this._loopCount;if(2200===n){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i<=t)t=i;else{if(!(t<0))break e;t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{var o=2202===n;if(-1===r&&(0<=e?(r=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),i<=t||t<0){var a=Math.floor(t/i);t-=i*a,r+=Math.abs(a);var s=this.repetitions-r;if(s<0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=0<e?i:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<e?1:-1});else{if(0===s){var l=e<0;this._setEndings(l,!l,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}if(o&&1==(1&r))return i-(this.time=t)}return this.time=t},_setEndings:function(e,t,i){var n=this._interpolantSettings;i?(n.endingStart=p,n.endingEnd=p):(n.endingStart=e?this.zeroSlopeAtStart?p:d:f,n.endingEnd=t?this.zeroSlopeAtEnd?p:d:f)},_scheduleFading:function(e,t,i){var n=this._mixer,r=n.time,o=this._weightInterpolant;null===o&&(o=n._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=r,s[0]=t,a[1]=r+e,s[1]=i,this}}),Object.assign(Ol.prototype,t.prototype,{_bindAction:function(e,t){var i=e._localRoot||this._root,n=e._clip.tracks,r=n.length,o=e._propertyBindings,a=e._interpolants,s=i.uuid,l=this._bindingsByRootAndName,c=l[s];void 0===c&&(c={},l[s]=c);for(var h=0;h!==r;++h){var u=n[h],d=u.name,p=c[d];if(void 0!==p)o[h]=p;else{if(void 0!==(p=o[h])){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,s,d));continue}var f=t&&t._propertyBindings[h].binding.parsedPath;++(p=new Cl(Al.create(i,d,f),u.ValueTypeName,u.getValueSize())).referenceCount,this._addInactiveBinding(p,s,d),o[h]=p}a[h].resultBuffer=p.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,i=e._clip.uuid,n=this._actionsByClip[i];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,i,t)}for(var r=e._propertyBindings,o=0,a=r.length;o!==a;++o){var s=r[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,i=0,n=t.length;i!==n;++i){var r=t[i];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,i){var n=this._actions,r=this._actionsByClip,o=r[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=o;else{var a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=n.length,n.push(e),o.actionByRoot[i]=e},_removeInactiveAction:function(e){var t=this._actions,i=t[t.length-1],n=e._cacheIndex;t[i._cacheIndex=n]=i,t.pop(),e._cacheIndex=null;var r=e._clip.uuid,o=this._actionsByClip,a=o[r],s=a.knownActions,l=s[s.length-1],c=e._byClipCacheIndex;s[l._byClipCacheIndex=c]=l,s.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete o[r],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,i=0,n=t.length;i!==n;++i){var r=t[i];0==--r.referenceCount&&this._removeInactiveBinding(r)}},_lendAction:function(e){var t=this._actions,i=e._cacheIndex,n=this._nActiveActions++,r=t[n];t[e._cacheIndex=n]=e,t[r._cacheIndex=i]=r},_takeBackAction:function(e){var t=this._actions,i=e._cacheIndex,n=--this._nActiveActions,r=t[n];t[e._cacheIndex=n]=e,t[r._cacheIndex=i]=r},_addInactiveBinding:function(e,t,i){var n=this._bindingsByRootAndName,r=n[t],o=this._bindings;void 0===r&&(r={},n[t]=r),(r[i]=e)._cacheIndex=o.length,o.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,i=e.binding,n=i.rootNode.uuid,r=i.path,o=this._bindingsByRootAndName,a=o[n],s=t[t.length-1],l=e._cacheIndex;t[s._cacheIndex=l]=s,t.pop(),delete a[r];e:{for(var c in a)break e;delete o[n]}},_lendBinding:function(e){var t=this._bindings,i=e._cacheIndex,n=this._nActiveBindings++,r=t[n];t[e._cacheIndex=n]=e,t[r._cacheIndex=i]=r},_takeBackBinding:function(e){var t=this._bindings,i=e._cacheIndex,n=--this._nActiveBindings,r=t[n];t[e._cacheIndex=n]=e,t[r._cacheIndex=i]=r},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,i=e[t];return void 0===i&&(e[(i=new Ga(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t]=i),i},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,i=e.__cacheIndex,n=--this._nActiveControlInterpolants,r=t[n];t[e.__cacheIndex=n]=e,t[r.__cacheIndex=i]=r},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var i=t||this._root,n=i.uuid,r="string"==typeof e?is.findByName(i,e):e,o=null!==r?r.uuid:e,a=this._actionsByClip[o],s=null;if(void 0!==a){var l=a.actionByRoot[n];if(void 0!==l)return l;s=a.knownActions[0],null===r&&(r=s._clip)}if(null===r)return null;var c=new Ll(this,r,t);return this._bindAction(c,s),this._addInactiveAction(c,o,n),c},existingAction:function(e,t){var i=t||this._root,n=i.uuid,r="string"==typeof e?is.findByName(i,e):e,o=r?r.uuid:e,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[n]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,i=this._bindings,n=this._nActiveBindings;this._nActiveActions=0;for(var r=this._nActiveBindings=0;r!==t;++r)e[r].reset();for(r=0;r!==n;++r)i[r].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,i=this._nActiveActions,n=this.time+=e,r=Math.sign(e),o=this._accuIndex^=1,a=0;a!==i;++a){t[a]._update(n,e,r,o)}var s=this._bindings,l=this._nActiveBindings;for(a=0;a!==l;++a)s[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,i=e.uuid,n=this._actionsByClip,r=n[i];if(void 0!==r){for(var o=r.knownActions,a=0,s=o.length;a!==s;++a){var l=o[a];this._deactivateAction(l);var c=l._cacheIndex,h=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,t[h._cacheIndex=c]=h,t.pop(),this._removeInactiveBindingsForAction(l)}delete n[i]}},uncacheRoot:function(e){var t=e.uuid,i=this._actionsByClip;for(var n in i){var r=i[n].actionByRoot[t];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}var o=this._bindingsByRootAndName[t];if(void 0!==o)for(var a in o){var s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(e,t){var i=this.existingAction(e,t);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}}),Il.prototype.clone=function(){return new Il(void 0===this.value.clone?this.value:this.value.clone())},Dl.prototype=Object.assign(Object.create(or.prototype),{constructor:Dl,isInstancedBufferGeometry:!0,addGroup:function(e,t,i){this.groups.push({start:e,count:t,materialIndex:i})},copy:function(e){var t=e.index;null!==t&&this.setIndex(t.clone());var i=e.attributes;for(var n in i){var r=i[n];this.addAttribute(n,r.clone())}for(var o=e.groups,a=0,s=o.length;a<s;a++){var l=o[a];this.addGroup(l.start,l.count,l.materialIndex)}return this}}),Object.defineProperties(kl.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(kl.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this},setXYZ:function(e,t,i,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=n,this},setXYZW:function(e,t,i,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=n,this.data.array[e+3]=r,this}}),Object.defineProperty(Nl.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Nl.prototype,{isInterleavedBuffer:!0,setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==e?e.length/this.stride:0,this.array=e},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(e,t,i){e*=this.stride,i*=t.stride;for(var n=0,r=this.stride;n<r;n++)this.array[e+n]=t.array[i+n];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),Hl.prototype=Object.assign(Object.create(Nl.prototype),{constructor:Hl,isInstancedInterleavedBuffer:!0,copy:function(e){return Nl.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Bl.prototype=Object.assign(Object.create(qn.prototype),{constructor:Bl,isInstancedBufferAttribute:!0,copy:function(e){return qn.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(Fl.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize()):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t){var i=[];return $l(e,this,i,t),i.sort(Ul),i},intersectObjects:function(e,t){var i=[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var n=0,r=e.length;n<r;n++)$l(e[n],this,i,t);return i.sort(Ul),i}}),Object.assign(zl.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}),Object.assign(jl.prototype,{set:function(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.radius=e.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e.x,e.z),this.phi=Math.acos(Qe.clamp(e.y/this.radius,-1,1))),this}}),Object.assign(Vl.prototype,{set:function(e,t,i){return this.radius=e,this.theta=t,this.y=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.radius=Math.sqrt(e.x*e.x+e.z*e.z),this.theta=Math.atan2(e.x,e.z),this.y=e.y,this}}),((Gl.prototype=Object.create(fr.prototype)).constructor=Gl).prototype.createAnimation=function(e,t,i,n){var r={start:t,end:i,length:i-t+1,fps:n,duration:(i-t)/n,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[e]=r,this.animationsList.push(r)},Gl.prototype.autoCreateAnimations=function(e){for(var t,i=/([a-z]+)_?(\d+)/i,n={},r=this.geometry,o=0,a=r.morphTargets.length;o<a;o++){var s=r.morphTargets[o].name.match(i);if(s&&1<s.length)n[l=s[1]]||(n[l]={start:1/0,end:-1/0}),o<(c=n[l]).start&&(c.start=o),o>c.end&&(c.end=o),t||(t=l)}for(var l in n){var c=n[l];this.createAnimation(l,c.start,c.end,e)}this.firstAnimation=t},Gl.prototype.setAnimationDirectionForward=function(e){var t=this.animationsMap[e];t&&(t.direction=1,t.directionBackwards=!1)},Gl.prototype.setAnimationDirectionBackward=function(e){var t=this.animationsMap[e];t&&(t.direction=-1,t.directionBackwards=!0)},Gl.prototype.setAnimationFPS=function(e,t){var i=this.animationsMap[e];i&&(i.fps=t,i.duration=(i.end-i.start)/i.fps)},Gl.prototype.setAnimationDuration=function(e,t){var i=this.animationsMap[e];i&&(i.duration=t,i.fps=(i.end-i.start)/i.duration)},Gl.prototype.setAnimationWeight=function(e,t){var i=this.animationsMap[e];i&&(i.weight=t)},Gl.prototype.setAnimationTime=function(e,t){var i=this.animationsMap[e];i&&(i.time=t)},Gl.prototype.getAnimationTime=function(e){var t=0,i=this.animationsMap[e];return i&&(t=i.time),t},Gl.prototype.getAnimationDuration=function(e){var t=-1,i=this.animationsMap[e];return i&&(t=i.duration),t},Gl.prototype.playAnimation=function(e){var t=this.animationsMap[e];t?(t.time=0,t.active=!0):console.warn("THREE.MorphBlendMesh: animation["+e+"] undefined in .playAnimation()")},Gl.prototype.stopAnimation=function(e){var t=this.animationsMap[e];t&&(t.active=!1)},Gl.prototype.update=function(e){for(var t=0,i=this.animationsList.length;t<i;t++){var n=this.animationsList[t];if(n.active){var r=n.duration/n.length;n.time+=n.direction*e,n.mirroredLoop?(n.time>n.duration||n.time<0)&&(n.direction*=-1,n.time>n.duration&&(n.time=n.duration,n.directionBackwards=!0),n.time<0&&(n.time=0,n.directionBackwards=!1)):(n.time=n.time%n.duration,n.time<0&&(n.time+=n.duration));var o=n.start+Qe.clamp(Math.floor(n.time/r),0,n.length-1),a=n.weight;o!==n.currentFrame&&(this.morphTargetInfluences[n.lastFrame]=0,this.morphTargetInfluences[n.currentFrame]=1*a,this.morphTargetInfluences[o]=0,n.lastFrame=n.currentFrame,n.currentFrame=o);var s=n.time%r/r;n.directionBackwards&&(s=1-s),n.currentFrame!==n.lastFrame?(this.morphTargetInfluences[n.currentFrame]=s*a,this.morphTargetInfluences[n.lastFrame]=(1-s)*a):this.morphTargetInfluences[n.currentFrame]=a}}},((Wl.prototype=Object.create(en.prototype)).constructor=Wl).prototype.isImmediateRenderObject=!0,((ql.prototype=Object.create(vo.prototype)).constructor=ql).prototype.update=(Ks=new rt,Js=new rt,Qs=new Ai,function(){var e=["a","b","c"];this.object.updateMatrixWorld(!0),Qs.getNormalMatrix(this.object.matrixWorld);var t=this.object.matrixWorld,i=this.geometry.attributes.position,n=this.object.geometry;if(n&&n.isGeometry)for(var r=n.vertices,o=n.faces,a=0,s=0,l=o.length;s<l;s++)for(var c=o[s],h=0,u=c.vertexNormals.length;h<u;h++){var d=r[c[e[h]]],p=c.vertexNormals[h];Ks.copy(d).applyMatrix4(t),Js.copy(p).applyMatrix3(Qs).normalize().multiplyScalar(this.size).add(Ks),i.setXYZ(a,Ks.x,Ks.y,Ks.z),a+=1,i.setXYZ(a,Js.x,Js.y,Js.z),a+=1}else if(n&&n.isBufferGeometry){var f=n.attributes.position,m=n.attributes.normal;for(h=a=0,u=f.count;h<u;h++)Ks.set(f.getX(h),f.getY(h),f.getZ(h)).applyMatrix4(t),Js.set(m.getX(h),m.getY(h),m.getZ(h)),Js.applyMatrix3(Qs).normalize().multiplyScalar(this.size).add(Ks),i.setXYZ(a,Ks.x,Ks.y,Ks.z),a+=1,i.setXYZ(a,Js.x,Js.y,Js.z),a+=1}i.needsUpdate=!0}),((Xl.prototype=Object.create(en.prototype)).constructor=Xl).prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Xl.prototype.update=(el=new rt,tl=new rt,function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),el.setFromMatrixPosition(this.light.matrixWorld),tl.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(tl.sub(el)),this.cone.material.color.copy(this.light.color)}),((Zl.prototype=Object.create(vo.prototype)).constructor=Zl).prototype.onBeforeRender=(il=new rt,nl=new ot,rl=new ot,function(){var e=this.bones,t=this.geometry,i=t.getAttribute("position");rl.getInverse(this.root.matrixWorld);for(var n=0,r=0;n<e.length;n++){var o=e[n];o.parent&&o.parent.isBone&&(nl.multiplyMatrices(rl,o.matrixWorld),il.setFromMatrixPosition(nl),i.setXYZ(r,il.x,il.y,il.z),nl.multiplyMatrices(rl,o.parent.matrixWorld),il.setFromMatrixPosition(nl),i.setXYZ(r+1,il.x,il.y,il.z),r+=2)}t.getAttribute("position").needsUpdate=!0}),((Yl.prototype=Object.create(fr.prototype)).constructor=Yl).prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Yl.prototype.update=function(){this.material.color.copy(this.light.color)},((Kl.prototype=Object.create(en.prototype)).constructor=Kl).prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Kl.prototype.update=function(){var e=this.children[0];e.material.color.copy(this.light.color);var t=.5*this.light.width,i=.5*this.light.height,n=e.geometry.attributes.position,r=n.array;r[0]=t,r[1]=-i,r[2]=0,r[3]=t,r[4]=i,r[5]=0,r[6]=-t,r[7]=i,r[8]=0,r[9]=-t,r[10]=-i,r[11]=0,r[12]=t,r[13]=-i,r[14]=0,n.needsUpdate=!0},((Jl.prototype=Object.create(en.prototype)).constructor=Jl).prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Jl.prototype.update=(ol=new rt,al=new Xt,sl=new Xt,function(){var e=this.children[0],t=e.geometry.getAttribute("color");al.copy(this.light.color),sl.copy(this.light.groundColor);for(var i=0,n=t.count;i<n;i++){var r=i<n/2?al:sl;t.setXYZ(i,r.r,r.g,r.b)}e.lookAt(ol.setFromMatrixPosition(this.light.matrixWorld).negate()),t.needsUpdate=!0}),(Ql.prototype=Object.create(vo.prototype)).constructor=Ql,(ec.prototype=Object.create(vo.prototype)).constructor=ec,((tc.prototype=Object.create(vo.prototype)).constructor=tc).prototype.update=(ll=new rt,cl=new rt,hl=new Ai,function(){this.object.updateMatrixWorld(!0),hl.getNormalMatrix(this.object.matrixWorld);for(var e=this.object.matrixWorld,t=this.geometry.attributes.position,i=this.object.geometry,n=i.vertices,r=i.faces,o=0,a=0,s=r.length;a<s;a++){var l=r[a],c=l.normal;ll.copy(n[l.a]).add(n[l.b]).add(n[l.c]).divideScalar(3).applyMatrix4(e),cl.copy(c).applyMatrix3(hl).normalize().multiplyScalar(this.size).add(ll),t.setXYZ(o,ll.x,ll.y,ll.z),o+=1,t.setXYZ(o,cl.x,cl.y,cl.z),o+=1}t.needsUpdate=!0}),((ic.prototype=Object.create(en.prototype)).constructor=ic).prototype.dispose=function(){var e=this.children[0],t=this.children[1];e.geometry.dispose(),e.material.dispose(),t.geometry.dispose(),t.material.dispose()},ic.prototype.update=(ul=new rt,dl=new rt,pl=new rt,function(){ul.setFromMatrixPosition(this.light.matrixWorld),dl.setFromMatrixPosition(this.light.target.matrixWorld),pl.subVectors(dl,ul);var e=this.children[0],t=this.children[1];e.lookAt(pl),e.material.color.copy(this.light.color),t.lookAt(pl),t.scale.z=pl.length()}),((nc.prototype=Object.create(vo.prototype)).constructor=nc).prototype.update=function(){var l,c,h=new rt,u=new tn;function e(e,t,i,n){h.set(t,i,n).unproject(u);var r=c[e];if(void 0!==r)for(var o=l.getAttribute("position"),a=0,s=r.length;a<s;a++)o.setXYZ(r[a],h.x,h.y,h.z)}return function(){l=this.geometry,c=this.pointMap;u.projectionMatrix.copy(this.camera.projectionMatrix),e("c",0,0,-1),e("t",0,0,1),e("n1",-1,-1,-1),e("n2",1,-1,-1),e("n3",-1,1,-1),e("n4",1,1,-1),e("f1",-1,-1,1),e("f2",1,-1,1),e("f3",-1,1,1),e("f4",1,1,1),e("u1",.7,1.1,-1),e("u2",-.7,1.1,-1),e("u3",0,2,-1),e("cf1",-1,0,1),e("cf2",1,0,1),e("cf3",0,-1,1),e("cf4",0,1,1),e("cn1",-1,0,-1),e("cn2",1,0,-1),e("cn3",0,-1,-1),e("cn4",0,1,-1),l.getAttribute("position").needsUpdate=!0}}(),((rc.prototype=Object.create(vo.prototype)).constructor=rc).prototype.update=(fl=new Ci,function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&fl.setFromObject(this.object),!fl.isEmpty()){var t=fl.min,i=fl.max,n=this.geometry.attributes.position,r=n.array;r[0]=i.x,r[1]=i.y,r[2]=i.z,r[3]=t.x,r[4]=i.y,r[5]=i.z,r[6]=t.x,r[7]=t.y,r[8]=i.z,r[9]=i.x,r[10]=t.y,r[11]=i.z,r[12]=i.x,r[13]=i.y,r[14]=t.z,r[15]=t.x,r[16]=i.y,r[17]=t.z,r[18]=t.x,r[19]=t.y,r[20]=t.z,r[21]=i.x,r[22]=t.y,r[23]=t.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}}),rc.prototype.setFromObject=function(e){return this.object=e,this.update(),this},((oc.prototype=Object.create(en.prototype)).constructor=oc).prototype.setDirection=(yl=new rt,function(e){.99999<e.y?this.quaternion.set(0,0,0,1):e.y<-.99999?this.quaternion.set(1,0,0,0):(yl.set(e.z,0,-e.x).normalize(),vl=Math.acos(e.y),this.quaternion.setFromAxisAngle(yl,vl))}),oc.prototype.setLength=function(e,t,i){void 0===t&&(t=.2*e),void 0===i&&(i=.2*t),this.line.scale.set(1,Math.max(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(i,t,i),this.cone.position.y=e,this.cone.updateMatrix()},oc.prototype.setColor=function(e){this.line.material.color.copy(e),this.cone.material.color.copy(e)},(ac.prototype=Object.create(vo.prototype)).constructor=ac;var lc=new rt,cc=new sc,hc=new sc,uc=new sc;function dc(e){xs.call(this),e.length<2&&console.warn("THREE.CatmullRomCurve3: Points array needs at least two entries."),this.points=e||[],this.closed=!1}function pc(e,t,i,n){xs.call(this),this.v0=e,this.v1=t,this.v2=i,this.v3=n}function fc(e,t,i){xs.call(this),this.v0=e,this.v1=t,this.v2=i}function mc(e,t){xs.call(this),this.v1=e,this.v2=t}function gc(e,t,i,n,r,o){Es.call(this,e,t,i,i,n,r,o)}((dc.prototype=Object.create(xs.prototype)).constructor=dc).prototype.getPoint=function(e){var t,i,n,r,o=this.points,a=o.length,s=(a-(this.closed?0:1))*e,l=Math.floor(s),c=s-l;if(this.closed?l+=0<l?0:(Math.floor(Math.abs(l)/o.length)+1)*o.length:0===c&&l===a-1&&(l=a-2,c=1),t=this.closed||0<l?o[(l-1)%a]:(lc.subVectors(o[0],o[1]).add(o[0]),lc),i=o[l%a],n=o[(l+1)%a],r=this.closed||l+2<a?o[(l+2)%a]:(lc.subVectors(o[a-1],o[a-2]).add(o[a-1]),lc),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var h="chordal"===this.type?.5:.25,u=Math.pow(t.distanceToSquared(i),h),d=Math.pow(i.distanceToSquared(n),h),p=Math.pow(n.distanceToSquared(r),h);d<1e-4&&(d=1),u<1e-4&&(u=d),p<1e-4&&(p=d),cc.initNonuniformCatmullRom(t.x,i.x,n.x,r.x,u,d,p),hc.initNonuniformCatmullRom(t.y,i.y,n.y,r.y,u,d,p),uc.initNonuniformCatmullRom(t.z,i.z,n.z,r.z,u,d,p)}else if("catmullrom"===this.type){var f=void 0!==this.tension?this.tension:.5;cc.initCatmullRom(t.x,i.x,n.x,r.x,f),hc.initCatmullRom(t.y,i.y,n.y,r.y,f),uc.initCatmullRom(t.z,i.z,n.z,r.z,f)}return new rt(cc.calc(c),hc.calc(c),uc.calc(c))},((pc.prototype=Object.create(xs.prototype)).constructor=pc).prototype.getPoint=function(e){var t=this.v0,i=this.v1,n=this.v2,r=this.v3;return new rt(bs(e,t.x,i.x,n.x,r.x),bs(e,t.y,i.y,n.y,r.y),bs(e,t.z,i.z,n.z,r.z))},((fc.prototype=Object.create(xs.prototype)).constructor=fc).prototype.getPoint=function(e){var t=this.v0,i=this.v1,n=this.v2;return new rt(ys(e,t.x,i.x,n.x),ys(e,t.y,i.y,n.y),ys(e,t.z,i.z,n.z))},((mc.prototype=Object.create(xs.prototype)).constructor=mc).prototype.getPoint=function(e){if(1===e)return this.v2.clone();var t=new rt;return t.subVectors(this.v2,this.v1),t.multiplyScalar(e),t.add(this.v1),t},(gc.prototype=Object.create(Es.prototype)).constructor=gc;var vc={createMultiMaterialObject:function(e,t){for(var i=new wo,n=0,r=t.length;n<r;n++)i.add(new fr(e,t[n]));return i},detach:function(e,t,i){e.applyMatrix(t.matrixWorld),t.remove(e),i.add(e)},attach:function(e,t,i){e.applyMatrix((new ot).getInverse(i.matrixWorld)),t.remove(e),i.add(e)}};var yc;function bc(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),dc.call(this,e),this.type="catmullrom",this.closed=!0}function xc(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),dc.call(this,e),this.type="catmullrom"}function wc(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),dc.call(this,e),this.type="catmullrom"}xs.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(xs.prototype),(e.prototype.constructor=e).prototype.getPoint=t,e},bc.prototype=Object.create(dc.prototype),xc.prototype=Object.create(dc.prototype),wc.prototype=Object.create(dc.prototype),Object.assign(wc.prototype,{initFromArray:function(e){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(e){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(e){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Ql.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Zl.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(ti.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(Ci.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),dr.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Qe.random16=function(){return console.warn("THREE.Math.random16() has been deprecated. Use Math.random() instead."),Math.random()},Object.assign(Ai.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(e){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e,t,i){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(e,t,i){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(ot.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){return void 0===yc&&(yc=new rt),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),yc.setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(e){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e,t,i){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(e,t,i){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,i,n,r,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,n,i,r,o)}}),Pi.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},nt.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(ur.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(Ps.prototype,{extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Wo(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new ia(this,e)}}),Object.assign(xe.prototype,{fromAttribute:function(e,t,i){return console.error("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,i)}}),Object.assign(rt.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,i){return console.error("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,i)}}),Object.assign(et.prototype,{fromAttribute:function(e,t,i){return console.error("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,i)}}),Wn.prototype.computeTangents=function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},Object.assign(en.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)}}),Object.defineProperties(en.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(ho.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(uo.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(xs.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),rn.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(La.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(qn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}}}),Object.assign(or.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,i){void 0!==i&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(or.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Il.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Ti.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Xt}}}),Object.defineProperties(ga.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Mi.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(no.prototype,{getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}}),Object.defineProperties(no.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=e}}}),Object.defineProperties(Oi.prototype,{cullFace:{get:function(){return this.renderReverseSided?V:j},set:function(e){var t=e!==j;console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to "+t+"."),this.renderReverseSided=t}}}),Object.defineProperties(tt.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Tl.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new xl).load(e,function(e){t.setBuffer(e)}),this},Sl.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()};var _c={merge:function(e,t,i){var n;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t.isMesh&&(t.matrixAutoUpdate&&t.updateMatrix(),n=t.matrix,t=t.geometry),e.merge(t,n,i)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},Ec={crossOrigin:void 0,loadTexture:function(e,t,i,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var r=new Pa;r.setCrossOrigin(this.crossOrigin);var o=r.load(e,i,void 0,n);return t&&(o.mapping=t),o},loadTextureCube:function(e,t,i,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var r=new Aa;r.setCrossOrigin(this.crossOrigin);var o=r.load(e,i,void 0,n);return t&&(o.mapping=t),o},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}};e.WebGLRenderTargetCube=it,e.WebGLRenderTarget=tt,e.WebGLRenderer=no,e.ShaderLib=ei,e.UniformsLib=Kt,e.UniformsUtils=Jt,e.ShaderChunk=Qt,e.FogExp2=ro,e.Fog=oo,e.Scene=ao,e.LensFlare=so,e.Sprite=co,e.LOD=ho,e.SkinnedMesh=fo,e.Skeleton=uo,e.Bone=po,e.Mesh=fr,e.LineSegments=vo,e.LineLoop=yo,e.Line=go,e.Points=xo,e.Group=wo,e.VideoTexture=_o,e.DataTexture=at,e.CompressedTexture=Eo,e.CubeTexture=st,e.CanvasTexture=To,e.DepthTexture=Mo,e.Texture=Ce,e.CompressedTextureLoader=Sa,e.DataTextureLoader=Ca,e.CubeTextureLoader=Aa,e.TextureLoader=Pa,e.ObjectLoader=ps,e.MaterialLoader=ns,e.BufferGeometryLoader=rs,e.DefaultLoadingManager=Ta,e.LoadingManager=Ea,e.JSONLoader=ds,e.ImageLoader=Ra,e.FontLoader=Is,e.FileLoader=Ma,e.Loader=us,e.Cache=_a,e.AudioLoader=xl,e.SpotLightShadow=Da,e.SpotLight=ka,e.PointLight=Na,e.RectAreaLight=Ua,e.HemisphereLight=Oa,e.DirectionalLightShadow=Ha,e.DirectionalLight=Ba,e.AmbientLight=Fa,e.LightShadow=Ia,e.Light=La,e.StereoCamera=wl,e.PerspectiveCamera=rn,e.OrthographicCamera=nn,e.CubeCamera=_l,e.ArrayCamera=Qr,e.Camera=tn,e.AudioListener=El,e.PositionalAudio=Ml,e.AudioContext=bl,e.AudioAnalyser=Sl,e.Audio=Tl,e.VectorKeyframeTrack=Xa,e.StringKeyframeTrack=Ja,e.QuaternionKeyframeTrack=Ya,e.NumberKeyframeTrack=Ka,e.ColorKeyframeTrack=es,e.BooleanKeyframeTrack=Qa,e.PropertyMixer=Cl,e.PropertyBinding=Al,e.KeyframeTrack=ts,e.AnimationUtils=za,e.AnimationObjectGroup=Pl,e.AnimationMixer=Ol,e.AnimationClip=is,e.Uniform=Il,e.InstancedBufferGeometry=Dl,e.BufferGeometry=or,e.GeometryIdCount=Gn,e.Geometry=Wn,e.InterleavedBufferAttribute=kl,e.InstancedInterleavedBuffer=Hl,e.InterleavedBuffer=Nl,e.InstancedBufferAttribute=Bl,e.Face3=on,e.Object3D=en,e.Raycaster=Fl,e.Layers=ki,e.EventDispatcher=t,e.Clock=zl,e.QuaternionLinearInterpolant=Za,e.LinearInterpolant=Ga,e.DiscreteInterpolant=Wa,e.CubicInterpolant=Va,e.Interpolant=ja,e.Triangle=pr,e.Math=Qe,e.Spherical=jl,e.Cylindrical=Vl,e.Plane=Pi,e.Frustum=Li,e.Sphere=Ri,e.Ray=ur,e.Matrix4=ot,e.Matrix3=Ai,e.Box3=Ci,e.Box2=ti,e.Line3=dr,e.Euler=Di,e.Vector4=et,e.Vector3=rt,e.Vector2=xe,e.Quaternion=nt,e.Color=Xt,e.MorphBlendMesh=Gl,e.ImmediateRenderObject=Wl,e.VertexNormalsHelper=ql,e.SpotLightHelper=Xl,e.SkeletonHelper=Zl,e.PointLightHelper=Yl,e.RectAreaLightHelper=Kl,e.HemisphereLightHelper=Jl,e.GridHelper=Ql,e.PolarGridHelper=ec,e.FaceNormalsHelper=tc,e.DirectionalLightHelper=ic,e.CameraHelper=nc,e.BoxHelper=rc,e.ArrowHelper=oc,e.AxisHelper=ac,e.CatmullRomCurve3=dc,e.CubicBezierCurve3=pc,e.QuadraticBezierCurve3=fc,e.LineCurve3=mc,e.ArcCurve=gc,e.EllipseCurve=Es,e.SplineCurve=Ts,e.CubicBezierCurve=Ms,e.QuadraticBezierCurve=Ss,e.LineCurve=ws,e.Shape=Ps,e.Path=As,e.ShapePath=Ls,e.Font=Os,e.CurvePath=_s,e.Curve=xs,e.ShapeUtils=Go,e.SceneUtils=vc,e.WireframeGeometry=So,e.ParametricGeometry=Co,e.ParametricBufferGeometry=Ro,e.TetrahedronGeometry=Lo,e.TetrahedronBufferGeometry=Oo,e.OctahedronGeometry=Io,e.OctahedronBufferGeometry=Do,e.IcosahedronGeometry=ko,e.IcosahedronBufferGeometry=No,e.DodecahedronGeometry=Ho,e.DodecahedronBufferGeometry=Bo,e.PolyhedronGeometry=Ao,e.PolyhedronBufferGeometry=Po,e.TubeGeometry=Fo,e.TubeBufferGeometry=Uo,e.TorusKnotGeometry=$o,e.TorusKnotBufferGeometry=zo,e.TorusGeometry=jo,e.TorusBufferGeometry=Vo,e.TextGeometry=Xo,e.TextBufferGeometry=Zo,e.SphereGeometry=Yo,e.SphereBufferGeometry=Ko,e.RingGeometry=Jo,e.RingBufferGeometry=Qo,e.PlaneGeometry=lr,e.PlaneBufferGeometry=cr,e.LatheGeometry=ea,e.LatheBufferGeometry=ta,e.ShapeGeometry=ia,e.ShapeBufferGeometry=na,e.ExtrudeGeometry=Wo,e.ExtrudeBufferGeometry=qo,e.EdgesGeometry=ra,e.ConeGeometry=sa,e.ConeBufferGeometry=la,e.CylinderGeometry=oa,e.CylinderBufferGeometry=aa,e.CircleGeometry=ca,e.CircleBufferGeometry=ha,e.BoxGeometry=ar,e.BoxBufferGeometry=sr,e.ShadowMaterial=da,e.SpriteMaterial=lo,e.RawShaderMaterial=pa,e.ShaderMaterial=Mi,e.PointsMaterial=bo,e.MeshPhysicalMaterial=ma,e.MeshStandardMaterial=fa,e.MeshPhongMaterial=ga,e.MeshToonMaterial=va,e.MeshNormalMaterial=ya,e.MeshLambertMaterial=ba,e.MeshDepthMaterial=Si,e.MeshBasicMaterial=hr,e.LineDashedMaterial=xa,e.LineBasicMaterial=mo,e.Material=Ti,e.Float64BufferAttribute=ir,e.Float32BufferAttribute=tr,e.Uint32BufferAttribute=er,e.Int32BufferAttribute=Qn,e.Uint16BufferAttribute=Jn,e.Int16BufferAttribute=Kn,e.Uint8ClampedBufferAttribute=Yn,e.Uint8BufferAttribute=Zn,e.Int8BufferAttribute=Xn,e.BufferAttribute=qn,e.REVISION="86",e.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},e.CullFaceNone=z,e.CullFaceBack=j,e.CullFaceFront=V,e.CullFaceFrontBack=3,e.FrontFaceDirectionCW=0,e.FrontFaceDirectionCCW=1,e.BasicShadowMap=0,e.PCFShadowMap=H,e.PCFSoftShadowMap=B,e.FrontSide=F,e.BackSide=Z,e.DoubleSide=Y,e.FlatShading=Re,e.SmoothShading=l,e.NoColors=Ae,e.FaceColors=1,e.VertexColors=2,e.NoBlending=G,e.NormalBlending=W,e.AdditiveBlending=q,e.SubtractiveBlending=X,e.MultiplyBlending=K,e.CustomBlending=J,e.AddEquation=Pe,e.SubtractEquation=101,e.ReverseSubtractEquation=102,e.MinEquation=103,e.MaxEquation=104,e.ZeroFactor=200,e.OneFactor=201,e.SrcColorFactor=202,e.OneMinusSrcColorFactor=203,e.SrcAlphaFactor=Le,e.OneMinusSrcAlphaFactor=Oe,e.DstAlphaFactor=206,e.OneMinusDstAlphaFactor=207,e.DstColorFactor=208,e.OneMinusDstColorFactor=209,e.SrcAlphaSaturateFactor=210,e.NeverDepth=Q,e.AlwaysDepth=ee,e.LessDepth=te,e.LessEqualDepth=ie,e.EqualDepth=ne,e.GreaterEqualDepth=re,e.GreaterDepth=oe,e.NotEqualDepth=ae,e.MultiplyOperation=U,e.MixOperation=$,e.AddOperation=se,e.NoToneMapping=le,e.LinearToneMapping=Ie,e.ReinhardToneMapping=ce,e.Uncharted2ToneMapping=he,e.CineonToneMapping=ue,e.UVMapping=300,e.CubeReflectionMapping=de,e.CubeRefractionMapping=pe,e.EquirectangularReflectionMapping=fe,e.EquirectangularRefractionMapping=me,e.SphericalReflectionMapping=ge,e.CubeUVReflectionMapping=ve,e.CubeUVRefractionMapping=ye,e.RepeatWrapping=De,e.ClampToEdgeWrapping=ke,e.MirroredRepeatWrapping=Ne,e.NearestFilter=He,e.NearestMipMapNearestFilter=Be,e.NearestMipMapLinearFilter=Fe,e.LinearFilter=Ue,e.LinearMipMapNearestFilter=1007,e.LinearMipMapLinearFilter=$e,e.UnsignedByteType=ze,e.ByteType=1010,e.ShortType=1011,e.UnsignedShortType=je,e.IntType=1013,e.UnsignedIntType=Ve,e.FloatType=Ge,e.HalfFloatType=We,e.UnsignedShort4444Type=1017,e.UnsignedShort5551Type=1018,e.UnsignedShort565Type=1019,e.UnsignedInt248Type=qe,e.AlphaFormat=1021,e.RGBFormat=Xe,e.RGBAFormat=Ze,e.LuminanceFormat=1024,e.LuminanceAlphaFormat=1025,e.RGBEFormat=c,e.DepthFormat=Ye,e.DepthStencilFormat=Ke,e.RGB_S3TC_DXT1_Format=2001,e.RGBA_S3TC_DXT1_Format=2002,e.RGBA_S3TC_DXT3_Format=2003,e.RGBA_S3TC_DXT5_Format=2004,e.RGB_PVRTC_4BPPV1_Format=2100,e.RGB_PVRTC_2BPPV1_Format=2101,e.RGBA_PVRTC_4BPPV1_Format=2102,e.RGBA_PVRTC_2BPPV1_Format=2103,e.RGB_ETC1_Format=2151,e.LoopOnce=2200,e.LoopRepeat=2201,e.LoopPingPong=2202,e.InterpolateDiscrete=h,e.InterpolateLinear=u,e.InterpolateSmooth=2302,e.ZeroCurvatureEnding=d,e.ZeroSlopeEnding=p,e.WrapAroundEnding=f,e.TrianglesDrawMode=Je,e.TriangleStripDrawMode=1,e.TriangleFanDrawMode=2,e.LinearEncoding=m,e.sRGBEncoding=g,e.GammaEncoding=v,e.RGBEEncoding=y,e.LogLuvEncoding=3003,e.RGBM7Encoding=b,e.RGBM16Encoding=x,e.RGBDEncoding=w,e.BasicDepthPacking=_,e.RGBADepthPacking=be,e.CubeGeometry=ar,e.Face4=function(e,t,i,n,r,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new on(e,t,i,r,o,a)},e.LineStrip=0,e.LinePieces=1,e.MeshFaceMaterial=function(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e},e.MultiMaterial=function(e){return void 0===e&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,(e.materials=e).clone=function(){return e.slice()},e},e.PointCloud=function(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new xo(e,t)},e.Particle=function(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new co(e)},e.ParticleSystem=function(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new xo(e,t)},e.PointCloudMaterial=function(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new bo(e)},e.ParticleBasicMaterial=function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new bo(e)},e.ParticleSystemMaterial=function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new bo(e)},e.Vertex=function(e,t,i){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new rt(e,t,i)},e.DynamicBufferAttribute=function(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new qn(e,t).setDynamic(!0)},e.Int8Attribute=function(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Xn(e,t)},e.Uint8Attribute=function(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Zn(e,t)},e.Uint8ClampedAttribute=function(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Yn(e,t)},e.Int16Attribute=function(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Kn(e,t)},e.Uint16Attribute=function(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Jn(e,t)},e.Int32Attribute=function(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Qn(e,t)},e.Uint32Attribute=function(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new er(e,t)},e.Float32Attribute=function(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new tr(e,t)},e.Float64Attribute=function(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new ir(e,t)},e.ClosedSplineCurve3=bc,e.SplineCurve3=xc,e.Spline=wc,e.BoundingBoxHelper=function(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new rc(e,t)},e.EdgesHelper=function(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new vo(new ra(e.geometry),new mo({color:void 0!==t?t:16777215}))},e.WireframeHelper=function(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new vo(new So(e.geometry),new mo({color:void 0!==t?t:16777215}))},e.XHRLoader=function(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Ma(e)},e.BinaryTextureLoader=function(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Ca(e)},e.GeometryUtils=_c,e.ImageUtils=Ec,e.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},e.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},Object.defineProperty(e,"__esModule",{value:!0})}),THREE.Object3D.prototype.getDescendants=function(e){void 0===e&&(e=[]),Array.prototype.push.apply(e,this.children);for(var t=0,i=this.children.length;t<i;t++)this.children[t].getDescendants(e);return e},THREE.ColladaLoader=function(){var _,l,c,h,a,s,p,B,F,t,u=null,d=null,f=null,P={},m={},E={},U={},$={},z={},j={},V={},G={},g=THREE.SmoothShading,W={centerGeometry:!1,convertUpAxis:!1,subdivideFaces:!0,upAxis:"Y",defaultEnvMap:null},v=1,y="Y",b=null;function x(e,t,i){if(u=(new DOMParser).parseFromString(e,"text/xml"),t=t||f,void 0!==i){var n=i.split("/");n.pop(),p=(n.length<1?".":n.join("/"))+"/"}!function(){var e=u.querySelectorAll("asset")[0];if(e&&e.childNodes)for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];switch(i.nodeName){case"unit":var n=i.getAttribute("meter");n&&(v=parseFloat(n));break;case"up_axis":y=i.textContent.charAt(0)}}}(),function(){if(!0!==W.convertUpAxis||y===W.upAxis)b=null;else switch(y){case"X":b="Y"===W.upAxis?"XtoY":"XtoZ";break;case"Y":b="X"===W.upAxis?"YtoX":"YtoZ";break;case"Z":b="X"===W.upAxis?"ZtoX":"ZtoY"}}(),m=w("library_images image",A,"image"),z=w("library_materials material",ae,"material"),j=w("library_effects effect",ue,"effect"),$=w("library_geometries geometry",H,"geometry"),V=w("library_cameras camera",ge,"camera"),G=w("library_lights light",ye,"light"),U=w("library_controllers controller",L,"controller"),E=w("library_animations animation",de,"animation"),a=w("library_visual_scenes visual_scene",O,"visual_scene"),s=w("library_kinematics_models kinematics_model",xe,"kinematics_model"),B=[],F=[],_=function(){var e=u.querySelectorAll("scene instance_visual_scene")[0];{if(e){var t=e.getAttribute("url").replace(/^#/,"");return a[0<t.length?t:"visual_scene0"]}return null}}(),d=new THREE.Group;for(var r=0;r<_.nodes.length;r++)d.add(Z(_.nodes[r]));d.scale.multiplyScalar(v),c=[],function e(t){var i=_.getChildById(t.colladaId,!0),n=null;if(i&&i.keys){n={fps:60,hierarchy:[{node:i,keys:i.keys,sids:i.sids}],node:t,name:"animation_"+t.name,length:0},c.push(n);for(var r=0,o=i.keys.length;r<o;r++)n.length=Math.max(n.length,i.keys[r].time)}else n={hierarchy:[{keys:[],sids:[]}]};for(var r=0,o=t.children.length;r<o;r++)for(var a=e(t.children[r]),s=0,l=a.hierarchy.length;s<l;s++)n.hierarchy.push({keys:[],sids:[]});return n}(d),l=function(){var e=u.querySelectorAll("instance_kinematics_model")[0];{if(e){var t=e.getAttribute("url").replace(/^#/,"");return s[0<t.length?t:"kinematics_model0"]}return null}}(),function(){if(l&&0===l.joints.length)return h=void 0;var p={},e=function(t,e){var i=e.getAttribute("id"),n=_.getChildById(i,!0),r=l.joints[t];d.traverse(function(e){e.colladaId==i&&(p[t]={node:e,transforms:n.transforms,joint:r,position:r.zeroPosition})})};h={joints:l&&l.joints,getJointValue:function(e){var t=p[e];if(t)return t.position;console.log("getJointValue: joint "+e+" doesn't exist")},setJointValue:function(e,t){var i=p[e];if(i){var n=i.joint;if(t>n.limits.max||t<n.limits.min)console.log("setJointValue: joint "+e+" value "+t+" outside of limits (min: "+n.limits.min+", max: "+n.limits.max+")");else if(n.static)console.log("setJointValue: joint "+e+" is static");else{var r=i.node,o=n.axis,a=i.transforms,s=new THREE.Matrix4,l=new THREE.Matrix4;for(f=0;f<a.length;f++){var c=a[f];if(c.sid&&-1!==c.sid.indexOf("joint"+e))switch(n.type){case"revolute":s.multiply(l.makeRotationAxis(o,THREE.Math.degToRad(t)));break;case"prismatic":s.multiply(l.makeTranslation(o.x*t,o.y*t,o.z*t));break;default:console.warn("setJointValue: unknown joint type: "+n.type)}else switch(c.type){case"matrix":s.multiply(c.obj);break;case"translate":s.multiply(l.makeTranslation(c.obj.x,c.obj.y,c.obj.z));break;case"rotate":s.multiply(l.makeRotationAxis(c.obj,c.angle))}}var h=s.elements,u=Array.prototype.slice.call(h),d=[u[0],u[4],u[8],u[12],u[1],u[5],u[9],u[13],u[2],u[6],u[10],u[14],u[3],u[7],u[11],u[15]];r.matrix.set.apply(r.matrix,d),r.matrix.decompose(r.position,r.quaternion,r.scale),p[e].position=t}}else console.log("setJointValue: joint "+e+" doesn't exist")}};var t=u.querySelector("scene instance_kinematics_scene");if(t)for(var f=0;f<t.childNodes.length;f++){var i=t.childNodes[f];if(1==i.nodeType)switch(i.nodeName){case"bind_joint_axis":var n=i.getAttribute("target").split("/").pop(),r=i.querySelector("axis param").textContent,o=parseInt(r.split("joint").pop().split(".")[0]),a=u.querySelector('[sid="'+n+'"]');if(a){var s=a.parentElement;e(o,s)}}}}();var o={scene:d,morphs:B,skins:F,animations:c,kinematics:h,dae:{images:m,materials:z,cameras:V,lights:G,effects:j,geometries:$,controllers:U,animations:E,visualScenes:a,visualScene:_,scene:_,kinematicsModels:s,kinematicsModel:l}};return t&&t(o),o}function w(e,t,i){for(var n=u.querySelectorAll(e),r={},o=0,a=n.length,s=0;s<a;s++){var l=n[s],c=(new t).parse(l);c.id&&0!==c.id.length||(c.id=i+o++),r[c.id]=c}return r}function q(e,t){var i=t instanceof k?U[t.url]:t;if(i&&i.morph){for(var n=i.morph,r=0;r<n.targets.length;r++){var o=n.targets[r],a=$[o];if(a.mesh&&a.mesh.primitives&&a.mesh.primitives.length){var s=a.mesh.primitives[0].geometry;s.vertices.length===e.vertices.length&&e.morphTargets.push({name:"target_1",vertices:s.vertices})}}e.morphTargets.push({name:"target_Z",vertices:e.vertices})}else console.log("could not find morph controller!")}function T(e,t,i,n){if(e.world=e.world||new THREE.Matrix4,e.localworld=e.localworld||new THREE.Matrix4,e.world.copy(e.matrix),e.localworld.copy(e.matrix),e.channels&&e.channels.length){var r=e.channels[0].sampler.output[i];r instanceof THREE.Matrix4&&(e.world.copy(r),e.localworld.copy(r),0===i&&e.matrix.copy(r))}n&&e.world.multiplyMatrices(n,e.world),t.push(e);for(var o=0;o<e.nodes.length;o++)T(e.nodes[o],t,i,e.world)}function M(e,t){for(var i=0;i<e.length;i++){var n=e[i],r=-1;if("JOINT"==n.type){for(var o=0;o<t.joints.length;o++)if(n.sid===t.joints[o]){r=o;break}if(0<=r){var a=t.invBindMatrices[r];n.invBindMatrix=a,n.skinningMatrix=new THREE.Matrix4,n.skinningMatrix.multiplyMatrices(n.world,a),n.animatrix=new THREE.Matrix4,n.animatrix.copy(n.localworld),n.weights=[];for(o=0;o<t.weights.length;o++)for(var s=0;s<t.weights[o].length;s++){var l=t.weights[o][s];l.joint===r&&n.weights.push(l)}}else console.warn("ColladaLoader: Could not find joint '"+n.sid+"'."),n.skinningMatrix=new THREE.Matrix4,n.weights=[]}}}function X(e,t,i){void 0===i&&(i=40);var n=U[t.url];if(n&&n.skin)if(t.skeleton&&t.skeleton.length){for(var r,a,o=function(){var e,t=1e6,i=-t,n=0;for(var r in E){var o=E[r];e=e||o.id;for(var a=0;a<o.sampler.length;a++){var s=o.sampler[a];s.create(),t=Math.min(t,s.startTime),i=Math.max(i,s.endTime),n=Math.max(n,s.input.length)}}return{start:t,end:i,frames:n,ID:e}}(),s=_.getChildById(t.skeleton[0],!0)||_.getChildBySid(t.skeleton[0],!0),l=((a=function(e,t,i){var n={};n.name=t.sid,n.parent=e,n.matrix=t.matrix;var r=[new THREE.Vector3,new THREE.Quaternion,new THREE.Vector3];for(var o in n.matrix.decompose(r[0],r[1],r[2]),n.pos=[r[0].x,r[0].y,r[0].z],n.scl=[r[2].x,r[2].y,r[2].z],n.rotq=[r[1].x,r[1].y,r[1].z,r[1].w],i.push(n),t.nodes)a(t.sid,t.nodes[o],i)})(-1,s,r=[]),r),c=n.skin.joints,h=[],u=0;u<c.length;u++)for(var d=0;d<l.length;d++)l[d].name===c[u]&&(h[u]=l[d]);for(var u=0;u<h.length;u++)for(var d=0;d<h.length;d++)h[u].parent===h[d].name&&(h[u].parent=d);new THREE.Vector3;for(u=0;u<e.vertices.length;u++)e.vertices[u].applyMatrix4(n.skin.bindShapeMatrix);var p=[],f=[],m=n.skin.weights;for(u=0;u<m.length;u++){var g=new THREE.Vector4(m[u][0]?m[u][0].joint:0,m[u][1]?m[u][1].joint:0,m[u][2]?m[u][2].joint:0,m[u][3]?m[u][3].joint:0),v=new THREE.Vector4(m[u][0]?m[u][0].weight:0,m[u][1]?m[u][1].weight:0,m[u][2]?m[u][2].weight:0,m[u][3]?m[u][3].weight:0);p.push(g),f.push(v)}e.skinIndices=p,e.skinWeights=f,e.bones=h;var y={name:o.ID,fps:30,length:o.frames/30,hierarchy:[]};for(d=0;d<h.length;d++)y.hierarchy.push({parent:h[d].parent,name:h[d].name,keys:[]});for(console.log("ColladaLoader:",o.ID+" has "+h.length+" bones."),function(e,t,i){var n=[];T(t,n,-1),M(n,i.skin);for(var r=new THREE.Vector3,o=[],a=0;a<e.vertices.length;a++)o.push(new THREE.Vector3);for(a=0;a<n.length;a++)if("JOINT"==n[a].type)for(var s=0;s<n[a].weights.length;s++){var l=n[a].weights[s],c=l.index,h=l.weight,u=e.vertices[c],d=o[c];r.x=u.x,r.y=u.y,r.z=u.z,r.applyMatrix4(n[a].skinningMatrix),d.x+=r.x*h,d.y+=r.y*h,d.z+=r.z*h}for(a=0;a<e.vertices.length;a++)e.vertices[a]=o[a]}(e,s,n),i=0;i<o.frames;i++){var b=[];T(s,b,i),M(b,n.skin);for(u=0;u<b.length;u++)for(d=0;d<y.hierarchy.length;d++)if(y.hierarchy[d].name===b[u].sid){var x={};x.time=i/30,x.matrix=b[u].animatrix,0===i&&(b[u].matrix=x.matrix);var w=[new THREE.Vector3,new THREE.Quaternion,new THREE.Vector3];x.matrix.decompose(w[0],w[1],w[2]),x.pos=[w[0].x,w[0].y,w[0].z],x.scl=[w[2].x,w[2].y,w[2].z],x.rot=w[1],y.hierarchy[d].keys.push(x)}e.animation=y}}else console.log("ColladaLoader: Could not find the skeleton for the skin. ");else console.log("ColladaLoader: Could not find skin controller.")}function Z(e,t){var i,n,r,o,a=new THREE.Object3D;for(r=0;r<e.controllers.length;r++){var s=U[e.controllers[r].url];switch(s.type){case"skin":if($[s.skin.source])(c=new Y).url=s.skin.source,c.instance_material=e.controllers[r].instance_material,e.geometries.push(c),!0,i=e.controllers[r];else if(U[s.skin.source]){var l=U[s.skin.source];if((n=l).morph&&$[l.morph.source])(c=new Y).url=l.morph.source,c.instance_material=e.controllers[r].instance_material,e.geometries.push(c)}break;case"morph":var c;if($[s.morph.source])(c=new Y).url=s.morph.source,c.instance_material=e.controllers[r].instance_material,e.geometries.push(c),n=e.controllers[r];console.log("ColladaLoader: Morph-controller partially supported.")}}var h={};for(r=0;r<e.geometries.length;r++){var u,d=e.geometries[r],p=d.instance_material,f=$[d.url],m={},g=[],v=0;if(f){if(!f.mesh||!f.mesh.primitives)continue;if(0===a.name.length&&(a.name=f.id),p)for(o=0;o<p.length;o++){var y=p[o],b=z[y.target],x=b.instance_effect.url,w=j[x].shader.material;if(f.doubleSided){if(!(y.symbol in h)){var _=w.clone();_.side=THREE.DoubleSide,h[y.symbol]=_}w=h[y.symbol]}w.opacity=w.opacity?w.opacity:1,m[y.symbol]=v,g.push(w),(u=w).name=null===b.name||""===b.name?b.id:b.name,v++}var E,T=u||new THREE.MeshLambertMaterial({color:14540253,side:f.doubleSided?THREE.DoubleSide:THREE.FrontSide}),M=f.mesh.geometry3js;if(1<v)for(T=new THREE.MultiMaterial(g),o=0;o<M.faces.length;o++){var S=M.faces[o];S.materialIndex=m[S.daeMaterial]}void 0!==i?(X(M,i),0<M.morphTargets.length?(T.morphTargets=!0,T.skinning=!1):(T.morphTargets=!1,T.skinning=!0),(E=new THREE.SkinnedMesh(M,T,!1)).name="skin_"+F.length,F.push(E)):void 0!==n?(q(M,n),T.morphTargets=!0,(E=new THREE.Mesh(M,T)).name="morph_"+B.length,B.push(E)):!0===M.isLineStrip?E=new THREE.Line(M):(E=new THREE.Mesh(M,T)).geometry.name=f.name,a.add(E)}}for(r=0;r<e.cameras.length;r++){var C=e.cameras[r],R=V[C.url],A=new THREE.PerspectiveCamera(R.yfov,parseFloat(R.aspect_ratio),parseFloat(R.znear),parseFloat(R.zfar));a.add(A)}for(r=0;r<e.lights.length;r++){var P=null,L=e.lights[r],O=G[L.url];if(O&&O.technique){var I=O.color.getHex(),D=O.intensity,k=O.distance,N=O.falloff_angle;switch(O.technique){case"directional":(P=new THREE.DirectionalLight(I,D,k)).position.set(0,0,1);break;case"point":P=new THREE.PointLight(I,D,k);break;case"spot":(P=new THREE.SpotLight(I,D,k,N)).position.set(0,0,1);break;case"ambient":P=new THREE.AmbientLight(I)}}P&&a.add(P)}if(a.name=e.name||e.id||"",a.colladaId=e.id||"",a.layer=e.layer||"",a.matrix=e.matrix,a.matrix.decompose(a.position,a.quaternion,a.scale),W.centerGeometry&&a.geometry){var H=a.geometry.center();H.multiply(a.scale),H.applyQuaternion(a.quaternion),a.position.sub(H)}for(r=0;r<e.nodes.length;r++)a.add(Z(e.nodes[r],e));return a}function r(e){for(var t=u.querySelectorAll("library_nodes node"),i=0;i<t.length;i++){var n=t[i].attributes.getNamedItem("id");if(n&&n.value===e)return t[i]}}function S(e,t){for(var i=null,n=0,r=e.length;n<r&&null===i;n++){var o=e[n];if(o.time===t)i=o;else if(o.time>t)break}return i}function C(e,t){for(var i=-1,n=0,r=e.length;n<r&&-1===i;n++){e[n].time>=t&&(i=n)}return i}function R(e,t,i,n){var r=function(e,t,i){for(i=0<=i?i:i+e.length;0<=i;i--){var n=e[i];if(n.hasTarget(t))return n}return null}(e,n,i?i-1:0),o=function(e,t,i){for(;i<e.length;i++){var n=e[i];if(n.hasTarget(t))return n}return null}(e,n,i+1);if(r&&o){var a,s=(t.time-r.time)/(o.time-r.time),l=r.getTarget(n),c=o.getTarget(n).data,h=l.data;if("matrix"===l.type)a=h;else if(h.length){a=[];for(var u=0;u<h.length;++u)a[u]=h[u]+(c[u]-h[u])*s}else a=h+(c-h)*s;t.addTarget(n,l.transform,l.member,a)}}function A(){this.id="",this.init_from=""}function L(){this.id="",this.name="",this.type="",this.skin=null,this.morph=null}function n(){this.method=null,this.source=null,this.targets=null,this.weights=null}function o(){this.source="",this.bindShapeMatrix=null,this.invBindMatrices=[],this.joints=[],this.weights=[]}function O(){this.id="",this.name="",this.nodes=[],this.scene=new THREE.Group}function I(){this.id="",this.name="",this.sid="",this.nodes=[],this.controllers=[],this.transforms=[],this.geometries=[],this.channels=[],this.matrix=new THREE.Matrix4}function D(){this.sid="",this.type="",this.data=[],this.obj=null}function k(){this.url="",this.skeleton=[],this.instance_material=[]}function N(){this.symbol="",this.target=""}function Y(){this.url="",this.instance_material=[]}function H(){this.id="",this.name="",this.mesh=null}function K(e){this.geometry=e.id,this.primitives=[],this.vertices=null,this.geometry3js=null}function J(){this.material="",this.count=0,this.inputs=[],this.vcount=null,this.p=[],this.geometry=new THREE.Geometry}function Q(){J.call(this),this.vcount=[]}function ee(){J.call(this),this.vcount=1}function te(){J.call(this),this.vcount=3}function ie(){this.source="",this.count=0,this.stride=0,this.params=[]}function ne(){this.input={}}function re(){this.semantic="",this.offset=0,this.source="",this.set=0}function oe(e){this.id=e,this.type=null}function ae(){this.id="",this.name="",this.instance_effect=null}function se(){this.color=new THREE.Color,this.color.setRGB(Math.random(),Math.random(),Math.random()),this.color.a=1,this.texture=null,this.texcoord=null,this.texOpts=null}function le(e,t){this.type=e,this.effect=t,this.material=null}function ce(e){this.effect=e,this.init_from=null,this.format=null}function he(e){this.effect=e,this.source=null,this.wrap_s=null,this.wrap_t=null,this.minfilter=null,this.magfilter=null,this.mipfilter=null}function ue(){this.id="",this.name="",this.shader=null,this.surface={},this.sampler={}}function i(){this.url=""}function de(){this.id="",this.name="",this.source={},this.sampler=[],this.channel=[]}function pe(e){this.animation=e,this.source="",this.target="",this.fullSid=null,this.sid=null,this.dotSyntax=null,this.arrSyntax=null,this.arrIndices=null,this.member=null}function fe(e){this.id="",this.animation=e,this.inputs=[],this.input=null,this.output=null,this.strideOut=null,this.interpolation=null,this.startTime=null,this.endTime=null,this.duration=0}function me(e){this.targets=[],this.time=e}function ge(){this.id="",this.name="",this.technique=""}function ve(){this.url=""}function ye(){this.id="",this.name="",this.technique=""}function be(){this.url=""}function xe(){this.id="",this.name="",this.joints=[],this.links=[]}function we(){this.sid="",this.name="",this.axis=new THREE.Vector3,this.limits={min:0,max:0},this.type="",this.static=!1,this.zeroPosition=0,this.middlePosition=0}function _e(){this.sid="",this.name="",this.transforms=[],this.attachments=[]}function Ee(){this.joint="",this.transforms=[],this.links=[]}function Te(e){var t=e.getAttribute("id");return null!=P[t]||(P[t]=new oe(t).parse(e)),P[t]}function Me(e){for(var t=Re(e),i=[],n=0,r=t.length;n<r;n++)i.push("true"===t[n]||"1"===t[n]);return i}function Se(e){for(var t=Re(e),i=[],n=0,r=t.length;n<r;n++)i.push(parseFloat(t[n]));return i}function Ce(e){for(var t=Re(e),i=[],n=0,r=t.length;n<r;n++)i.push(parseInt(t[n],10));return i}function Re(e){return 0<e.length?(t=e,t.replace(/^\s+/,"").replace(/\s+$/,"")).split(/\s+/):[];var t}function Ae(e,t,i){return e.hasAttribute(t)?parseInt(e.getAttribute(t),10):i}function Pe(t,e){var i=new THREE.ImageLoader;i.setCrossOrigin(""),i.load(e,function(e){t.image=e,t.needsUpdate=!0})}function Le(e,t){e.doubleSided=!1;var i=t.querySelectorAll("extra double_sided")[0];i&&i&&1===parseInt(i.textContent,10)&&(e.doubleSided=!0)}function Oe(e,t){if(!0===W.convertUpAxis&&y!==W.upAxis)switch(b){case"XtoY":var i=e[0];e[0]=t*e[1],e[1]=i;break;case"XtoZ":i=e[2];e[2]=e[1],e[1]=e[0],e[0]=i;break;case"YtoX":i=e[0];e[0]=e[1],e[1]=t*i;break;case"YtoZ":i=e[1];e[1]=t*e[2],e[2]=i;break;case"ZtoX":i=e[0];e[0]=e[1],e[1]=e[2],e[2]=i;break;case"ZtoY":i=e[1];e[1]=e[2],e[2]=t*i}}function Ie(e,t){var i=[e[t],e[t+1],e[t+2]];return Oe(i,-1),new THREE.Vector3(i[0],i[1],i[2])}function De(e){if(W.convertUpAxis){var t=[e[0],e[4],e[8]];Oe(t,-1),e[0]=t[0],e[4]=t[1],e[8]=t[2],Oe(t=[e[1],e[5],e[9]],-1),e[1]=t[0],e[5]=t[1],e[9]=t[2],Oe(t=[e[2],e[6],e[10]],-1),e[2]=t[0],e[6]=t[1],e[10]=t[2],Oe(t=[e[0],e[1],e[2]],-1),e[0]=t[0],e[1]=t[1],e[2]=t[2],Oe(t=[e[4],e[5],e[6]],-1),e[4]=t[0],e[5]=t[1],e[6]=t[2],Oe(t=[e[8],e[9],e[10]],-1),e[8]=t[0],e[9]=t[1],e[10]=t[2],Oe(t=[e[3],e[7],e[11]],-1),e[3]=t[0],e[7]=t[1],e[11]=t[2]}return(new THREE.Matrix4).set(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function ke(e){if(-1<e&&e<3){e={X:0,Y:1,Z:2}[e=Ne(["X","Y","Z"][e])]}return e}function Ne(e){if(W.convertUpAxis)switch(e){case"X":switch(b){case"XtoY":case"XtoZ":case"YtoX":e="Y";break;case"ZtoX":e="Z"}break;case"Y":switch(b){case"XtoY":case"YtoX":case"ZtoX":e="X";break;case"XtoZ":case"YtoZ":case"ZtoY":e="Z"}break;case"Z":switch(b){case"XtoZ":e="X";break;case"YtoZ":case"ZtoX":case"ZtoY":e="Y"}}return e}return A.prototype.parse=function(e){this.id=e.getAttribute("id");for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];"init_from"===i.nodeName&&(this.init_from=i.textContent)}return this},L.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),this.type="none";for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];switch(i.nodeName){case"skin":this.skin=(new o).parse(i),this.type=i.nodeName;break;case"morph":this.morph=(new n).parse(i),this.type=i.nodeName}}return this},n.prototype.parse=function(e){var t,i={},n=[];for(this.method=e.getAttribute("method"),this.source=e.getAttribute("source").replace(/^#/,""),t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(1==r.nodeType)switch(r.nodeName){case"source":i[(a=(new oe).parse(r)).id]=a;break;case"targets":n=this.parseInputs(r);break;default:console.log(r.nodeName)}}for(t=0;t<n.length;t++){var o=n[t],a=i[o.source];switch(o.semantic){case"MORPH_TARGET":this.targets=a.read();break;case"MORPH_WEIGHT":this.weights=a.read()}}return this},n.prototype.parseInputs=function(e){for(var t=[],i=0;i<e.childNodes.length;i++){var n=e.childNodes[i];if(1==n.nodeType)switch(n.nodeName){case"input":t.push((new re).parse(n))}}return t},o.prototype.parse=function(e){var t,i,n={};this.source=e.getAttribute("source").replace(/^#/,""),this.invBindMatrices=[],this.joints=[],this.weights=[];for(var r=0;r<e.childNodes.length;r++){var o=e.childNodes[r];if(1==o.nodeType)switch(o.nodeName){case"bind_shape_matrix":var a=Se(o.textContent);this.bindShapeMatrix=De(a);break;case"source":var s=(new oe).parse(o);n[s.id]=s;break;case"joints":t=o;break;case"vertex_weights":i=o;break;default:console.log(o.nodeName)}}return this.parseJoints(t,n),this.parseWeights(i,n),this},o.prototype.parseJoints=function(e,t){for(var i=0;i<e.childNodes.length;i++){var n=e.childNodes[i];if(1==n.nodeType)switch(n.nodeName){case"input":var r=(new re).parse(n),o=t[r.source];"JOINT"===r.semantic?this.joints=o.read():"INV_BIND_MATRIX"===r.semantic&&(this.invBindMatrices=o.read())}}},o.prototype.parseWeights=function(e,t){for(var i,n,r=[],o=0;o<e.childNodes.length;o++){var a=e.childNodes[o];if(1==a.nodeType)switch(a.nodeName){case"input":r.push((new re).parse(a));break;case"v":i=Ce(a.textContent);break;case"vcount":n=Ce(a.textContent)}}var s=0;for(o=0;o<n.length;o++){for(var l=n[o],c=[],h=0;h<l;h++){for(var u={},d=0;d<r.length;d++){var p=r[d],f=i[s+p.offset];switch(p.semantic){case"JOINT":u.joint=f;break;case"WEIGHT":u.weight=t[p.source].data[f]}}c.push(u),s+=r.length}for(h=0;h<c.length;h++)c[h].index=o;this.weights.push(c)}},O.prototype.getChildById=function(e,t){for(var i=0;i<this.nodes.length;i++){var n=this.nodes[i].getChildById(e,t);if(n)return n}return null},O.prototype.getChildBySid=function(e,t){for(var i=0;i<this.nodes.length;i++){var n=this.nodes[i].getChildBySid(e,t);if(n)return n}return null},O.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),this.nodes=[];for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"node":this.nodes.push((new I).parse(i))}}return this},I.prototype.getChannelForTransform=function(e){for(var t=0;t<this.channels.length;t++){var i,n=this.channels[t],r=n.target.split("/"),o=(r.shift(),r.shift()),a=0<=o.indexOf("."),s=0<=o.indexOf("(");if(a)o=(r=o.split(".")).shift();else if(s){o=(i=o.split("(")).shift();for(var l=0;l<i.length;l++)i[l]=parseInt(i[l].replace(/\)/,""))}if(o===e)return n.info={sid:o,dotSyntax:a,arrSyntax:s,arrIndices:i},n}return null},I.prototype.getChildById=function(e,t){if(this.id===e)return this;if(t)for(var i=0;i<this.nodes.length;i++){var n=this.nodes[i].getChildById(e,t);if(n)return n}return null},I.prototype.getChildBySid=function(e,t){if(this.sid===e)return this;if(t)for(var i=0;i<this.nodes.length;i++){var n=this.nodes[i].getChildBySid(e,t);if(n)return n}return null},I.prototype.getTransformBySid=function(e){for(var t=0;t<this.transforms.length;t++)if(this.transforms[t].sid===e)return this.transforms[t];return null},I.prototype.parse=function(e){this.id=e.getAttribute("id"),this.sid=e.getAttribute("sid"),this.name=e.getAttribute("name"),this.type=e.getAttribute("type"),this.layer=e.getAttribute("layer"),this.type="JOINT"===this.type?this.type:"NODE",this.nodes=[],this.transforms=[],this.geometries=[],this.cameras=[],this.lights=[],this.controllers=[],this.matrix=new THREE.Matrix4;for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"node":this.nodes.push((new I).parse(i));break;case"instance_camera":this.cameras.push((new ve).parse(i));break;case"instance_controller":this.controllers.push((new k).parse(i));break;case"instance_geometry":this.geometries.push((new Y).parse(i));break;case"instance_light":this.lights.push((new be).parse(i));break;case"instance_node":var n=r(i.getAttribute("url").replace(/^#/,""));n&&this.nodes.push((new I).parse(n));break;case"rotate":case"translate":case"scale":case"matrix":case"lookat":case"skew":this.transforms.push((new D).parse(i));break;case"extra":break;default:console.log(i.nodeName)}}return this.channels=function(e){var t=[],i=1e6,n=-1e6;for(var r in E)for(var o=E[r],a=0;a<o.channel.length;a++){var s=o.channel[a],l=o.sampler[a];(r=s.target.split("/")[0])==e.id&&(l.create(),s.sampler=l,i=Math.min(i,l.startTime),n=Math.max(n,l.endTime),t.push(s))}return t.length&&(e.startTime=i,e.endTime=n),t}(this),function(e){if(e.channels&&e.channels.length){for(var t=[],i=[],n=0,r=e.channels.length;n<r;n++){var o,a=e.channels[n],s=a.fullSid,l=a.sampler,c=l.input,h=e.getTransformBySid(a.sid);if(a.arrIndices){o=[];for(var u=0,d=a.arrIndices.length;u<d;u++)o[u]=ke(a.arrIndices[u])}else o=Ne(a.member);if(h)for(-1===i.indexOf(s)&&i.push(s),u=0,d=c.length;u<d;u++){var p=c[u],f=l.getData(h.type,u,o);if(!(v=S(t,p))){v=new me(p);var m=C(t,p);t.splice(-1===m?t.length:m,0,v)}v.addTarget(s,h,o,f)}else console.log('Could not find transform "'+a.sid+'" in node '+e.id)}for(n=0;n<i.length;n++){var g=i[n];for(u=0;u<t.length;u++){var v;(v=t[u]).hasTarget(g)||R(t,v,u,g)}}e.keys=t,e.sids=i}}(this),this.updateMatrix(),this},I.prototype.updateMatrix=function(){this.matrix.identity();for(var e=0;e<this.transforms.length;e++)this.transforms[e].apply(this.matrix)},D.prototype.parse=function(e){return this.sid=e.getAttribute("sid"),this.type=e.nodeName,this.data=Se(e.textContent),this.convert(),this},D.prototype.convert=function(){switch(this.type){case"matrix":this.obj=De(this.data);break;case"rotate":this.angle=THREE.Math.degToRad(this.data[3]);case"translate":Oe(this.data,-1),this.obj=new THREE.Vector3(this.data[0],this.data[1],this.data[2]);break;case"scale":Oe(this.data,1),this.obj=new THREE.Vector3(this.data[0],this.data[1],this.data[2]);break;default:console.log("Can not convert Transform of type "+this.type)}},D.prototype.apply=(t=new THREE.Matrix4,function(e){switch(this.type){case"matrix":e.multiply(this.obj);break;case"translate":e.multiply(t.makeTranslation(this.obj.x,this.obj.y,this.obj.z));break;case"rotate":e.multiply(t.makeRotationAxis(this.obj,this.angle));break;case"scale":e.scale(this.obj)}}),D.prototype.update=function(e,t){var i=["X","Y","Z","ANGLE"];switch(this.type){case"matrix":if(t)if(1===t.length)switch(t[0]){case 0:this.obj.n11=e[0],this.obj.n21=e[1],this.obj.n31=e[2],this.obj.n41=e[3];break;case 1:this.obj.n12=e[0],this.obj.n22=e[1],this.obj.n32=e[2],this.obj.n42=e[3];break;case 2:this.obj.n13=e[0],this.obj.n23=e[1],this.obj.n33=e[2],this.obj.n43=e[3];break;case 3:this.obj.n14=e[0],this.obj.n24=e[1],this.obj.n34=e[2],this.obj.n44=e[3]}else if(2===t.length){var n="n"+(t[0]+1)+(t[1]+1);this.obj[n]=e}else console.log("Incorrect addressing of matrix in transform.");else this.obj.copy(e);break;case"translate":case"scale":switch("[object Array]"===Object.prototype.toString.call(t)&&(t=i[t[0]]),t){case"X":this.obj.x=e;break;case"Y":this.obj.y=e;break;case"Z":this.obj.z=e;break;default:this.obj.x=e[0],this.obj.y=e[1],this.obj.z=e[2]}break;case"rotate":switch("[object Array]"===Object.prototype.toString.call(t)&&(t=i[t[0]]),t){case"X":this.obj.x=e;break;case"Y":this.obj.y=e;break;case"Z":this.obj.z=e;break;case"ANGLE":this.angle=THREE.Math.degToRad(e);break;default:this.obj.x=e[0],this.obj.y=e[1],this.obj.z=e[2],this.angle=THREE.Math.degToRad(e[3])}}},k.prototype.parse=function(e){this.url=e.getAttribute("url").replace(/^#/,""),this.skeleton=[],this.instance_material=[];for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1===i.nodeType)switch(i.nodeName){case"skeleton":this.skeleton.push(i.textContent.replace(/^#/,""));break;case"bind_material":for(var n=i.querySelectorAll("instance_material"),r=0;r<n.length;r++){var o=n[r];this.instance_material.push((new N).parse(o))}}}return this},N.prototype.parse=function(e){return this.symbol=e.getAttribute("symbol"),this.target=e.getAttribute("target").replace(/^#/,""),this},Y.prototype.parse=function(e){this.url=e.getAttribute("url").replace(/^#/,""),this.instance_material=[];for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType&&"bind_material"===i.nodeName){for(var n=i.querySelectorAll("instance_material"),r=0;r<n.length;r++){var o=n[r];this.instance_material.push((new N).parse(o))}break}}return this},H.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),Le(this,e);for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];switch(i.nodeName){case"mesh":this.mesh=new K(this).parse(i)}}return this},K.prototype.parse=function(e){this.primitives=[];for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];switch(i.nodeName){case"source":Te(i);break;case"vertices":this.vertices=(new ne).parse(i);break;case"linestrips":this.primitives.push((new ee).parse(i));break;case"triangles":this.primitives.push((new te).parse(i));break;case"polygons":this.primitives.push((new J).parse(i));break;case"polylist":this.primitives.push((new Q).parse(i))}}if(this.geometry3js=new THREE.Geometry,null===this.vertices)return this;var n=P[this.vertices.input.POSITION.source].data;for(t=0;t<n.length;t+=3)this.geometry3js.vertices.push(Ie(n,t).clone());for(t=0;t<this.primitives.length;t++){var r=this.primitives[t];r.setVertices(this.vertices),this.handlePrimitive(r,this.geometry3js)}return this.geometry3js.calcNormals&&(this.geometry3js.computeVertexNormals(),delete this.geometry3js.calcNormals),this},K.prototype.handlePrimitive=function(e,t){if(e instanceof ee)t.isLineStrip=!0;else{var i,n,r,o,a,s,l,c,h=e.p,u=e.inputs,d=0,p=0,f=[];for(i=0;i<u.length;i++){var m=(r=u[i]).offset+1;switch(p=p<m?m:p,r.semantic){case"TEXCOORD":f.push(r.set)}}for(var g=0;g<h.length;++g)for(var v=h[g],y=0;y<v.length;){var b=[],x=[],w=null,_=[];for(c=e.vcount?e.vcount.length?e.vcount[d++]:e.vcount:v.length/p,i=0;i<c;i++)for(n=0;n<u.length;n++)switch(r=u[n],s=P[r.source],a=(o=v[y+i*p+r.offset])*(l=s.accessor.params.length),r.semantic){case"VERTEX":b.push(o);break;case"NORMAL":x.push(Ie(s.data,a));break;case"TEXCOORD":void 0===(w=w||{})[r.set]&&(w[r.set]=[]),w[r.set].push(new THREE.Vector2(s.data[a],s.data[a+1]));break;case"COLOR":_.push((new THREE.Color).setRGB(s.data[a],s.data[a+1],s.data[a+2]))}if(0===x.length)if(r=this.vertices.input.NORMAL){l=(s=P[r.source]).accessor.params.length;for(var E=0,T=b.length;E<T;E++)x.push(Ie(s.data,b[E]*l))}else t.calcNormals=!0;if(!w&&(w={},r=this.vertices.input.TEXCOORD)){f.push(r.set),l=(s=P[r.source]).accessor.params.length;for(E=0,T=b.length;E<T;E++)a=b[E]*l,void 0===w[r.set]&&(w[r.set]=[]),w[r.set].push(new THREE.Vector2(s.data[a],1-s.data[a+1]))}if(0===_.length&&(r=this.vertices.input.COLOR)){l=(s=P[r.source]).accessor.params.length;for(E=0,T=b.length;E<T;E++)a=b[E]*l,_.push((new THREE.Color).setRGB(s.data[a],s.data[a+1],s.data[a+2]))}var M,S,C=null,R=[];if(3===c)R.push(new THREE.Face3(b[0],b[1],b[2],x,_.length?_:new THREE.Color));else if(4===c)R.push(new THREE.Face3(b[0],b[1],b[3],x.length?[x[0].clone(),x[1].clone(),x[3].clone()]:[],_.length?[_[0],_[1],_[3]]:new THREE.Color)),R.push(new THREE.Face3(b[1],b[2],b[3],x.length?[x[1].clone(),x[2].clone(),x[3].clone()]:[],_.length?[_[1],_[2],_[3]]:new THREE.Color));else if(4<c&&W.subdivideFaces){var A=_.length?_:new THREE.Color;for(n=1;n<c-1;)R.push(new THREE.Face3(b[0],b[n],b[n+1],x.length?[x[0].clone(),x[n++].clone(),x[n].clone()]:[],A))}if(R.length)for(E=0,T=R.length;E<T;E++)for((C=R[E]).daeMaterial=e.material,t.faces.push(C),n=0;n<f.length;n++)M=w[f[n]],S=4<c?[M[0],M[E+1],M[E+2]]:4===c?0===E?[M[0],M[1],M[3]]:[M[1].clone(),M[2],M[3].clone()]:[M[0],M[1],M[2]],void 0===t.faceVertexUvs[n]&&(t.faceVertexUvs[n]=[]),t.faceVertexUvs[n].push(S);else console.log("dropped face with vcount "+c+" for geometry with id: "+t.id);y+=p*c}}},J.prototype.setVertices=function(e){for(var t=0;t<this.inputs.length;t++)this.inputs[t].source===e.id&&(this.inputs[t].source=e.input.POSITION.source)},J.prototype.parse=function(e){this.material=e.getAttribute("material"),this.count=Ae(e,"count",0);for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];switch(i.nodeName){case"input":this.inputs.push((new re).parse(e.childNodes[t]));break;case"vcount":this.vcount=Ce(i.textContent);break;case"p":this.p.push(Ce(i.textContent));break;case"ph":console.warn("polygon holes not yet supported!")}}return this},(Q.prototype=Object.create(J.prototype)).constructor=Q,(ee.prototype=Object.create(J.prototype)).constructor=ee,(te.prototype=Object.create(J.prototype)).constructor=te,ie.prototype.parse=function(e){this.params=[],this.source=e.getAttribute("source"),this.count=Ae(e,"count",0),this.stride=Ae(e,"stride",0);for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if("param"===i.nodeName){var n={};n.name=i.getAttribute("name"),n.type=i.getAttribute("type"),this.params.push(n)}}return this},ne.prototype.parse=function(e){this.id=e.getAttribute("id");for(var t=0;t<e.childNodes.length;t++)if("input"===e.childNodes[t].nodeName){var i=(new re).parse(e.childNodes[t]);this.input[i.semantic]=i}return this},re.prototype.parse=function(e){return this.semantic=e.getAttribute("semantic"),this.source=e.getAttribute("source").replace(/^#/,""),this.set=Ae(e,"set",-1),this.offset=Ae(e,"offset",0),"TEXCOORD"===this.semantic&&this.set<0&&(this.set=0),this},oe.prototype.parse=function(e){this.id=e.getAttribute("id");for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];switch(i.nodeName){case"bool_array":this.data=Me(i.textContent),this.type=i.nodeName;break;case"float_array":this.data=Se(i.textContent),this.type=i.nodeName;break;case"int_array":this.data=Ce(i.textContent),this.type=i.nodeName;break;case"IDREF_array":case"Name_array":this.data=Re(i.textContent),this.type=i.nodeName;break;case"technique_common":for(var n=0;n<i.childNodes.length;n++)if("accessor"===i.childNodes[n].nodeName){this.accessor=(new ie).parse(i.childNodes[n]);break}}}return this},oe.prototype.read=function(){var e=[],t=this.accessor.params[0];switch(t.type){case"IDREF":case"Name":case"name":case"float":return this.data;case"float4x4":for(var i=0;i<this.data.length;i+=16){var n=De(this.data.slice(i,i+16));e.push(n)}break;default:console.log("ColladaLoader: Source: Read dont know how to read "+t.type+".")}return e},ae.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name");for(var t=0;t<e.childNodes.length;t++)if("instance_effect"===e.childNodes[t].nodeName){this.instance_effect=(new i).parse(e.childNodes[t]);break}return this},se.prototype.isColor=function(){return null===this.texture},se.prototype.isTexture=function(){return null!=this.texture},se.prototype.parse=function(e){"transparent"===e.nodeName&&(this.opaque=e.getAttribute("opaque"));for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"color":var n=Se(i.textContent);this.color=new THREE.Color,this.color.setRGB(n[0],n[1],n[2]),this.color.a=n[3];break;case"texture":this.texture=i.getAttribute("texture"),this.texcoord=i.getAttribute("texcoord"),this.texOpts={offsetU:0,offsetV:0,repeatU:1,repeatV:1,wrapU:1,wrapV:1},this.parseTexture(i)}}return this},se.prototype.parseTexture=function(e){if(!e.childNodes)return this;e.childNodes[1]&&"extra"===e.childNodes[1].nodeName&&(e=e.childNodes[1]).childNodes[1]&&"technique"===e.childNodes[1].nodeName&&(e=e.childNodes[1]);for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];switch(i.nodeName){case"offsetU":case"offsetV":case"repeatU":case"repeatV":this.texOpts[i.nodeName]=parseFloat(i.textContent);break;case"wrapU":case"wrapV":"TRUE"===i.textContent.toUpperCase()?this.texOpts[i.nodeName]=1:this.texOpts[i.nodeName]=parseInt(i.textContent);break;default:this.texOpts[i.nodeName]=i.textContent}}return this},le.prototype.parse=function(e){for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"emission":case"diffuse":case"specular":case"transparent":this[i.nodeName]=(new se).parse(i);break;case"bump":var n=i.getAttribute("bumptype");n?"heightfield"===n.toLowerCase()?this.bump=(new se).parse(i):"normalmap"===n.toLowerCase()?this.normal=(new se).parse(i):(console.error("Shader.prototype.parse: Invalid value for attribute 'bumptype' ("+n+") - valid bumptypes are 'HEIGHTFIELD' and 'NORMALMAP' - defaulting to 'HEIGHTFIELD'"),this.bump=(new se).parse(i)):(console.error("Shader.prototype.parse: Invalid value for attribute 'bumptype' ("+n+") - valid bumptypes are 'HEIGHTFIELD' and 'NORMALMAP' - defaulting to 'NORMALMAP'"),this.normal=(new se).parse(i));break;case"shininess":case"reflectivity":case"index_of_refraction":case"transparency":var r=i.querySelectorAll("float");0<r.length&&(this[i.nodeName]=parseFloat(r[0].textContent))}}return this.create(),this},le.prototype.create=function(){var e={},t=!1;if(void 0!==this.transparency&&void 0!==this.transparent){this.transparent;var i=(this.transparent.color.r+this.transparent.color.g+this.transparent.color.b)/3*this.transparency;0<i&&(t=!0,e.transparent=!0,e.opacity=1-i)}var n={diffuse:"map",ambient:"lightMap",specular:"specularMap",emission:"emissionMap",bump:"bumpMap",normal:"normalMap"};for(var r in this)switch(r){case"ambient":case"emission":case"diffuse":case"specular":case"bump":case"normal":var o=this[r];if(o instanceof se)if(o.isTexture()){var a=o.texture,s=this.effect.sampler[a],l=void 0;if(void 0!==s&&void 0!==s.source){var c=this.effect.surface[s.source];void 0!==c&&(l=m[c.init_from])}else l=m[a];if(l){var h,u=p+l.init_from,d=THREE.Loader.Handlers.get(u);null!==d?(d.crossOrigin="",h=d.load(u)):Pe(h=new THREE.Texture,u),s&&"MIRROR"===s.wrap_s?h.wrapS=THREE.MirroredRepeatWrapping:s&&"WRAP"===s.wrap_s||o.texOpts.wrapU?h.wrapS=THREE.RepeatWrapping:h.wrapS=THREE.ClampToEdgeWrapping,s&&"MIRROR"===s.wrap_t?h.wrapT=THREE.MirroredRepeatWrapping:s&&"WRAP"===s.wrap_t||o.texOpts.wrapV?h.wrapT=THREE.RepeatWrapping:h.wrapT=THREE.ClampToEdgeWrapping,h.offset.x=o.texOpts.offsetU,h.offset.y=o.texOpts.offsetV,h.repeat.x=o.texOpts.repeatU,h.repeat.y=o.texOpts.repeatV,e[n[r]]=h,"emission"===r&&(e.emissive=16777215)}}else"diffuse"!==r&&t||("emission"===r?e.emissive=o.color.getHex():e[r]=o.color.getHex());break;case"shininess":e[r]=this[r];break;case"reflectivity":e[r]=this[r],0<e[r]&&(e.envMap=W.defaultEnvMap),e.combine=THREE.MixOperation;break;case"index_of_refraction":e.refractionRatio=this[r],1!==this[r]&&(e.envMap=W.defaultEnvMap)}switch(e.shading=g,e.side=this.effect.doubleSided?THREE.DoubleSide:THREE.FrontSide,void 0!==e.diffuse&&(e.color=e.diffuse,delete e.diffuse),this.type){case"constant":null!=e.emissive&&(e.color=e.emissive),this.material=new THREE.MeshBasicMaterial(e);break;case"phong":case"blinn":this.material=new THREE.MeshPhongMaterial(e);break;case"lambert":default:void 0!==e.normalMap?this.material=new THREE.MeshPhongMaterial(e):this.material=new THREE.MeshLambertMaterial(e)}return this.material},ce.prototype.parse=function(e){for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"init_from":this.init_from=i.textContent;break;case"format":this.format=i.textContent;break;default:console.log("unhandled Surface prop: "+i.nodeName)}}return this},he.prototype.parse=function(e){for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"source":this.source=i.textContent;break;case"minfilter":this.minfilter=i.textContent;break;case"magfilter":this.magfilter=i.textContent;break;case"mipfilter":this.mipfilter=i.textContent;break;case"wrap_s":this.wrap_s=i.textContent;break;case"wrap_t":this.wrap_t=i.textContent;break;default:console.log("unhandled Sampler2D prop: "+i.nodeName)}}return this},ue.prototype.create=function(){if(null===this.shader)return null},ue.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),Le(this,e),this.shader=null;for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"profile_COMMON":this.parseTechnique(this.parseProfileCOMMON(i))}}return this},ue.prototype.parseNewparam=function(e){for(var t=e.getAttribute("sid"),i=0;i<e.childNodes.length;i++){var n=e.childNodes[i];if(1==n.nodeType)switch(n.nodeName){case"surface":this.surface[t]=new ce(this).parse(n);break;case"sampler2D":this.sampler[t]=new he(this).parse(n);break;case"extra":break;default:console.log(n.nodeName)}}},ue.prototype.parseProfileCOMMON=function(e){for(var t,i=0;i<e.childNodes.length;i++){var n=e.childNodes[i];if(1==n.nodeType)switch(n.nodeName){case"profile_COMMON":this.parseProfileCOMMON(n);break;case"technique":t=n;break;case"newparam":this.parseNewparam(n);break;case"image":var r=(new A).parse(n);m[r.id]=r;break;case"extra":break;default:console.log(n.nodeName)}}return t},ue.prototype.parseTechnique=function(e){for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"constant":case"lambert":case"blinn":case"phong":this.shader=new le(i.nodeName,this).parse(i);break;case"extra":this.parseExtra(i)}}},ue.prototype.parseExtra=function(e){for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"technique":this.parseExtraTechnique(i)}}},ue.prototype.parseExtraTechnique=function(e){for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"bump":this.shader.parse(e)}}},i.prototype.parse=function(e){return this.url=e.getAttribute("url").replace(/^#/,""),this},de.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),this.source={};for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"animation":var n=(new de).parse(i);for(var r in n.source)this.source[r]=n.source[r];for(var o=0;o<n.channel.length;o++)this.channel.push(n.channel[o]),this.sampler.push(n.sampler[o]);break;case"source":r=(new oe).parse(i);this.source[r.id]=r;break;case"sampler":this.sampler.push(new fe(this).parse(i));break;case"channel":this.channel.push(new pe(this).parse(i))}}return this},pe.prototype.parse=function(e){this.source=e.getAttribute("source").replace(/^#/,""),this.target=e.getAttribute("target");var t=this.target.split("/"),i=(t.shift(),t.shift()),n=0<=i.indexOf("."),r=0<=i.indexOf("(");if(n)t=i.split("."),this.sid=t.shift(),this.member=t.shift();else if(r){var o=i.split("(");this.sid=o.shift();for(var a=0;a<o.length;a++)o[a]=parseInt(o[a].replace(/\)/,""));this.arrIndices=o}else this.sid=i;return this.fullSid=i,this.dotSyntax=n,this.arrSyntax=r,this},fe.prototype.parse=function(e){this.id=e.getAttribute("id"),this.inputs=[];for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"input":this.inputs.push((new re).parse(i))}}return this},fe.prototype.create=function(){for(var e=0;e<this.inputs.length;e++){var t=this.inputs[e],i=this.animation.source[t.source];switch(t.semantic){case"INPUT":this.input=i.read();break;case"OUTPUT":this.output=i.read(),this.strideOut=i.accessor.stride;break;case"INTERPOLATION":this.interpolation=i.read();break;case"IN_TANGENT":case"OUT_TANGENT":break;default:console.log(t.semantic)}}if(this.startTime=0,this.endTime=0,this.duration=0,this.input.length){this.startTime=1e8,this.endTime=-1e8;for(e=0;e<this.input.length;e++)this.startTime=Math.min(this.startTime,this.input[e]),this.endTime=Math.max(this.endTime,this.input[e]);this.duration=this.endTime-this.startTime}},fe.prototype.getData=function(e,t,i){var n;if("matrix"===e&&16===this.strideOut)n=this.output[t];else if(1<this.strideOut){n=[],t*=this.strideOut;for(var r=0;r<this.strideOut;++r)n[r]=this.output[t+r];if(3===this.strideOut)switch(e){case"rotate":case"translate":Oe(n,-1);break;case"scale":Oe(n,1)}else 4===this.strideOut&&"matrix"===e&&Oe(n,-1)}else n=this.output[t],i&&"translate"===e&&(n=function(e,t){if(!0!==W.convertUpAxis||y===W.upAxis)return t;switch(e){case"X":t="XtoY"===b?-1*t:t;break;case"Y":t="YtoZ"===b||"YtoX"===b?-1*t:t;break;case"Z":t="ZtoY"===b?-1*t:t}return t}(i,n));return n},me.prototype.addTarget=function(e,t,i,n){this.targets.push({sid:e,member:i,transform:t,data:n})},me.prototype.apply=function(e){for(var t=0;t<this.targets.length;++t){var i=this.targets[t];e&&i.sid!==e||i.transform.update(i.data,i.member)}},me.prototype.getTarget=function(e){for(var t=0;t<this.targets.length;++t)if(this.targets[t].sid===e)return this.targets[t];return null},me.prototype.hasTarget=function(e){for(var t=0;t<this.targets.length;++t)if(this.targets[t].sid===e)return!0;return!1},me.prototype.interpolate=function(e,t){for(var i=0,n=this.targets.length;i<n;i++){var r,o=this.targets[i],a=e.getTarget(o.sid);if("matrix"!==o.transform.type&&a){var s=(t-this.time)/(e.time-this.time),l=a.data,c=o.data;if(s<0&&(s=0),1<s&&(s=1),c.length){r=[];for(var h=0;h<c.length;++h)r[h]=c[h]+(l[h]-c[h])*s}else r=c+(l-c)*s}else r=o.data;o.transform.update(r,o.member)}},ge.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name");for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"optics":this.parseOptics(i)}}return this},ge.prototype.parseOptics=function(e){for(var t=0;t<e.childNodes.length;t++)if("technique_common"===e.childNodes[t].nodeName)for(var i=e.childNodes[t],n=0;n<i.childNodes.length;n++)if(this.technique=i.childNodes[n].nodeName,"perspective"===this.technique)for(var r=i.childNodes[n],o=0;o<r.childNodes.length;o++){switch((s=r.childNodes[o]).nodeName){case"yfov":this.yfov=s.textContent;break;case"xfov":this.xfov=s.textContent;break;case"znear":this.znear=s.textContent;break;case"zfar":this.zfar=s.textContent;break;case"aspect_ratio":this.aspect_ratio=s.textContent}}else if("orthographic"===this.technique){var a=i.childNodes[n];for(o=0;o<a.childNodes.length;o++){var s;switch((s=a.childNodes[o]).nodeName){case"xmag":this.xmag=s.textContent;break;case"ymag":this.ymag=s.textContent;break;case"znear":this.znear=s.textContent;break;case"zfar":this.zfar=s.textContent;break;case"aspect_ratio":this.aspect_ratio=s.textContent}}}return this},ve.prototype.parse=function(e){return this.url=e.getAttribute("url").replace(/^#/,""),this},ye.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name");for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"technique_common":this.parseCommon(i);break;case"technique":this.parseTechnique(i)}}return this},ye.prototype.parseCommon=function(e){for(var t=0;t<e.childNodes.length;t++)switch(e.childNodes[t].nodeName){case"directional":case"point":case"spot":case"ambient":this.technique=e.childNodes[t].nodeName;for(var i=e.childNodes[t],n=0;n<i.childNodes.length;n++){var r=i.childNodes[n];switch(r.nodeName){case"color":var o=Se(r.textContent);this.color=new THREE.Color(0),this.color.setRGB(o[0],o[1],o[2]),this.color.a=o[3];break;case"falloff_angle":this.falloff_angle=parseFloat(r.textContent);break;case"quadratic_attenuation":var a=parseFloat(r.textContent);this.distance=a?Math.sqrt(1/a):0}}}return this},ye.prototype.parseTechnique=function(e){this.profile=e.getAttribute("profile");for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];switch(i.nodeName){case"intensity":this.intensity=parseFloat(i.textContent)}}return this},be.prototype.parse=function(e){return this.url=e.getAttribute("url").replace(/^#/,""),this},xe.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),this.joints=[],this.links=[];for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"technique_common":this.parseCommon(i)}}return this},xe.prototype.parseCommon=function(e){for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(e.childNodes[t].nodeName){case"joint":this.joints.push((new we).parse(i));break;case"link":this.links.push((new _e).parse(i))}}return this},we.prototype.parse=function(e){this.sid=e.getAttribute("sid"),this.name=e.getAttribute("name"),this.axis=new THREE.Vector3,this.limits={min:0,max:0},this.type="",this.static=!1,this.zeroPosition=0,this.middlePosition=0;var t=Se(e.querySelector("axis").textContent);this.axis=Ie(t,0);var i=e.querySelector("limits min")?parseFloat(e.querySelector("limits min").textContent):-360,n=e.querySelector("limits max")?parseFloat(e.querySelector("limits max").textContent):360;this.limits={min:i,max:n};for(var r=["prismatic","revolute"],o=0;o<r.length;o++){var a=r[o];e.querySelector(a)&&(this.type=a)}return this.limits.min>=this.limits.max&&(this.static=!0),this.middlePosition=(this.limits.min+this.limits.max)/2,this},_e.prototype.parse=function(e){this.sid=e.getAttribute("sid"),this.name=e.getAttribute("name"),this.transforms=[],this.attachments=[];for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"attachment_full":this.attachments.push((new Ee).parse(i));break;case"rotate":case"translate":case"matrix":this.transforms.push((new D).parse(i))}}return this},Ee.prototype.parse=function(e){this.joint=e.getAttribute("joint").split("/").pop(),this.links=[];for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"link":this.links.push((new _e).parse(i));break;case"rotate":case"translate":case"matrix":this.transforms.push((new D).parse(i))}}return this},{load:function(e,t,i,n){var r=0;if(document.implementation&&document.implementation.createDocument){var o=new XMLHttpRequest;o.onreadystatechange=function(){4===o.readyState?0===o.status||200===o.status?o.response?(f=t,x(o.response,void 0,e)):n?n({type:"error",url:e}):console.error("ColladaLoader: Empty or non-existing file ("+e+")"):n?n({type:"error",url:e}):console.error("ColladaLoader: Couldn't load \""+e+'" ('+o.status+")"):3===o.readyState&&i&&(0===r&&(r=o.getResponseHeader("Content-Length")),i({total:r,loaded:o.responseText.length}))},o.open("GET",e,!0),o.send(null)}else alert("Don't know how to parse XML!")},parse:x,setPreferredShading:function(e){g=e},applySkin:X,geometries:$,options:W}};var Detector={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var e=document.createElement("div");return e.id="webgl-error-message",e.style.fontFamily="monospace",e.style.fontSize="13px",e.style.fontWeight="normal",e.style.textAlign="center",e.style.background="#fff",e.style.color="#000",e.style.padding="1.5em",e.style.width="400px",e.style.margin="5em auto 0",this.webgl||(e.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n")),e},addGetWebGLMessage:function(e){var t,i,n;t=void 0!==(e=e||{}).parent?e.parent:document.body,i=void 0!==e.id?e.id:"oldie",(n=Detector.getWebGLErrorMessage()).id=i,t.appendChild(n)}};"object"==typeof module&&(module.exports=Detector),THREE.MTLLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.MTLLoader.prototype={constructor:THREE.MTLLoader,load:function(e,t,i,n){var r=this,o=new THREE.FileLoader(this.manager);o.setPath(this.path),o.load(e,function(e){t(r.parse(e))},i,n)},setPath:function(e){this.path=e},setTexturePath:function(e){this.texturePath=e},setBaseUrl:function(e){console.warn("THREE.MTLLoader: .setBaseUrl() is deprecated. Use .setTexturePath( path ) for texture path or .setPath( path ) for general base path instead."),this.setTexturePath(e)},setCrossOrigin:function(e){this.crossOrigin=e},setMaterialOptions:function(e){this.materialOptions=e},parse:function(e){for(var t=e.split("\n"),i={},n=/\s+/,r={},o=0;o<t.length;o++){var a=t[o];if(0!==(a=a.trim()).length&&"#"!==a.charAt(0)){var s=a.indexOf(" "),l=0<=s?a.substring(0,s):a;l=l.toLowerCase();var c=0<=s?a.substring(s+1):"";if(c=c.trim(),"newmtl"===l)i={name:c},r[c]=i;else if(i)if("ka"===l||"kd"===l||"ks"===l){var h=c.split(n,3);i[l]=[parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2])]}else i[l]=c}}var u=new THREE.MTLLoader.MaterialCreator(this.texturePath||this.path,this.materialOptions);return u.setCrossOrigin(this.crossOrigin),u.setManager(this.manager),u.setMaterials(r),u}},THREE.MTLLoader.MaterialCreator=function(e,t){this.baseUrl=e||"",this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:THREE.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping},THREE.MTLLoader.MaterialCreator.prototype={constructor:THREE.MTLLoader.MaterialCreator,setCrossOrigin:function(e){this.crossOrigin=e},setManager:function(e){this.manager=e},setMaterials:function(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(e){if(!this.options)return e;var t={};for(var i in e){var n=e[i],r={};for(var o in t[i]=r,n){var a=!0,s=n[o],l=o.toLowerCase();switch(l){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(s=[s[0]/255,s[1]/255,s[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===s[0]&&0===s[1]&&0===s[2]&&(a=!1)}a&&(r[l]=s)}}return t},preload:function(){for(var e in this.materialsInfo)this.create(e)},getIndex:function(e){return this.nameLookup[e]},getAsArray:function(){var e=0;for(var t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray},create:function(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]},createMaterial_:function(e){var a=this,t=this.materialsInfo[e],s={name:e,side:this.side};function i(e,t){if(!s[e]){var i,n,r=a.getTextureParams(t,s),o=a.loadTexture((i=a.baseUrl,"string"!=typeof(n=r.url)||""===n?"":/^https?:\/\//i.test(n)?n:i+n));o.repeat.copy(r.scale),o.offset.copy(r.offset),o.wrapS=a.wrap,o.wrapT=a.wrap,s[e]=o}}for(var n in t){var r,o=t[n];if(""!==o)switch(n.toLowerCase()){case"kd":s.color=(new THREE.Color).fromArray(o);break;case"ks":s.specular=(new THREE.Color).fromArray(o);break;case"map_kd":i("map",o);break;case"map_ks":i("specularMap",o);break;case"map_bump":case"bump":i("bumpMap",o);break;case"ns":s.shininess=parseFloat(o);break;case"d":(r=parseFloat(o))<1&&(s.opacity=r,s.transparent=!0);break;case"tr":0<(r=parseFloat(o))&&(s.opacity=1-r,s.transparent=!0)}}return this.materials[e]=new THREE.MeshPhongMaterial(s),this.materials[e]},getTextureParams:function(e,t){var i,n={scale:new THREE.Vector2(1,1),offset:new THREE.Vector2(0,0)},r=e.split(/\s+/);return 0<=(i=r.indexOf("-bm"))&&(t.bumpScale=parseFloat(r[i+1]),r.splice(i,2)),0<=(i=r.indexOf("-s"))&&(n.scale.set(parseFloat(r[i+1]),parseFloat(r[i+2])),r.splice(i,4)),0<=(i=r.indexOf("-o"))&&(n.offset.set(parseFloat(r[i+1]),parseFloat(r[i+2])),r.splice(i,4)),n.url=r.join(" ").trim(),n},loadTexture:function(e,t,i,n,r){var o,a=THREE.Loader.Handlers.get(e),s=void 0!==this.manager?this.manager:THREE.DefaultLoadingManager;return null===a&&(a=new THREE.TextureLoader(s)),a.setCrossOrigin&&a.setCrossOrigin(this.crossOrigin),o=a.load(e,i,n,r),void 0!==t&&(o.mapping=t),o}},THREE.OBJLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.materials=null,this.regexp={vertex_pattern:/^v\s+([\d\.\+\-eE]+)\s+([\d\.\+\-eE]+)\s+([\d\.\+\-eE]+)/,normal_pattern:/^vn\s+([\d\.\+\-eE]+)\s+([\d\.\+\-eE]+)\s+([\d\.\+\-eE]+)/,uv_pattern:/^vt\s+([\d\.\+\-eE]+)\s+([\d\.\+\-eE]+)/,face_vertex:/^f\s+(-?\d+)\s+(-?\d+)\s+(-?\d+)(?:\s+(-?\d+))?/,face_vertex_uv:/^f\s+(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)(?:\s+(-?\d+)\/(-?\d+))?/,face_vertex_uv_normal:/^f\s+(-?\d+)\/(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)\/(-?\d+)(?:\s+(-?\d+)\/(-?\d+)\/(-?\d+))?/,face_vertex_normal:/^f\s+(-?\d+)\/\/(-?\d+)\s+(-?\d+)\/\/(-?\d+)\s+(-?\d+)\/\/(-?\d+)(?:\s+(-?\d+)\/\/(-?\d+))?/,object_pattern:/^[og]\s*(.+)?/,smoothing_pattern:/^s\s+(\d+|on|off)/,material_library_pattern:/^mtllib /,material_use_pattern:/^usemtl /}},THREE.OBJLoader.prototype={constructor:THREE.OBJLoader,load:function(e,t,i,n){var r=this,o=new THREE.FileLoader(r.manager);o.setPath(this.path),o.load(e,function(e){t(r.parse(e))},i,n)},setPath:function(e){this.path=e},setMaterials:function(e){this.materials=e},_createParserState:function(){var e={objects:[],object:{},vertices:[],normals:[],uvs:[],materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);var i=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(e,t){var i=this._finalize(!1);i&&(i.inherited||i.groupCount<=0)&&this.materials.splice(i.index,1);var n={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&0<t.length?t[t.length-1]:"",smooth:void 0!==i?i.smooth:this.smooth,groupStart:void 0!==i?i.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){var t={index:"number"==typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(n),n},currentMaterial:function(){if(0<this.materials.length)return this.materials[this.materials.length-1]},_finalize:function(e){var t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&1<this.materials.length)for(var i=this.materials.length-1;0<=i;i--)this.materials[i].groupCount<=0&&this.materials.splice(i,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},i&&i.name&&"function"==typeof i.clone){var n=i.clone(0);n.inherited=!0,this.object.materials.push(n)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){var i=parseInt(e,10);return 3*(0<=i?i-1:i+t/3)},parseNormalIndex:function(e,t){var i=parseInt(e,10);return 3*(0<=i?i-1:i+t/3)},parseUVIndex:function(e,t){var i=parseInt(e,10);return 2*(0<=i?i-1:i+t/2)},addVertex:function(e,t,i){var n=this.vertices,r=this.object.geometry.vertices;r.push(n[e+0]),r.push(n[e+1]),r.push(n[e+2]),r.push(n[t+0]),r.push(n[t+1]),r.push(n[t+2]),r.push(n[i+0]),r.push(n[i+1]),r.push(n[i+2])},addVertexLine:function(e){var t=this.vertices,i=this.object.geometry.vertices;i.push(t[e+0]),i.push(t[e+1]),i.push(t[e+2])},addNormal:function(e,t,i){var n=this.normals,r=this.object.geometry.normals;r.push(n[e+0]),r.push(n[e+1]),r.push(n[e+2]),r.push(n[t+0]),r.push(n[t+1]),r.push(n[t+2]),r.push(n[i+0]),r.push(n[i+1]),r.push(n[i+2])},addUV:function(e,t,i){var n=this.uvs,r=this.object.geometry.uvs;r.push(n[e+0]),r.push(n[e+1]),r.push(n[t+0]),r.push(n[t+1]),r.push(n[i+0]),r.push(n[i+1])},addUVLine:function(e){var t=this.uvs,i=this.object.geometry.uvs;i.push(t[e+0]),i.push(t[e+1])},addFace:function(e,t,i,n,r,o,a,s,l,c,h,u){var d,p=this.vertices.length,f=this.parseVertexIndex(e,p),m=this.parseVertexIndex(t,p),g=this.parseVertexIndex(i,p);if(void 0===n?this.addVertex(f,m,g):(d=this.parseVertexIndex(n,p),this.addVertex(f,m,d),this.addVertex(m,g,d)),void 0!==r){var v=this.uvs.length;f=this.parseUVIndex(r,v),m=this.parseUVIndex(o,v),g=this.parseUVIndex(a,v),void 0===n?this.addUV(f,m,g):(d=this.parseUVIndex(s,v),this.addUV(f,m,d),this.addUV(m,g,d))}if(void 0!==l){var y=this.normals.length;f=this.parseNormalIndex(l,y),m=l===c?f:this.parseNormalIndex(c,y),g=l===h?f:this.parseNormalIndex(h,y),void 0===n?this.addNormal(f,m,g):(d=this.parseNormalIndex(u,y),this.addNormal(f,m,d),this.addNormal(m,g,d))}},addLineGeometry:function(e,t){this.object.geometry.type="Line";for(var i=this.vertices.length,n=this.uvs.length,r=0,o=e.length;r<o;r++)this.addVertexLine(this.parseVertexIndex(e[r],i));var a=0;for(o=t.length;a<o;a++)this.addUVLine(this.parseUVIndex(t[a],n))}};return e.startObject("",!1),e},parse:function(e){console.time("OBJLoader");var t=this._createParserState();-1!==e.indexOf("\r\n")&&(e=e.replace(/\r\n/g,"\n")),-1!==e.indexOf("\\\n")&&(e=e.replace(/\\\n/g,""));for(var i=e.split("\n"),n="",r="",o="",a=[],s="function"==typeof"".trimLeft,l=0,c=i.length;l<c;l++)if(n=i[l],0!==(n=s?n.trimLeft():n.trim()).length&&"#"!==(r=n.charAt(0)))if("v"===r)if(" "===(o=n.charAt(1))&&null!==(a=this.regexp.vertex_pattern.exec(n)))t.vertices.push(parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3]));else if("n"===o&&null!==(a=this.regexp.normal_pattern.exec(n)))t.normals.push(parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3]));else{if("t"!==o||null===(a=this.regexp.uv_pattern.exec(n)))throw new Error("Unexpected vertex/normal/uv line: '"+n+"'");t.uvs.push(parseFloat(a[1]),parseFloat(a[2]))}else if("f"===r)if(null!==(a=this.regexp.face_vertex_uv_normal.exec(n)))t.addFace(a[1],a[4],a[7],a[10],a[2],a[5],a[8],a[11],a[3],a[6],a[9],a[12]);else if(null!==(a=this.regexp.face_vertex_uv.exec(n)))t.addFace(a[1],a[3],a[5],a[7],a[2],a[4],a[6],a[8]);else if(null!==(a=this.regexp.face_vertex_normal.exec(n)))t.addFace(a[1],a[3],a[5],a[7],void 0,void 0,void 0,void 0,a[2],a[4],a[6],a[8]);else{if(null===(a=this.regexp.face_vertex.exec(n)))throw new Error("Unexpected face line: '"+n+"'");t.addFace(a[1],a[2],a[3],a[4])}else if("l"===r){var h=n.substring(1).trim().split(" "),u=[],d=[];if(-1===n.indexOf("/"))u=h;else for(var p=0,f=h.length;p<f;p++){var m=h[p].split("/");""!==m[0]&&u.push(m[0]),""!==m[1]&&d.push(m[1])}t.addLineGeometry(u,d)}else if(null!==(a=this.regexp.object_pattern.exec(n))){var g=(" "+a[0].substr(1).trim()).substr(1);t.startObject(g)}else if(this.regexp.material_use_pattern.test(n))t.object.startMaterial(n.substring(7).trim(),t.materialLibraries);else if(this.regexp.material_library_pattern.test(n))t.materialLibraries.push(n.substring(7).trim());else{if(null===(a=this.regexp.smoothing_pattern.exec(n))){if("\0"===n)continue;throw new Error("Unexpected line: '"+n+"'")}var v=a[1].trim().toLowerCase();t.object.smooth="0"!==v&&"off"!==v,(A=t.object.currentMaterial())&&(A.smooth=t.object.smooth)}t.finalize();var y=new THREE.Group;y.materialLibraries=[].concat(t.materialLibraries);for(l=0,c=t.objects.length;l<c;l++){var b=t.objects[l],x=b.geometry,w=b.materials,_="Line"===x.type;if(0!==x.vertices.length){var E=new THREE.BufferGeometry;E.addAttribute("position",new THREE.BufferAttribute(new Float32Array(x.vertices),3)),0<x.normals.length?E.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(x.normals),3)):E.computeVertexNormals(),0<x.uvs.length&&E.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(x.uvs),2));for(var T,M=[],S=0,C=w.length;S<C;S++){var R=w[S],A=void 0;if(null!==this.materials&&(A=this.materials.create(R.name),_&&A&&!(A instanceof THREE.LineBasicMaterial))){var P=new THREE.LineBasicMaterial;P.copy(A),A=P}A||((A=_?new THREE.LineBasicMaterial:new THREE.MeshPhongMaterial).name=R.name),A.shading=R.smooth?THREE.SmoothShading:THREE.FlatShading,M.push(A)}if(1<M.length){for(S=0,C=w.length;S<C;S++){R=w[S];E.addGroup(R.groupStart,R.groupCount,S)}T=_?new THREE.LineSegments(E,M):new THREE.Mesh(E,M)}else T=_?new THREE.LineSegments(E,M[0]):new THREE.Mesh(E,M[0]);T.name=b.name,y.add(T)}}return console.timeEnd("OBJLoader"),y}},THREE.OrbitControls=function(d,e){this.object=d,this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new THREE.Vector3,this.targetIndicator=new THREE.Mesh(new THREE.SphereGeometry(1,20,20),new THREE.MeshPhongMaterial({emissive:3355392,color:16776960,shading:THREE.SmoothShading})),this.targetIndicator.visible=!1,this.showTargetIndicator=!1,this.center=this.target,this.object.lookAt(this.target),this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};var p=this,c=new THREE.Vector2,h=new THREE.Vector2,u=new THREE.Vector2,f=new THREE.Vector2,m=new THREE.Vector2,g=new THREE.Vector2,v=new THREE.Vector2,y=new THREE.Vector2,b=new THREE.Vector2,x=0,w=0,_=1,E=new THREE.Vector3,T=new THREE.Vector3,M={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY_PAN:4},S=M.NONE,C=null,R={type:"change"};function A(e){p.targetIndicator.visible=e,p.showTargetIndicator||(p.targetIndicator.visible=!1)}function P(){return 2*Math.PI/60/60*p.autoRotateSpeed}function t(){return Math.pow(.95,p.zoomSpeed)}function i(e){if(!1===p.enabled)return p.domElement.removeEventListener("mousemove",i,!1),void p.domElement.removeEventListener("mouseup",n,!1);e.preventDefault();var t=p.domElement===document?p.domElement.body:p.domElement;if(S===M.ROTATE){if(!0===p.noRotate)return;h.set(e.clientX,e.clientY),u.subVectors(h,c),p.rotateLeft(2*Math.PI*u.x/t.clientWidth*p.rotateSpeed),p.rotateUp(2*Math.PI*u.y/t.clientHeight*p.rotateSpeed),c.copy(h)}else if(S===M.DOLLY){if(!0===p.noZoom)return;y.set(e.clientX,e.clientY),b.subVectors(y,v),0<b.y?p.dollyIn():p.dollyOut(),v.copy(y)}else if(S===M.PAN){if(!0===p.noPan)return;m.set(e.clientX,e.clientY),g.subVectors(m,f),p.pan(g),f.copy(m)}p.update()}function n(){!1!==p.enabled&&(p.domElement.removeEventListener("mousemove",i,!1),p.domElement.removeEventListener("mouseup",n,!1),S=M.NONE,A(!1))}function r(e){if(!1!==p.enabled&&!0!==p.noZoom){p.targetIndicator.position.set(p.target.x,p.target.y,p.target.z),A(!0),C=(new Date).getTime();var t=0;e.wheelDelta?t=e.wheelDelta:e.detail&&(t=-e.detail),0<t?p.dollyOut():p.dollyIn()}}this.rotateLeft=function(e){void 0===e&&(e=P()),w-=e},this.rotateUp=function(e){void 0===e&&(e=P()),x-=e},this.panLeft=function(e){var t=new THREE.Vector3,i=this.object.matrix.elements;t.set(i[0],i[1],i[2]),t.multiplyScalar(-e),E.add(t)},this.panUp=function(e){var t=new THREE.Vector3,i=this.object.matrix.elements;t.set(i[4],i[5],i[6]),t.multiplyScalar(e),E.add(t)},this.pan=function(e){var t=p.domElement===document?p.domElement.body:p.domElement;if(void 0!==p.object.fov){var i=p.object.position.clone().sub(p.target).length(),n=p.object.fov*Math.PI/180,r=2*Math.atan(Math.tan(n/2)*p.object.aspect);p.panLeft(2*e.x*i*Math.tan(r/2)/t.clientWidth),p.panUp(2*e.y*i*Math.tan(n/2)/t.clientHeight)}else void 0!==p.object.top?(p.panLeft(e.x*(p.object.right-p.object.left)/t.clientWidth),p.panUp(e.y*(p.object.top-p.object.bottom)/t.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknowncamera type - pan disabled.")},this.dollyIn=function(e){void 0===e&&(e=t()),_/=e},this.dollyOut=function(e){void 0===e&&(e=t()),_*=e},this.update=function(){var e=this.object.position,t=e.clone().sub(this.target),i=Math.atan2(t.x,t.y),n=Math.atan2(Math.sqrt(t.x*t.x+t.y*t.y),t.z);this.autoRotate&&this.rotateLeft(P());var r=i,o=n;i-=w,n+=x,n=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,n)),n=Math.max(1e-6,Math.min(Math.PI-1e-6,n));var a=t.length()*_;if(a=Math.max(this.minDistance,Math.min(this.maxDistance,a)),this.target.add(E),t.x=a*Math.sin(n)*Math.sin(i),t.z=a*Math.cos(n),t.y=a*Math.sin(n)*Math.cos(i),w||x){var s=function(e,t,i){rotWorldMatrix=new THREE.Matrix4,rotWorldMatrix.makeRotationAxis(t.normalize(),i),rotWorldMatrix.multiply(e.matrix),rotWorldMatrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrix()};this.object.position.sub(this.target),this.object.updateMatrix(),s(this.object,new THREE.Vector3(0,0,1),r-i);var l=new THREE.Vector3(1,0,0);l.applyQuaternion(this.object.quaternion),s(this.object,l,n-o),this.object.position.add(this.target),this.object.updateMatrix()}else e.copy(this.target).add(t);x=w=0,_=1,E.set(0,0,0),0<T.distanceTo(this.object.position)&&(this.dispatchEvent(R),T.copy(this.object.position)),!1===p.enabled&&A(!1);var c=(new Date).getTime();if(C&&400<c-C&&(A(!1),C=null),p.targetIndicator.visible){var h=new THREE.Vector3;h.copy(d.position).sub(p.targetIndicator.position);var u=h.length()/100;p.targetIndicator.scale.set(u,u,u)}},this.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},!1),this.domElement.addEventListener("mousedown",function(e){if(!1!==p.enabled){if(e.preventDefault(),e.shiftKey&&0===e.button){if(!0===p.noRotate)return;S=M.ROTATE,c.set(e.clientX,e.clientY)}else if(1===e.button){if(!0===p.noRotate)return;S=M.ROTATE,c.set(e.clientX,e.clientY)}else if(2===e.button){if(!0===p.noZoom)return;S=M.DOLLY,v.set(e.clientX,e.clientY)}else if(0===e.button){if(!0===p.noPan)return;S=M.PAN,f.set(e.clientX,e.clientY)}p.targetIndicator.position.set(p.target.x,p.target.y,p.target.z),A(!0),p.domElement.addEventListener("mousemove",i,!1),p.domElement.addEventListener("mouseup",n,!1)}},!1),this.domElement.addEventListener("mousewheel",r,!1),this.domElement.addEventListener("DOMMouseScroll",r,!1),this.domElement.addEventListener("keydown",function(e){if(!1!==p.enabled&&!0!==p.noKeys&&!0!==p.noPan){var t=!1;switch(e.keyCode){case p.keys.UP:p.pan(new THREE.Vector2(0,p.keyPanSpeed)),t=!0;break;case p.keys.BOTTOM:p.pan(new THREE.Vector2(0,-p.keyPanSpeed)),t=!0;break;case p.keys.LEFT:p.pan(new THREE.Vector2(p.keyPanSpeed,0)),t=!0;break;case p.keys.RIGHT:p.pan(new THREE.Vector2(-p.keyPanSpeed,0)),t=!0}t&&p.update()}},!1),this.domElement.addEventListener("touchstart",function(e){if(!1!==p.enabled)switch(p.targetIndicator.position.set(p.target.x,p.target.y,p.target.z),A(!0),e.touches.length){case 1:if(!0===p.noRotate)return;S=M.TOUCH_ROTATE,c.set(e.touches[0].pageX,e.touches[0].pageY);break;case 2:if(!1===p.noZoom){S=M.TOUCH_DOLLY_PAN;var t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY,n=Math.sqrt(t*t+i*i);v.set(0,n)}if(!1===p.noPan){var r=(e.touches[0].pageX+e.touches[1].pageX)/2,o=(e.touches[0].pageY+e.touches[1].pageY)/2;f.set(r,o)}break;default:S=M.NONE}},!1),this.domElement.addEventListener("touchend",function(){!1!==p.enabled&&(S=M.NONE,p.noPan=!1,A(p.noZoom=!1))},!1),this.domElement.addEventListener("touchmove",function(e){if(!1!==p.enabled){e.preventDefault(),e.stopPropagation();var t=p.domElement===document?p.domElement.body:p.domElement;switch(e.touches.length){case 1:if(!0===p.noRotate)return;if(S!==M.TOUCH_ROTATE)return;h.set(e.touches[0].pageX,e.touches[0].pageY),u.subVectors(h,c),p.rotateLeft(2*Math.PI*u.x/t.clientWidth*p.rotateSpeed),p.rotateUp(2*Math.PI*u.y/t.clientHeight*p.rotateSpeed),c.copy(h);break;case 2:if(S!==M.TOUCH_DOLLY_PAN)return;if(!1===p.noZoom){var i=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(i*i+n*n);y.set(0,r),b.subVectors(y,v);var o=Math.abs(b.y);v.copy(y)}if(!1===p.noPan){var a=(e.touches[0].pageX+e.touches[1].pageX)/2,s=(e.touches[0].pageY+e.touches[1].pageY)/2;m.set(a,s),g.subVectors(m,f);var l=Math.max(Math.abs(g.x),Math.abs(g.y));f.copy(m)}!1===p.noPan&&!1===p.noZoom&&(l<o?p.noPan=!0:p.noZoom=!0),!1===p.noZoom&&1.3<Math.abs(b.y)&&(0<b.y?p.dollyOut():p.dollyIn()),!1===p.noPan&&p.pan(g);break;default:S=M.NONE}}},!1)},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.STLLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.STLLoader.prototype={constructor:THREE.STLLoader,load:function(e,t,i,n){var r=this,o=new THREE.FileLoader(r.manager);o.setResponseType("arraybuffer"),o.load(e,function(e){t(r.parse(e))},i,n)},parse:function(e){var t=function(e){if("string"!=typeof e)return e;for(var t=new Uint8Array(e.length),i=0;i<e.length;i++)t[i]=255&e.charCodeAt(i);return t.buffer||t}(e);return function(e){var t;if(84+50*(t=new DataView(e)).getUint32(80,!0)===t.byteLength)return!0;for(var i=[115,111,108,105,100],n=0;n<5;n++)if(i[n]!=t.getUint8(n,!1))return!0;return!1}(t)?function(e){for(var t,i,n,r,o,a,s,l,c=new DataView(e),h=c.getUint32(80,!0),u=!1,d=0;d<70;d++)1129270351==c.getUint32(d,!1)&&82==c.getUint8(d+4)&&61==c.getUint8(d+5)&&(u=!0,r=[],o=c.getUint8(d+6)/255,a=c.getUint8(d+7)/255,s=c.getUint8(d+8)/255,l=c.getUint8(d+9)/255);for(var p=new THREE.BufferGeometry,f=[],m=[],g=0;g<h;g++){var v=84+50*g,y=c.getFloat32(v,!0),b=c.getFloat32(v+4,!0),x=c.getFloat32(v+8,!0);if(u){var w=c.getUint16(v+48,!0);n=0==(32768&w)?(t=(31&w)/31,i=(w>>5&31)/31,(w>>10&31)/31):(t=o,i=a,s)}for(var _=1;_<=3;_++){var E=v+12*_;f.push(c.getFloat32(E,!0)),f.push(c.getFloat32(E+4,!0)),f.push(c.getFloat32(E+8,!0)),m.push(y,b,x),u&&r.push(t,i,n)}}return p.addAttribute("position",new THREE.BufferAttribute(new Float32Array(f),3)),p.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(m),3)),u&&(p.addAttribute("color",new THREE.BufferAttribute(new Float32Array(r),3)),p.hasColors=!0,p.alpha=l),p}(t):function(e){for(var t,i=new THREE.BufferGeometry,n=/facet([\s\S]*?)endfacet/g,r=0,o=/[\s]+([+-]?(?:\d+.\d+|\d+.|\d+|.\d+)(?:[eE][+-]?\d+)?)/.source,a=new RegExp("vertex"+o+o+o,"g"),s=new RegExp("normal"+o+o+o,"g"),l=[],c=[],h=new THREE.Vector3;null!==(t=n.exec(e));){for(var u=0,d=0,p=t[0];null!==(t=s.exec(p));)h.x=parseFloat(t[1]),h.y=parseFloat(t[2]),h.z=parseFloat(t[3]),d++;for(;null!==(t=a.exec(p));)l.push(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])),c.push(h.x,h.y,h.z),u++;1!==d&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+r),3!==u&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+r),r++}return i.addAttribute("position",new THREE.Float32BufferAttribute(l,3)),i.addAttribute("normal",new THREE.Float32BufferAttribute(c,3)),i}(function(e){if("string"==typeof e)return e;var t=new Uint8Array(e);if(void 0!==window.TextDecoder)return(new TextDecoder).decode(t);for(var i="",n=0,r=e.byteLength;n<r;n++)i+=String.fromCharCode(t[n]);return i}(e))}},function(p,X,Z){"use strict";function g(i){return function(){var e,t=arguments[0];t="["+(i?i+":":"")+t+"] http://errors.angularjs.org/1.3.0-beta.7/"+(i?i+"/":"")+t;for(e=1;e<arguments.length;e++)t=t+(1==e?"?":"&")+"p"+(e-1)+"="+encodeURIComponent("function"==typeof arguments[e]?arguments[e].toString().replace(/ \{[\s\S]*$/,""):void 0===arguments[e]?"undefined":"string"!=typeof arguments[e]?JSON.stringify(arguments[e]):arguments[e]);return Error(t)}}function M(e){if(null==e||s(e))return!1;var t=e.length;return!(1!==e.nodeType||!t)||(J(e)||Q(e)||0===t||"number"==typeof t&&0<t&&t-1 in e)}function Y(e,t,i){var n;if(e)if(ee(e))for(n in e)"prototype"==n||"length"==n||"name"==n||e.hasOwnProperty&&!e.hasOwnProperty(n)||t.call(i,e[n],n);else if(e.forEach&&e.forEach!==Y)e.forEach(t,i);else if(M(e))for(n=0;n<e.length;n++)t.call(i,e[n],n);else for(n in e)e.hasOwnProperty(n)&&t.call(i,e[n],n);return e}function L(e){var t,i=[];for(t in e)e.hasOwnProperty(t)&&i.push(t);return i.sort()}function f(i){return function(e,t){i(t,e)}}function a(){for(var e,t=Kt.length;t;){if(57==(e=Kt[--t].charCodeAt(0)))return Kt[t]="A",Kt.join("");if(90!=e)return Kt[t]=String.fromCharCode(e+1),Kt.join("");Kt[t]="0"}return Kt.unshift("0"),Kt.join("")}function r(e,t){t?e.$$hashKey=t:delete e.$$hashKey}function C(i){var e=i.$$hashKey;return Y(arguments,function(e){e!==i&&Y(e,function(e,t){i[t]=e})}),r(i,e),i}function v(e){return parseInt(e,10)}function d(e,t){return C(new(C(function(){},{prototype:e})),t)}function S(){}function m(e){return e}function R(e){return function(){return e}}function O(e){return void 0===e}function I(e){return void 0!==e}function K(e){return null!=e&&"object"==typeof e}function J(e){return"string"==typeof e}function c(e){return"number"==typeof e}function u(e){return"[object Date]"===Xt.call(e)}function Q(e){return"[object Array]"===Xt.call(e)}function ee(e){return"function"==typeof e}function o(e){return"[object RegExp]"===Xt.call(e)}function s(e){return e&&e.document&&e.location&&e.alert&&e.setInterval}function h(e){return!(!e||!(e.nodeName||e.prop&&e.attr&&e.find))}function w(e,t){if(e.indexOf)return e.indexOf(t);for(var i=0;i<e.length;i++)if(t===e[i])return i;return-1}function A(e,t){var i=w(e,t);return 0<=i&&e.splice(i,1),t}function _(e,i){if(s(e)||e&&e.$evalAsync&&e.$watch)throw Zt("cpws");if(i){if(e===i)throw Zt("cpi");if(Q(e))for(var t=i.length=0;t<e.length;t++)i.push(_(e[t]));else{for(var n in t=i.$$hashKey,Y(i,function(e,t){delete i[t]}),e)i[n]=_(e[n]);r(i,t)}}else(i=e)&&(Q(e)?i=_(e,[]):u(e)?i=new Date(e.getTime()):o(e)?i=RegExp(e.source):K(e)&&(i=_(e,{})));return i}function te(e,t){for(var i in t=t||{},e)!e.hasOwnProperty(i)||"$"===i.charAt(0)&&"$"===i.charAt(1)||(t[i]=e[i]);return t}function ie(e,t){if(e===t)return!0;if(null===e||null===t)return!1;if(e!=e&&t!=t)return!0;var i,n=typeof e;if(n==typeof t&&"object"==n){if(!Q(e)){if(u(e))return u(t)&&e.getTime()==t.getTime();if(o(e)&&o(t))return e.toString()==t.toString();if(e&&e.$evalAsync&&e.$watch||t&&t.$evalAsync&&t.$watch||s(e)||s(t)||Q(t))return!1;for(i in n={},e)if("$"!==i.charAt(0)&&!ee(e[i])){if(!ie(e[i],t[i]))return!1;n[i]=!0}for(i in t)if(!n.hasOwnProperty(i)&&"$"!==i.charAt(0)&&t[i]!==Z&&!ee(t[i]))return!1;return!0}if(!Q(t))return!1;if((n=e.length)==t.length){for(i=0;i<n;i++)if(!ie(e[i],t[i]))return!1;return!0}}return!1}function y(){return X.securityPolicy&&X.securityPolicy.isActive||X.querySelector&&!(!X.querySelector("[ng-csp]")&&!X.querySelector("[data-ng-csp]"))}function P(e,t){var i=2<arguments.length?Wt.call(arguments,2):[];return!ee(t)||t instanceof RegExp?t:i.length?function(){return arguments.length?t.apply(e,i.concat(Wt.call(arguments,0))):t.apply(e,i)}:function(){return arguments.length?t.apply(e,arguments):t.call(e)}}function i(e,t){var i=t;return"string"==typeof e&&"$"===e.charAt(0)?i=Z:s(t)?i="$WINDOW":t&&X===t?i="$DOCUMENT":t&&t.$evalAsync&&t.$watch&&(i="$SCOPE"),i}function E(e,t){return void 0===e?Z:JSON.stringify(e,i,t?"  ":null)}function b(e){return J(e)?JSON.parse(e):e}function x(e){return e="function"==typeof e||!(!e||0===e.length)&&!("f"==(e=jt(""+e))||"0"==e||"false"==e||"no"==e||"n"==e||"[]"==e)}function ne(e){e=Ft(e).clone();try{e.empty()}catch(e){}var t=Ft("<div>").append(e).html();try{return 3===e[0].nodeType?jt(t):t.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(e,t){return"<"+jt(t)})}catch(e){return jt(t)}}function l(e){try{return decodeURIComponent(e)}catch(e){}}function T(e){var t,i,n={};return Y((e||"").split("&"),function(e){e&&(t=e.split("="),I(i=l(t[0]))&&(e=!I(t[1])||l(t[1]),n[i]?Q(n[i])?n[i].push(e):n[i]=[n[i],e]:n[i]=e))}),n}function D(e){var i=[];return Y(e,function(e,t){Q(e)?Y(e,function(e){i.push(N(t,!0)+(!0===e?"":"="+N(e,!0)))}):i.push(N(t,!0)+(!0===e?"":"="+N(e,!0)))}),i.length?i.join("&"):""}function k(e){return N(e,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function N(e,t){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,t?"%20":"+")}function e(t,e){function i(e){e&&o.push(e)}var n,r,o=[t],a={},s=["ng:app","ng-app","x-ng-app","data-ng-app"],l=/\sng[:\-]app(:\s*([\w\d_]+);?)?\s/;Y(s,function(e){s[e]=!0,i(X.getElementById(e)),e=e.replace(":","\\:"),t.querySelectorAll&&(Y(t.querySelectorAll("."+e),i),Y(t.querySelectorAll("."+e+"\\:"),i),Y(t.querySelectorAll("["+e+"]"),i))}),Y(o,function(t){if(!n){var e=l.exec(" "+t.className+" ");e?(n=t,r=(e[2]||"").replace(/\s+/g,",")):Y(t.attributes,function(e){!n&&s[e.name]&&(n=t,r=e.value)})}}),n&&(a.strictDi=null!==function(e,t){var i,n,r=Qt.length;for(e=Ft(e),n=0;n<r;++n)if(i=Qt[n]+t,J(i=e.attr(i)))return i;return null}(n,"strict-di"),e(n,r?[r]:[],a))}function H(t,i,n){K(n)||(n={}),n=C({strictDi:!1},n);var r=function(){if((t=Ft(t)).injector()){var e=t[0]===X?"document":ne(t);throw Zt("btstrpd",e)}return(i=i||[]).unshift(["$provide",function(e){e.value("$rootElement",t)}]),i.unshift("ng"),(e=ye(i,n.strictDi)).invoke(["$rootScope","$rootElement","$compile","$injector","$animate",function(e,t,i,n,r){e.$apply(function(){t.data("$injector",n),i(t)(e)})}]),e},e=/^NG_DEFER_BOOTSTRAP!/;if(p&&!e.test(p.name))return r();p.name=p.name.replace(e,""),Yt.resumeBootstrap=function(e){Y(e,function(e){i.push(e)}),r()}}function re(e,i){return i=i||"_",e.replace(ei,function(e,t){return(t?i:"")+e.toLowerCase()})}function oe(e,t,i){if(!e)throw Zt("areq",t||"?",i||"required");return e}function B(e,t,i){return i&&Q(e)&&(e=e[e.length-1]),oe(ee(e),t,"not a function, got "+(e&&"object"==typeof e?e.constructor.name||"Object":typeof e)),e}function F(e,t){if("hasOwnProperty"===e)throw Zt("badname",t)}function U(e,t,i){if(!t)return e;for(var n,r=e,o=(t=t.split(".")).length,a=0;a<o;a++)n=t[a],e&&(e=(r=e)[n]);return!i&&ee(e)?P(r,e):e}function $(e){var t=e[0];if(t===(e=e[e.length-1]))return Ft(t);var i=[t];do{if(!(t=t.nextSibling))break;i.push(t)}while(t!==e);return Ft(i)}function z(e){return e.replace(si,function(e,t,i,n){return n?i.toUpperCase():i}).replace(li,"Moz$1")}function t(e,c,h,u){function t(e){var t,i,n,r,o,a,s=h&&e?[this.filter(e)]:[this],l=c;if(!u||null!=e)for(;s.length;)for(i=0,n=(t=s.shift()).length;i<n;i++)for(r=Ft(t[i]),l?r.triggerHandler("$destroy"):l=!l,o=0,r=(a=r.children()).length;o<r;o++)s.push(Ut(a[o]));return d.apply(this,arguments)}var d=(d=Ut.fn[e]).$original||d;t.$original=d,Ut.fn[e]=t}function j(e){if(e instanceof j)return e;if(J(e)&&(e=Jt(e)),!(this instanceof j)){if(J(e)&&"<"!=e.charAt(0))throw ci("nosel");return new j(e)}var t,i;J(e)&&(t=X,e=(i=hi.exec(e))?[t.createElement(i[1])]:(i=function(e,t){var i,n,r=t.createDocumentFragment(),o=[];if(ui.test(e)){for(i=i||r.appendChild(t.createElement("div")),n=(di.exec(e)||["",""])[1].toLowerCase(),n=fi[n]||fi._default,i.innerHTML=n[1]+e.replace(pi,"<$1></$2>")+n[2],n=n[0];n--;)i=i.lastChild;o=o.concat(Wt.call(i.childNodes,void 0)),(i=r.firstChild).textContent=""}else o.push(t.createTextNode(e));return r.textContent="",r.innerHTML="",Y(o,function(e){r.appendChild(e)}),r}(e,t))?i.childNodes:[]);he(this,e)}function ae(e){return e.cloneNode(!0)}function V(e){n(e);var t=0;for(e=e.childNodes||[];t<e.length;t++)V(e[t])}function G(i,e,t,n){if(I(n))throw ci("offargs");var r=W(i,"events");W(i,"handle")&&(O(e)?Y(r,function(e,t){ai(i,t,e),delete r[t]}):Y(e.split(" "),function(e){O(t)?(ai(i,e,r[e]),delete r[e]):A(r[e]||[],t)}))}function n(e,t){var i=e[ni],n=ii[i];n&&(t?delete ii[i].data[t]:(n.handle&&(n.events.$destroy&&n.handle({},"$destroy"),G(e)),delete ii[i],e[ni]=Z))}function W(e,t,i){var n=e[ni];n=ii[n||-1];if(!I(i))return n&&n[t];n||(e[ni]=n=++ri,n=ii[n]={}),n[t]=i}function q(e,t,i){var n=W(e,"data"),r=I(i),o=!r&&I(t),a=o&&!K(t);if(n||a||W(e,"data",n={}),r)n[t]=i;else{if(!o)return n;if(a)return n&&n[t];C(n,t)}}function se(e,t){return!!e.getAttribute&&-1<(" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+t+" ")}function le(t,e){e&&t.setAttribute&&Y(e.split(" "),function(e){t.setAttribute("class",Jt((" "+(t.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+Jt(e)+" "," ")))})}function ce(e,t){if(t&&e.setAttribute){var i=(" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");Y(t.split(" "),function(e){e=Jt(e),-1===i.indexOf(" "+e+" ")&&(i+=e+" ")}),e.setAttribute("class",Jt(i))}}function he(e,t){if(t){t=t.nodeName||!I(t.length)||s(t)?[t]:t;for(var i=0;i<t.length;i++)e.push(t[i])}}function ue(e,t){return de(e,"$"+(t||"ngController")+"Controller")}function de(e,t,i){for(9==(e=Ft(e))[0].nodeType&&(e=e.find("html")),t=Q(t)?t:[t];e.length;){for(var n=e[0],r=0,o=t.length;r<o;r++)if((i=e.data(t[r]))!==Z)return i;e=Ft(n.parentNode||11===n.nodeType&&n.host)}}function pe(e){for(var t=0,i=e.childNodes;t<i.length;t++)V(i[t]);for(;e.firstChild;)e.removeChild(e.firstChild)}function fe(e,t){var i=gi[t.toLowerCase()];return i&&vi[e.nodeName]&&i}function me(e){var t,i=typeof e;return"object"==i&&null!==e?"function"==typeof(t=e.$$hashKey)?t=e.$$hashKey():t===Z&&(t=e.$$hashKey=a()):t=e,i+":"+t}function ge(e){Y(e,this.put,this)}function ve(e,t,i){var n,r;if("function"==typeof e){if(!(n=e.$inject)){if(n=[],e.length){if(t)throw J(i)&&i||(i=e.name||((r=(r=e).toString().replace(wi,"").match(yi))?"function("+(r[1]||"").replace(/[\s\r\n]+/," ")+")":"fn")),_i("strictdi",i);Y((t=(t=e.toString().replace(wi,"")).match(yi))[1].split(bi),function(e){e.replace(xi,function(e,t,i){n.push(i)})})}e.$inject=n}}else Q(e)?(B(e[t=e.length-1],"fn"),n=e.slice(0,t)):B(e,"fn",!0);return n}function ye(e,c){function t(i){return function(e,t){if(!K(e))return i(e,t);Y(e,f(i))}}function i(e,t){if(F(e,"service"),(ee(t)||Q(t))&&(t=d.instantiate(t)),!t.$get)throw _i("pget",e);return u[e+a]=t}function n(e,t){return i(e,{$get:t})}function r(i,e){function l(t){if(i.hasOwnProperty(t)){if(i[t]===o)throw _i("cdep",s.join(" <- "));return i[t]}try{return s.unshift(t),i[t]=o,i[t]=e(t)}catch(e){throw i[t]===o&&delete i[t],e}finally{s.shift()}}function r(e,t,i,n){"string"==typeof i&&(n=i,i=null);var r,o,a,s=[];for(o=0,r=(n=ve(e,c,n)).length;o<r;o++){if("string"!=typeof(a=n[o]))throw _i("itkn",a);s.push(i&&i.hasOwnProperty(a)?i[a]:l(a))}return e.$inject||(e=e[r]),e.apply(t,s)}return{invoke:r,instantiate:function(e,t,i){var n=function(){};return n.prototype=(Q(e)?e[e.length-1]:e).prototype,K(e=r(e,n=new n,t,i))||ee(e)?e:n},get:l,annotate:ve,has:function(e){return u.hasOwnProperty(e+a)||i.hasOwnProperty(e)}}}c=!0===c;var o={},a="Provider",s=[],h=new ge,u={$provide:{provider:t(i),factory:t(n),service:t(function(e,t){return n(e,["$injector",function(e){return e.instantiate(t)}])}),value:t(function(e,t){return n(e,R(t))}),constant:t(function(e,t){F(e,"constant"),u[e]=t,l[e]=t}),decorator:function(e,t){var i=d.get(e+a),n=i.$get;i.$get=function(){var e=p.invoke(n,i);return p.invoke(t,null,{$delegate:e})}}}},d=u.$injector=r(u,function(){throw _i("unpr",s.join(" <- "))}),l={},p=l.$injector=r(l,function(e){var t=d.get(e+a);return p.invoke(t.$get,t,Z,e)});return Y(function n(e){var r,o,a,s,l=[];return Y(e,function(t){if(!h.get(t)){h.put(t,!0);try{if(J(t))for(r=$t(t),l=l.concat(n(r.requires)).concat(r._runBlocks),o=r._invokeQueue,a=0,s=o.length;a<s;a++){var e=o[a],i=d.get(e[0]);i[e[1]].apply(i,e[2])}else ee(t)?l.push(d.invoke(t)):Q(t)?l.push(d.invoke(t)):B(t,"module")}catch(e){throw Q(t)&&(t=t[t.length-1]),e.message&&e.stack&&-1==e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),_i("modulerr",t,e.stack||e.message||e)}}}),l}(e),function(e){p.invoke(e||S)}),p}function be(){var i=!0;this.disableAutoScrolling=function(){i=!1},this.$get=["$window","$location","$rootScope",function(r,o,e){function t(){var e,t,i,n=o.hash();n?(e=a.getElementById(n))?e.scrollIntoView():(t=a.getElementsByName(n),i=null,Y(t,function(e){i||"a"!==jt(e.nodeName)||(i=e)}),(e=i)?e.scrollIntoView():"top"===n&&r.scrollTo(0,0)):r.scrollTo(0,0)}var a=r.document;return i&&e.$watch(function(){return o.hash()},function(){e.$evalAsync(t)}),t}]}function xe(){this.$get=["$$rAF","$timeout",function(t,i){return t.supported?function(e){return t(e)}:function(e){return i(e,0,!1)}}]}function we(i,e,a,n){function r(e){try{e.apply(null,Wt.call(arguments,1))}finally{if(0===--p)for(;f.length;)try{f.pop()()}catch(e){a.error(e)}}}function t(){b=null,v!=o.url()&&(v=o.url(),Y(x,function(e){e(o.url())}))}var o=this,s=e[0],l=i.location,c=i.history,h=i.setTimeout,u=i.clearTimeout,d={};o.isMock=!1;var p=0,f=[];o.$$completeOutstandingRequest=r,o.$$incOutstandingRequestCount=function(){p++},o.notifyWhenNoOutstandingRequests=function(e){Y(g,function(e){e()}),0===p?e():f.push(e)};var m,g=[];o.addPollFn=function(e){var t,i;return O(m)&&(t=100,i=h,function e(){Y(g,function(e){e()}),m=i(e,t)}()),g.push(e),e};var v=l.href,y=e.find("base"),b=null;o.url=function(e,t){return l!==i.location&&(l=i.location),c!==i.history&&(c=i.history),e?v!=e?(v=e,n.history?t?c.replaceState(null,"",e):(c.pushState(null,"",e),y.attr("href",y.attr("href"))):(b=e,t?l.replace(e):l.href=e),o):void 0:b||l.href.replace(/%27/g,"'")};var x=[],w=!1;o.onUrlChange=function(e){return w||(n.history&&Ft(i).on("popstate",t),n.hashchange?Ft(i).on("hashchange",t):o.addPollFn(t),w=!0),x.push(e),e},o.baseHref=function(){var e=y.attr("href");return e?e.replace(/^(https?\:)?\/\/[^\/]*/,""):""};var _={},E="",T=o.baseHref();o.cookies=function(e,t){var i,n,r,o;if(!e){if(s.cookie!==E)for(i=(E=s.cookie).split("; "),_={},r=0;r<i.length;r++)0<(o=(n=i[r]).indexOf("="))&&(e=unescape(n.substring(0,o)),_[e]===Z&&(_[e]=unescape(n.substring(o+1))));return _}t===Z?s.cookie=escape(e)+"=;path="+T+";expires=Thu, 01 Jan 1970 00:00:00 GMT":J(t)&&(4096<(i=(s.cookie=escape(e)+"="+escape(t)+";path="+T).length+1)&&a.warn("Cookie '"+e+"' possibly not set or overflowed because it was too large ("+i+" > 4096 bytes)!"))},o.defer=function(e,t){var i;return p++,i=h(function(){delete d[i],r(e)},t||0),d[i]=!0,i},o.defer.cancel=function(e){return!!d[e]&&(delete d[e],u(e),r(S),!0)}}function _e(){this.$get=["$window","$log","$sniffer","$document",function(e,t,i,n){return new we(e,n,t,i)}]}function Ee(){this.$get=function(){function e(e,t){function i(e){e!=c&&(h?h==e&&(h=e.n):h=e,n(e.n,e.p),n(e,c),(c=e).n=null)}function n(e,t){e!=t&&(e&&(e.p=t),t&&(t.n=e))}if(e in u)throw g("$cacheFactory")("iid",e);var r=0,o=C({},t,{id:e}),a={},s=t&&t.capacity||Number.MAX_VALUE,l={},c=null,h=null;return u[e]={put:function(e,t){s<Number.MAX_VALUE&&i(l[e]||(l[e]={key:e}));if(!O(t))return e in a||r++,a[e]=t,s<r&&this.remove(h.key),t},get:function(e){if(s<Number.MAX_VALUE){var t=l[e];if(!t)return;i(t)}return a[e]},remove:function(e){if(s<Number.MAX_VALUE){var t=l[e];if(!t)return;t==c&&(c=t.p),t==h&&(h=t.n),n(t.n,t.p),delete l[e]}delete a[e],r--},removeAll:function(){a={},r=0,l={},c=h=null},destroy:function(){l=o=a=null,delete u[e]},info:function(){return C({},o,{size:r})}}}var u={};return e.info=function(){var i={};return Y(u,function(e,t){i[t]=e.info()}),i},e.get=function(e){return u[e]},e}}function Te(){this.$get=["$cacheFactory",function(e){return e("templates")}]}function Me(i,t){var u={},M=/^\s*directive\:\s*([\d\w\-_]+)\s+(.*)$/,S=/(([\d\w\-_]+)(?:\:([^;]+))?;?)/,c=/^(on[a-z]+|formaction)$/;this.directive=function e(a,t){return F(a,"directive"),J(a)?(oe(t,"directiveFactory"),u.hasOwnProperty(a)||(u[a]=[],i.factory(a+"Directive",["$injector","$exceptionHandler",function(n,r){var o=[];return Y(u[a],function(e,t){try{var i=n.invoke(e);ee(i)?i={compile:R(i)}:!i.compile&&i.link&&(i.compile=R(i.link)),i.priority=i.priority||0,i.index=t,i.name=i.name||a,i.require=i.require||i.controller&&i.name,i.restrict=i.restrict||"A",o.push(i)}catch(e){r(e)}}),o}])),u[a].push(t)):Y(a,f(e)),this},this.aHrefSanitizationWhitelist=function(e){return I(e)?(t.aHrefSanitizationWhitelist(e),this):t.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(e){return I(e)?(t.imgSrcSanitizationWhitelist(e),this):t.imgSrcSanitizationWhitelist()},this.$get=["$injector","$interpolate","$exceptionHandler","$http","$templateCache","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function(h,L,O,e,t,I,D,o,i,a,r,s){function k(a,e,t,i,n){a instanceof Ft||(a=Ft(a)),Y(a,function(e,t){3==e.nodeType&&e.nodeValue.match(/\S+/)&&(a[t]=Ft(e).wrap("<span></span>").parent()[0])});var s=_(a,e,a,t,i,n);return N(a,"ng-scope"),function(e,t,i){oe(e,"scope");var n=t?mi.clone.call(a):a;Y(i,function(e,t){n.data("$"+t+"Controller",e)}),i=0;for(var r=n.length;i<r;i++){var o=n[i].nodeType;1!==o&&9!==o||n.eq(i).data("$scope",e)}return t&&t(n,e),s&&s(e,n,n),n}}function N(e,t){try{e.addClass(t)}catch(e){}}function _(e,d,t,i,n,r){for(var o,a,s,l,p=[],c=0;c<e.length;c++)o=new W,(r=(a=H(e[c],[],o,0===c?i:Z,n)).length?T(a,e[c],o,d,t,null,[],[],r):null)&&r.scope&&N(Ft(e[c]),"ng-scope"),o=r&&r.terminal||!(s=e[c].childNodes)||!s.length?null:_(s,r?r.transclude:d),p.push(r,o),l=l||r||o,r=null;return l?function(e,t,i,n){var r,o,a,s,l,c,h;r=t.length;var u=Array(r);for(l=0;l<r;l++)u[l]=t[l];for(h=l=0,c=p.length;l<c;h++)o=u[h],t=p[l++],r=p[l++],a=Ft(o),t?(t.scope?(s=e.$new(),a.data("$scope",s)):s=e,(a=t.transclude)||!n&&d?t(r,s,o,i,E(e,a||d)):t(r,s,o,i,n)):r&&r(e,o.childNodes,Z,n)}:null}function E(r,o){return function(e,t,i){var n=!1;return e||(n=(e=r.$new()).$$transcluded=!0),t=o(e,t,i),n&&t.on("$destroy",P(e,e.$destroy)),t}}function H(e,t,i,n,r){var o,a,s,l,c=i.$attr;switch(e.nodeType){case 1:var h,u,d;y(t,Se(zt(e).toLowerCase()),"E",n,r);for(var p=0,f=(o=e.attributes)&&o.length;p<f;p++){var m=!1,g=!1;if(h=o[p],!Bt||8<=Bt||h.specified){d=Se(u=h.name),w.test(d)&&(u=re(d.substr(6),"-"));var v=d.replace(/(Start|End)$/,"");d===v+"Start"&&(g=(m=u).substr(0,u.length-5)+"end",u=u.substr(0,u.length-6)),c[d=Se(u.toLowerCase())]=u,i[d]=h=Jt(h.value),fe(e,d)&&(i[d]=!0),x(e,t,h,d),y(t,d,"A",n,r,m,g)}}if(J(e=e.className)&&""!==e)for(;o=S.exec(e);)y(t,d=Se(o[2]),"C",n,r)&&(i[d]=Jt(o[3])),e=e.substr(o.index+o[0].length);break;case 3:a=t,s=e.nodeValue,(l=L(s,!0))&&a.push({priority:0,compile:R(function(e,t){var i=t.parent(),n=i.data("$binding")||[];n.push(l),N(i.data("$binding",n),"ng-binding"),e.$watch(l,function(e){t[0].nodeValue=e})})});break;case 8:try{(o=M.exec(e.nodeValue))&&(y(t,d=Se(o[1]),"M",n,r)&&(i[d]=Jt(o[2])))}catch(e){}}return t.sort(b),t}function B(e,t,i){var n=[],r=0;if(t&&e.hasAttribute&&e.hasAttribute(t))do{if(!e)throw Mi("uterdir",t,i);1==e.nodeType&&(e.hasAttribute(t)&&r++,e.hasAttribute(i)&&r--),n.push(e),e=e.nextSibling}while(0<r);else n.push(e);return Ft(n)}function F(o,a,s){return function(e,t,i,n,r){return t=B(t[0],a,s),o(e,t,i,n,r)}}function T(e,f,m,t,i,n,g,v,r){function o(e,t,i,n){e&&(i&&(e=F(e,i,n)),e.require=l.require,e.directiveName=c,(x===l||l.$$isolateScope)&&(e=G(e,{isolateScope:!0})),g.push(e)),t&&(i&&(t=F(t,i,n)),t.require=l.require,t.directiveName=c,(x===l||l.$$isolateScope)&&(t=G(t,{isolateScope:!0})),v.push(t))}function y(t,e,i,n){var r,o="data",a=!1;if(J(e)){for(;"^"==(r=e.charAt(0))||"?"==r;)e=e.substr(1),"^"==r&&(o="inheritedData"),a=a||"?"==r;if(r=null,n&&"data"===o&&(r=n[e]),!(r=r||i[o]("$"+e+"Controller"))&&!a)throw Mi("ctreq",e,t)}else Q(e)&&(r=[],Y(e,function(e){r.push(y(t,e,i,n))}));return r}function a(e,c,t,i,n){var h,r,o,a,s,u,l,d={};if(h=f===t?m:te(m,new W(Ft(t),m.$attr)),r=h.$$element,x){var p=/^\s*([@=&])(\??)\s*(\w*)\s*$/;i=Ft(t),u=c.$new(!0),w&&w===x.$$originalDirective?i.data("$isolateScope",u):i.data("$isolateScopeNoTemplate",u),N(i,"ng-isolate-scope"),Y(x.scope,function(e,t){var i,n,r,o,a=(l=e.match(p)||[])[3]||t,s="?"==l[2],l=l[1];switch(u.$$isolateBindings[t]=l+a,l){case"@":h.$observe(a,function(e){u[t]=e}),h.$$observers[a].$$scope=c,h[a]&&(u[t]=L(h[a])(c));break;case"=":if(s&&!h[a])break;n=I(h[a]),o=n.literal?ie:function(e,t){return e===t},r=n.assign||function(){throw i=u[t]=n(c),Mi("nonassign",h[a],x.name)},i=u[t]=n(c),u.$watch(function(){var e=n(c);return o(e,u[t])||(o(e,i)?r(c,e=u[t]):u[t]=e),i=e},null,n.literal);break;case"&":n=I(h[a]),u[t]=function(e){return n(c,e)};break;default:throw Mi("iscp",x.name,t,e)}})}for(l=n&&function(e,t){var i;return arguments.length<2&&(t=e,e=Z),E&&(i=d),n(e,t,i)},b&&Y(b,function(e){var t,i={$scope:e===x||e.$$isolateScope?u:c,$element:r,$attrs:h,$transclude:l};"@"==(s=e.controller)&&(s=h[e.name]),t=D(s,i),d[e.name]=t,E||r.data("$"+e.name+"Controller",t),e.controllerAs&&(i.$scope[e.controllerAs]=t)}),i=0,o=g.length;i<o;i++)try{(a=g[i])(a.isolateScope?u:c,r,h,a.require&&y(a.directiveName,a.require,r,d),l)}catch(e){O(e,ne(r))}for(i=c,x&&(x.template||null===x.templateUrl)&&(i=u),e&&e(i,t.childNodes,Z,n),i=v.length-1;0<=i;i--)try{(a=v[i])(a.isolateScope?u:c,r,h,a.require&&y(a.directiveName,a.require,r,d),l)}catch(e){O(e,ne(r))}}r=r||{};for(var s,l,c,h,u,d=-Number.MAX_VALUE,b=r.controllerDirectives,x=r.newIsolateScopeDirective,w=r.templateDirective,p=r.nonTlbTranscludeDirective,_=!1,E=r.hasElementTranscludeDirective,T=m.$$element=Ft(f),M=t,S=0,C=e.length;S<C;S++){var R=(l=e[S]).$$start,A=l.$$end;if(R&&(T=B(f,R,A)),h=Z,d>l.priority)break;if((h=l.scope)&&(s=s||l,l.templateUrl||(j("new/isolated scope",x,l,T),K(h)&&(x=l))),c=l.name,!l.templateUrl&&l.controller&&(h=l.controller,j("'"+c+"' controller",(b=b||{})[c],l,T),b[c]=l),(h=l.transclude)&&(_=!0,l.$$tlb||(j("transclusion",p,l,T),p=l),M="element"==h?(E=!0,d=l.priority,h=B(f,R,A),T=m.$$element=Ft(X.createComment(" "+c+": "+m[c]+" ")),f=T[0],V(i,Ft(Wt.call(h,0)),f),k(h,t,d,n&&n.name,{nonTlbTranscludeDirective:p})):(h=Ft(ae(f)).contents(),T.empty(),k(h,t))),l.template)if(j("template",w,l,T),h=ee((w=l).template)?l.template(T,m):l.template,h=q(h),l.replace){if(n=l,h=ui.test(h)?Ft(Jt(h)):[],f=h[0],1!=h.length||1!==f.nodeType)throw Mi("tplrt",c,"");V(i,T,f),h=H(f,[],C={$attr:{}});var P=e.splice(S+1,e.length-(S+1));x&&U(h),e=e.concat(h).concat(P),$(m,C),C=e.length}else T.html(h);if(l.templateUrl)j("template",w,l,T),(w=l).replace&&(n=l),a=z(e.splice(S,e.length-S),T,m,i,M,g,v,{controllerDirectives:b,newIsolateScopeDirective:x,templateDirective:w,nonTlbTranscludeDirective:p}),C=e.length;else if(l.compile)try{ee(u=l.compile(T,m,M))?o(null,u,R,A):u&&o(u.pre,u.post,R,A)}catch(e){O(e,ne(T))}l.terminal&&(a.terminal=!0,d=Math.max(d,l.priority))}return a.scope=s&&!0===s.scope,a.transclude=_&&M,r.hasElementTranscludeDirective=E,a}function U(e){for(var t=0,i=e.length;t<i;t++)e[t]=d(e[t],{$$isolateScope:!0})}function y(e,t,i,n,r,o,a){if(t===r)return null;if(r=null,u.hasOwnProperty(t))for(var s,l=0,c=(t=h.get(t+"Directive")).length;l<c;l++)try{s=t[l],(n===Z||n>s.priority)&&-1!=s.restrict.indexOf(i)&&(o&&(s=d(s,{$$start:o,$$end:a})),e.push(s),r=s)}catch(e){O(e)}return r}function $(i,n){var r=n.$attr,o=i.$attr,a=i.$$element;Y(i,function(e,t){"$"!=t.charAt(0)&&(n[t]&&(e+=("style"===t?";":" ")+n[t]),i.$set(t,e,!0,r[t]))}),Y(n,function(e,t){"class"==t?(N(a,e),i.class=(i.class?i.class+" ":"")+e):"style"==t?(a.attr("style",a.attr("style")+";"+e),i.style=(i.style?i.style+";":"")+e):"$"==t.charAt(0)||i.hasOwnProperty(t)||(i[t]=e,o[t]=r[t])})}function z(s,l,c,h,u,d,p,f){var m,g,v=[],y=l[0],b=s.shift(),x=C({},b,{templateUrl:null,transclude:null,replace:null,$$originalDirective:b}),w=ee(b.templateUrl)?b.templateUrl(l,c):b.templateUrl;return l.empty(),e.get(a.getTrustedResourceUrl(w),{cache:t}).success(function(e){var i,t;if(e=q(e),b.replace){if(e=ui.test(e)?Ft(Jt(e)):[],i=e[0],1!=e.length||1!==i.nodeType)throw Mi("tplrt",b.name,w);e={$attr:{}},V(h,l,i);var n=H(i,[],e);K(b.scope)&&U(n),s=n.concat(s),$(c,e)}else i=y,l.html(e);for(s.unshift(x),m=T(s,i,c,u,l,b,d,p,f),Y(h,function(e,t){e==i&&(h[t]=l[0])}),g=_(l[0].childNodes,u);v.length;){e=v.shift(),t=v.shift();var r=v.shift(),o=v.shift();n=l[0];if(t!==y){var a=t.className;f.hasElementTranscludeDirective&&b.replace||(n=ae(i)),V(r,Ft(t),n),N(Ft(n),a)}t=m.transclude?E(e,m.transclude):o,m(g,e,n,h,t)}v=null}).error(function(e,t,i,n){throw Mi("tpload",n.url)}),function(e,t,i,n,r){v?(v.push(t),v.push(i),v.push(n),v.push(r)):m(g,t,i,n,r)}}function b(e,t){var i=t.priority-e.priority;return 0!==i?i:e.name!==t.name?e.name<t.name?-1:1:e.index-t.index}function j(e,t,i,n){if(t)throw Mi("multidir",t.name,i.name,e,ne(n))}function x(n,e,t,r){var o=L(t,!0);if(o){if("multiple"===r&&"SELECT"===zt(n))throw Mi("selmulti",ne(n));e.push({priority:100,compile:function(){return{pre:function(e,t,i){if(t=i.$$observers||(i.$$observers={}),c.test(r))throw Mi("nodomevents");(o=L(i[r],!0,function(e,t){if("srcdoc"==t)return a.HTML;var i=zt(e);return"xlinkHref"==t||"FORM"==i&&"action"==t||"IMG"!=i&&("src"==t||"ngSrc"==t)?a.RESOURCE_URL:void 0}(n,r)))&&(i[r]=o(e),(t[r]||(t[r]=[])).$$inter=!0,(i.$$observers&&i.$$observers[r].$$scope||e).$watch(o,function(e,t){"class"===r&&e!=t?i.$updateClass(e,t):i.$set(r,e)}))}}}})}}function V(e,t,i){var n,r,o=t[0],a=t.length,s=o.parentNode;if(e)for(n=0,r=e.length;n<r;n++)if(e[n]==o){e[n++]=i,r=n+a-1;for(var l=e.length;n<l;n++,r++)r<l?e[n]=e[r]:delete e[n];e.length-=a-1;break}for(s&&s.replaceChild(i,o),(e=X.createDocumentFragment()).appendChild(o),i[Ft.expando]=o[Ft.expando],o=1,a=t.length;o<a;o++)s=t[o],Ft(s).remove(),e.appendChild(s),delete t[o];t[0]=i,t.length=1}function G(e,t){return C(function(){return e.apply(null,arguments)},e,t)}var W=function(e,t){this.$$element=e,this.$attr=t||{}};W.prototype={$normalize:Se,$addClass:function(e){e&&0<e.length&&r.addClass(this.$$element,e)},$removeClass:function(e){e&&0<e.length&&r.removeClass(this.$$element,e)},$updateClass:function(e,t){var i=Ce(e,t),n=Ce(t,e);0===i.length?r.removeClass(this.$$element,n):0===n.length?r.addClass(this.$$element,i):r.setClass(this.$$element,i,n)},$set:function(e,t,i,n){var r=fe(this.$$element[0],e);r&&(this.$$element.prop(e,t),n=r),this[e]=t,n?this.$attr[e]=n:(n=this.$attr[e])||(this.$attr[e]=n=re(e,"-")),("A"===(r=zt(this.$$element))&&"href"===e||"IMG"===r&&"src"===e)&&(this[e]=t=s(t,"src"===e)),!1!==i&&(null===t||t===Z?this.$$element.removeAttr(n):this.$$element.attr(n,t)),(i=this.$$observers)&&Y(i[e],function(e){try{e(t)}catch(e){O(e)}})},$observe:function(e,t){var i=this,n=i.$$observers||(i.$$observers={}),r=n[e]||(n[e]=[]);return r.push(t),o.$evalAsync(function(){r.$$inter||t(i[e])}),function(){A(r,t)}}};var n=L.startSymbol(),l=L.endSymbol(),q="{{"==n||"}}"==l?m:function(e){return e.replace(/\{\{/g,n).replace(/}}/g,l)},w=/^ngAttr[A-Z]/;return k}]}function Se(e){return z(e.replace(Si,""))}function Ce(e,t){var i="",n=e.split(/\s+/),r=t.split(/\s+/),o=0;e:for(;o<n.length;o++){for(var a=n[o],s=0;s<r.length;s++)if(a==r[s])continue e;i+=(0<i.length?" ":"")+a}return i}function Re(){var s={},l=/^(\S+)(\s+as\s+(\w+))?$/;this.register=function(e,t){F(e,"controller"),K(e)?C(s,e):s[e]=t},this.$get=["$injector","$window",function(o,a){return function(e,t){var i,n,r;if(J(e)&&(n=(i=e.match(l))[1],r=i[3],B(e=s.hasOwnProperty(n)?s[n]:U(t.$scope,n,!0)||U(a,n,!0),n,!0)),i=o.instantiate(e,t,n),r){if(!t||"object"!=typeof t.$scope)throw g("$controller")("noscp",n||e.name,r);t.$scope[r]=i}return i}}]}function Ae(){this.$get=["$window",function(e){return Ft(e.document)}]}function Pe(){this.$get=["$log",function(i){return function(e,t){i.error.apply(i,arguments)}}]}function Le(e){var t,i,n,r={};return e&&Y(e.split("\n"),function(e){n=e.indexOf(":"),t=jt(Jt(e.substr(0,n))),i=Jt(e.substr(n+1)),t&&(r[t]=r[t]?r[t]+", "+i:i)}),r}function Oe(t){var i=K(t)?t:Z;return function(e){return i||(i=Le(t)),e?i[jt(e)]||null:i}}function Ie(t,i,e){return ee(e)?e(t,i):(Y(e,function(e){t=e(t,i)}),t)}function De(){var t=/^\s*(\[|\{[^\{])/,i=/[\}\]]\s*$/,n=/^\)\]\}',?\n/,e={"Content-Type":"application/json;charset=utf-8"},m=this.defaults={transformResponse:[function(e){return J(e)&&(e=e.replace(n,""),t.test(e)&&i.test(e)&&(e=b(e))),e}],transformRequest:[function(e){return K(e)&&"[object File]"!==Xt.call(e)&&"[object Blob]"!==Xt.call(e)?E(e):e}],headers:{common:{Accept:"application/json, text/plain, */*"},post:_(e),put:_(e),patch:_(e)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},r=this.interceptors=[],o=this.responseInterceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory","$rootScope","$q","$injector",function(h,s,e,u,d,n){function p(e){function i(e){var t=C({},e,{data:Ie(e.data,e.headers,n.transformResponse)});return 200<=e.status&&e.status<300?t:d.reject(t)}var n={method:"get",transformRequest:m.transformRequest,transformResponse:m.transformResponse},r=function(e){function t(i){var n;Y(i,function(e,t){ee(e)&&(null!=(n=e())?i[t]=n:delete i[t])})}var i,n,r=m.headers,o=C({},e.headers);t(r=C({},r.common,r[jt(e.method)])),t(o);e:for(i in r){for(n in e=jt(i),o)if(jt(n)===e)continue e;o[i]=r[i]}return o}(e);C(n,e),n.headers=r,n.method=Gt(n.method),(e=mt(n.url)?s.cookies()[n.xsrfCookieName||m.xsrfCookieName]:Z)&&(r[n.xsrfHeaderName||m.xsrfHeaderName]=e);var t=[function(e){r=e.headers;var t=Ie(e.data,Oe(r),e.transformRequest);return O(e.data)&&Y(r,function(e,t){"content-type"===jt(t)&&delete r[t]}),O(e.withCredentials)&&!O(m.withCredentials)&&(e.withCredentials=m.withCredentials),function(r,e,t){function o(e,t,i,n){(200<=(t=Math.max(t,0))&&t<300?s.resolve:s.reject)({data:e,status:t,headers:Oe(i),config:r,statusText:n})}function i(){var e=w(p.pendingRequests,r);-1!==e&&p.pendingRequests.splice(e,1)}var a,n,s=d.defer(),l=s.promise,c=function(e,t){if(!t)return e;var i=[];return function(e,t,i){for(var n=L(e),r=0;r<n.length;r++)t.call(i,e[n[r]],n[r])}(t,function(e,t){null===e||O(e)||(Q(e)||(e=[e]),Y(e,function(e){K(e)&&(e=E(e)),i.push(N(t)+"="+N(e))}))}),0<i.length&&(e+=(-1==e.indexOf("?")?"?":"&")+i.join("&")),e}(r.url,r.params);if(p.pendingRequests.push(r),l.then(i,i),(r.cache||m.cache)&&!1!==r.cache&&"GET"==r.method&&(a=K(r.cache)?r.cache:K(m.cache)?m.cache:f),a)if(I(n=a.get(c))){if(n.then)return n.then(i,i),n;Q(n)?o(n[1],n[0],_(n[2]),n[3]):o(n,200,{},"OK")}else a.put(c,l);return O(n)&&h(r.method,c,e,function(e,t,i,n){a&&(200<=e&&e<300?a.put(c,[e,t,Le(i),n]):a.remove(c)),o(t,e,i,n),u.$$phase||u.$apply()},t,r.timeout,r.withCredentials,r.responseType),l}(e,t,r).then(i,i)},Z],o=d.when(n);for(Y(l,function(e){(e.request||e.requestError)&&t.unshift(e.request,e.requestError),(e.response||e.responseError)&&t.push(e.response,e.responseError)});t.length;){e=t.shift();var a=t.shift();o=o.then(e,a)}return o.success=function(t){return o.then(function(e){t(e.data,e.status,e.headers,n)}),o},o.error=function(t){return o.then(null,function(e){t(e.data,e.status,e.headers,n)}),o},o}var f=e("$http"),l=[];return Y(r,function(e){l.unshift(J(e)?n.get(e):n.invoke(e))}),Y(o,function(e,t){var i=J(e)?n.get(e):n.invoke(e);l.splice(t,0,{response:function(e){return i(d.when(e))},responseError:function(e){return i(d.reject(e))}})}),p.pendingRequests=[],function(e){Y(arguments,function(i){p[i]=function(e,t){return p(C(t||{},{method:i,url:e}))}})}("get","delete","head","jsonp"),function(e){Y(arguments,function(n){p[n]=function(e,t,i){return p(C(i||{},{method:n,url:e,data:t}))}})}("post","put"),p.defaults=m,p}]}function ke(e){if(Bt<=8&&(!e.match(/^(get|post|head|put|delete|options)$/i)||!p.XMLHttpRequest))return new p.ActiveXObject("Microsoft.XMLHTTP");if(p.XMLHttpRequest)return new p.XMLHttpRequest;throw g("$httpBackend")("noxhr")}function Ne(){this.$get=["$browser","$window","$document",function(e,t,i){return w=ke,_=(x=e).defer,E=t.angular.callbacks,T=i[0],function(e,o,t,i,n,r,a,s){function l(){h=-1,v&&v(),y&&y.abort()}function c(e,t,i,n,r){b&&_.cancel(b),v=y=null,0===t&&(t=i?200:"file"==ft(o).protocol?404:0),e(1223===t?204:t,i,n,r||""),x.$$completeOutstandingRequest(S)}var h,u,d,p,f,m;if(x.$$incOutstandingRequestCount(),o=o||x.url(),"jsonp"==jt(e)){var g="_"+(E.counter++).toString(36);E[g]=function(e){E[g].data=e,E[g].called=!0};var v=(u=o.replace("JSON_CALLBACK","angular.callbacks."+g),d=g,p=function(e,t){c(i,e,E[g].data,"",t),E[g]=S},f=T.createElement("script"),m=null,f.type="text/javascript",f.src=u,f.async=!0,m=function(e){ai(f,"load",m),ai(f,"error",m),T.body.removeChild(f),f=null;var t=-1,i="unknown";e&&("load"!==e.type||E[d].called||(e={type:"error"}),i=e.type,t="error"===e.type?404:200),p&&p(t,i)},oi(f,"load",m),oi(f,"error",m),T.body.appendChild(f),m)}else{var y=w(e);if(y.open(e,o,!0),Y(n,function(e,t){I(e)&&y.setRequestHeader(t,e)}),y.onreadystatechange=function(){if(y&&4==y.readyState){var e=null,t=null;-1!==h&&(e=y.getAllResponseHeaders(),t="response"in y?y.response:y.responseText),c(i,h||y.status,t,e,y.statusText||"")}},a&&(y.withCredentials=!0),s)try{y.responseType=s}catch(e){if("json"!==s)throw e}y.send(t||null)}if(0<r)var b=_(l,r);else r&&r.then&&r.then(l)};var x,w,_,E,T}]}function He(){var x="{{",w="}}";this.startSymbol=function(e){return e?(x=e,this):x},this.endSymbol=function(e){return e?(w=e,this):w},this.$get=["$parse","$exceptionHandler","$sce",function(s,y,b){function e(h,e,u){for(var t,i,n=0,d=[],p=[],f=[],r=h.length,o=!1,a=!1,m=[],g={},v={};n<r;){if(-1==(t=h.indexOf(x,n))||-1==(i=h.indexOf(w,t+l))){n!==r&&(a=!0,d.push(h.substring(n)));break}n!==t&&(a=!0),d.push(h.substring(n,t)),n=h.substring(t+l,i),p.push(n),f.push(s(n)),n=i+c,o=!0}if(d.length===p.length&&d.push(""),u&&o&&(a||1<p.length))throw Ci("noconcat",h);if(!e||o){m.length=d.length+p.length;return C(function(t){var e,i,n=t.$id||"notAScope",r=g[n],o=v[n],a=0,s=p.length,l=Array(s),c=o===Z;r||(r=[],c=!0,t.$on&&t.$on("$destroy",function(){g[n]=null,v[n]=null}));try{for(;a<s;a++)i=f[a](t),null===(i=u?b.getTrusted(u,i):b.valueOf(i))||O(i)?i="":"string"!=typeof i&&(i=E(i)),(e=i)!==r[a]&&(c=!0),l[a]=e;c&&(g[n]=l,v[n]=o=function(e){for(var t=0,i=p.length;t<i;t++)m[2*t]=d[t],m[2*t+1]=e[t];return m[2*i]=d[i],m.join("")}(l))}catch(e){t=Ci("interr",h,e.toString()),y(t)}return o},{exp:h,separators:d,expressions:p})}}var l=x.length,c=w.length;return e.startSymbol=function(){return x},e.endSymbol=function(){return w},e}]}function Be(){this.$get=["$rootScope","$window","$q",function(h,u,d){function e(e,t,i,n){var r=u.setInterval,o=u.clearInterval,a=d.defer(),s=a.promise,l=0,c=I(n)&&!n;return i=I(i)?i:0,s.then(null,null,e),s.$$intervalId=r(function(){a.notify(l++),0<i&&i<=l&&(a.resolve(l),o(s.$$intervalId),delete p[s.$$intervalId]),c||h.$apply()},t),p[s.$$intervalId]=a,s}var p={};return e.cancel=function(e){return!!(e&&e.$$intervalId in p)&&(p[e.$$intervalId].reject("canceled"),clearInterval(e.$$intervalId),delete p[e.$$intervalId],!0)},e}]}function Fe(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,maxFrac:2,posPre:"¤",posSuf:"",negPre:"(¤",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January February March April May June July August September October November December".split(" "),SHORTMONTH:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),DAY:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),SHORTDAY:"Sun Mon Tue Wed Thu Fri Sat".split(" "),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a",short:"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a"},pluralCat:function(e){return 1===e?"one":"other"}}}}function Ue(e){for(var t=(e=e.split("/")).length;t--;)e[t]=k(e[t]);return e.join("/")}function $e(e,t,i){e=ft(e,i),t.$$protocol=e.protocol,t.$$host=e.hostname,t.$$port=v(e.port)||Ai[e.protocol]||null}function ze(e,t,i){var n="/"!==e.charAt(0);n&&(e="/"+e),e=ft(e,i),t.$$path=decodeURIComponent(n&&"/"===e.pathname.charAt(0)?e.pathname.substring(1):e.pathname),t.$$search=T(e.search),t.$$hash=decodeURIComponent(e.hash),t.$$path&&"/"!=t.$$path.charAt(0)&&(t.$$path="/"+t.$$path)}function je(e,t){if(0===t.indexOf(e))return t.substr(e.length)}function Ve(e){var t=e.indexOf("#");return-1==t?e:e.substr(0,t)}function Ge(e){return e.substr(0,Ve(e).lastIndexOf("/")+1)}function We(i,n){this.$$html5=!0,n=n||"";var r=Ge(i);$e(i,this,i),this.$$parse=function(e){var t=je(r,e);if(!J(t))throw Pi("ipthprfx",e,r);ze(t,this,i),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var e=D(this.$$search),t=this.$$hash?"#"+k(this.$$hash):"";this.$$url=Ue(this.$$path)+(e?"?"+e:"")+t,this.$$absUrl=r+this.$$url.substr(1)},this.$$rewrite=function(e){var t;return(t=je(i,e))!==Z?(t=je(n,e=t))!==Z?r+(je("/",t)||t):i+e:(t=je(r,e))!==Z?r+t:r==e+"/"?r:void 0}}function qe(n,r){var o=Ge(n);$e(n,this,n),this.$$parse=function(e){var t;if(!J(t="#"==(t=je(n,e)||je(o,e)).charAt(0)?je(r,t):this.$$html5?t:""))throw Pi("ihshprfx",e,r);ze(t,this,n),e=this.$$path;var i=/^\/[A-Z]:(\/.*)/;0===t.indexOf(n)&&(t=t.replace(n,"")),i.exec(t)||(e=(t=i.exec(e))?t[1]:e),this.$$path=e,this.$$compose()},this.$$compose=function(){var e=D(this.$$search),t=this.$$hash?"#"+k(this.$$hash):"";this.$$url=Ue(this.$$path)+(e?"?"+e:"")+t,this.$$absUrl=n+(this.$$url?r+this.$$url:"")},this.$$rewrite=function(e){if(Ve(n)==Ve(e))return e}}function Xe(i,n){this.$$html5=!0,qe.apply(this,arguments);var r=Ge(i);this.$$rewrite=function(e){var t;return i==Ve(e)?e:(t=je(r,e))?i+n+t:r===e+"/"?r:void 0},this.$$compose=function(){var e=D(this.$$search),t=this.$$hash?"#"+k(this.$$hash):"";this.$$url=Ue(this.$$path)+(e?"?"+e:"")+t,this.$$absUrl=i+n+this.$$url}}function Ze(e){return function(){return this[e]}}function Ye(t,i){return function(e){return O(e)?this[t]:(this[t]=i(e),this.$$compose(),this)}}function Ke(){var d="",o=!1;this.hashPrefix=function(e){return I(e)?(d=e,this):d},this.html5Mode=function(e){return I(e)?(o=e,this):o},this.$get=["$rootScope","$browser","$sniffer","$rootElement",function(a,s,e,l){function i(e){a.$broadcast("$locationChangeSuccess",c.absUrl(),e)}var c,h,u,t=s.baseHref(),n=s.url();h=o?(u=n.substring(0,n.indexOf("/",n.indexOf("//")+2))+(t||"/"),e.history?We:Xe):(u=Ve(n),qe),(c=new h(u,"#"+d)).$$parse(c.$$rewrite(n)),l.on("click",function(e){if(!e.ctrlKey&&!e.metaKey&&2!=e.which){for(var t=Ft(e.target);"a"!==jt(t[0].nodeName);)if(t[0]===l[0]||!(t=t.parent())[0])return;var i=t.prop("href");if(K(i)&&"[object SVGAnimatedString]"===i.toString()&&(i=ft(i.animVal).href),h===Xe)if((r=t.attr("href")||t.attr("xlink:href")).indexOf("://")<0)if(i="#"+d,"/"==r[0])i=u+i+r;else if("#"==r[0])i=u+i+(c.path()||"/")+r;else{for(var n=c.path().split("/"),r=r.split("/"),o=0;o<r.length;o++)"."!=r[o]&&(".."==r[o]?n.pop():r[o].length&&n.push(r[o]));i=u+i+n.join("/")}n=c.$$rewrite(i),i&&!t.attr("target")&&n&&!e.isDefaultPrevented()&&(e.preventDefault(),n!=s.url()&&(c.$$parse(n),a.$apply(),p.angular["ff-684208-preventDefault"]=!0))}}),c.absUrl()!=n&&s.url(c.absUrl(),!0),s.onUrlChange(function(t){c.absUrl()!=t&&(a.$evalAsync(function(){var e=c.absUrl();c.$$parse(t),a.$broadcast("$locationChangeStart",t,e).defaultPrevented?(c.$$parse(e),s.url(e)):i(e)}),a.$$phase||a.$digest())});var r=0;return a.$watch(function(){var e=s.url(),t=c.$$replace;return r&&e==c.absUrl()||(r++,a.$evalAsync(function(){a.$broadcast("$locationChangeStart",c.absUrl(),e).defaultPrevented?c.$$parse(e):(s.url(c.absUrl(),t),i(e))})),c.$$replace=!1,r}),c}]}function Je(){var n=!0,r=this;this.debugEnabled=function(e){return I(e)?(n=e,this):n},this.$get=["$window",function(i){function e(e){var t=i.console||{},n=t[e]||t.log||S;e=!1;try{e=!!n.apply}catch(e){}return e?function(){var i=[];return Y(arguments,function(e){var t;i.push(((t=e)instanceof Error&&(t.stack?t=t.message&&-1===t.stack.indexOf(t.message)?"Error: "+t.message+"\n"+t.stack:t.stack:t.sourceURL&&(t=t.message+"\n"+t.sourceURL+":"+t.line)),t))}),n.apply(t,i)}:function(e,t){n(e,null==t?"":t)}}return{log:e("log"),info:e("info"),warn:e("warn"),error:e("error"),debug:(t=e("debug"),function(){n&&t.apply(r,arguments)})};var t}]}function Qe(e,t){if("constructor"===e)throw Oi("isecfld",t);return e}function et(e,t){if(e){if(e.constructor===e)throw Oi("isecfn",t);if(e.document&&e.location&&e.alert&&e.setInterval)throw Oi("isecwindow",t);if(e.children&&(e.nodeName||e.prop&&e.attr&&e.find))throw Oi("isecdom",t)}return e}function tt(e,t,i,n,r){r=r||{},t=t.split(".");for(var o,a=0;1<t.length;a++){var s=e[o=Qe(t.shift(),n)];s||(s={},e[o]=s),(e=s).then&&r.unwrapPromises&&(Li(n),"$$v"in e||function(t){t.then(function(e){t.$$v=e})}(e),e.$$v===Z&&(e.$$v={}),e=e.$$v)}return e[o=Qe(t.shift(),n)]=i}function it(r,o,a,s,l,c,e){return Qe(r,c),Qe(o,c),Qe(a,c),Qe(s,c),Qe(l,c),e.unwrapPromises?function(e,t){var i,n=t&&t.hasOwnProperty(r)?t:e;return null==n?n:((n=n[r])&&n.then&&(Li(c),"$$v"in n||((i=n).$$v=Z,i.then(function(e){i.$$v=e})),n=n.$$v),o?null==n?Z:((n=n[o])&&n.then&&(Li(c),"$$v"in n||((i=n).$$v=Z,i.then(function(e){i.$$v=e})),n=n.$$v),a?null==n?Z:((n=n[a])&&n.then&&(Li(c),"$$v"in n||((i=n).$$v=Z,i.then(function(e){i.$$v=e})),n=n.$$v),s?null==n?Z:((n=n[s])&&n.then&&(Li(c),"$$v"in n||((i=n).$$v=Z,i.then(function(e){i.$$v=e})),n=n.$$v),l?null==n?Z:((n=n[l])&&n.then&&(Li(c),"$$v"in n||((i=n).$$v=Z,i.then(function(e){i.$$v=e})),n=n.$$v),n):n):n):n):n)}:function(e,t){var i=t&&t.hasOwnProperty(r)?t:e;return null==i?i:(i=i[r],o?null==i?Z:(i=i[o],a?null==i?Z:(i=i[a],s?null==i?Z:(i=i[s],l?null==i?Z:i=i[l]:i):i):i):i)}}function nt(e,r,o){if(Bi.hasOwnProperty(e))return Bi[e];var t,i,n,a,s,l=e.split("."),c=l.length;if(r.unwrapPromises||1!==c)if(r.unwrapPromises||2!==c)if(r.csp)t=c<6?it(l[0],l[1],l[2],l[3],l[4],o,r):function(e,t){for(var i,n=0;i=it(l[n++],l[n++],l[n++],l[n++],l[n++],o,r)(e,t),t=Z,e=i,n<c;);return i};else{var h="var p;\n";Y(l,function(e,t){Qe(e,o),h+="if(s == null) return undefined;\ns="+(t?"s":'((k&&k.hasOwnProperty("'+e+'"))?k:s)')+'["'+e+'"];\n'+(r.unwrapPromises?'if (s && s.then) {\n pw("'+o.replace(/(["\r\n])/g,"\\$1")+'");\n if (!("$$v" in s)) {\n p=s;\n p.$$v = undefined;\n p.then(function(v) {p.$$v=v;});\n}\n s=s.$$v\n}\n':"")});h=h+"return s;";var u=new Function("s","k","pw",h);u.toString=R(h),t=r.unwrapPromises?function(e,t){return u(e,t,Li)}:u}else n=l[0],a=l[1],Qe(n,s=o),Qe(a,s),t=function(e,t){return null==e?Z:null==(e=(t&&t.hasOwnProperty(n)?t:e)[n])?Z:e[a]};else Qe(i=l[0],o),t=function(e,t){return null==e?Z:(t&&t.hasOwnProperty(i)?t:e)[i]};return"hasOwnProperty"!==e&&(Bi[e]=t),t}function rt(){var n={},r={csp:!1,unwrapPromises:!1,logPromiseWarnings:!0};this.unwrapPromises=function(e){return I(e)?(r.unwrapPromises=!!e,this):r.unwrapPromises},this.logPromiseWarnings=function(e){return I(e)?(r.logPromiseWarnings=e,this):r.logPromiseWarnings},this.$get=["$filter","$sniffer","$log",function(i,e,t){return r.csp=e.csp,Li=function(e){r.logPromiseWarnings&&!Ii.hasOwnProperty(e)&&(Ii[e]=!0,t.warn("[$parse] Promise found in the expression `"+e+"`. Automatic unwrapping of promises in Angular expressions is deprecated."))},function(e){var t;switch(typeof e){case"string":return n.hasOwnProperty(e)?n[e]:(t=new Ni(r),t=new Hi(t,i,r).parse(e,!1),"hasOwnProperty"!==e&&(n[e]=t),t);case"function":return e;default:return S}}}]}function ot(){this.$get=["$rootScope","$exceptionHandler",function(t,e){return function(c,h){function u(e){return e}function d(e){return m(e)}var p=function(){var s,t,l=[];return t={resolve:function(e){if(l){var n=l;l=Z,s=f(e),n.length&&c(function(){for(var e,t=0,i=n.length;t<i;t++)e=n[t],s.then(e[0],e[1],e[2])})}},reject:function(e){t.resolve(i(e))},notify:function(i){if(l){var n=l;l.length&&c(function(){for(var e=0,t=n.length;e<t;e++)n[e][2](i)})}},promise:{then:function(t,i,n){var r=p(),e=function(e){try{r.resolve((ee(t)?t:u)(e))}catch(e){r.reject(e),h(e)}},o=function(e){try{r.resolve((ee(i)?i:d)(e))}catch(e){r.reject(e),h(e)}},a=function(e){try{r.notify((ee(n)?n:u)(e))}catch(e){h(e)}};return l?l.push([e,o,a]):s.then(e,o,a),r.promise},catch:function(e){return this.then(null,e)},finally:function(n){function r(e,t){var i=p();return t?i.resolve(e):i.reject(e),i.promise}function t(e,t){var i=null;try{i=(n||u)()}catch(e){return r(e,!1)}return i&&ee(i.then)?i.then(function(){return r(e,t)},function(e){return r(e,!1)}):r(e,t)}return this.then(function(e){return t(e,!0)},function(e){return t(e,!1)})}}}},f=function(i){return i&&ee(i.then)?i:{then:function(e){var t=p();return c(function(){t.resolve(e(i))}),t.promise}}},m=function(e){var t=p();return t.reject(e),t.promise},i=function(n){return{then:function(e,t){var i=p();return c(function(){try{i.resolve((ee(t)?t:d)(n))}catch(e){i.reject(e),h(e)}}),i.promise}}};return{defer:p,reject:m,when:function(e,t,i,n){var r,o=p(),a=function(e){try{return(ee(t)?t:u)(e)}catch(e){return h(e),m(e)}},s=function(e){try{return(ee(i)?i:d)(e)}catch(e){return h(e),m(e)}},l=function(e){try{return(ee(n)?n:u)(e)}catch(e){h(e)}};return c(function(){f(e).then(function(e){r||(r=!0,o.resolve(f(e).then(a,s,l)))},function(e){r||(r=!0,o.resolve(s(e)))},function(e){r||o.notify(l(e))})}),o.promise},all:function(e){var i=p(),n=0,r=Q(e)?[]:{};return Y(e,function(e,t){n++,f(e).then(function(e){r.hasOwnProperty(t)||(r[t]=e,--n||i.resolve(r))},function(e){r.hasOwnProperty(t)||i.reject(e)})}),0===n&&i.resolve(r),i.promise}}}(function(e){t.$evalAsync(e)},e)}]}function at(){this.$get=["$window","$timeout",function(e,i){var n=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame,r=e.cancelAnimationFrame||e.webkitCancelAnimationFrame||e.mozCancelAnimationFrame||e.webkitCancelRequestAnimationFrame,t=!!n,o=t?function(e){var t=n(e);return function(){r(t)}}:function(e){var t=i(e,16.66,!1);return function(){i.cancel(t)}};return o.supported=t,o}]}function st(){var y=10,b=g("$rootScope"),x=null;this.digestTtl=function(e){return arguments.length&&(y=e),y},this.$get=["$injector","$exceptionHandler","$parse","$browser",function(e,f,p,t){function i(){this.$id=a(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this.this=this.$root=this,this.$$destroyed=!1,this.$$asyncQueue=[],this.$$postDigestQueue=[],this.$$listeners={},this.$$listenerCount={},this.$$isolateBindings={}}function m(e){if(v.$$phase)throw b("inprog",v.$$phase);v.$$phase=e}function l(e,t){var i=p(e);return B(i,t),i}function o(e,t,i){for(;e.$$listenerCount[i]-=t,0===e.$$listenerCount[i]&&delete e.$$listenerCount[i],e=e.$parent;);}function g(){}i.prototype={constructor:i,$new:function(e){return e?((e=new i).$root=this.$root,e.$$asyncQueue=this.$$asyncQueue,e.$$postDigestQueue=this.$$postDigestQueue):(this.$$childScopeClass||(this.$$childScopeClass=function(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$id=a(),this.$$childScopeClass=null},this.$$childScopeClass.prototype=this),e=new this.$$childScopeClass),(e.this=e).$parent=this,e.$$prevSibling=this.$$childTail,this.$$childHead?this.$$childTail=this.$$childTail.$$nextSibling=e:this.$$childHead=this.$$childTail=e,e},$watch:function(e,t,i){var n=l(e,"watch"),r=this.$$watchers,o={fn:t,last:g,get:n,exp:e,eq:!!i};if(x=null,!ee(t)){var a=l(t||S,"listener");o.fn=function(e,t,i){a(i)}}if("string"==typeof e&&n.constant){var s=o.fn;o.fn=function(e,t,i){s.call(this,e,t,i),A(r,o)}}return r||(r=this.$$watchers=[]),r.unshift(o),function(){A(r,o),x=null}},$watchGroup:function(e,t){var n=Array(e.length),r=Array(e.length),o=[],a=0,s=this;return Y(e,function(e,i){o.push(s.$watch(e,function(e,t){r[i]=e,n[i]=t,a++}))},this),o.push(s.$watch(function(){return a},function(){t(r,n,s)})),function(){Y(o,function(e){e()})}},$watchCollection:function(e,t){var i,n,r,o=this,a=1<t.length,s=0,l=p(e),c=[],h={},u=!0,d=0;return this.$watch(function(){var e,t;if(K(i=l(o)))if(M(i))for(n!==c&&(d=(n=c).length=0,s++),e=i.length,d!==e&&(s++,n.length=d=e),t=0;t<e;t++)n[t]!=n[t]&&i[t]!=i[t]||n[t]===i[t]||(s++,n[t]=i[t]);else{for(t in n!==h&&(n=h={},d=0,s++),e=0,i)i.hasOwnProperty(t)&&(e++,n.hasOwnProperty(t)?n[t]!==i[t]&&(s++,n[t]=i[t]):(d++,n[t]=i[t],s++));if(e<d)for(t in s++,n)n.hasOwnProperty(t)&&!i.hasOwnProperty(t)&&(d--,delete n[t])}else n!==i&&(n=i,s++);return s},function(){if(u?(u=!1,t(i,i,o)):t(i,r,o),a)if(K(i))if(M(i)){r=Array(i.length);for(var e=0;e<i.length;e++)r[e]=i[e]}else for(e in r={},i)Vt.call(i,e)&&(r[e]=i[e]);else r=i})},$digest:function(){var e,t,i,n,r,o,a,s,l,c,h=this.$$asyncQueue,u=this.$$postDigestQueue,d=y,p=[];m("$digest"),x=null;do{for(o=!1,a=this;h.length;){try{(c=h.shift()).scope.$eval(c.expression)}catch(e){v.$$phase=null,f(e)}x=null}e:do{if(n=a.$$watchers)for(r=n.length;r--;)try{if(e=n[r])if((t=e.get(a))===(i=e.last)||(e.eq?ie(t,i):"number"==typeof t&&"number"==typeof i&&isNaN(t)&&isNaN(i))){if(e===x){o=!1;break e}}else o=!0,(x=e).last=e.eq?_(t):t,e.fn(t,i===g?t:i,a),d<5&&(p[s=4-d]||(p[s]=[]),l=ee(e.exp)?"fn: "+(e.exp.name||e.exp.toString()):e.exp,l+="; newVal: "+E(t)+"; oldVal: "+E(i),p[s].push(l))}catch(e){v.$$phase=null,f(e)}if(!(n=a.$$childHead||a!==this&&a.$$nextSibling))for(;a!==this&&!(n=a.$$nextSibling);)a=a.$parent}while(a=n);if((o||h.length)&&!d--)throw v.$$phase=null,b("infdig",y,E(p))}while(o||h.length);for(v.$$phase=null;u.length;)try{u.shift()()}catch(e){f(e)}},$destroy:function(){if(!this.$$destroyed){var e=this.$parent;this.$broadcast("$destroy"),this.$$destroyed=!0,this!==v&&(Y(this.$$listenerCount,P(null,o,this)),e.$$childHead==this&&(e.$$childHead=this.$$nextSibling),e.$$childTail==this&&(e.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=this.$root=null,this.$$listeners={},this.$$watchers=this.$$asyncQueue=this.$$postDigestQueue=[],this.$destroy=this.$digest=this.$apply=S,this.$on=this.$watch=this.$watchGroup=function(){return S})}},$eval:function(e,t){return p(e)(this,t)},$evalAsync:function(e){v.$$phase||v.$$asyncQueue.length||t.defer(function(){v.$$asyncQueue.length&&v.$digest()}),this.$$asyncQueue.push({scope:this,expression:e})},$$postDigest:function(e){this.$$postDigestQueue.push(e)},$apply:function(e){try{return m("$apply"),this.$eval(e)}catch(e){f(e)}finally{v.$$phase=null;try{v.$digest()}catch(e){throw f(e),e}}},$on:function(e,t){var i=this.$$listeners[e];i||(this.$$listeners[e]=i=[]),i.push(t);for(var n=this;n.$$listenerCount[e]||(n.$$listenerCount[e]=0),n.$$listenerCount[e]++,n=n.$parent;);var r=this;return function(){i[w(i,t)]=null,o(r,1,e)}},$emit:function(e,t){var i,n,r,o=[],a=this,s=!1,l={name:e,targetScope:a,stopPropagation:function(){s=!0},preventDefault:function(){l.defaultPrevented=!0},defaultPrevented:!1},c=[l].concat(Wt.call(arguments,1));do{for(i=a.$$listeners[e]||o,l.currentScope=a,n=0,r=i.length;n<r;n++)if(i[n])try{i[n].apply(null,c)}catch(e){f(e)}else i.splice(n,1),n--,r--;if(s)break;a=a.$parent}while(a);return l},$broadcast:function(e,t){for(var i,n,r=this,o=this,a={name:e,targetScope:this,preventDefault:function(){a.defaultPrevented=!0},defaultPrevented:!1},s=[a].concat(Wt.call(arguments,1));r=o;){for(i=0,n=(o=(a.currentScope=r).$$listeners[e]||[]).length;i<n;i++)if(o[i])try{o[i].apply(null,s)}catch(e){f(e)}else o.splice(i,1),i--,n--;if(!(o=r.$$listenerCount[e]&&r.$$childHead||r!==this&&r.$$nextSibling))for(;r!==this&&!(o=r.$$nextSibling);)r=r.$parent}return a}};var v=new i;return v}]}function lt(){var r=/^\s*(https?|ftp|mailto|tel|file):/,o=/^\s*(https?|ftp|file|blob):|data:image\//;this.aHrefSanitizationWhitelist=function(e){return I(e)?(r=e,this):r},this.imgSrcSanitizationWhitelist=function(e){return I(e)?(o=e,this):o},this.$get=function(){return function(e,t){var i,n=t?o:r;return Bt&&!(8<=Bt)||(""===(i=ft(e).href)||i.match(n))?e:"unsafe:"+i}}}function ct(e){var t=[];return I(e)&&Y(e,function(e){t.push(function(e){if("self"===e)return e;if(J(e)){if(-1<e.indexOf("***"))throw Fi("iwcard",e);return e=e.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08").replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),RegExp("^"+e+"$")}if(o(e))return RegExp("^"+e.source+"$");throw Fi("imatcher")}(e))}),t}function ht(){this.SCE_CONTEXTS=Ui;var l=["self"],c=[];this.resourceUrlWhitelist=function(e){return arguments.length&&(l=ct(e)),l},this.resourceUrlBlacklist=function(e){return arguments.length&&(c=ct(e)),c},this.$get=["$injector",function(e){function t(e){var t=function(e){this.$$unwrapTrustedValue=function(){return e}};return e&&(t.prototype=new e),t.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},t.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},t}var a=function(e){throw Fi("unsafe")};e.has("$sanitize")&&(a=e.get("$sanitize"));var i=t(),s={};return s[Ui.HTML]=t(i),s[Ui.CSS]=t(i),s[Ui.URL]=t(i),s[Ui.JS]=t(i),s[Ui.RESOURCE_URL]=t(s[Ui.URL]),{trustAs:function(e,t){var i=s.hasOwnProperty(e)?s[e]:null;if(!i)throw Fi("icontext",e,t);if(null===t||t===Z||""===t)return t;if("string"!=typeof t)throw Fi("itype",e);return new i(t)},getTrusted:function(e,t){if(null===t||t===Z||""===t)return t;if((r=s.hasOwnProperty(e)?s[e]:null)&&t instanceof r)return t.$$unwrapTrustedValue();if(e===Ui.RESOURCE_URL){var i,n,r=ft(t.toString()),o=!1;for(i=0,n=l.length;i<n;i++)if("self"===l[i]?mt(r):l[i].exec(r.href)){o=!0;break}if(o)for(i=0,n=c.length;i<n;i++)if("self"===c[i]?mt(r):c[i].exec(r.href)){o=!1;break}if(o)return t;throw Fi("insecurl",t.toString())}if(e===Ui.HTML)return a(t);throw Fi("unsafe")},valueOf:function(e){return e instanceof i?e.$$unwrapTrustedValue():e}}}]}function ut(){var s=!0;this.enabled=function(e){return arguments.length&&(s=!!e),s},this.$get=["$parse","$sniffer","$sceDelegate",function(t,e,i){if(s&&e.msie&&e.msieDocumentMode<8)throw Fi("iequirks");var r=_(Ui);r.isEnabled=function(){return s},r.trustAs=i.trustAs,r.getTrusted=i.getTrusted,r.valueOf=i.valueOf,s||(r.trustAs=r.getTrusted=function(e,t){return t},r.valueOf=m),r.parseAs=function(i,e){var n=t(e);return n.literal&&n.constant?n:function(e,t){return r.getTrusted(i,n(e,t))}};var n=r.parseAs,o=r.getTrusted,a=r.trustAs;return Y(Ui,function(t,e){var i=jt(e);r[z("parse_as_"+i)]=function(e){return n(t,e)},r[z("get_trusted_"+i)]=function(e){return o(t,e)},r[z("trust_as_"+i)]=function(e){return a(t,e)}}),r}]}function dt(){this.$get=["$window","$document",function(e,t){var i,n={},r=v((/android (\d+)/.exec(jt((e.navigator||{}).userAgent))||[])[1]),o=/Boxee/i.test((e.navigator||{}).userAgent),a=t[0]||{},s=a.documentMode,l=/^(Moz|webkit|O|ms)(?=[A-Z])/,c=a.body&&a.body.style,h=!1,u=!1;if(c){for(var d in c)if(h=l.exec(d)){i=(i=h[0]).substr(0,1).toUpperCase()+i.substr(1);break}i||(i="WebkitOpacity"in c&&"webkit"),h=!!("transition"in c||i+"Transition"in c),u=!!("animation"in c||i+"Animation"in c),!r||h&&u||(h=J(a.body.style.webkitTransition),u=J(a.body.style.webkitAnimation))}return{history:!(!e.history||!e.history.pushState||r<4||o),hashchange:"onhashchange"in e&&(!s||7<s),hasEvent:function(e){if("input"==e&&9==Bt)return!1;if(O(n[e])){var t=a.createElement("div");n[e]="on"+e in t}return n[e]},csp:y(),vendorPrefix:i,transitions:h,animations:u,android:r,msie:Bt,msieDocumentMode:s}}]}function pt(){this.$get=["$rootScope","$browser","$q","$exceptionHandler",function(a,s,l,c){function e(e,t,i){var n=l.defer(),r=n.promise,o=I(i)&&!i;return t=s.defer(function(){try{n.resolve(e())}catch(e){n.reject(e),c(e)}finally{delete h[r.$$timeoutId]}o||a.$apply()},t),r.$$timeoutId=t,h[t]=n,r}var h={};return e.cancel=function(e){return!!(e&&e.$$timeoutId in h)&&(h[e.$$timeoutId].reject("canceled"),delete h[e.$$timeoutId],s.defer.cancel(e.$$timeoutId))},e}]}function ft(e,t){var i=e;return Bt&&($i.setAttribute("href",i),i=$i.href),$i.setAttribute("href",i),{href:$i.href,protocol:$i.protocol?$i.protocol.replace(/:$/,""):"",host:$i.host,search:$i.search?$i.search.replace(/^\?/,""):"",hash:$i.hash?$i.hash.replace(/^#/,""):"",hostname:$i.hostname,port:$i.port,pathname:"/"===$i.pathname.charAt(0)?$i.pathname:"/"+$i.pathname}}function mt(e){return(e=J(e)?ft(e):e).protocol===zi.protocol&&e.host===zi.host}function gt(){this.$get=R(p)}function vt(n){function r(e,t){if(K(e)){var i={};return Y(e,function(e,t){i[t]=r(t,e)}),i}return n.factory(e+o,t)}var o="Filter";this.register=r,this.$get=["$injector",function(t){return function(e){return t.get(e+o)}}],r("currency",bt),r("date",Ct),r("filter",yt),r("json",Rt),r("limitTo",At),r("lowercase",qi),r("number",xt),r("orderBy",Pt),r("uppercase",Xi)}function yt(){return function(e,i,n){if(!Q(e))return e;var t=typeof n,r=[];r.check=function(e){for(var t=0;t<r.length;t++)if(!r[t](e))return!1;return!0},"function"!==t&&(n="boolean"===t&&n?function(e,t){return Yt.equals(e,t)}:function(e,t){if(e&&t&&"object"==typeof e&&"object"==typeof t){for(var i in e)if("$"!==i.charAt(0)&&Vt.call(e,i)&&n(e[i],t[i]))return!0;return!1}return t=(""+t).toLowerCase(),-1<(""+e).toLowerCase().indexOf(t)});var o=function(e,t){if("string"==typeof t&&"!"===t.charAt(0))return!o(e,t.substr(1));switch(typeof e){case"boolean":case"number":case"string":return n(e,t);case"object":switch(typeof t){case"object":return n(e,t);default:for(var i in e)if("$"!==i.charAt(0)&&o(e[i],t))return!0}return!1;case"array":for(i=0;i<e.length;i++)if(o(e[i],t))return!0;return!1;default:return!1}};switch(typeof i){case"boolean":case"number":case"string":i={$:i};case"object":for(var a in i)!function(t){void 0!==i[t]&&r.push(function(e){return o("$"==t?e:e&&e[t],i[t])})}(a);break;case"function":r.push(i);break;default:return e}for(t=[],a=0;a<e.length;a++){var s=e[a];r.check(s)&&t.push(s)}return t}}function bt(e){var i=e.NUMBER_FORMATS;return function(e,t){return O(t)&&(t=i.CURRENCY_SYM),wt(e,i.PATTERNS[1],i.GROUP_SEP,i.DECIMAL_SEP,2).replace(/\u00A4/g,t)}}function xt(e){var i=e.NUMBER_FORMATS;return function(e,t){return wt(e,i.PATTERNS[0],i.GROUP_SEP,i.DECIMAL_SEP,t)}}function wt(e,t,i,n,r){if(null==e||!isFinite(e)||K(e))return"";var o=e<0,a=(e=Math.abs(e))+"",s="",l=[],c=!1;-1!==a.indexOf("e")&&((h=a.match(/([\d\.]+)e(-?)(\d+)/))&&"-"==h[2]&&h[3]>r+1?a="0":(s=a,c=!0));if(c)0<r&&-1<e&&e<1&&(s=e.toFixed(r));else{a=(a.split(ji)[1]||"").length,O(r)&&(r=Math.min(Math.max(t.minFrac,a),t.maxFrac)),a=Math.pow(10,r),a=(e=(""+(e=Math.round(e*a)/a)).split(ji))[0],e=e[1]||"";var h=0,u=t.lgSize,d=t.gSize;if(a.length>=u+d)for(h=a.length-u,c=0;c<h;c++)0==(h-c)%d&&0!==c&&(s+=i),s+=a.charAt(c);for(c=h;c<a.length;c++)0==(a.length-c)%u&&0!==c&&(s+=i),s+=a.charAt(c);for(;e.length<r;)e+="0";r&&"0"!==r&&(s+=n+e.substr(0,r))}return l.push(o?t.negPre:t.posPre),l.push(s),l.push(o?t.negSuf:t.posSuf),l.join("")}function _t(e,t,i){var n="";for(e<0&&(n="-",e=-e),e=""+e;e.length<t;)e="0"+e;return i&&(e=e.substr(e.length-t)),n+e}function Et(t,i,n,r){return n=n||0,function(e){return e=e["get"+t](),(0<n||-n<e)&&(e+=n),0===e&&-12==n&&(e=12),_t(e,i,r)}}function Tt(n,r){return function(e,t){var i=e["get"+n]();return t[Gt(r?"SHORT"+n:n)][i]}}function Mt(e){var t=new Date(e,0,1).getDay();return new Date(e,0,(t<=4?5:12)-t)}function St(i){return function(e){var t=Mt(e.getFullYear());return e=+new Date(e.getFullYear(),e.getMonth(),e.getDate()+(4-e.getDay()))-+t,_t(e=1+Math.round(e/6048e5),i)}}function Ct(a){var s=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(t,e){var i,n,r="",o=[];if(e=e||"mediumDate",e=a.DATETIME_FORMATS[e]||e,J(t)&&(t=Wi.test(t)?v(t):function(e){var t;if(t=e.match(s)){e=new Date(0);var i=0,n=0,r=t[8]?e.setUTCFullYear:e.setFullYear,o=t[8]?e.setUTCHours:e.setHours;t[9]&&(i=v(t[9]+t[10]),n=v(t[9]+t[11])),r.call(e,v(t[1]),v(t[2])-1,v(t[3])),i=v(t[4]||0)-i,n=v(t[5]||0)-n,r=v(t[6]||0),t=Math.round(1e3*parseFloat("0."+(t[7]||0))),o.call(e,i,n,r,t)}return e}(t)),c(t)&&(t=new Date(t)),!u(t))return t;for(;e;)e=(n=Gi.exec(e))?(o=o.concat(Wt.call(n,1))).pop():(o.push(e),null);return Y(o,function(e){i=Vi[e],r+=i?i(t,a.DATETIME_FORMATS):e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),r}}function Rt(){return function(e){return E(e,!0)}}function At(){return function(e,t){if(!Q(e)&&!J(e))return e;if(t=1/0===Math.abs(Number(t))?Number(t):v(t),J(e))return t?0<=t?e.slice(0,t):e.slice(t,e.length):"";var i,n,r=[];for(t>e.length?t=e.length:t<-e.length&&(t=-e.length),n=0<t?(i=0,t):(i=e.length+t,e.length);i<n;i++)r.push(e[i]);return r}}function Pt(h){return function(e,r,t){function o(i,e){return x(e)?function(e,t){return i(t,e)}:i}function a(e,t){var i=typeof e,n=typeof t;return i==n?("string"==i&&(e=e.toLowerCase(),t=t.toLowerCase()),e===t?0:e<t?-1:1):i<n?-1:1}if(!Q(e)||!r)return e;var n,s,l;r=Q(r)?r:[r],n=function(e){var t=!1,i=e||m;if(J(e)&&("+"!=e.charAt(0)&&"-"!=e.charAt(0)||(t="-"==e.charAt(0),e=e.substring(1)),(i=h(e)).constant)){var n=i();return o(function(e,t){return a(e[n],t[n])},t)}return o(function(e,t){return a(i(e),i(t))},t)},l=[],Y(r,function(e,t,i){l.push(n.call(s,e,t,i))}),r=l;for(var i=[],c=0;c<e.length;c++)i.push(e[c]);return i.sort(o(function(e,t){for(var i=0;i<r.length;i++){var n=r[i](e,t);if(0!==n)return n}return 0},t))}}function Lt(e){return ee(e)&&(e={link:e}),e.restrict=e.restrict||"AC",R(e)}function Ot(i,e,t,n){function r(e,t){t=t?"-"+re(t,"-"):"",n.removeClass(i,(e?fn:pn)+t),n.addClass(i,(e?pn:fn)+t)}var o=this,a=i.parent().controller("form")||Ki,s=0,l=o.$error={},c=[];o.$name=e.name||e.ngForm,o.$dirty=!1,o.$pristine=!0,o.$valid=!0,o.$invalid=!1,a.$addControl(o),i.addClass(mn),r(!0),o.$addControl=function(e){F(e.$name,"input"),c.push(e),e.$name&&(o[e.$name]=e)},o.$removeControl=function(i){i.$name&&o[i.$name]===i&&delete o[i.$name],Y(l,function(e,t){o.$setValidity(t,!0,i)}),A(c,i)},o.$setValidity=function(e,t,i){var n=l[e];if(t)n&&(A(n,i),n.length||(--s||(r(t),o.$valid=!0,o.$invalid=!1),r(!(l[e]=!1),e),a.$setValidity(e,!0,o)));else{if(s||r(t),n){if(-1!=w(n,i))return}else l[e]=n=[],s++,r(!1,e),a.$setValidity(e,!1,o);n.push(i),o.$valid=!1,o.$invalid=!0}},o.$setDirty=function(){n.removeClass(i,mn),n.addClass(i,gn),o.$dirty=!0,o.$pristine=!1,a.$setDirty()},o.$setPristine=function(){n.removeClass(i,gn),n.addClass(i,mn),o.$dirty=!1,o.$pristine=!0,Y(c,function(e){e.$setPristine()})}}function It(e,t,i,n){return e.$setValidity(t,i),i?n:Z}function Dt(n,r,o,a,e,t){var s=r.prop("validity"),l=r[0].placeholder,c={};if(!e.android){var h=!1;r.on("compositionstart",function(e){h=!0}),r.on("compositionend",function(){h=!1,i()})}var i=function(e){if(!h){var t=r.val(),i=e&&e.type;Bt&&"input"===(e||c).type&&r[0].placeholder!==l?l=r[0].placeholder:(x(o.ngTrim||"T")&&(t=Jt(t)),(a.$viewValue!==t||s&&""===t&&!s.valueMissing)&&(n.$$phase?a.$setViewValue(t,i):n.$apply(function(){a.$setViewValue(t,i)})))}};if(a.$options&&a.$options.updateOn&&r.on(a.$options.updateOn,i),!a.$options||a.$options.updateOnDefault){if(e.hasEvent("input"))r.on("input",i);else{var u,d=function(e){u||(u=t.defer(function(){i(e),u=null}))};r.on("keydown",function(e){var t=e.keyCode;91===t||15<t&&t<19||37<=t&&t<=40||d(e)}),e.hasEvent("paste")&&r.on("paste cut",d)}r.on("change",i)}a.$render=function(){r.val(a.$isEmpty(a.$viewValue)?"":a.$viewValue)};var p=o.ngPattern;if(p&&(e=(e=p.match(/^\/(.*)\/([gim]*)$/))?(p=RegExp(e[1],e[2]),function(e){return It(a,"pattern",a.$isEmpty(e)||p.test(e),e)}):function(e){var t=n.$eval(p);if(!t||!t.test)throw g("ngPattern")("noregexp",p,t,ne(r));return It(a,"pattern",a.$isEmpty(e)||t.test(e),e)},a.$formatters.push(e),a.$parsers.push(e)),o.ngMinlength){var f=v(o.ngMinlength);e=function(e){return It(a,"minlength",a.$isEmpty(e)||e.length>=f,e)},a.$parsers.push(e),a.$formatters.push(e)}if(o.ngMaxlength){var m=v(o.ngMaxlength);e=function(e){return It(a,"maxlength",a.$isEmpty(e)||e.length<=m,e)},a.$parsers.push(e),a.$formatters.push(e)}}function kt(t,n){return function(e){var i;return u(e)?e:J(e)&&(t.lastIndex=0,e=t.exec(e))?(e.shift(),i={yyyy:0,MM:1,dd:1,HH:0,mm:0},Y(e,function(e,t){t<n.length&&(i[n[t]]=+e)}),new Date(i.yyyy,i.MM-1,i.dd,i.HH,i.mm)):NaN}}function Nt(s,l,c,h){return function(e,t,i,n,r,o,a){Dt(e,t,i,n,r,o),n.$parsers.push(function(e){return n.$isEmpty(e)?(n.$setValidity(s,!0),null):l.test(e)?(n.$setValidity(s,!0),c(e)):(n.$setValidity(s,!1),Z)}),n.$formatters.push(function(e){return u(e)?a("date")(e,h):""}),i.min&&(e=function(e){var t=n.$isEmpty(e)||c(e)>=c(i.min);return n.$setValidity("min",t),t?e:Z},n.$parsers.push(e),n.$formatters.push(e)),i.max&&(e=function(e){var t=n.$isEmpty(e)||c(e)<=c(i.max);return n.$setValidity("max",t),t?e:Z},n.$parsers.push(e),n.$formatters.push(e))}}function Ht(d,p){return d="ngClass"+d,["$animate",function(c){function h(e,t){var i=[],n=0;e:for(;n<e.length;n++){for(var r=e[n],o=0;o<t.length;o++)if(r==t[o])continue e;i.push(r)}return i}function u(e){if(!Q(e)){if(J(e))return e.split(" ");if(K(e)){var i=[];return Y(e,function(e,t){e&&i.push(t)}),i}}return e}return{restrict:"AC",link:function(r,o,a){function s(e,t){var i=o.data("$classCounts")||{},n=[];return Y(e,function(e){(0<t||i[e])&&(i[e]=(i[e]||0)+t,i[e]===+(0<t)&&n.push(e))}),o.data("$classCounts",i),n.join(" ")}function t(e){if(!0===p||r.$index%2===p){var t=u(e||[]);if(l){if(!ie(e,l)){var i=u(l);n=h(t,i),t=s(t=h(i,t),-1);0===(n=s(n,1)).length?c.removeClass(o,t):0===t.length?c.addClass(o,n):c.setClass(o,n,t)}}else{var n=s(t,1);a.$addClass(n)}}l=_(e)}var l;r.$watch(a[d],t,!0),a.$observe("class",function(e){t(r.$eval(a[d]))}),"ngClass"!==d&&r.$watch("$index",function(e,t){var i=1&e;if(i!==t&1){var n=u(r.$eval(a[d]));i===p?(i=s(n,1),a.$addClass(i)):(i=s(n,-1),a.$removeClass(i))}})}}}]}var Bt,Ft,Ut,$t,zt,jt=function(e){return J(e)?e.toLowerCase():e},Vt=Object.prototype.hasOwnProperty,Gt=function(e){return J(e)?e.toUpperCase():e},Wt=[].slice,qt=[].push,Xt=Object.prototype.toString,Zt=g("ng"),Yt=p.angular||(p.angular={}),Kt=["0","0","0"];Bt=v((/msie (\d+)/.exec(jt(navigator.userAgent))||[])[1]),isNaN(Bt)&&(Bt=v((/trident\/.*; rv:(\d+)/.exec(jt(navigator.userAgent))||[])[1])),S.$inject=[],m.$inject=[];var Jt=String.prototype.trim?function(e){return J(e)?e.trim():e}:function(e){return J(e)?e.replace(/^\s\s*/,"").replace(/\s\s*$/,""):e};zt=Bt<9?function(e){return(e=e.nodeName?e:e[0]).scopeName&&"HTML"!=e.scopeName?Gt(e.scopeName+":"+e.nodeName):e.nodeName}:function(e){return e.nodeName?e.nodeName:e[0].nodeName};var Qt=["ng-","data-ng-","ng:","x-ng-"],ei=/[A-Z]/g,ti={full:"1.3.0-beta.7",major:1,minor:3,dot:0,codeName:"proper-attribution"},ii=j.cache={},ni=j.expando="ng-"+(new Date).getTime(),ri=1,oi=p.document.addEventListener?function(e,t,i){e.addEventListener(t,i,!1)}:function(e,t,i){e.attachEvent("on"+t,i)},ai=p.document.removeEventListener?function(e,t,i){e.removeEventListener(t,i,!1)}:function(e,t,i){e.detachEvent("on"+t,i)};j._data=function(e){return this.cache[e[this.expando]]||{}};var si=/([\:\-\_]+(.))/g,li=/^moz([A-Z])/,ci=g("jqLite"),hi=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ui=/<|&#?\w+;/,di=/<([\w:]+)/,pi=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,fi={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};fi.optgroup=fi.option,fi.tbody=fi.tfoot=fi.colgroup=fi.caption=fi.thead,fi.th=fi.td;var mi=j.prototype={ready:function(e){function t(){i||(i=!0,e())}var i=!1;"complete"===X.readyState?setTimeout(t):(this.on("DOMContentLoaded",t),j(p).on("load",t))},toString:function(){var t=[];return Y(this,function(e){t.push(""+e)}),"["+t.join(", ")+"]"},eq:function(e){return Ft(0<=e?this[e]:this[this.length+e])},length:0,push:qt,sort:[].sort,splice:[].splice},gi={};Y("multiple selected checked disabled readOnly required open".split(" "),function(e){gi[jt(e)]=e});var vi={};Y("input select option textarea button form details".split(" "),function(e){vi[Gt(e)]=!0}),Y({data:q,inheritedData:de,scope:function(e){return Ft(e).data("$scope")||de(e.parentNode||e,["$isolateScope","$scope"])},isolateScope:function(e){return Ft(e).data("$isolateScope")||Ft(e).data("$isolateScopeNoTemplate")},controller:ue,injector:function(e){return de(e,"$injector")},removeAttr:function(e,t){e.removeAttribute(t)},hasClass:se,css:function(e,t,i){var n;if(t=z(t),!I(i))return Bt<=8&&(""===(n=e.currentStyle&&e.currentStyle[t])&&(n="auto")),n=n||e.style[t],Bt<=8&&(n=""===n?Z:n),n;e.style[t]=i},attr:function(e,t,i){var n=jt(t);if(gi[n]){if(!I(i))return e[t]||(e.attributes.getNamedItem(t)||S).specified?n:Z;i?(e[t]=!0,e.setAttribute(t,n)):(e[t]=!1,e.removeAttribute(n))}else if(I(i))e.setAttribute(t,i);else if(e.getAttribute)return null===(e=e.getAttribute(t,2))?Z:e},prop:function(e,t,i){if(!I(i))return e[t];e[t]=i},text:function(){function e(e,t){var i=n[e.nodeType];if(O(t))return i?e[i]:"";e[i]=t}var n=[];return Bt<9?(n[1]="innerText",n[3]="nodeValue"):n[1]=n[3]="textContent",e.$dv="",e}(),val:function(e,t){if(O(t)){if("SELECT"===zt(e)&&e.multiple){var i=[];return Y(e.options,function(e){e.selected&&i.push(e.value||e.text)}),0===i.length?null:i}return e.value}e.value=t},html:function(e,t){if(O(t))return e.innerHTML;for(var i=0,n=e.childNodes;i<n.length;i++)V(n[i]);e.innerHTML=t},empty:pe},function(a,e){j.prototype[e]=function(e,t){var i,n;if(a!==pe&&(2==a.length&&a!==se&&a!==ue?e:t)===Z){if(K(e)){for(i=0;i<this.length;i++)if(a===q)a(this[i],e);else for(n in e)a(this[i],n,e[n]);return this}n=(i=a.$dv)===Z?Math.min(this.length,1):this.length;for(var r=0;r<n;r++){var o=a(this[r],e,t);i=i?i+o:o}return i}for(i=0;i<this.length;i++)a(this[i],e,t);return this}}),Y({removeData:n,dealoc:V,on:function t(r,e,o,i){if(I(i))throw ci("onargs");var n,a,s,l=W(r,"events"),c=W(r,"handle");l||W(r,"events",l={}),c||W(r,"handle",(a=l,(s=function(t,e){if(t.preventDefault||(t.preventDefault=function(){t.returnValue=!1}),t.stopPropagation||(t.stopPropagation=function(){t.cancelBubble=!0}),t.target||(t.target=t.srcElement||X),O(t.defaultPrevented)){var i=t.preventDefault;t.preventDefault=function(){t.defaultPrevented=!0,i.call(t)},t.defaultPrevented=!1}t.isDefaultPrevented=function(){return t.defaultPrevented||!1===t.returnValue},Y(te(a[e||t.type]||[]),function(e){e.call(n,t)}),Bt<=8?(t.preventDefault=null,t.stopPropagation=null,t.isDefaultPrevented=null):(delete t.preventDefault,delete t.stopPropagation,delete t.isDefaultPrevented)}).elem=n=r,c=s)),Y(e.split(" "),function(i){var e=l[i];if(!e){if("mouseenter"==i||"mouseleave"==i){var n=X.body.contains||X.body.compareDocumentPosition?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1};l[i]=[],t(r,{mouseleave:"mouseout",mouseenter:"mouseover"}[i],function(e){var t=e.relatedTarget;t&&(t===this||n(this,t))||c(e,i)})}else oi(r,i,c),l[i]=[];e=l[i]}e.push(o)})},off:G,one:function(t,i,n){(t=Ft(t)).on(i,function e(){t.off(i,n),t.off(i,e)}),t.on(i,n)},replaceWith:function(t,e){var i,n=t.parentNode;V(t),Y(new j(e),function(e){i?n.insertBefore(e,i.nextSibling):n.replaceChild(e,t),i=e})},children:function(e){var t=[];return Y(e.childNodes,function(e){1===e.nodeType&&t.push(e)}),t},contents:function(e){return e.contentDocument||e.childNodes||[]},append:function(t,e){Y(new j(e),function(e){1!==t.nodeType&&11!==t.nodeType||t.appendChild(e)})},prepend:function(t,e){if(1===t.nodeType){var i=t.firstChild;Y(new j(e),function(e){t.insertBefore(e,i)})}},wrap:function(e,t){t=Ft(t)[0];var i=e.parentNode;i&&i.replaceChild(t,e),t.appendChild(e)},remove:function(e){V(e);var t=e.parentNode;t&&t.removeChild(e)},after:function(e,t){var i=e,n=e.parentNode;Y(new j(t),function(e){n.insertBefore(e,i.nextSibling),i=e})},addClass:ce,removeClass:le,toggleClass:function(i,e,n){e&&Y(e.split(" "),function(e){var t=n;O(t)&&(t=!se(i,e)),(t?ce:le)(i,e)})},parent:function(e){return(e=e.parentNode)&&11!==e.nodeType?e:null},next:function(e){if(e.nextElementSibling)return e.nextElementSibling;for(e=e.nextSibling;null!=e&&1!==e.nodeType;)e=e.nextSibling;return e},find:function(e,t){return e.getElementsByTagName?e.getElementsByTagName(t):[]},clone:ae,triggerHandler:function(t,e,i){e=(W(t,"events")||{})[e],i=i||[];var n=[{preventDefault:S,stopPropagation:S}];Y(e,function(e){e.apply(t,n.concat(i))})}},function(o,e){j.prototype[e]=function(e,t,i){for(var n,r=0;r<this.length;r++)O(n)?I(n=o(this[r],e,t,i))&&(n=Ft(n)):he(n,o(this[r],e,t,i));return I(n)?n:this},j.prototype.bind=j.prototype.on,j.prototype.unbind=j.prototype.off}),ge.prototype={put:function(e,t){this[me(e)]=t},get:function(e){return this[me(e)]},remove:function(e){var t=this[e=me(e)];return delete this[e],t}};var yi=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,bi=/,/,xi=/^\s*(_?)(\S+?)\1\s*$/,wi=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,_i=g("$injector");ye.$$annotate=ve;var Ei=g("$animate"),Ti=["$provide",function(n){this.$$selectors={},this.register=function(e,t){var i=e+"-animation";if(e&&"."!=e.charAt(0))throw Ei("notcsel",e);this.$$selectors[e.substr(1)]=i,n.factory(i,t)},this.classNameFilter=function(e){return 1===arguments.length&&(this.$$classNameFilter=e instanceof RegExp?e:null),this.$$classNameFilter},this.$get=["$timeout","$$asyncCallback",function(e,r){return{enter:function(e,t,i,n){i?i.after(e):t.prepend(e),n&&r(n)},leave:function(e,t){e.remove(),t&&r(t)},move:function(e,t,i,n){this.enter(e,t,i,n)},addClass:function(e,t,i){t=J(t)?t:Q(t)?t.join(" "):"",Y(e,function(e){ce(e,t)}),i&&r(i)},removeClass:function(e,t,i){t=J(t)?t:Q(t)?t.join(" "):"",Y(e,function(e){le(e,t)}),i&&r(i)},setClass:function(e,t,i,n){Y(e,function(e){ce(e,t),le(e,i)}),n&&r(n)},enabled:S}}]}],Mi=g("$compile");Me.$inject=["$provide","$$sanitizeUriProvider"];var Si=/^(x[\:\-_]|data[\:\-_])/i,Ci=g("$interpolate"),Ri=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,Ai={http:80,https:443,ftp:21},Pi=g("$location");Xe.prototype=qe.prototype=We.prototype={$$html5:!1,$$replace:!1,absUrl:Ze("$$absUrl"),url:function(e,t){if(O(e))return this.$$url;var i=Ri.exec(e);return i[1]&&this.path(decodeURIComponent(i[1])),(i[2]||i[1])&&this.search(i[3]||""),this.hash(i[5]||"",t),this},protocol:Ze("$$protocol"),host:Ze("$$host"),port:Ze("$$port"),path:Ye("$$path",function(e){return"/"==e.charAt(0)?e:"/"+e}),search:function(e,t){switch(arguments.length){case 0:return this.$$search;case 1:if(J(e))this.$$search=T(e);else{if(!K(e))throw Pi("isrcharg");this.$$search=e}break;default:O(t)||null===t?delete this.$$search[e]:this.$$search[e]=t}return this.$$compose(),this},hash:Ye("$$hash",m),replace:function(){return this.$$replace=!0,this}};var Li,Oi=g("$parse"),Ii={},Di={null:function(){return null},true:function(){return!0},false:function(){return!1},undefined:S,"+":function(e,t,i,n){return i=i(e,t),n=n(e,t),I(i)?I(n)?i+n:i:I(n)?n:Z},"-":function(e,t,i,n){return i=i(e,t),n=n(e,t),(I(i)?i:0)-(I(n)?n:0)},"*":function(e,t,i,n){return i(e,t)*n(e,t)},"/":function(e,t,i,n){return i(e,t)/n(e,t)},"%":function(e,t,i,n){return i(e,t)%n(e,t)},"^":function(e,t,i,n){return i(e,t)^n(e,t)},"=":S,"===":function(e,t,i,n){return i(e,t)===n(e,t)},"!==":function(e,t,i,n){return i(e,t)!==n(e,t)},"==":function(e,t,i,n){return i(e,t)==n(e,t)},"!=":function(e,t,i,n){return i(e,t)!=n(e,t)},"<":function(e,t,i,n){return i(e,t)<n(e,t)},">":function(e,t,i,n){return i(e,t)>n(e,t)},"<=":function(e,t,i,n){return i(e,t)<=n(e,t)},">=":function(e,t,i,n){return i(e,t)>=n(e,t)},"&&":function(e,t,i,n){return i(e,t)&&n(e,t)},"||":function(e,t,i,n){return i(e,t)||n(e,t)},"&":function(e,t,i,n){return i(e,t)&n(e,t)},"|":function(e,t,i,n){return n(e,t)(e,t,i(e,t))},"!":function(e,t,i){return!i(e,t)}},ki={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},Ni=function(e){this.options=e};Ni.prototype={constructor:Ni,lex:function(e){var t;for(this.text=e,this.index=0,this.ch=Z,this.lastCh=":",this.tokens=[],e=[];this.index<this.text.length;){if(this.ch=this.text.charAt(this.index),this.is("\"'"))this.readString(this.ch);else if(this.isNumber(this.ch)||this.is(".")&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(this.ch))this.readIdent(),this.was("{,")&&"{"===e[0]&&(t=this.tokens[this.tokens.length-1])&&(t.json=-1===t.text.indexOf("."));else if(this.is("(){}[].,;:?"))this.tokens.push({index:this.index,text:this.ch,json:this.was(":[,")&&this.is("{[")||this.is("}]:,")}),this.is("{[")&&e.unshift(this.ch),this.is("}]")&&e.shift(),this.index++;else{if(this.isWhitespace(this.ch)){this.index++;continue}var i=this.ch+this.peek(),n=i+this.peek(2),r=Di[this.ch],o=Di[i],a=Di[n];a?(this.tokens.push({index:this.index,text:n,fn:a}),this.index+=3):o?(this.tokens.push({index:this.index,text:i,fn:o}),this.index+=2):r?(this.tokens.push({index:this.index,text:this.ch,fn:r,json:this.was("[,:")&&this.is("+-")}),this.index+=1):this.throwError("Unexpected next character ",this.index,this.index+1)}this.lastCh=this.ch}return this.tokens},is:function(e){return-1!==e.indexOf(this.ch)},was:function(e){return-1!==e.indexOf(this.lastCh)},peek:function(e){return e=e||1,this.index+e<this.text.length&&this.text.charAt(this.index+e)},isNumber:function(e){return"0"<=e&&e<="9"},isWhitespace:function(e){return" "===e||"\r"===e||"\t"===e||"\n"===e||"\v"===e||" "===e},isIdent:function(e){return"a"<=e&&e<="z"||"A"<=e&&e<="Z"||"_"===e||"$"===e},isExpOperator:function(e){return"-"===e||"+"===e||this.isNumber(e)},throwError:function(e,t,i){throw i=i||this.index,t=I(t)?"s "+t+"-"+this.index+" ["+this.text.substring(t,i)+"]":" "+i,Oi("lexerr",e,t,this.text)},readNumber:function(){for(var e="",t=this.index;this.index<this.text.length;){var i=jt(this.text.charAt(this.index));if("."==i||this.isNumber(i))e+=i;else{var n=this.peek();if("e"==i&&this.isExpOperator(n))e+=i;else if(this.isExpOperator(i)&&n&&this.isNumber(n)&&"e"==e.charAt(e.length-1))e+=i;else{if(!this.isExpOperator(i)||n&&this.isNumber(n)||"e"!=e.charAt(e.length-1))break;this.throwError("Invalid exponent")}}this.index++}e*=1,this.tokens.push({index:t,text:e,json:!0,fn:function(){return e}})},readIdent:function(){for(var e,t,i,n,r=this,o="",a=this.index;this.index<this.text.length&&("."===(n=this.text.charAt(this.index))||this.isIdent(n)||this.isNumber(n));)"."===n&&(e=this.index),o+=n,this.index++;if(e)for(t=this.index;t<this.text.length;){if("("===(n=this.text.charAt(t))){i=o.substr(e-a+1),o=o.substr(0,e-a),this.index=t;break}if(!this.isWhitespace(n))break;t++}if(a={index:a,text:o},Di.hasOwnProperty(o))a.fn=Di[o],a.json=Di[o];else{var s=nt(o,this.options,this.text);a.fn=C(function(e,t){return s(e,t)},{assign:function(e,t){return tt(e,o,t,r.text,r.options)}})}this.tokens.push(a),i&&(this.tokens.push({index:e,text:".",json:!1}),this.tokens.push({index:e+1,text:i,json:!1}))},readString:function(e){var t=this.index;this.index++;for(var i="",n=e,r=!1;this.index<this.text.length;){var o=this.text.charAt(this.index);n=n+o;if(r)"u"===o?((o=this.text.substring(this.index+1,this.index+5)).match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+o+"]"),this.index+=4,i+=String.fromCharCode(parseInt(o,16))):i=(r=ki[o])?i+r:i+o,r=!1;else if("\\"===o)r=!0;else{if(o===e)return this.index++,void this.tokens.push({index:t,text:n,string:i,json:!0,fn:function(){return i}});i+=o}this.index++}this.throwError("Unterminated quote",t)}};var Hi=function(e,t,i){this.lexer=e,this.$filter=t,this.options=i};Hi.ZERO=C(function(){return 0},{constant:!0}),Hi.prototype={constructor:Hi,parse:function(e,t){this.text=e,this.json=t,this.tokens=this.lexer.lex(e),t&&(this.assignment=this.logicalOR,this.functionCall=this.fieldAccess=this.objectIndex=this.filterChain=function(){this.throwError("is not valid json",{text:e,index:0})});var i=t?this.primary():this.statements();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),i.literal=!!i.literal,i.constant=!!i.constant,i},primary:function(){var e,t;if(this.expect("("))e=this.filterChain(),this.consume(")");else if(this.expect("["))e=this.arrayDeclaration();else if(this.expect("{"))e=this.object();else{var i=this.expect();(e=i.fn)||this.throwError("not a primary expression",i),i.json&&(e.constant=!0,e.literal=!0)}for(;i=this.expect("(","[",".");)"("===i.text?(e=this.functionCall(e,t),t=null):"["===i.text?(t=e,e=this.objectIndex(e)):"."===i.text?(t=e,e=this.fieldAccess(e)):this.throwError("IMPOSSIBLE");return e},throwError:function(e,t){throw Oi("syntax",t.text,e,t.index+1,this.text,this.text.substring(t.index))},peekToken:function(){if(0===this.tokens.length)throw Oi("ueoe",this.text);return this.tokens[0]},peek:function(e,t,i,n){if(0<this.tokens.length){var r=this.tokens[0],o=r.text;if(o===e||o===t||o===i||o===n||!(e||t||i||n))return r}return!1},expect:function(e,t,i,n){return!!(e=this.peek(e,t,i,n))&&(this.json&&!e.json&&this.throwError("is not valid json",e),this.tokens.shift(),e)},consume:function(e){this.expect(e)||this.throwError("is unexpected, expecting ["+e+"]",this.peek())},unaryFn:function(i,n){return C(function(e,t){return i(e,t,n)},{constant:n.constant})},ternaryFn:function(i,n,r){return C(function(e,t){return i(e,t)?n(e,t):r(e,t)},{constant:i.constant&&n.constant&&r.constant})},binaryFn:function(i,n,r){return C(function(e,t){return n(e,t,i,r)},{constant:i.constant&&r.constant})},statements:function(){for(var o=[];;)if(0<this.tokens.length&&!this.peek("}",")",";","]")&&o.push(this.filterChain()),!this.expect(";"))return 1===o.length?o[0]:function(e,t){for(var i,n=0;n<o.length;n++){var r=o[n];r&&(i=r(e,t))}return i}},filterChain:function(){for(var e,t=this.expression();;){if(!(e=this.expect("|")))return t;t=this.binaryFn(t,e.fn,this.filter())}},filter:function(){for(var e=this.expect(),r=this.$filter(e.text),o=[];;){if(!(e=this.expect(":"))){var t=function(e,t,i){i=[i];for(var n=0;n<o.length;n++)i.push(o[n](e,t));return r.apply(e,i)};return function(){return t}}o.push(this.expression())}},expression:function(){return this.assignment()},assignment:function(){var i,e,n=this.ternary();return(e=this.expect("="))?(n.assign||this.throwError("implies assignment but ["+this.text.substring(0,e.index)+"] can not be assigned to",e),i=this.ternary(),function(e,t){return n.assign(e,i(e,t),t)}):n},ternary:function(){var e,t,i=this.logicalOR();return this.expect("?")?(e=this.ternary(),(t=this.expect(":"))?this.ternaryFn(i,e,this.ternary()):void this.throwError("expected :",t)):i},logicalOR:function(){for(var e,t=this.logicalAND();;){if(!(e=this.expect("||")))return t;t=this.binaryFn(t,e.fn,this.logicalAND())}},logicalAND:function(){var e,t=this.equality();return(e=this.expect("&&"))&&(t=this.binaryFn(t,e.fn,this.logicalAND())),t},equality:function(){var e,t=this.relational();return(e=this.expect("==","!=","===","!=="))&&(t=this.binaryFn(t,e.fn,this.equality())),t},relational:function(){var e,t=this.additive();return(e=this.expect("<",">","<=",">="))&&(t=this.binaryFn(t,e.fn,this.relational())),t},additive:function(){for(var e,t=this.multiplicative();e=this.expect("+","-");)t=this.binaryFn(t,e.fn,this.multiplicative());return t},multiplicative:function(){for(var e,t=this.unary();e=this.expect("*","/","%");)t=this.binaryFn(t,e.fn,this.unary());return t},unary:function(){var e;return this.expect("+")?this.primary():(e=this.expect("-"))?this.binaryFn(Hi.ZERO,e.fn,this.unary()):(e=this.expect("!"))?this.unaryFn(e.fn,this.unary()):this.primary()},fieldAccess:function(n){var r=this,o=this.expect().text,a=nt(o,this.options,this.text);return C(function(e,t,i){return a(i||n(e,t))},{assign:function(e,t,i){return tt(n(e,i),o,t,r.text,r.options)}})},objectIndex:function(o){var a=this,s=this.expression();return this.consume("]"),C(function(e,t){var i,n=o(e,t),r=s(e,t);return n?((n=et(n[r],a.text))&&n.then&&a.options.unwrapPromises&&("$$v"in(i=n)||(i.$$v=Z,i.then(function(e){i.$$v=e})),n=n.$$v),n):Z},{assign:function(e,t,i){var n=s(e,i);return et(o(e,i),a.text)[n]=t}})},functionCall:function(o,a){var s=[];if(")"!==this.peekToken().text)for(;s.push(this.expression()),this.expect(","););this.consume(")");var l=this;return function(e,t){for(var i=[],n=a?a(e,t):e,r=0;r<s.length;r++)i.push(s[r](e,t));return r=o(e,t,n)||S,et(n,l.text),et(r,l.text),et(i=r.apply?r.apply(n,i):r(i[0],i[1],i[2],i[3],i[4]),l.text)}},arrayDeclaration:function(){var r=[],e=!0;if("]"!==this.peekToken().text)do{if(this.peek("]"))break;var t=this.expression();r.push(t),t.constant||(e=!1)}while(this.expect(","));return this.consume("]"),C(function(e,t){for(var i=[],n=0;n<r.length;n++)i.push(r[n](e,t));return i},{literal:!0,constant:e})},object:function(){var o=[],e=!0;if("}"!==this.peekToken().text)do{if(this.peek("}"))break;var t=(t=this.expect()).string||t.text;this.consume(":");var i=this.expression();o.push({key:t,value:i}),i.constant||(e=!1)}while(this.expect(","));return this.consume("}"),C(function(e,t){for(var i={},n=0;n<o.length;n++){var r=o[n];i[r.key]=r.value(e,t)}return i},{literal:!0,constant:e})}};var Bi={},Fi=g("$sce"),Ui={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},$i=X.createElement("a"),zi=ft(p.location.href);vt.$inject=["$provide"],bt.$inject=["$locale"],xt.$inject=["$locale"];var ji=".",Vi={yyyy:Et("FullYear",4),yy:Et("FullYear",2,0,!0),y:Et("FullYear",1),MMMM:Tt("Month"),MMM:Tt("Month",!0),MM:Et("Month",2,1),M:Et("Month",1,1),dd:Et("Date",2),d:Et("Date",1),HH:Et("Hours",2),H:Et("Hours",1),hh:Et("Hours",2,-12),h:Et("Hours",1,-12),mm:Et("Minutes",2),m:Et("Minutes",1),ss:Et("Seconds",2),s:Et("Seconds",1),sss:Et("Milliseconds",3),EEEE:Tt("Day"),EEE:Tt("Day",!0),a:function(e,t){return e.getHours()<12?t.AMPMS[0]:t.AMPMS[1]},Z:function(e){return(0<=(e=-1*e.getTimezoneOffset())?"+":"")+(_t(Math[0<e?"floor":"ceil"](e/60),2)+_t(Math.abs(e%60),2))},ww:St(2),w:St(1)},Gi=/((?:[^yMdHhmsaZEw']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z|w+))(.*)/,Wi=/^\-?\d+$/;Ct.$inject=["$locale"];var qi=R(jt),Xi=R(Gt);Pt.$inject=["$parse"];var Zi=R({restrict:"E",compile:function(e,t){if(Bt<=8&&(t.href||t.name||t.$set("href",""),e.append(X.createComment("IE fix"))),!t.href&&!t.xlinkHref&&!t.name)return function(e,t){var i="[object SVGAnimatedString]"===Xt.call(t.prop("href"))?"xlink:href":"href";t.on("click",function(e){t.attr(i)||e.preventDefault()})}}}),Yi={};Y(gi,function(e,n){if("multiple"!=e){var r=Se("ng-"+n);Yi[r]=function(){return{priority:100,link:function(e,t,i){e.$watch(i[r],function(e){i.$set(n,!!e)})}}}}}),Y(["src","srcset","href"],function(o){var a=Se("ng-"+o);Yi[a]=function(){return{priority:99,link:function(e,t,i){var n=o,r=o;"href"===o&&"[object SVGAnimatedString]"===Xt.call(t.prop("href"))&&(r="xlinkHref",i.$attr[r]="xlink:href",n=null),i.$observe(a,function(e){e&&(i.$set(r,e),Bt&&n&&t.prop(n,i[r]))})}}}});var Ki={$addControl:S,$removeControl:S,$setValidity:S,$setDirty:S,$setPristine:S};Ot.$inject=["$element","$attrs","$scope","$animate"];var Ji=function(e){return["$timeout",function(s){return{name:"form",restrict:e?"EAC":"E",controller:Ot,compile:function(){return{pre:function(e,t,i,n){if(!i.action){var r=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1};oi(t[0],"submit",r),t.on("$destroy",function(){s(function(){ai(t[0],"submit",r)},0,!1)})}var o=t.parent().controller("form"),a=i.name||i.ngForm;a&&tt(e,a,n,a),o&&t.on("$destroy",function(){o.$removeControl(n),a&&tt(e,a,Z,a),C(n,Ki)})}}}}}]},Qi=Ji(),en=Ji(!0),tn=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,nn=/^[a-z0-9!#$%&'*+/=?^_`{|}~.-]+@[a-z0-9-]+(\.[a-z0-9-]+)*$/i,rn=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,on=/^(\d{4})-(\d{2})-(\d{2})$/,an=/^(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d)$/,sn=/^(\d{4})-W(\d\d)$/,ln=/^(\d{4})-(\d\d)$/,cn=/^(\d\d):(\d\d)$/,hn=/(\b|^)default(\b|$)/,un={text:Dt,date:Nt("date",on,kt(on,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":Nt("datetimelocal",an,kt(an,["yyyy","MM","dd","HH","mm"]),"yyyy-MM-ddTHH:mm"),time:Nt("time",cn,kt(cn,["HH","mm"]),"HH:mm"),week:Nt("week",sn,function(e){if(u(e))return e;if(J(e)&&(sn.lastIndex=0,i=sn.exec(e))){e=+i[1];var t=+i[2],i=Mt(e);t=7*(t-1);return new Date(e,0,i.getDate()+t)}return NaN},"yyyy-Www"),month:Nt("month",ln,kt(ln,["yyyy","MM"]),"yyyy-MM"),number:function(e,t,i,n,r,o){var a,s,l;Dt(e,t,i,n,r,o),n.$parsers.push(function(e){var t=n.$isEmpty(e);return t||rn.test(e)?(n.$setValidity("number",!0),""===e?null:t?e:parseFloat(e)):(n.$setValidity("number",!1),Z)}),a=n,s="number",K(l=t.prop("validity"))&&a.$parsers.push(function(e){if(a.$error[s]||!(l.badInput||l.customError||l.typeMismatch)||l.valueMissing)return e;a.$setValidity(s,!1)}),n.$formatters.push(function(e){return n.$isEmpty(e)?"":""+e}),i.min&&(e=function(e){var t=parseFloat(i.min);return It(n,"min",n.$isEmpty(e)||t<=e,e)},n.$parsers.push(e),n.$formatters.push(e)),i.max&&(e=function(e){var t=parseFloat(i.max);return It(n,"max",n.$isEmpty(e)||e<=t,e)},n.$parsers.push(e),n.$formatters.push(e)),n.$formatters.push(function(e){return It(n,"number",n.$isEmpty(e)||c(e),e)})},url:function(e,t,i,n,r,o){Dt(e,t,i,n,r,o),e=function(e){return It(n,"url",n.$isEmpty(e)||tn.test(e),e)},n.$formatters.push(e),n.$parsers.push(e)},email:function(e,t,i,n,r,o){Dt(e,t,i,n,r,o),e=function(e){return It(n,"email",n.$isEmpty(e)||nn.test(e),e)},n.$formatters.push(e),n.$parsers.push(e)},radio:function(t,i,n,r){O(n.name)&&i.attr("name",a());var e=function(e){i[0].checked&&t.$apply(function(){r.$setViewValue(n.value,e&&e.type)})};r.$options&&r.$options.updateOn&&i.on(r.$options.updateOn,e),r.$options&&!r.$options.updateOnDefault||i.on("click",e),r.$render=function(){i[0].checked=n.value==r.$viewValue},n.$observe("value",r.$render)},checkbox:function(t,i,e,n){var r=e.ngTrueValue,o=e.ngFalseValue;J(r)||(r=!0),J(o)||(o=!1),e=function(e){t.$apply(function(){n.$setViewValue(i[0].checked,e&&e.type)})},n.$options&&n.$options.updateOn&&i.on(n.$options.updateOn,e),n.$options&&!n.$options.updateOnDefault||i.on("click",e),n.$render=function(){i[0].checked=n.$viewValue},n.$isEmpty=function(e){return e!==r},n.$formatters.push(function(e){return e===r}),n.$parsers.push(function(e){return e?r:o})},hidden:S,button:S,submit:S,reset:S,file:S},dn=["$browser","$sniffer","$filter",function(r,o,a){return{restrict:"E",require:["?ngModel"],link:function(e,t,i,n){n[0]&&(un[jt(i.type)]||un.text)(e,t,i,n[0],o,r,a)}}}],pn="ng-valid",fn="ng-invalid",mn="ng-pristine",gn="ng-dirty",vn=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout",function(n,i,e,r,t,o,a){function s(e,t){t=t?"-"+re(t,"-"):"",o.removeClass(r,(e?fn:pn)+t),o.addClass(r,(e?pn:fn)+t)}this.$modelValue=this.$viewValue=Number.NaN,this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$name=e.name;var l=t(e.ngModel),c=l.assign,h=null,u=this;if(!c)throw g("ngModel")("nonassign",e.ngModel,ne(r));this.$render=S,this.$isEmpty=function(e){return O(e)||""===e||null===e||e!=e};var d=r.inheritedData("$formController")||Ki,p=0,f=this.$error={};r.addClass(mn),s(!0),this.$setValidity=function(e,t){f[e]!==!t&&(t?(f[e]&&p--,p||(s(!0),u.$valid=!0,u.$invalid=!1)):(s(!1),u.$invalid=!0,u.$valid=!1,p++),f[e]=!t,s(t,e),d.$setValidity(e,t,u))},this.$setPristine=function(){u.$dirty=!1,u.$pristine=!0,o.removeClass(r,gn),o.addClass(r,mn)},this.$cancelUpdate=function(){a.cancel(h),u.$render()},this.$$realSetViewValue=function(t){u.$viewValue=t,u.$pristine&&(u.$dirty=!0,u.$pristine=!1,o.removeClass(r,mn),o.addClass(r,gn),d.$setDirty()),Y(u.$parsers,function(e){t=e(t)}),u.$modelValue!==t&&(u.$modelValue=t,c(n,t),Y(u.$viewChangeListeners,function(e){try{e()}catch(e){i(e)}}))},this.$setViewValue=function(e,t){var i=u.$options&&(K(u.$options.debounce)?u.$options.debounce[t]||u.$options.debounce.default||0:u.$options.debounce)||0;a.cancel(h),i?h=a(function(){u.$$realSetViewValue(e)},i):u.$$realSetViewValue(e)},n.$watch(function(){var e=l(n);if(u.$modelValue!==e){var t=u.$formatters,i=t.length;for(u.$modelValue=e;i--;)e=t[i](e);u.$viewValue!==e&&(u.$viewValue=e,u.$render())}return e})}],yn=function(){return{require:["ngModel","^?form","^?ngModelOptions"],controller:vn,link:function(e,t,i,n){var r=n[0],o=n[1]||Ki;o.$addControl(r),n[2]&&(r.$options=n[2].$options),e.$on("$destroy",function(){o.$removeControl(r)})}}},bn=R({require:"ngModel",link:function(e,t,i,n){n.$viewChangeListeners.push(function(){e.$eval(i.ngChange)})}}),xn=function(){return{require:"?ngModel",link:function(e,t,i,n){if(n){i.required=!0;var r=function(e){if(!i.required||!n.$isEmpty(e))return n.$setValidity("required",!0),e;n.$setValidity("required",!1)};n.$formatters.push(r),n.$parsers.unshift(r),i.$observe("required",function(){r(n.$viewValue)})}}}},wn=function(){return{require:"ngModel",link:function(e,t,i,n){var r=(e=/\/(.*)\//.exec(i.ngList))&&RegExp(e[1])||i.ngList||",";n.$parsers.push(function(e){if(!O(e)){var t=[];return e&&Y(e.split(r),function(e){e&&t.push(Jt(e))}),t}}),n.$formatters.push(function(e){return Q(e)?e.join(", "):Z}),n.$isEmpty=function(e){return!e||!e.length}}}},_n=/^(true|false|\d+)$/,En=function(){return{priority:100,compile:function(e,t){return _n.test(t.ngValue)?function(e,t,i){i.$set("value",e.$eval(i.ngValue))}:function(e,t,i){e.$watch(i.ngValue,function(e){i.$set("value",e)})}}}},Tn=function(){return{controller:["$scope","$attrs",function(e,t){var i=this;this.$options=e.$eval(t.ngModelOptions),this.$options.updateOn?(this.$options.updateOnDefault=!1,this.$options.updateOn=this.$options.updateOn.replace(hn,function(){return i.$options.updateOnDefault=!0," "})):this.$options.updateOnDefault=!0}]}},Mn=Lt(function(e,t,i){t.addClass("ng-binding").data("$binding",i.ngBind),e.$watch(i.ngBind,function(e){t.text(e==Z?"":e)})}),Sn=["$interpolate",function(n){return function(e,t,i){e=n(t.attr(i.$attr.ngBindTemplate)),t.addClass("ng-binding").data("$binding",e),i.$observe("ngBindTemplate",function(e){t.text(e)})}}],Cn=["$sce","$parse",function(r,o){return function(t,i,e){i.addClass("ng-binding").data("$binding",e.ngBindHtml);var n=o(e.ngBindHtml);t.$watch(function(){return(n(t)||"").toString()},function(e){i.html(r.getTrustedHtml(n(t))||"")})}}],Rn=Ht("",!0),An=Ht("Odd",0),Pn=Ht("Even",1),Ln=Lt({compile:function(e,t){t.$set("ngCloak",Z),e.removeClass("ng-cloak")}}),On=[function(){return{scope:!0,controller:"@",priority:500}}],In={};Y("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(r){var o=Se("ng-"+r);In[o]=["$parse",function(i){return{compile:function(e,t){var n=i(t[o]);return function(t,e,i){e.on(jt(r),function(e){t.$apply(function(){n(t,{$event:e})})})}}}}]});var Dn=["$animate",function(l){return{transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(t,i,n,e,r){var o,a,s;t.$watch(n.ngIf,function(e){x(e)?a||(a=t.$new(),r(a,function(e){e[e.length++]=X.createComment(" end ngIf: "+n.ngIf+" "),o={clone:e},l.enter(e,i.parent(),i)})):(s&&(s.remove(),s=null),a&&(a.$destroy(),a=null),o&&(s=$(o.clone),l.leave(s,function(){s=null}),o=null))})}}}],kn=["$http","$templateCache","$anchorScroll","$animate","$sce",function(f,m,g,v,n){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:Yt.noop,compile:function(e,t){var i=t.ngInclude||t.src,d=t.onload||"",p=t.autoscroll;return function(r,o,e,a,s){var l,t,c,h=0,u=function(){t&&(t.remove(),t=null),l&&(l.$destroy(),l=null),c&&(v.leave(c,function(){t=null}),t=c,c=null)};r.$watch(n.parseAsResourceUrl(i),function(e){var i=function(){!I(p)||p&&!r.$eval(p)||g()},n=++h;e?(f.get(e,{cache:m}).success(function(e){if(n===h){var t=r.$new();a.template=e,e=s(t,function(e){u(),v.enter(e,null,o,i)}),c=e,(l=t).$emit("$includeContentLoaded"),r.$eval(d)}}).error(function(){n===h&&u()}),r.$emit("$includeContentRequested")):(u(),a.template=null)})}}}}],Nn=["$compile",function(r){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(e,t,i,n){t.html(n.template),r(t.contents())(e)}}}],Hn=Lt({priority:450,compile:function(){return{pre:function(e,t,i){e.$eval(i.ngInit)}}}}),Bn=Lt({terminal:!0,priority:1e3}),Fn=["$locale","$interpolate",function(u,d){var p=/{}/g;return{restrict:"EA",link:function(t,i,n){var r=n.count,e=n.$attr.when&&i.attr(n.$attr.when),o=n.offset||0,a=t.$eval(e)||{},s={},l=d.startSymbol(),c=d.endSymbol(),h=/^when(Minus)?(.+)$/;Y(n,function(e,t){h.test(t)&&(a[jt(t.replace("when","").replace("Minus","-"))]=i.attr(n.$attr[t]))}),Y(a,function(e,t){s[t]=d(e.replace(p,l+r+"-"+o+c))}),t.$watch(function(){var e=parseFloat(t.$eval(r));return isNaN(e)?"":(e in a||(e=u.pluralCat(e-o)),s[e](t))},function(e){i.text(e)})}}}],Un=["$parse","$animate",function(o,E){var T=g("ngRepeat");return{transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,link:function(p,f,e,t,m){var n,g,v,y,b,x,w=e.ngRepeat,i=w.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),r={$id:me};if(!i)throw T("iexp",w);if(e=i[1],t=i[2],(i=i[3])?(n=o(i),g=function(e,t,i){return x&&(r[x]=e),r[b]=t,r.$index=i,n(p,r)}):(v=function(e,t){return me(t)},y=function(e){return e}),!(i=e.match(/^(?:([\$\w]+)|\(([\$\w]+)\s*,\s*([\$\w]+)\))$/)))throw T("iidexp",e);b=i[3]||i[1],x=i[2];var _={};p.$watchCollection(t,function(e){var t,i,n,r,o,a,s,l,c,h=f[0],u={},d=[];if(M(e))l=e,n=g||v;else{for(a in n=g||y,l=[],e)e.hasOwnProperty(a)&&"$"!=a.charAt(0)&&l.push(a);l.sort()}for(r=l.length,i=d.length=l.length,t=0;t<i;t++)if(F(s=n(a=e===l?t:l[t],s=e[a],t),"`track by` id"),_.hasOwnProperty(s))c=_[s],delete _[s],u[s]=c,d[t]=c;else{if(u.hasOwnProperty(s))throw Y(d,function(e){e&&e.scope&&(_[e.id]=e)}),T("dupes",w,s);d[t]={id:s},u[s]=!1}for(a in _)_.hasOwnProperty(a)&&(t=$((c=_[a]).clone),E.leave(t),Y(t,function(e){e.$$NG_REMOVED=!0}),c.scope.$destroy());for(t=0,i=l.length;t<i;t++){if(s=e[a=e===l?t:l[t]],c=d[t],d[t-1]&&(h=d[t-1].clone[d[t-1].clone.length-1]),c.scope){for(o=c.scope,n=h;(n=n.nextSibling)&&n.$$NG_REMOVED;);c.clone[0]!=n&&E.move($(c.clone),null,Ft(h)),h=c.clone[c.clone.length-1]}else o=p.$new();o[b]=s,x&&(o[x]=a),o.$index=t,o.$first=0===t,o.$last=t===r-1,o.$middle=!(o.$first||o.$last),o.$odd=!(o.$even=0==(1&t)),c.scope||m(o,function(e){e[e.length++]=X.createComment(" end ngRepeat: "+w+" "),E.enter(e,null,Ft(h)),h=e,c.scope=o,c.clone=e,u[c.id]=c})}_=u})}}}],$n=["$animate",function(n){return function(e,t,i){e.$watch(i.ngShow,function(e){n[x(e)?"removeClass":"addClass"](t,"ng-hide")})}}],zn=["$animate",function(n){return function(e,t,i){e.$watch(i.ngHide,function(e){n[x(e)?"addClass":"removeClass"](t,"ng-hide")})}}],jn=Lt(function(e,i,t){e.$watch(t.ngStyle,function(e,t){t&&e!==t&&Y(t,function(e,t){i.css(t,"")}),e&&i.css(e)},!0)}),Vn=["$animate",function(u){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(r,e,o,a){var s,l,c,h=[];r.$watch(o.ngSwitch||o.on,function(e){var t,i=h.length;if(0<i){if(c){for(t=0;t<i;t++)c[t].remove();c=null}for(c=[],t=0;t<i;t++){var n=l[t];h[t].$destroy(),c[t]=n,u.leave(n,function(){c.splice(t,1),0===c.length&&(c=null)})}}l=[],h=[],(s=a.cases["!"+e]||a.cases["?"])&&(r.$eval(o.change),Y(s,function(i){var e=r.$new();h.push(e),i.transclude(e,function(e){var t=i.element;l.push(e),u.enter(e,t.parent(),t)})}))})}}}],Gn=Lt({transclude:"element",priority:800,require:"^ngSwitch",link:function(e,t,i,n,r){n.cases["!"+i.ngSwitchWhen]=n.cases["!"+i.ngSwitchWhen]||[],n.cases["!"+i.ngSwitchWhen].push({transclude:r,element:t})}}),Wn=Lt({transclude:"element",priority:800,require:"^ngSwitch",link:function(e,t,i,n,r){n.cases["?"]=n.cases["?"]||[],n.cases["?"].push({transclude:r,element:t})}}),qn=Lt({link:function(e,t,i,n,r){if(!r)throw g("ngTransclude")("orphan",ne(t));r(function(e){t.empty(),t.append(e)})}}),Xn=["$templateCache",function(i){return{restrict:"E",terminal:!0,compile:function(e,t){"text/ng-template"==t.type&&i.put(t.id,e[0].text)}}}],Zn=g("ngOptions"),Yn=R({terminal:!0}),Kn=["$compile","$parse",function(R,A){var P=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,s={$setViewValue:S};return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function(t,e,i){var n,r=this,o={},a=s;r.databound=i.ngModel,r.init=function(e,t,i){a=e,n=i},r.addOption=function(e){F(e,'"option value"'),o[e]=!0,a.$viewValue==e&&(t.val(e),n.parent()&&n.remove())},r.removeOption=function(e){this.hasOption(e)&&(delete o[e],a.$viewValue==e&&this.renderUnknownOption(e))},r.renderUnknownOption=function(e){e="? "+me(e)+" ?",n.val(e),t.prepend(n),t.val(e),n.prop("selected",!0)},r.hasOption=function(e){return o.hasOwnProperty(e)},e.$on("$destroy",function(){r.renderUnknownOption=S})}],link:function(e,t,i,n){if(n[1]){var r=n[0];n=n[1];var o,T=i.multiple,a=i.ngOptions,M=!1,S=Ft(X.createElement("option")),C=Ft(X.createElement("optgroup")),s=S.clone();i=0;for(var l=t.children(),c=l.length;i<c;i++)if(""===l[i].value){o=M=l.eq(i);break}r.init(n,M,s),T&&(n.$isEmpty=function(e){return!e||0===e.length}),a?function(p,f,m){function e(){var e,t,i,n,r,o={"":[]},a=[""];n=m.$modelValue,r=w(p)||[];var s,l,c,h,u,d=y?L(r):r;if(i=!(l={}),T)if(_&&Q(n))for(i=new ge([]),c=0;c<n.length;c++)l[v]=n[c],i.put(_(p,l),n[c]);else i=new ge(n);for(c=0;c<(s=d.length);c++){if(t=c,y){if("$"===(t=d[c]).charAt(0))continue;l[y]=t}l[v]=r[t],(t=o[e=b(p,l)||""])||(t=o[e]=[],a.push(e)),T?e=I(i.remove(_?_(p,l):x(p,l))):(e=_?((e={})[v]=n,_(p,e)===_(p,l)):n===x(p,l),i=i||e),h=I(h=g(p,l))?h:"",t.push({id:_?_(p,l):y?d[c]:c,label:h,selected:e})}for(T||(M||null===n?o[""].unshift({id:"",label:"",selected:!i}):i||o[""].unshift({id:"?",label:"",selected:!0})),l=0,d=a.length;l<d;l++){for(t=o[e=a[l]],E.length<=l?(r=[n={element:C.clone().attr("label",e),label:t.label}],E.push(r),f.append(n.element)):(n=(r=E[l])[0]).label!=e&&n.element.attr("label",n.label=e),h=null,c=0,s=t.length;c<s;c++)i=t[c],(e=r[c+1])?(h=e.element,e.label!==i.label&&h.text(e.label=i.label),e.id!==i.id&&h.val(e.id=i.id),e.selected!==i.selected&&h.prop("selected",e.selected=i.selected)):(""===i.id&&M?u=M:(u=S.clone()).val(i.id).attr("selected",i.selected).text(i.label),r.push({element:u,label:i.label,id:i.id,selected:i.selected}),h?h.after(u):n.element.append(u),h=u);for(c++;r.length>c;)r.pop().element.remove()}for(;E.length>l;)E.pop()[0].element.remove()}var t;if(!(t=a.match(P)))throw Zn("iexp",a,ne(f));var g=A(t[2]||t[1]),v=t[4]||t[6],y=t[5],b=A(t[3]||""),x=A(t[2]?t[1]:v),w=A(t[7]),_=t[8]?A(t[8]):null,E=[[{element:f,label:""}]];M&&(R(M)(p),M.removeClass("ng-scope"),M.remove()),f.empty(),f.on("change",function(){p.$apply(function(){var e,t,i,n,r,o,a,s,l=w(p)||[],c={};if(T){for(i=[],r=0,a=E.length;r<a;r++)for(n=1,o=(e=E[r]).length;n<o;n++)if((t=e[n].element)[0].selected){if(t=t.val(),y&&(c[y]=t),_)for(s=0;s<l.length&&(c[v]=l[s],_(p,c)!=t);s++);else c[v]=l[t];i.push(x(p,c))}}else{if("?"==(t=f.val()))i=Z;else if(""===t)i=null;else if(_){for(s=0;s<l.length;s++)if(c[v]=l[s],_(p,c)==t){i=x(p,c);break}}else c[v]=l[t],y&&(c[y]=t),i=x(p,c);1<E[0].length&&E[0][1].id!==t&&(E[0][1].selected=!1)}m.$setViewValue(i)})}),m.$render=e,p.$watch(e)}(e,t,n):T?(f=e,m=t,(g=n).$render=function(){var t=new ge(g.$viewValue);Y(m.find("option"),function(e){e.selected=I(t.get(e.value))})},f.$watch(function(){ie(v,g.$viewValue)||(v=_(g.$viewValue),g.$render())}),m.on("change",function(){f.$apply(function(){var t=[];Y(m.find("option"),function(e){e.selected&&t.push(e.value)}),g.$setViewValue(t)})})):(h=e,u=t,p=r,(d=n).$render=function(){var e=d.$viewValue;p.hasOption(e)?(s.parent()&&s.remove(),u.val(e),""===e&&o.prop("selected",!0)):O(e)&&o?u.val(""):p.renderUnknownOption(e)},u.on("change",function(){h.$apply(function(){s.parent()&&s.remove(),d.$setViewValue(u.val())})}))}var h,u,d,p,f,m,g,v}}}],Jn=["$interpolate",function(i){var a={addOption:S,removeOption:S};return{restrict:"E",priority:100,compile:function(e,t){if(O(t.value)){var o=i(e.text(),!0);o||t.$set("value",e.text())}return function(e,t,i){var n=t.parent(),r=n.data("$selectController")||n.parent().data("$selectController");r&&r.databound?t.prop("selected",!1):r=a,o?e.$watch(o,function(e,t){i.$set("value",e),t!==e&&r.removeOption(t),r.addOption(e)}):r.addOption(i.value),t.on("$destroy",function(){r.removeOption(i.value)})}}}}],Qn=R({restrict:"E",terminal:!1});p.angular.bootstrap?console.log("WARNING: Tried to load angular more than once."):((Ut=p.jQuery)?(C((Ft=Ut).fn,{scope:mi.scope,isolateScope:mi.isolateScope,controller:mi.controller,injector:mi.injector,inheritedData:mi.inheritedData}),t("remove",!0,!0,!1),t("empty",!1,!1,!1),t("html",!1,!1,!0)):Ft=j,Yt.element=Ft,function(e){var t,i,l,n;C(e,{bootstrap:H,copy:_,extend:C,equals:ie,element:Ft,forEach:Y,injector:ye,noop:S,bind:P,toJson:E,fromJson:b,identity:m,isUndefined:O,isDefined:I,isString:J,isFunction:ee,isObject:K,isNumber:c,isElement:h,isArray:Q,version:ti,isDate:u,lowercase:jt,uppercase:Gt,callbacks:{counter:0},$$minErr:g,$$csp:y}),t=p,l=g("$injector"),n=g("ng"),(t=t.angular||(t.angular={})).$$minErr=t.$$minErr||g,$t=t.module||(t.module=(i={},function(o,a,s){if("hasOwnProperty"===o)throw n("badname","module");return a&&i.hasOwnProperty(o)&&(i[o]=null),i[o]||(i[o]=function(){function e(e,t,i){return function(){return n[i||"push"]([e,t,arguments]),r}}if(!a)throw l("nomod",o);var n=[],t=[],i=e("$injector","invoke"),r={_invokeQueue:n,_runBlocks:t,requires:a,name:o,provider:e("$provide","provider"),factory:e("$provide","factory"),service:e("$provide","service"),value:e("$provide","value"),constant:e("$provide","constant","unshift"),animation:e("$animateProvider","register"),filter:e("$filterProvider","register"),controller:e("$controllerProvider","register"),directive:e("$compileProvider","directive"),config:i,run:function(e){return t.push(e),this}};return s&&i(s),r}())}));try{$t("ngLocale")}catch(e){$t("ngLocale",[]).provider("$locale",Fe)}$t("ng",["ngLocale"],["$provide",function(e){e.provider({$$sanitizeUri:lt}),e.provider("$compile",Me).directive({a:Zi,input:dn,textarea:dn,form:Qi,script:Xn,select:Kn,style:Qn,option:Jn,ngBind:Mn,ngBindHtml:Cn,ngBindTemplate:Sn,ngClass:Rn,ngClassEven:Pn,ngClassOdd:An,ngCloak:Ln,ngController:On,ngForm:en,ngHide:zn,ngIf:Dn,ngInclude:kn,ngInit:Hn,ngNonBindable:Bn,ngPluralize:Fn,ngRepeat:Un,ngShow:$n,ngStyle:jn,ngSwitch:Vn,ngSwitchWhen:Gn,ngSwitchDefault:Wn,ngOptions:Yn,ngTransclude:qn,ngModel:yn,ngList:wn,ngChange:bn,required:xn,ngRequired:xn,ngValue:En,ngModelOptions:Tn}).directive({ngInclude:Nn}).directive(Yi).directive(In),e.provider({$anchorScroll:be,$animate:Ti,$browser:_e,$cacheFactory:Ee,$controller:Re,$document:Ae,$exceptionHandler:Pe,$filter:vt,$interpolate:He,$interval:Be,$http:De,$httpBackend:Ne,$location:Ke,$log:Je,$parse:rt,$rootScope:st,$q:ot,$sce:ut,$sceDelegate:ht,$sniffer:dt,$templateCache:Te,$timeout:pt,$window:gt,$$rAF:at,$$asyncCallback:xe})}])}(Yt),Ft(X).ready(function(){e(X,H)}))}(window,document),!angular.$$csp()&&angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide{display:none !important;}ng\\:form{display:block;}</style>'),function(h){var u=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},t=10;function c(){this._events={},this._conf&&i.call(this,this._conf)}function i(e){e?((this._conf=e).delimiter&&(this.delimiter=e.delimiter),this._maxListeners=e.maxListeners!==h?e.maxListeners:t,e.wildcard&&(this.wildcard=e.wildcard),e.newListener&&(this._newListener=e.newListener),e.removeListener&&(this._removeListener=e.removeListener),e.verboseMemoryLeak&&(this.verboseMemoryLeak=e.verboseMemoryLeak),this.wildcard&&(this.listenerTree={})):this._maxListeners=t}function a(e,t){var i="(node) warning: possible EventEmitter memory leak detected. "+e+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(i+=" Event name: "+t+"."),"undefined"!=typeof process&&process.emitWarning){var n=new Error(i);n.name="MaxListenersExceededWarning",n.emitter=this,n.count=e,process.emitWarning(n)}else console.error(i),console.trace&&console.trace()}function e(e){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,i.call(this,e)}function m(e,t,i,n){if(!i)return[];var r,o,a,s,l,c,h,u=[],d=t.length,p=t[n],f=t[n+1];if(n===d&&i._listeners){if("function"==typeof i._listeners)return e&&e.push(i._listeners),[i];for(r=0,o=i._listeners.length;r<o;r++)e&&e.push(i._listeners[r]);return[i]}if("*"===p||"**"===p||i[p]){if("*"===p){for(a in i)"_listeners"!==a&&i.hasOwnProperty(a)&&(u=u.concat(m(e,t,i[a],n+1)));return u}if("**"===p){for(a in(h=n+1===d||n+2===d&&"*"===f)&&i._listeners&&(u=u.concat(m(e,t,i,d))),i)"_listeners"!==a&&i.hasOwnProperty(a)&&(u="*"===a||"**"===a?(i[a]._listeners&&!h&&(u=u.concat(m(e,t,i[a],d))),u.concat(m(e,t,i[a],n))):a===f?u.concat(m(e,t,i[a],n+2)):u.concat(m(e,t,i[a],n)));return u}u=u.concat(m(e,t,i[p],n+1))}if((s=i["*"])&&m(e,t,s,n+1),l=i["**"])if(n<d)for(a in l._listeners&&m(e,t,l,d),l)"_listeners"!==a&&l.hasOwnProperty(a)&&(a===f?m(e,t,l[a],n+2):a===p?m(e,t,l[a],n+1):((c={})[a]=l[a],m(e,t,{"**":c},n+1)));else l._listeners?m(e,t,l,d):l["*"]&&l["*"]._listeners&&m(e,t,l["*"],d);return u}(e.EventEmitter2=e).prototype.delimiter=".",e.prototype.setMaxListeners=function(e){e!==h&&(this._maxListeners=e,this._conf||(this._conf={}),this._conf.maxListeners=e)},e.prototype.event="",e.prototype.once=function(e,t){return this._once(e,t,!1)},e.prototype.prependOnceListener=function(e,t){return this._once(e,t,!0)},e.prototype._once=function(e,t,i){return this._many(e,1,t,i),this},e.prototype.many=function(e,t,i){return this._many(e,t,i,!1)},e.prototype.prependMany=function(e,t,i){return this._many(e,t,i,!0)},e.prototype._many=function(e,t,i,n){var r=this;if("function"!=typeof i)throw new Error("many only accepts instances of Function");function o(){return 0==--t&&r.off(e,o),i.apply(this,arguments)}return o._origin=i,this._on(e,o,n),r},e.prototype.emit=function(){this._events||c.call(this);var e=arguments[0];if("newListener"===e&&!this._newListener&&!this._events.newListener)return!1;var t,i,n,r,o,a=arguments.length;if(this._all&&this._all.length){if(o=this._all.slice(),3<a)for(t=new Array(a),r=0;r<a;r++)t[r]=arguments[r];for(n=0,i=o.length;n<i;n++)switch(this.event=e,a){case 1:o[n].call(this,e);break;case 2:o[n].call(this,e,arguments[1]);break;case 3:o[n].call(this,e,arguments[1],arguments[2]);break;default:o[n].apply(this,t)}}if(this.wildcard){o=[];var s="string"==typeof e?e.split(this.delimiter):e.slice();m.call(this,o,s,this.listenerTree,0)}else{if("function"==typeof(o=this._events[e])){switch(this.event=e,a){case 1:o.call(this);break;case 2:o.call(this,arguments[1]);break;case 3:o.call(this,arguments[1],arguments[2]);break;default:for(t=new Array(a-1),r=1;r<a;r++)t[r-1]=arguments[r];o.apply(this,t)}return!0}o&&(o=o.slice())}if(o&&o.length){if(3<a)for(t=new Array(a-1),r=1;r<a;r++)t[r-1]=arguments[r];for(n=0,i=o.length;n<i;n++)switch(this.event=e,a){case 1:o[n].call(this);break;case 2:o[n].call(this,arguments[1]);break;case 3:o[n].call(this,arguments[1],arguments[2]);break;default:o[n].apply(this,t)}return!0}if(!this._all&&"error"===e)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},e.prototype.emitAsync=function(){this._events||c.call(this);var e=arguments[0];if("newListener"===e&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);var t,i,n,r,o,a=[],s=arguments.length;if(this._all){if(3<s)for(t=new Array(s),r=1;r<s;r++)t[r]=arguments[r];for(n=0,i=this._all.length;n<i;n++)switch(this.event=e,s){case 1:a.push(this._all[n].call(this,e));break;case 2:a.push(this._all[n].call(this,e,arguments[1]));break;case 3:a.push(this._all[n].call(this,e,arguments[1],arguments[2]));break;default:a.push(this._all[n].apply(this,t))}}if(this.wildcard){o=[];var l="string"==typeof e?e.split(this.delimiter):e.slice();m.call(this,o,l,this.listenerTree,0)}else o=this._events[e];if("function"==typeof o)switch(this.event=e,s){case 1:a.push(o.call(this));break;case 2:a.push(o.call(this,arguments[1]));break;case 3:a.push(o.call(this,arguments[1],arguments[2]));break;default:for(t=new Array(s-1),r=1;r<s;r++)t[r-1]=arguments[r];a.push(o.apply(this,t))}else if(o&&o.length){if(o=o.slice(),3<s)for(t=new Array(s-1),r=1;r<s;r++)t[r-1]=arguments[r];for(n=0,i=o.length;n<i;n++)switch(this.event=e,s){case 1:a.push(o[n].call(this));break;case 2:a.push(o[n].call(this,arguments[1]));break;case 3:a.push(o[n].call(this,arguments[1],arguments[2]));break;default:a.push(o[n].apply(this,t))}}else if(!this._all&&"error"===e)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(a)},e.prototype.on=function(e,t){return this._on(e,t,!1)},e.prototype.prependListener=function(e,t){return this._on(e,t,!0)},e.prototype.onAny=function(e){return this._onAny(e,!1)},e.prototype.prependAny=function(e){return this._onAny(e,!0)},e.prototype.addListener=e.prototype.on,e.prototype._onAny=function(e,t){if("function"!=typeof e)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),t?this._all.unshift(e):this._all.push(e),this},e.prototype._on=function(e,t,i){if("function"==typeof e)return this._onAny(e,t),this;if("function"!=typeof t)throw new Error("on only accepts instances of Function");return this._events||c.call(this),this._newListener&&this.emit("newListener",e,t),this.wildcard?function(e,t){for(var i=0,n=(e="string"==typeof e?e.split(this.delimiter):e.slice()).length;i+1<n;i++)if("**"===e[i]&&"**"===e[i+1])return;for(var r=this.listenerTree,o=e.shift();o!==h;){if(r[o]||(r[o]={}),r=r[o],0===e.length)return r._listeners?("function"==typeof r._listeners&&(r._listeners=[r._listeners]),r._listeners.push(t),!r._listeners.warned&&0<this._maxListeners&&r._listeners.length>this._maxListeners&&(r._listeners.warned=!0,a.call(this,r._listeners.length,o))):r._listeners=t,!0;o=e.shift()}return!0}.call(this,e,t):this._events[e]?("function"==typeof this._events[e]&&(this._events[e]=[this._events[e]]),i?this._events[e].unshift(t):this._events[e].push(t),!this._events[e].warned&&0<this._maxListeners&&this._events[e].length>this._maxListeners&&(this._events[e].warned=!0,a.call(this,this._events[e].length,e))):this._events[e]=t,this},e.prototype.off=function(e,t){if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");var i,n=[];if(this.wildcard){var r="string"==typeof e?e.split(this.delimiter):e.slice();n=m.call(this,null,r,this.listenerTree,0)}else{if(!this._events[e])return this;i=this._events[e],n.push({_listeners:i})}for(var o=0;o<n.length;o++){var a=n[o];if(i=a._listeners,u(i)){for(var s=-1,l=0,c=i.length;l<c;l++)if(i[l]===t||i[l].listener&&i[l].listener===t||i[l]._origin&&i[l]._origin===t){s=l;break}if(s<0)continue;return this.wildcard?a._listeners.splice(s,1):this._events[e].splice(s,1),0===i.length&&(this.wildcard?delete a._listeners:delete this._events[e]),this._removeListener&&this.emit("removeListener",e,t),this}(i===t||i.listener&&i.listener===t||i._origin&&i._origin===t)&&(this.wildcard?delete a._listeners:delete this._events[e],this._removeListener&&this.emit("removeListener",e,t))}return function e(t){if(t!==h){var i=Object.keys(t);for(var n in i){var r=i[n],o=t[r];o instanceof Function||"object"!=typeof o||null===o||(0<Object.keys(o).length&&e(t[r]),0===Object.keys(o).length&&delete t[r])}}}(this.listenerTree),this},e.prototype.offAny=function(e){var t,i=0,n=0;if(e&&this._all&&0<this._all.length){for(i=0,n=(t=this._all).length;i<n;i++)if(e===t[i])return t.splice(i,1),this._removeListener&&this.emit("removeListenerAny",e),this}else{if(t=this._all,this._removeListener)for(i=0,n=t.length;i<n;i++)this.emit("removeListenerAny",t[i]);this._all=[]}return this},e.prototype.removeListener=e.prototype.off,e.prototype.removeAllListeners=function(e){if(0===arguments.length)return!this._events||c.call(this),this;if(this.wildcard)for(var t="string"==typeof e?e.split(this.delimiter):e.slice(),i=m.call(this,null,t,this.listenerTree,0),n=0;n<i.length;n++){i[n]._listeners=null}else this._events&&(this._events[e]=null);return this},e.prototype.listeners=function(e){if(this.wildcard){var t=[],i="string"==typeof e?e.split(this.delimiter):e.slice();return m.call(this,t,i,this.listenerTree,0),t}return this._events||c.call(this),this._events[e]||(this._events[e]=[]),u(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]},e.prototype.eventNames=function(){return Object.keys(this._events)},e.prototype.listenerCount=function(e){return this.listeners(e).length},e.prototype.listenersAny=function(){return this._all?this._all:[]},"function"==typeof define&&define.amd?define(function(){return e}):"object"==typeof exports?module.exports=e:window.EventEmitter2=e}(),function(f,E){var t,i,v=typeof E,m=f.document,e=f.location,n=f.jQuery,r=f.$,o={},u=[],y=u.concat,s=u.push,h=u.slice,a=u.indexOf,l=o.toString,g=o.hasOwnProperty,c="1.9.1".trim,ge=function(e,t){return new ge.fn.init(e,t,i)},d=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,T=/\S+/g,p=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,b=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,x=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,w=/^[\],:{}\s]*$/,_=/(?:^|:|,)(?:\s*\[)+/g,M=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,S=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,C=/^-ms-/,R=/-([\da-z])/gi,A=function(e,t){return t.toUpperCase()},P=function(e){(m.addEventListener||"load"===e.type||"complete"===m.readyState)&&(L(),ge.ready())},L=function(){m.addEventListener?(m.removeEventListener("DOMContentLoaded",P,!1),f.removeEventListener("load",P,!1)):(m.detachEvent("onreadystatechange",P),f.detachEvent("onload",P))};function O(e){var t=e.length,i=ge.type(e);return!ge.isWindow(e)&&(!(1!==e.nodeType||!t)||("array"===i||"function"!==i&&(0===t||"number"==typeof t&&0<t&&t-1 in e)))}ge.fn=ge.prototype={jquery:"1.9.1",constructor:ge,init:function(e,t,i){var n,r;if(!e)return this;if("string"!=typeof e)return e.nodeType?(this.context=this[0]=e,this.length=1,this):ge.isFunction(e)?i.ready(e):(e.selector!==E&&(this.selector=e.selector,this.context=e.context),ge.makeArray(e,this));if(!(n="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&3<=e.length?[null,e,null]:b.exec(e))||!n[1]&&t)return!t||t.jquery?(t||i).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof ge?t[0]:t,ge.merge(this,ge.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:m,!0)),x.test(n[1])&&ge.isPlainObject(t))for(n in t)ge.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}if((r=m.getElementById(n[2]))&&r.parentNode){if(r.id!==n[2])return i.find(e);this.length=1,this[0]=r}return this.context=m,this.selector=e,this},selector:"",length:0,size:function(){return this.length},toArray:function(){return h.call(this)},get:function(e){return null==e?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e){var t=ge.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return ge.each(this,e,t)},ready:function(e){return ge.ready.promise().done(e),this},slice:function(){return this.pushStack(h.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(e<0?t:0);return this.pushStack(0<=i&&i<t?[this[i]]:[])},map:function(i){return this.pushStack(ge.map(this,function(e,t){return i.call(e,t,e)}))},end:function(){return this.prevObject||this.constructor(null)},push:s,sort:[].sort,splice:[].splice},ge.fn.init.prototype=ge.fn,ge.extend=ge.fn.extend=function(){var e,t,i,n,r,o,a=arguments[0]||{},s=1,l=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[1]||{},s=2),"object"==typeof a||ge.isFunction(a)||(a={}),l===s&&(a=this,--s);s<l;s++)if(null!=(r=arguments[s]))for(n in r)e=a[n],a!==(i=r[n])&&(c&&i&&(ge.isPlainObject(i)||(t=ge.isArray(i)))?(o=t?(t=!1,e&&ge.isArray(e)?e:[]):e&&ge.isPlainObject(e)?e:{},a[n]=ge.extend(c,o,i)):i!==E&&(a[n]=i));return a},ge.extend({noConflict:function(e){return f.$===ge&&(f.$=r),e&&f.jQuery===ge&&(f.jQuery=n),ge},isReady:!1,readyWait:1,holdReady:function(e){e?ge.readyWait++:ge.ready(!0)},ready:function(e){if(!0===e?!--ge.readyWait:!ge.isReady){if(!m.body)return setTimeout(ge.ready);(ge.isReady=!0)!==e&&0<--ge.readyWait||(t.resolveWith(m,[ge]),ge.fn.trigger&&ge(m).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===ge.type(e)},isArray:Array.isArray||function(e){return"array"===ge.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?o[l.call(e)]||"object":typeof e},isPlainObject:function(e){if(!e||"object"!==ge.type(e)||e.nodeType||ge.isWindow(e))return!1;try{if(e.constructor&&!g.call(e,"constructor")&&!g.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}var t;for(t in e);return t===E||g.call(e,t)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||m;var n=x.exec(e),r=!i&&[];return n?[t.createElement(n[1])]:(n=ge.buildFragment([e],t,r),r&&ge(r).remove(),ge.merge([],n.childNodes))},parseJSON:function(e){return f.JSON&&f.JSON.parse?f.JSON.parse(e):null===e?e:"string"==typeof e&&(e=ge.trim(e))&&w.test(e.replace(M,"@").replace(S,"]").replace(_,""))?new Function("return "+e)():void ge.error("Invalid JSON: "+e)},parseXML:function(e){var t;if(!e||"string"!=typeof e)return null;try{f.DOMParser?t=(new DOMParser).parseFromString(e,"text/xml"):((t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e))}catch(e){t=E}return t&&t.documentElement&&!t.getElementsByTagName("parsererror").length||ge.error("Invalid XML: "+e),t},noop:function(){},globalEval:function(e){e&&ge.trim(e)&&(f.execScript||function(e){f.eval.call(f,e)})(e)},camelCase:function(e){return e.replace(C,"ms-").replace(R,A)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,i){var n=0,r=e.length,o=O(e);if(i){if(o)for(;n<r&&!1!==t.apply(e[n],i);n++);else for(n in e)if(!1===t.apply(e[n],i))break}else if(o)for(;n<r&&!1!==t.call(e[n],n,e[n]);n++);else for(n in e)if(!1===t.call(e[n],n,e[n]))break;return e},trim:c&&!c.call("\ufeff ")?function(e){return null==e?"":c.call(e)}:function(e){return null==e?"":(e+"").replace(p,"")},makeArray:function(e,t){var i=t||[];return null!=e&&(O(Object(e))?ge.merge(i,"string"==typeof e?[e]:e):s.call(i,e)),i},inArray:function(e,t,i){var n;if(t){if(a)return a.call(t,e,i);for(n=t.length,i=i?i<0?Math.max(0,n+i):i:0;i<n;i++)if(i in t&&t[i]===e)return i}return-1},merge:function(e,t){var i=t.length,n=e.length,r=0;if("number"==typeof i)for(;r<i;r++)e[n++]=t[r];else for(;t[r]!==E;)e[n++]=t[r++];return e.length=n,e},grep:function(e,t,i){var n=[],r=0,o=e.length;for(i=!!i;r<o;r++)i!==!!t(e[r],r)&&n.push(e[r]);return n},map:function(e,t,i){var n,r=0,o=e.length,a=[];if(O(e))for(;r<o;r++)null!=(n=t(e[r],r,i))&&(a[a.length]=n);else for(r in e)null!=(n=t(e[r],r,i))&&(a[a.length]=n);return y.apply([],a)},guid:1,proxy:function(e,t){var i,n,r;return"string"==typeof t&&(r=e[t],t=e,e=r),ge.isFunction(e)?(i=h.call(arguments,2),(n=function(){return e.apply(t||this,i.concat(h.call(arguments)))}).guid=e.guid=e.guid||ge.guid++,n):E},access:function(e,t,i,n,r,o,a){var s=0,l=e.length,c=null==i;if("object"===ge.type(i))for(s in r=!0,i)ge.access(e,t,s,i[s],!0,o,a);else if(n!==E&&(r=!0,ge.isFunction(n)||(a=!0),c&&(t=a?(t.call(e,n),null):(c=t,function(e,t,i){return c.call(ge(e),i)})),t))for(;s<l;s++)t(e[s],i,a?n:n.call(e[s],s,t(e[s],i)));return r?e:c?t.call(e):l?t(e[0],i):o},now:function(){return(new Date).getTime()}}),ge.ready.promise=function(e){if(!t)if(t=ge.Deferred(),"complete"===m.readyState)setTimeout(ge.ready);else if(m.addEventListener)m.addEventListener("DOMContentLoaded",P,!1),f.addEventListener("load",P,!1);else{m.attachEvent("onreadystatechange",P),f.attachEvent("onload",P);var i=!1;try{i=null==f.frameElement&&m.documentElement}catch(e){}i&&i.doScroll&&function t(){if(!ge.isReady){try{i.doScroll("left")}catch(e){return setTimeout(t,50)}L(),ge.ready()}}()}return t.promise(e)},ge.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){o["[object "+t+"]"]=t.toLowerCase()}),i=ge(m);var I={};ge.Callbacks=function(r){var e,i;r="string"==typeof r?I[r]||(i=I[e=r]={},ge.each(e.match(T)||[],function(e,t){i[t]=!0}),i):ge.extend({},r);var n,t,o,a,s,l,c=[],h=!r.once&&[],u=function(e){for(t=r.memory&&e,o=!0,s=l||0,l=0,a=c.length,n=!0;c&&s<a;s++)if(!1===c[s].apply(e[0],e[1])&&r.stopOnFalse){t=!1;break}n=!1,c&&(h?h.length&&u(h.shift()):t?c=[]:d.disable())},d={add:function(){if(c){var e=c.length;!function n(e){ge.each(e,function(e,t){var i=ge.type(t);"function"===i?r.unique&&d.has(t)||c.push(t):t&&t.length&&"string"!==i&&n(t)})}(arguments),n?a=c.length:t&&(l=e,u(t))}return this},remove:function(){return c&&ge.each(arguments,function(e,t){for(var i;-1<(i=ge.inArray(t,c,i));)c.splice(i,1),n&&(i<=a&&a--,i<=s&&s--)}),this},has:function(e){return e?-1<ge.inArray(e,c):!(!c||!c.length)},empty:function(){return c=[],this},disable:function(){return c=h=t=E,this},disabled:function(){return!c},lock:function(){return h=E,t||d.disable(),this},locked:function(){return!h},fireWith:function(e,t){return t=[e,(t=t||[]).slice?t.slice():t],!c||o&&!h||(n?h.push(t):u(t)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!o}};return d},ge.extend({Deferred:function(e){var a=[["resolve","done",ge.Callbacks("once memory"),"resolved"],["reject","fail",ge.Callbacks("once memory"),"rejected"],["notify","progress",ge.Callbacks("memory")]],r="pending",s={state:function(){return r},always:function(){return l.done(arguments).fail(arguments),this},then:function(){var o=arguments;return ge.Deferred(function(r){ge.each(a,function(e,t){var i=t[0],n=ge.isFunction(o[e])&&o[e];l[t[1]](function(){var e=n&&n.apply(this,arguments);e&&ge.isFunction(e.promise)?e.promise().done(r.resolve).fail(r.reject).progress(r.notify):r[i+"With"](this===s?r.promise():this,n?[e]:arguments)})}),o=null}).promise()},promise:function(e){return null!=e?ge.extend(e,s):s}},l={};return s.pipe=s.then,ge.each(a,function(e,t){var i=t[2],n=t[3];s[t[1]]=i.add,n&&i.add(function(){r=n},a[1^e][2].disable,a[2][2].lock),l[t[0]]=function(){return l[t[0]+"With"](this===l?s:this,arguments),this},l[t[0]+"With"]=i.fireWith}),s.promise(l),e&&e.call(l,l),l},when:function(e){var r,t,i,n=0,o=h.call(arguments),a=o.length,s=1!==a||e&&ge.isFunction(e.promise)?a:0,l=1===s?e:ge.Deferred(),c=function(t,i,n){return function(e){i[t]=this,n[t]=1<arguments.length?h.call(arguments):e,n===r?l.notifyWith(i,n):--s||l.resolveWith(i,n)}};if(1<a)for(r=new Array(a),t=new Array(a),i=new Array(a);n<a;n++)o[n]&&ge.isFunction(o[n].promise)?o[n].promise().done(c(n,i,o)).fail(l.reject).progress(c(n,t,r)):--s;return s||l.resolveWith(i,o),l.promise()}}),ge.support=function(){var o,e,t,i,n,r,a,s,l,c,h=m.createElement("div");if(h.setAttribute("className","t"),h.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=h.getElementsByTagName("*"),t=h.getElementsByTagName("a")[0],!e||!t||!e.length)return{};a=(n=m.createElement("select")).appendChild(m.createElement("option")),i=h.getElementsByTagName("input")[0],t.style.cssText="top:1px;float:left;opacity:.5",o={getSetAttribute:"t"!==h.className,leadingWhitespace:3===h.firstChild.nodeType,tbody:!h.getElementsByTagName("tbody").length,htmlSerialize:!!h.getElementsByTagName("link").length,style:/top/.test(t.getAttribute("style")),hrefNormalized:"/a"===t.getAttribute("href"),opacity:/^0.5/.test(t.style.opacity),cssFloat:!!t.style.cssFloat,checkOn:!!i.value,optSelected:a.selected,enctype:!!m.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==m.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===m.compatMode,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},i.checked=!0,o.noCloneChecked=i.cloneNode(!0).checked,n.disabled=!0,o.optDisabled=!a.disabled;try{delete h.test}catch(e){o.deleteExpando=!1}for(c in(i=m.createElement("input")).setAttribute("value",""),o.input=""===i.getAttribute("value"),i.value="t",i.setAttribute("type","radio"),o.radioValue="t"===i.value,i.setAttribute("checked","t"),i.setAttribute("name","t"),(r=m.createDocumentFragment()).appendChild(i),o.appendChecked=i.checked,o.checkClone=r.cloneNode(!0).cloneNode(!0).lastChild.checked,h.attachEvent&&(h.attachEvent("onclick",function(){o.noCloneEvent=!1}),h.cloneNode(!0).click()),{submit:!0,change:!0,focusin:!0})h.setAttribute(s="on"+c,"t"),o[c+"Bubbles"]=s in f||!1===h.attributes[s].expando;return h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",o.clearCloneStyle="content-box"===h.style.backgroundClip,ge(function(){var e,t,i,n="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",r=m.getElementsByTagName("body")[0];r&&((e=m.createElement("div")).style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",r.appendChild(e).appendChild(h),h.innerHTML="<table><tr><td></td><td>t</td></tr></table>",(i=h.getElementsByTagName("td"))[0].style.cssText="padding:0;margin:0;border:0;display:none",l=0===i[0].offsetHeight,i[0].style.display="",i[1].style.display="none",o.reliableHiddenOffsets=l&&0===i[0].offsetHeight,h.innerHTML="",h.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",o.boxSizing=4===h.offsetWidth,o.doesNotIncludeMarginInBodyOffset=1!==r.offsetTop,f.getComputedStyle&&(o.pixelPosition="1%"!==(f.getComputedStyle(h,null)||{}).top,o.boxSizingReliable="4px"===(f.getComputedStyle(h,null)||{width:"4px"}).width,(t=h.appendChild(m.createElement("div"))).style.cssText=h.style.cssText=n,t.style.marginRight=t.style.width="0",h.style.width="1px",o.reliableMarginRight=!parseFloat((f.getComputedStyle(t,null)||{}).marginRight)),typeof h.style.zoom!==v&&(h.innerHTML="",h.style.cssText=n+"width:1px;padding:1px;display:inline;zoom:1",o.inlineBlockNeedsLayout=3===h.offsetWidth,h.style.display="block",h.innerHTML="<div></div>",h.firstChild.style.width="5px",o.shrinkWrapBlocks=3!==h.offsetWidth,o.inlineBlockNeedsLayout&&(r.style.zoom=1)),r.removeChild(e),e=h=i=t=null)}),e=n=r=a=t=i=null,o}();var D=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,k=/([A-Z])/g;function N(e,t,i,n){if(ge.acceptData(e)){var r,o,a=ge.expando,s="string"==typeof t,l=e.nodeType,c=l?ge.cache:e,h=l?e[a]:e[a]&&a;if(h&&c[h]&&(n||c[h].data)||!s||i!==E)return h||(l?e[a]=h=u.pop()||ge.guid++:h=a),c[h]||(c[h]={},l||(c[h].toJSON=ge.noop)),"object"!=typeof t&&"function"!=typeof t||(n?c[h]=ge.extend(c[h],t):c[h].data=ge.extend(c[h].data,t)),r=c[h],n||(r.data||(r.data={}),r=r.data),i!==E&&(r[ge.camelCase(t)]=i),s?null==(o=r[t])&&(o=r[ge.camelCase(t)]):o=r,o}}function H(e,t,i){if(ge.acceptData(e)){var n,r,o,a=e.nodeType,s=a?ge.cache:e,l=a?e[ge.expando]:ge.expando;if(s[l]){if(t&&(o=i?s[l]:s[l].data)){for((n=0,r=(t=ge.isArray(t)?t.concat(ge.map(t,ge.camelCase)):t in o?[t]:(t=ge.camelCase(t))in o?[t]:t.split(" ")).length);n<r;n++)delete o[t[n]];if(!(i?F:ge.isEmptyObject)(o))return}(i||(delete s[l].data,F(s[l])))&&(a?ge.cleanData([e],!0):ge.support.deleteExpando||s!=s.window?delete s[l]:s[l]=null)}}}function B(e,t,i){if(i===E&&1===e.nodeType){var n="data-"+t.replace(k,"-$1").toLowerCase();if("string"==typeof(i=e.getAttribute(n))){try{i="true"===i||"false"!==i&&("null"===i?null:+i+""===i?+i:D.test(i)?ge.parseJSON(i):i)}catch(e){}ge.data(e,t,i)}else i=E}return i}function F(e){var t;for(t in e)if(("data"!==t||!ge.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}ge.extend({cache:{},expando:"jQuery"+("1.9.1"+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return!!(e=e.nodeType?ge.cache[e[ge.expando]]:e[ge.expando])&&!F(e)},data:function(e,t,i){return N(e,t,i)},removeData:function(e,t){return H(e,t)},_data:function(e,t,i){return N(e,t,i,!0)},_removeData:function(e,t){return H(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&ge.noData[e.nodeName.toLowerCase()];return!t||!0!==t&&e.getAttribute("classid")===t}}),ge.fn.extend({data:function(t,e){var i,n,r=this[0],o=0,a=null;if(t!==E)return"object"==typeof t?this.each(function(){ge.data(this,t)}):ge.access(this,function(e){if(e===E)return r?B(r,t,ge.data(r,t)):null;this.each(function(){ge.data(this,t,e)})},null,e,1<arguments.length,null,!0);if(this.length&&(a=ge.data(r),1===r.nodeType&&!ge._data(r,"parsedAttrs"))){for(i=r.attributes;o<i.length;o++)(n=i[o].name).indexOf("data-")||(n=ge.camelCase(n.slice(5)),B(r,n,a[n]));ge._data(r,"parsedAttrs",!0)}return a},removeData:function(e){return this.each(function(){ge.removeData(this,e)})}}),ge.extend({queue:function(e,t,i){var n;if(e)return t=(t||"fx")+"queue",n=ge._data(e,t),i&&(!n||ge.isArray(i)?n=ge._data(e,t,ge.makeArray(i)):n.push(i)),n||[]},dequeue:function(e,t){t=t||"fx";var i=ge.queue(e,t),n=i.length,r=i.shift(),o=ge._queueHooks(e,t);"inprogress"===r&&(r=i.shift(),n--),(o.cur=r)&&("fx"===t&&i.unshift("inprogress"),delete o.stop,r.call(e,function(){ge.dequeue(e,t)},o)),!n&&o&&o.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return ge._data(e,i)||ge._data(e,i,{empty:ge.Callbacks("once memory").add(function(){ge._removeData(e,t+"queue"),ge._removeData(e,i)})})}}),ge.fn.extend({queue:function(t,i){var e=2;return"string"!=typeof t&&(i=t,t="fx",e--),arguments.length<e?ge.queue(this[0],t):i===E?this:this.each(function(){var e=ge.queue(this,t,i);ge._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&ge.dequeue(this,t)})},dequeue:function(e){return this.each(function(){ge.dequeue(this,e)})},delay:function(n,e){return n=ge.fx&&ge.fx.speeds[n]||n,e=e||"fx",this.queue(e,function(e,t){var i=setTimeout(e,n);t.stop=function(){clearTimeout(i)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,n=1,r=ge.Deferred(),o=this,a=this.length,s=function(){--n||r.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=E),e=e||"fx";a--;)(i=ge._data(o[a],e+"queueHooks"))&&i.empty&&(n++,i.empty.add(s));return s(),r.promise(t)}});var U,$,z=/[\t\r\n]/g,j=/\r/g,V=/^(?:input|select|textarea|button|object)$/i,G=/^(?:a|area)$/i,W=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,q=/^(?:checked|selected)$/i,X=ge.support.getSetAttribute,Z=ge.support.input;ge.fn.extend({attr:function(e,t){return ge.access(this,ge.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){ge.removeAttr(this,e)})},prop:function(e,t){return ge.access(this,ge.prop,e,t,1<arguments.length)},removeProp:function(e){return e=ge.propFix[e]||e,this.each(function(){try{this[e]=E,delete this[e]}catch(e){}})},addClass:function(t){var e,i,n,r,o,a=0,s=this.length,l="string"==typeof t&&t;if(ge.isFunction(t))return this.each(function(e){ge(this).addClass(t.call(this,e,this.className))});if(l)for(e=(t||"").match(T)||[];a<s;a++)if(n=1===(i=this[a]).nodeType&&(i.className?(" "+i.className+" ").replace(z," "):" ")){for(o=0;r=e[o++];)n.indexOf(" "+r+" ")<0&&(n+=r+" ");i.className=ge.trim(n)}return this},removeClass:function(t){var e,i,n,r,o,a=0,s=this.length,l=0===arguments.length||"string"==typeof t&&t;if(ge.isFunction(t))return this.each(function(e){ge(this).removeClass(t.call(this,e,this.className))});if(l)for(e=(t||"").match(T)||[];a<s;a++)if(n=1===(i=this[a]).nodeType&&(i.className?(" "+i.className+" ").replace(z," "):"")){for(o=0;r=e[o++];)for(;0<=n.indexOf(" "+r+" ");)n=n.replace(" "+r+" "," ");i.className=t?ge.trim(n):""}return this},toggleClass:function(o,a){var s=typeof o,l="boolean"==typeof a;return ge.isFunction(o)?this.each(function(e){ge(this).toggleClass(o.call(this,e,this.className,a),a)}):this.each(function(){if("string"===s)for(var e,t=0,i=ge(this),n=a,r=o.match(T)||[];e=r[t++];)n=l?n:!i.hasClass(e),i[n?"addClass":"removeClass"](e);else s!==v&&"boolean"!==s||(this.className&&ge._data(this,"__className__",this.className),this.className=this.className||!1===o?"":ge._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,n=this.length;i<n;i++)if(1===this[i].nodeType&&0<=(" "+this[i].className+" ").replace(z," ").indexOf(t))return!0;return!1},val:function(n){var e,r,o,t=this[0];return arguments.length?(o=ge.isFunction(n),this.each(function(e){var t,i=ge(this);1===this.nodeType&&(null==(t=o?n.call(this,e,i.val()):n)?t="":"number"==typeof t?t+="":ge.isArray(t)&&(t=ge.map(t,function(e){return null==e?"":e+""})),(r=ge.valHooks[this.type]||ge.valHooks[this.nodeName.toLowerCase()])&&"set"in r&&r.set(this,t,"value")!==E||(this.value=t))})):t?(r=ge.valHooks[t.type]||ge.valHooks[t.nodeName.toLowerCase()])&&"get"in r&&(e=r.get(t,"value"))!==E?e:"string"==typeof(e=t.value)?e.replace(j,""):null==e?"":e:void 0}}),ge.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){for(var t,i,n=e.options,r=e.selectedIndex,o="select-one"===e.type||r<0,a=o?null:[],s=o?r+1:n.length,l=r<0?s:o?r:0;l<s;l++)if(((i=n[l]).selected||l===r)&&(ge.support.optDisabled?!i.disabled:null===i.getAttribute("disabled"))&&(!i.parentNode.disabled||!ge.nodeName(i.parentNode,"optgroup"))){if(t=ge(i).val(),o)return t;a.push(t)}return a},set:function(e,t){var i=ge.makeArray(t);return ge(e).find("option").each(function(){this.selected=0<=ge.inArray(ge(this).val(),i)}),i.length||(e.selectedIndex=-1),i}}},attr:function(e,t,i){var n,r,o,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return typeof e.getAttribute===v?ge.prop(e,t,i):((r=1!==a||!ge.isXMLDoc(e))&&(t=t.toLowerCase(),n=ge.attrHooks[t]||(W.test(t)?$:U)),i===E?n&&r&&"get"in n&&null!==(o=n.get(e,t))?o:(typeof e.getAttribute!==v&&(o=e.getAttribute(t)),null==o?E:o):null!==i?n&&r&&"set"in n&&(o=n.set(e,i,t))!==E?o:(e.setAttribute(t,i+""),i):void ge.removeAttr(e,t))},removeAttr:function(e,t){var i,n,r=0,o=t&&t.match(T);if(o&&1===e.nodeType)for(;i=o[r++];)n=ge.propFix[i]||i,W.test(i)?!X&&q.test(i)?e[ge.camelCase("default-"+i)]=e[n]=!1:e[n]=!1:ge.attr(e,i,""),e.removeAttribute(X?i:n)},attrHooks:{type:{set:function(e,t){if(!ge.support.radioValue&&"radio"===t&&ge.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},propFix:{tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,t,i){var n,r,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return(1!==o||!ge.isXMLDoc(e))&&(t=ge.propFix[t]||t,r=ge.propHooks[t]),i!==E?r&&"set"in r&&(n=r.set(e,i,t))!==E?n:e[t]=i:r&&"get"in r&&null!==(n=r.get(e,t))?n:e[t]},propHooks:{tabIndex:{get:function(e){var t=e.getAttributeNode("tabindex");return t&&t.specified?parseInt(t.value,10):V.test(e.nodeName)||G.test(e.nodeName)&&e.href?0:E}}}}),$={get:function(e,t){var i=ge.prop(e,t),n="boolean"==typeof i&&e.getAttribute(t),r="boolean"==typeof i?Z&&X?null!=n:q.test(t)?e[ge.camelCase("default-"+t)]:!!n:e.getAttributeNode(t);return r&&!1!==r.value?t.toLowerCase():E},set:function(e,t,i){return!1===t?ge.removeAttr(e,i):Z&&X||!q.test(i)?e.setAttribute(!X&&ge.propFix[i]||i,i):e[ge.camelCase("default-"+i)]=e[i]=!0,i}},Z&&X||(ge.attrHooks.value={get:function(e,t){var i=e.getAttributeNode(t);return ge.nodeName(e,"input")?e.defaultValue:i&&i.specified?i.value:E},set:function(e,t,i){if(!ge.nodeName(e,"input"))return U&&U.set(e,t,i);e.defaultValue=t}}),X||(U=ge.valHooks.button={get:function(e,t){var i=e.getAttributeNode(t);return i&&("id"===t||"name"===t||"coords"===t?""!==i.value:i.specified)?i.value:E},set:function(e,t,i){var n=e.getAttributeNode(i);return n||e.setAttributeNode(n=e.ownerDocument.createAttribute(i)),n.value=t+="","value"===i||t===e.getAttribute(i)?t:E}},ge.attrHooks.contenteditable={get:U.get,set:function(e,t,i){U.set(e,""!==t&&t,i)}},ge.each(["width","height"],function(e,i){ge.attrHooks[i]=ge.extend(ge.attrHooks[i],{set:function(e,t){if(""===t)return e.setAttribute(i,"auto"),t}})})),ge.support.hrefNormalized||(ge.each(["href","src","width","height"],function(e,i){ge.attrHooks[i]=ge.extend(ge.attrHooks[i],{get:function(e){var t=e.getAttribute(i,2);return null==t?E:t}})}),ge.each(["href","src"],function(e,t){ge.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}})),ge.support.style||(ge.attrHooks.style={get:function(e){return e.style.cssText||E},set:function(e,t){return e.style.cssText=t+""}}),ge.support.optSelected||(ge.propHooks.selected=ge.extend(ge.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),ge.support.enctype||(ge.propFix.enctype="encoding"),ge.support.checkOn||ge.each(["radio","checkbox"],function(){ge.valHooks[this]={get:function(e){return null===e.getAttribute("value")?"on":e.value}}}),ge.each(["radio","checkbox"],function(){ge.valHooks[this]=ge.extend(ge.valHooks[this],{set:function(e,t){if(ge.isArray(t))return e.checked=0<=ge.inArray(ge(e).val(),t)}})});var Y=/^(?:input|select|textarea)$/i,K=/^key/,J=/^(?:mouse|contextmenu)|click/,Q=/^(?:focusinfocus|focusoutblur)$/,ee=/^([^.]*)(?:\.(.+)|)$/;function te(){return!0}function ie(){return!1}ge.event={global:{},add:function(e,t,i,n,r){var o,a,s,l,c,h,u,d,p,f,m,g=ge._data(e);if(g){for(i.handler&&(i=(l=i).handler,r=l.selector),i.guid||(i.guid=ge.guid++),(a=g.events)||(a=g.events={}),(h=g.handle)||((h=g.handle=function(e){return typeof ge===v||e&&ge.event.triggered===e.type?E:ge.event.dispatch.apply(h.elem,arguments)}).elem=e),s=(t=(t||"").match(T)||[""]).length;s--;)p=m=(o=ee.exec(t[s])||[])[1],f=(o[2]||"").split(".").sort(),c=ge.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,c=ge.event.special[p]||{},u=ge.extend({type:p,origType:m,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&ge.expr.match.needsContext.test(r),namespace:f.join(".")},l),(d=a[p])||((d=a[p]=[]).delegateCount=0,c.setup&&!1!==c.setup.call(e,n,f,h)||(e.addEventListener?e.addEventListener(p,h,!1):e.attachEvent&&e.attachEvent("on"+p,h))),c.add&&(c.add.call(e,u),u.handler.guid||(u.handler.guid=i.guid)),r?d.splice(d.delegateCount++,0,u):d.push(u),ge.event.global[p]=!0;e=null}},remove:function(e,t,i,n,r){var o,a,s,l,c,h,u,d,p,f,m,g=ge.hasData(e)&&ge._data(e);if(g&&(h=g.events)){for(c=(t=(t||"").match(T)||[""]).length;c--;)if(p=m=(s=ee.exec(t[c])||[])[1],f=(s[2]||"").split(".").sort(),p){for(u=ge.event.special[p]||{},d=h[p=(n?u.delegateType:u.bindType)||p]||[],s=s[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=o=d.length;o--;)a=d[o],!r&&m!==a.origType||i&&i.guid!==a.guid||s&&!s.test(a.namespace)||n&&n!==a.selector&&("**"!==n||!a.selector)||(d.splice(o,1),a.selector&&d.delegateCount--,u.remove&&u.remove.call(e,a));l&&!d.length&&(u.teardown&&!1!==u.teardown.call(e,f,g.handle)||ge.removeEvent(e,p,g.handle),delete h[p])}else for(p in h)ge.event.remove(e,p+t[c],i,n,!0);ge.isEmptyObject(h)&&(delete g.handle,ge._removeData(e,"events"))}},trigger:function(e,t,i,n){var r,o,a,s,l,c,h,u=[i||m],d=g.call(e,"type")?e.type:e,p=g.call(e,"namespace")?e.namespace.split("."):[];if(a=c=i=i||m,3!==i.nodeType&&8!==i.nodeType&&!Q.test(d+ge.event.triggered)&&(0<=d.indexOf(".")&&(d=(p=d.split(".")).shift(),p.sort()),o=d.indexOf(":")<0&&"on"+d,(e=e[ge.expando]?e:new ge.Event(d,"object"==typeof e&&e)).isTrigger=!0,e.namespace=p.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=E,e.target||(e.target=i),t=null==t?[e]:ge.makeArray(t,[e]),l=ge.event.special[d]||{},n||!l.trigger||!1!==l.trigger.apply(i,t))){if(!n&&!l.noBubble&&!ge.isWindow(i)){for(s=l.delegateType||d,Q.test(s+d)||(a=a.parentNode);a;a=a.parentNode)u.push(a),c=a;c===(i.ownerDocument||m)&&u.push(c.defaultView||c.parentWindow||f)}for(h=0;(a=u[h++])&&!e.isPropagationStopped();)e.type=1<h?s:l.bindType||d,(r=(ge._data(a,"events")||{})[e.type]&&ge._data(a,"handle"))&&r.apply(a,t),(r=o&&a[o])&&ge.acceptData(a)&&r.apply&&!1===r.apply(a,t)&&e.preventDefault();if(e.type=d,!n&&!e.isDefaultPrevented()&&(!l._default||!1===l._default.apply(i.ownerDocument,t))&&("click"!==d||!ge.nodeName(i,"a"))&&ge.acceptData(i)&&o&&i[d]&&!ge.isWindow(i)){(c=i[o])&&(i[o]=null),ge.event.triggered=d;try{i[d]()}catch(e){}ge.event.triggered=E,c&&(i[o]=c)}return e.result}},dispatch:function(e){e=ge.event.fix(e);var t,i,n,r,o,a,s=h.call(arguments),l=(ge._data(this,"events")||{})[e.type]||[],c=ge.event.special[e.type]||{};if((s[0]=e).delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,e)){for(a=ge.event.handlers.call(this,e,l),t=0;(r=a[t++])&&!e.isPropagationStopped();)for(e.currentTarget=r.elem,o=0;(n=r.handlers[o++])&&!e.isImmediatePropagationStopped();)e.namespace_re&&!e.namespace_re.test(n.namespace)||(e.handleObj=n,e.data=n.data,(i=((ge.event.special[n.origType]||{}).handle||n.handler).apply(r.elem,s))!==E&&!1===(e.result=i)&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,t){var i,n,r,o,a=[],s=t.delegateCount,l=e.target;if(s&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(!0!==l.disabled||"click"!==e.type)){for(r=[],o=0;o<s;o++)r[i=(n=t[o]).selector+" "]===E&&(r[i]=n.needsContext?0<=ge(i,this).index(l):ge.find(i,this,null,[l]).length),r[i]&&r.push(n);r.length&&a.push({elem:l,handlers:r})}return s<t.length&&a.push({elem:this,handlers:t.slice(s)}),a},fix:function(e){if(e[ge.expando])return e;var t,i,n,r=e.type,o=e,a=this.fixHooks[r];for(a||(this.fixHooks[r]=a=J.test(r)?this.mouseHooks:K.test(r)?this.keyHooks:{}),n=a.props?this.props.concat(a.props):this.props,e=new ge.Event(o),t=n.length;t--;)e[i=n[t]]=o[i];return e.target||(e.target=o.srcElement||m),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,a.filter?a.filter(e,o):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var i,n,r,o=t.button,a=t.fromElement;return null==e.pageX&&null!=t.clientX&&(r=(n=e.target.ownerDocument||m).documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?t.toElement:a),e.which||o===E||(e.which=1&o?1:2&o?3:4&o?2:0),e}},special:{load:{noBubble:!0},click:{trigger:function(){if(ge.nodeName(this,"input")&&"checkbox"===this.type&&this.click)return this.click(),!1}},focus:{trigger:function(){if(this!==m.activeElement&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){if(this===m.activeElement&&this.blur)return this.blur(),!1},delegateType:"focusout"},beforeunload:{postDispatch:function(e){e.result!==E&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,n){var r=ge.extend(new ge.Event,i,{type:e,isSimulated:!0,originalEvent:{}});n?ge.event.trigger(r,null,t):ge.event.dispatch.call(t,r),r.isDefaultPrevented()&&i.preventDefault()}},ge.removeEvent=m.removeEventListener?function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)}:function(e,t,i){var n="on"+t;e.detachEvent&&(typeof e[n]===v&&(e[n]=null),e.detachEvent(n,i))},ge.Event=function(e,t){if(!(this instanceof ge.Event))return new ge.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||!1===e.returnValue||e.getPreventDefault&&e.getPreventDefault()?te:ie):this.type=e,t&&ge.extend(this,t),this.timeStamp=e&&e.timeStamp||ge.now(),this[ge.expando]=!0},ge.Event.prototype={isDefaultPrevented:ie,isPropagationStopped:ie,isImmediatePropagationStopped:ie,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=te,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=te,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=te,this.stopPropagation()}},ge.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,r){ge.event.special[e]={delegateType:r,bindType:r,handle:function(e){var t,i=e.relatedTarget,n=e.handleObj;return i&&(i===this||ge.contains(this,i))||(e.type=n.origType,t=n.handler.apply(this,arguments),e.type=r),t}}}),ge.support.submitBubbles||(ge.event.special.submit={setup:function(){if(ge.nodeName(this,"form"))return!1;ge.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,i=ge.nodeName(t,"input")||ge.nodeName(t,"button")?t.form:E;i&&!ge._data(i,"submitBubbles")&&(ge.event.add(i,"submit._submit",function(e){e._submit_bubble=!0}),ge._data(i,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&ge.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(ge.nodeName(this,"form"))return!1;ge.event.remove(this,"._submit")}}),ge.support.changeBubbles||(ge.event.special.change={setup:function(){if(Y.test(this.nodeName))return"checkbox"!==this.type&&"radio"!==this.type||(ge.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),ge.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),ge.event.simulate("change",this,e,!0)})),!1;ge.event.add(this,"beforeactivate._change",function(e){var t=e.target;Y.test(t.nodeName)&&!ge._data(t,"changeBubbles")&&(ge.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||ge.event.simulate("change",this.parentNode,e,!0)}),ge._data(t,"changeBubbles",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type)return e.handleObj.handler.apply(this,arguments)},teardown:function(){return ge.event.remove(this,"._change"),!Y.test(this.nodeName)}}),ge.support.focusinBubbles||ge.each({focus:"focusin",blur:"focusout"},function(e,t){var i=0,n=function(e){ge.event.simulate(t,e.target,ge.event.fix(e),!0)};ge.event.special[t]={setup:function(){0==i++&&m.addEventListener(e,n,!0)},teardown:function(){0==--i&&m.removeEventListener(e,n,!0)}}}),ge.fn.extend({on:function(e,t,i,n,r){var o,a;if("object"==typeof e){for(o in"string"!=typeof t&&(i=i||t,t=E),e)this.on(o,t,i,e[o],r);return this}if(null==i&&null==n?(n=t,i=t=E):null==n&&("string"==typeof t?(n=i,i=E):(n=i,i=t,t=E)),!1===n)n=ie;else if(!n)return this;return 1===r&&(a=n,(n=function(e){return ge().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=ge.guid++)),this.each(function(){ge.event.add(this,e,n,i,t)})},one:function(e,t,i,n){return this.on(e,t,i,n,1)},off:function(e,t,i){var n,r;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,ge(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"!=typeof e)return!1!==t&&"function"!=typeof t||(i=t,t=E),!1===i&&(i=ie),this.each(function(){ge.event.remove(this,e,i,t)});for(r in e)this.off(r,t,e[r]);return this},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)},trigger:function(e,t){return this.each(function(){ge.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];if(i)return ge.event.trigger(e,t,i,!0)}}),function(i,e){var t,w,_,o,n,f,c,E,m,T,r,g,v,a,s,y,h,M="sizzle"+-new Date,b=i.document,x={},S=0,u=0,l=ee(),d=ee(),p=ee(),C="undefined",R=[],A=R.pop,P=R.push,L=R.slice,O=R.indexOf||function(e){for(var t=0,i=this.length;t<i;t++)if(this[t]===e)return t;return-1},I="[\\x20\\t\\r\\n\\f]",D="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",k=D.replace("w","w#"),N="\\["+I+"*("+D+")"+I+"*(?:([*^$|!~]?=)"+I+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+k+")|)|)"+I+"*\\]",H=":("+D+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+N.replace(3,8)+")*)|.*)\\)|)",B=new RegExp("^"+I+"+|((?:^|[^\\\\])(?:\\\\.)*)"+I+"+$","g"),F=new RegExp("^"+I+"*,"+I+"*"),U=new RegExp("^"+I+"*([\\x20\\t\\r\\n\\f>+~])"+I+"*"),$=new RegExp(H),z=new RegExp("^"+k+"$"),j={ID:new RegExp("^#("+D+")"),CLASS:new RegExp("^\\.("+D+")"),NAME:new RegExp("^\\[name=['\"]?("+D+")['\"]?\\]"),TAG:new RegExp("^("+D.replace("w","w*")+")"),ATTR:new RegExp("^"+N),PSEUDO:new RegExp("^"+H),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+I+"*(even|odd|(([+-]|)(\\d*)n|)"+I+"*(?:([+-]|)"+I+"*(\\d+)|))"+I+"*\\)|)","i"),needsContext:new RegExp("^"+I+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+I+"*((?:-\\d)?\\d*)"+I+"*\\)|)(?=[^-]|$)","i")},V=/[\x20\t\r\n\f]*[+~]/,G=/^[^{]+\{\s*\[native code/,W=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,q=/^(?:input|select|textarea|button)$/i,X=/^h\d$/i,Z=/'|\\/g,Y=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,K=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,J=function(e,t){var i="0x"+t-65536;return i!=i?t:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)};try{L.call(b.documentElement.childNodes,0)[0].nodeType}catch(e){L=function(e){for(var t,i=[];t=this[e++];)i.push(t);return i}}function Q(e){return G.test(e+"")}function ee(){var i,n=[];return i=function(e,t){return n.push(e+=" ")>_.cacheLength&&delete i[n.shift()],i[e]=t}}function te(e){return e[M]=!0,e}function ie(e){var t=T.createElement("div");try{return e(t)}catch(e){return!1}finally{t=null}}function ne(e,t,i,n){var r,o,a,s,l,c,h,u,d,p;if((t?t.ownerDocument||t:b)!==T&&m(t),i=i||[],!e||"string"!=typeof e)return i;if(1!==(s=(t=t||T).nodeType)&&9!==s)return[];if(!g&&!n){if(r=W.exec(e))if(a=r[1]){if(9===s){if(!(o=t.getElementById(a))||!o.parentNode)return i;if(o.id===a)return i.push(o),i}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&y(t,o)&&o.id===a)return i.push(o),i}else{if(r[2])return P.apply(i,L.call(t.getElementsByTagName(e),0)),i;if((a=r[3])&&x.getByClassName&&t.getElementsByClassName)return P.apply(i,L.call(t.getElementsByClassName(a),0)),i}if(x.qsa&&!v.test(e)){if(h=!0,u=M,d=t,p=9===s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){for(c=le(e),(h=t.getAttribute("id"))?u=h.replace(Z,"\\$&"):t.setAttribute("id",u),u="[id='"+u+"'] ",l=c.length;l--;)c[l]=u+ce(c[l]);d=V.test(e)&&t.parentNode||t,p=c.join(",")}if(p)try{return P.apply(i,L.call(d.querySelectorAll(p),0)),i}catch(e){}finally{h||t.removeAttribute("id")}}}return function(e,t,i,n){var r,o,a,s,l,c=le(e);if(!n&&1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(a=o[0]).type&&9===t.nodeType&&!g&&_.relative[o[1].type]){if(!(t=_.find.ID(a.matches[0].replace(K,J),t)[0]))return i;e=e.slice(o.shift().value.length)}for(r=j.needsContext.test(e)?0:o.length;r--&&(a=o[r],!_.relative[s=a.type]);)if((l=_.find[s])&&(n=l(a.matches[0].replace(K,J),V.test(o[0].type)&&t.parentNode||t))){if(o.splice(r,1),!(e=n.length&&ce(o)))return P.apply(i,L.call(n,0)),i;break}}return f(e,c)(n,t,g,i,V.test(e)),i}(e.replace(B,"$1"),t,i,n)}function re(e,t){var i=t&&e,n=i&&(~t.sourceIndex||1<<31)-(~e.sourceIndex||1<<31);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function oe(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ae(i){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===i}}function se(a){return te(function(o){return o=+o,te(function(e,t){for(var i,n=a([],e.length,o),r=n.length;r--;)e[i=n[r]]&&(e[i]=!(t[i]=e[i]))})})}for(t in n=ne.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},m=ne.setDocument=function(e){var l=e?e.ownerDocument||e:b;return l!==T&&9===l.nodeType&&l.documentElement&&(r=(T=l).documentElement,g=n(l),x.tagNameNoComments=ie(function(e){return e.appendChild(l.createComment("")),!e.getElementsByTagName("*").length}),x.attributes=ie(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return"boolean"!==t&&"string"!==t}),x.getByClassName=ie(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!(!e.getElementsByClassName||!e.getElementsByClassName("e").length)&&(e.lastChild.className="e",2===e.getElementsByClassName("e").length)}),x.getByName=ie(function(e){e.id=M+0,e.innerHTML="<a name='"+M+"'></a><div name='"+M+"'></div>",r.insertBefore(e,r.firstChild);var t=l.getElementsByName&&l.getElementsByName(M).length===2+l.getElementsByName(M+0).length;return x.getIdNotName=!l.getElementById(M),r.removeChild(e),t}),_.attrHandle=ie(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==C&&"#"===e.firstChild.getAttribute("href")})?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},x.getIdNotName?(_.find.ID=function(e,t){if(typeof t.getElementById!==C&&!g){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},_.filter.ID=function(e){var t=e.replace(K,J);return function(e){return e.getAttribute("id")===t}}):(_.find.ID=function(e,t){if(typeof t.getElementById!==C&&!g){var i=t.getElementById(e);return i?i.id===e||typeof i.getAttributeNode!==C&&i.getAttributeNode("id").value===e?[i]:void 0:[]}},_.filter.ID=function(e){var i=e.replace(K,J);return function(e){var t=typeof e.getAttributeNode!==C&&e.getAttributeNode("id");return t&&t.value===i}}),_.find.TAG=x.tagNameNoComments?function(e,t){if(typeof t.getElementsByTagName!==C)return t.getElementsByTagName(e)}:function(e,t){var i,n=[],r=0,o=t.getElementsByTagName(e);if("*"!==e)return o;for(;i=o[r++];)1===i.nodeType&&n.push(i);return n},_.find.NAME=x.getByName&&function(e,t){if(typeof t.getElementsByName!==C)return t.getElementsByName(name)},_.find.CLASS=x.getByClassName&&function(e,t){if(typeof t.getElementsByClassName!==C&&!g)return t.getElementsByClassName(e)},a=[],v=[":focus"],(x.qsa=Q(l.querySelectorAll))&&(ie(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||v.push("\\["+I+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||v.push(":checked")}),ie(function(e){e.innerHTML="<input type='hidden' i=''/>",e.querySelectorAll("[i^='']").length&&v.push("[*^$]="+I+"*(?:\"\"|'')"),e.querySelectorAll(":enabled").length||v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")})),(x.matchesSelector=Q(s=r.matchesSelector||r.mozMatchesSelector||r.webkitMatchesSelector||r.oMatchesSelector||r.msMatchesSelector))&&ie(function(e){x.disconnectedMatch=s.call(e,"div"),s.call(e,"[s!='']:x"),a.push("!=",H)}),v=new RegExp(v.join("|")),a=new RegExp(a.join("|")),y=Q(r.contains)||r.compareDocumentPosition?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},h=r.compareDocumentPosition?function(e,t){var i;return e===t?(c=!0,0):(i=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t))?1&i||e.parentNode&&11===e.parentNode.nodeType?e===l||y(b,e)?-1:t===l||y(b,t)?1:0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var i,n=0,r=e.parentNode,o=t.parentNode,a=[e],s=[t];if(e===t)return c=!0,0;if(!r||!o)return e===l?-1:t===l?1:r?-1:o?1:0;if(r===o)return re(e,t);for(i=e;i=i.parentNode;)a.unshift(i);for(i=t;i=i.parentNode;)s.unshift(i);for(;a[n]===s[n];)n++;return n?re(a[n],s[n]):a[n]===b?-1:s[n]===b?1:0},c=!1,[0,0].sort(h),x.detectDuplicates=c),T},ne.matches=function(e,t){return ne(e,null,null,t)},ne.matchesSelector=function(e,t){if((e.ownerDocument||e)!==T&&m(e),t=t.replace(Y,"='$1']"),x.matchesSelector&&!g&&(!a||!a.test(t))&&!v.test(t))try{var i=s.call(e,t);if(i||x.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(e){}return 0<ne(t,T,null,[e]).length},ne.contains=function(e,t){return(e.ownerDocument||e)!==T&&m(e),y(e,t)},ne.attr=function(e,t){var i;return(e.ownerDocument||e)!==T&&m(e),g||(t=t.toLowerCase()),(i=_.attrHandle[t])?i(e):g||x.attributes?e.getAttribute(t):((i=e.getAttributeNode(t))||e.getAttribute(t))&&!0===e[t]?t:i&&i.specified?i.value:null},ne.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ne.uniqueSort=function(e){var t,i=[],n=1,r=0;if(c=!x.detectDuplicates,e.sort(h),c){for(;t=e[n];n++)t===e[n-1]&&(r=i.push(n));for(;r--;)e.splice(i[r],1)}return e},o=ne.getText=function(e){var t,i="",n=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=o(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[n];n++)i+=o(t);return i},_=ne.selectors={cacheLength:50,createPseudo:te,match:j,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(K,J),e[3]=(e[4]||e[5]||"").replace(K,J),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ne.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ne.error(e[0]),e},PSEUDO:function(e){var t,i=!e[5]&&e[2];return j.CHILD.test(e[0])?null:(e[4]?e[2]=e[4]:i&&$.test(i)&&(t=le(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(t){return"*"===t?function(){return!0}:(t=t.replace(K,J).toLowerCase(),function(e){return e.nodeName&&e.nodeName.toLowerCase()===t})},CLASS:function(e){var t=l[e+" "];return t||(t=new RegExp("(^|"+I+")"+e+"("+I+"|$)"))&&l(e,function(e){return t.test(e.className||typeof e.getAttribute!==C&&e.getAttribute("class")||"")})},ATTR:function(i,n,r){return function(e){var t=ne.attr(e,i);return null==t?"!="===n:!n||(t+="","="===n?t===r:"!="===n?t!==r:"^="===n?r&&0===t.indexOf(r):"*="===n?r&&-1<t.indexOf(r):"$="===n?r&&t.slice(-r.length)===r:"~="===n?-1<(" "+t+" ").indexOf(r):"|="===n&&(t===r||t.slice(0,r.length+1)===r+"-"))}},CHILD:function(p,e,t,f,m){var g="nth"!==p.slice(0,3),v="last"!==p.slice(-4),y="of-type"===e;return 1===f&&0===m?function(e){return!!e.parentNode}:function(e,t,i){var n,r,o,a,s,l,c=g!==v?"nextSibling":"previousSibling",h=e.parentNode,u=y&&e.nodeName.toLowerCase(),d=!i&&!y;if(h){if(g){for(;c;){for(o=e;o=o[c];)if(y?o.nodeName.toLowerCase()===u:1===o.nodeType)return!1;l=c="only"===p&&!l&&"nextSibling"}return!0}if(l=[v?h.firstChild:h.lastChild],v&&d){for(s=(n=(r=h[M]||(h[M]={}))[p]||[])[0]===S&&n[1],a=n[0]===S&&n[2],o=s&&h.childNodes[s];o=++s&&o&&o[c]||(a=s=0)||l.pop();)if(1===o.nodeType&&++a&&o===e){r[p]=[S,s,a];break}}else if(d&&(n=(e[M]||(e[M]={}))[p])&&n[0]===S)a=n[1];else for(;(o=++s&&o&&o[c]||(a=s=0)||l.pop())&&((y?o.nodeName.toLowerCase()!==u:1!==o.nodeType)||!++a||(d&&((o[M]||(o[M]={}))[p]=[S,a]),o!==e)););return(a-=m)===f||a%f==0&&0<=a/f}}},PSEUDO:function(e,o){var t,a=_.pseudos[e]||_.setFilters[e.toLowerCase()]||ne.error("unsupported pseudo: "+e);return a[M]?a(o):1<a.length?(t=[e,e,"",o],_.setFilters.hasOwnProperty(e.toLowerCase())?te(function(e,t){for(var i,n=a(e,o),r=n.length;r--;)e[i=O.call(e,n[r])]=!(t[i]=n[r])}):function(e){return a(e,0,t)}):a}},pseudos:{not:te(function(e){var n=[],r=[],s=f(e.replace(B,"$1"));return s[M]?te(function(e,t,i,n){for(var r,o=s(e,null,n,[]),a=e.length;a--;)(r=o[a])&&(e[a]=!(t[a]=r))}):function(e,t,i){return n[0]=e,s(n,null,i,r),!r.pop()}}),has:te(function(t){return function(e){return 0<ne(t,e).length}}),contains:te(function(t){return function(e){return-1<(e.textContent||e.innerText||o(e)).indexOf(t)}}),lang:te(function(i){return z.test(i||"")||ne.error("unsupported lang: "+i),i=i.replace(K,J).toLowerCase(),function(e){var t;do{if(t=g?e.getAttribute("xml:lang")||e.getAttribute("lang"):e.lang)return(t=t.toLowerCase())===i||0===t.indexOf(i+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=i.location&&i.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===r},focus:function(e){return e===T.activeElement&&(!T.hasFocus||T.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if("@"<e.nodeName||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!_.pseudos.empty(e)},header:function(e){return X.test(e.nodeName)},input:function(e){return q.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:se(function(){return[0]}),last:se(function(e,t){return[t-1]}),eq:se(function(e,t,i){return[i<0?i+t:i]}),even:se(function(e,t){for(var i=0;i<t;i+=2)e.push(i);return e}),odd:se(function(e,t){for(var i=1;i<t;i+=2)e.push(i);return e}),lt:se(function(e,t,i){for(var n=i<0?i+t:i;0<=--n;)e.push(n);return e}),gt:se(function(e,t,i){for(var n=i<0?i+t:i;++n<t;)e.push(n);return e})}},{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})_.pseudos[t]=oe(t);for(t in{submit:!0,reset:!0})_.pseudos[t]=ae(t);function le(e,t){var i,n,r,o,a,s,l,c=d[e+" "];if(c)return t?0:c.slice(0);for(a=e,s=[],l=_.preFilter;a;){for(o in i&&!(n=F.exec(a))||(n&&(a=a.slice(n[0].length)||a),s.push(r=[])),i=!1,(n=U.exec(a))&&(i=n.shift(),r.push({value:i,type:n[0].replace(B," ")}),a=a.slice(i.length)),_.filter)!(n=j[o].exec(a))||l[o]&&!(n=l[o](n))||(i=n.shift(),r.push({value:i,type:o,matches:n}),a=a.slice(i.length));if(!i)break}return t?a.length:a?ne.error(e):d(e,s).slice(0)}function ce(e){for(var t=0,i=e.length,n="";t<i;t++)n+=e[t].value;return n}function he(s,e,t){var l=e.dir,c=t&&"parentNode"===l,h=u++;return e.first?function(e,t,i){for(;e=e[l];)if(1===e.nodeType||c)return s(e,t,i)}:function(e,t,i){var n,r,o,a=S+" "+h;if(i){for(;e=e[l];)if((1===e.nodeType||c)&&s(e,t,i))return!0}else for(;e=e[l];)if(1===e.nodeType||c)if((r=(o=e[M]||(e[M]={}))[l])&&r[0]===a){if(!0===(n=r[1])||n===w)return!0===n}else if((r=o[l]=[a])[1]=s(e,t,i)||w,!0===r[1])return!0}}function ue(r){return 1<r.length?function(e,t,i){for(var n=r.length;n--;)if(!r[n](e,t,i))return!1;return!0}:r[0]}function de(e,t,i,n,r){for(var o,a=[],s=0,l=e.length,c=null!=t;s<l;s++)(o=e[s])&&(i&&!i(o,n,r)||(a.push(o),c&&t.push(s)));return a}function pe(p,f,m,g,v,e){return g&&!g[M]&&(g=pe(g)),v&&!v[M]&&(v=pe(v,e)),te(function(e,t,i,n){var r,o,a,s=[],l=[],c=t.length,h=e||function(e,t,i){for(var n=0,r=t.length;n<r;n++)ne(e,t[n],i);return i}(f||"*",i.nodeType?[i]:i,[]),u=!p||!e&&f?h:de(h,s,p,i,n),d=m?v||(e?p:c||g)?[]:t:u;if(m&&m(u,d,i,n),g)for(r=de(d,l),g(r,[],i,n),o=r.length;o--;)(a=r[o])&&(d[l[o]]=!(u[l[o]]=a));if(e){if(v||p){if(v){for(r=[],o=d.length;o--;)(a=d[o])&&r.push(u[o]=a);v(null,d=[],r,n)}for(o=d.length;o--;)(a=d[o])&&-1<(r=v?O.call(e,a):s[o])&&(e[r]=!(t[r]=a))}}else d=de(d===t?d.splice(c,d.length):d),v?v(null,t,d,n):P.apply(t,d)})}function fe(e){for(var n,t,i,r=e.length,o=_.relative[e[0].type],a=o||_.relative[" "],s=o?1:0,l=he(function(e){return e===n},a,!0),c=he(function(e){return-1<O.call(n,e)},a,!0),h=[function(e,t,i){return!o&&(i||t!==E)||((n=t).nodeType?l(e,t,i):c(e,t,i))}];s<r;s++)if(t=_.relative[e[s].type])h=[he(ue(h),t)];else{if((t=_.filter[e[s].type].apply(null,e[s].matches))[M]){for(i=++s;i<r&&!_.relative[e[i].type];i++);return pe(1<s&&ue(h),1<s&&ce(e.slice(0,s-1)).replace(B,"$1"),t,s<i&&fe(e.slice(s,i)),i<r&&fe(e=e.slice(i)),i<r&&ce(e))}h.push(t)}return ue(h)}function me(){}f=ne.compile=function(e,t){var i,g,v,y,b,x,n,r=[],o=[],a=p[e+" "];if(!a){for(t||(t=le(e)),i=t.length;i--;)(a=fe(t[i]))[M]?r.push(a):o.push(a);a=p(e,(g=o,b=(y=0)<(v=r).length,x=0<g.length,n=function(e,t,i,n,r){var o,a,s,l=[],c=0,h="0",u=e&&[],d=null!=r,p=E,f=e||x&&_.find.TAG("*",r&&t.parentNode||t),m=S+=null==p?1:Math.random()||.1;for(d&&(E=t!==T&&t,w=y);null!=(o=f[h]);h++){if(x&&o){for(a=0;s=g[a++];)if(s(o,t,i)){n.push(o);break}d&&(S=m,w=++y)}b&&((o=!s&&o)&&c--,e&&u.push(o))}if(c+=h,b&&h!==c){for(a=0;s=v[a++];)s(u,l,t,i);if(e){if(0<c)for(;h--;)u[h]||l[h]||(l[h]=A.call(n));l=de(l)}P.apply(n,l),d&&!e&&0<l.length&&1<c+v.length&&ne.uniqueSort(n)}return d&&(S=m,E=p),u},b?te(n):n))}return a},_.pseudos.nth=_.pseudos.eq,_.filters=me.prototype=_.pseudos,_.setFilters=new me,m(),ne.attr=ge.attr,ge.find=ne,ge.expr=ne.selectors,ge.expr[":"]=ge.expr.pseudos,ge.unique=ne.uniqueSort,ge.text=ne.getText,ge.isXMLDoc=ne.isXML,ge.contains=ne.contains}(f);var ne=/Until$/,re=/^(?:parents|prev(?:Until|All))/,oe=/^.[^:#\[\.,]*$/,ae=ge.expr.match.needsContext,se={children:!0,contents:!0,next:!0,prev:!0};function le(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function ce(e,i,n){if(i=i||0,ge.isFunction(i))return ge.grep(e,function(e,t){return!!i.call(e,t,e)===n});if(i.nodeType)return ge.grep(e,function(e){return e===i===n});if("string"==typeof i){var t=ge.grep(e,function(e){return 1===e.nodeType});if(oe.test(i))return ge.filter(i,t,!n);i=ge.filter(i,t)}return ge.grep(e,function(e){return 0<=ge.inArray(e,i)===n})}function he(e){var t=ue.split("|"),i=e.createDocumentFragment();if(i.createElement)for(;t.length;)i.createElement(t.pop());return i}ge.fn.extend({find:function(e){var t,i,n,r=this.length;if("string"!=typeof e)return(n=this).pushStack(ge(e).filter(function(){for(t=0;t<r;t++)if(ge.contains(n[t],this))return!0}));for(i=[],t=0;t<r;t++)ge.find(e,this[t],i);return(i=this.pushStack(1<r?ge.unique(i):i)).selector=(this.selector?this.selector+" ":"")+e,i},has:function(e){var t,i=ge(e,this),n=i.length;return this.filter(function(){for(t=0;t<n;t++)if(ge.contains(this,i[t]))return!0})},not:function(e){return this.pushStack(ce(this,e,!1))},filter:function(e){return this.pushStack(ce(this,e,!0))},is:function(e){return!!e&&("string"==typeof e?ae.test(e)?0<=ge(e,this.context).index(this[0]):0<ge.filter(e,this).length:0<this.filter(e).length)},closest:function(e,t){for(var i,n=0,r=this.length,o=[],a=ae.test(e)||"string"!=typeof e?ge(e,t||this.context):0;n<r;n++)for(i=this[n];i&&i.ownerDocument&&i!==t&&11!==i.nodeType;){if(a?-1<a.index(i):ge.find.matchesSelector(i,e)){o.push(i);break}i=i.parentNode}return this.pushStack(1<o.length?ge.unique(o):o)},index:function(e){return e?"string"==typeof e?ge.inArray(this[0],ge(e)):ge.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var i="string"==typeof e?ge(e,t):ge.makeArray(e&&e.nodeType?[e]:e),n=ge.merge(this.get(),i);return this.pushStack(ge.unique(n))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ge.fn.andSelf=ge.fn.addBack,ge.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return ge.dir(e,"parentNode")},parentsUntil:function(e,t,i){return ge.dir(e,"parentNode",i)},next:function(e){return le(e,"nextSibling")},prev:function(e){return le(e,"previousSibling")},nextAll:function(e){return ge.dir(e,"nextSibling")},prevAll:function(e){return ge.dir(e,"previousSibling")},nextUntil:function(e,t,i){return ge.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return ge.dir(e,"previousSibling",i)},siblings:function(e){return ge.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return ge.sibling(e.firstChild)},contents:function(e){return ge.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:ge.merge([],e.childNodes)}},function(n,r){ge.fn[n]=function(e,t){var i=ge.map(this,r,e);return ne.test(n)||(t=e),t&&"string"==typeof t&&(i=ge.filter(t,i)),i=1<this.length&&!se[n]?ge.unique(i):i,1<this.length&&re.test(n)&&(i=i.reverse()),this.pushStack(i)}}),ge.extend({filter:function(e,t,i){return i&&(e=":not("+e+")"),1===t.length?ge.find.matchesSelector(t[0],e)?[t[0]]:[]:ge.find.matches(e,t)},dir:function(e,t,i){for(var n=[],r=e[t];r&&9!==r.nodeType&&(i===E||1!==r.nodeType||!ge(r).is(i));)1===r.nodeType&&n.push(r),r=r[t];return n},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}});var ue="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",de=/ jQuery\d+="(?:null|\d+)"/g,pe=new RegExp("<(?:"+ue+")[\\s/>]","i"),fe=/^\s+/,me=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ve=/<([\w:]+)/,ye=/<tbody/i,be=/<|&#?\w+;/,xe=/<(?:script|style|link)/i,we=/^(?:checkbox|radio)$/i,_e=/checked\s*(?:[^=]|=\s*.checked.)/i,Ee=/^$|\/(?:java|ecma)script/i,Te=/^true\/(.*)/,Me=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Se={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:ge.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},Ce=he(m).appendChild(m.createElement("div"));function Re(e){var t=e.getAttributeNode("type");return e.type=(t&&t.specified)+"/"+e.type,e}function Ae(e){var t=Te.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function Pe(e,t){for(var i,n=0;null!=(i=e[n]);n++)ge._data(i,"globalEval",!t||ge._data(t[n],"globalEval"))}function Le(e,t){if(1===t.nodeType&&ge.hasData(e)){var i,n,r,o=ge._data(e),a=ge._data(t,o),s=o.events;if(s)for(i in delete a.handle,a.events={},s)for(n=0,r=s[i].length;n<r;n++)ge.event.add(t,i,s[i][n]);a.data&&(a.data=ge.extend({},a.data))}}function Oe(e,t){var i,n,r;if(1===t.nodeType){if(i=t.nodeName.toLowerCase(),!ge.support.noCloneEvent&&t[ge.expando]){for(n in(r=ge._data(t)).events)ge.removeEvent(t,n,r.handle);t.removeAttribute(ge.expando)}"script"===i&&t.text!==e.text?(Re(t).text=e.text,Ae(t)):"object"===i?(t.parentNode&&(t.outerHTML=e.outerHTML),ge.support.html5Clone&&e.innerHTML&&!ge.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===i&&we.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===i?t.defaultSelected=t.selected=e.defaultSelected:"input"!==i&&"textarea"!==i||(t.defaultValue=e.defaultValue)}}function Ie(e,t){var i,n,r=0,o=typeof e.getElementsByTagName!==v?e.getElementsByTagName(t||"*"):typeof e.querySelectorAll!==v?e.querySelectorAll(t||"*"):E;if(!o)for(o=[],i=e.childNodes||e;null!=(n=i[r]);r++)!t||ge.nodeName(n,t)?o.push(n):ge.merge(o,Ie(n,t));return t===E||t&&ge.nodeName(e,t)?ge.merge([e],o):o}function De(e){we.test(e.type)&&(e.defaultChecked=e.checked)}Se.optgroup=Se.option,Se.tbody=Se.tfoot=Se.colgroup=Se.caption=Se.thead,Se.th=Se.td,ge.fn.extend({text:function(e){return ge.access(this,function(e){return e===E?ge.text(this):this.empty().append((this[0]&&this[0].ownerDocument||m).createTextNode(e))},null,e,arguments.length)},wrapAll:function(t){if(ge.isFunction(t))return this.each(function(e){ge(this).wrapAll(t.call(this,e))});if(this[0]){var e=ge(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(i){return ge.isFunction(i)?this.each(function(e){ge(this).wrapInner(i.call(this,e))}):this.each(function(){var e=ge(this),t=e.contents();t.length?t.wrapAll(i):e.append(i)})},wrap:function(t){var i=ge.isFunction(t);return this.each(function(e){ge(this).wrapAll(i?t.call(this,e):t)})},unwrap:function(){return this.parent().each(function(){ge.nodeName(this,"body")||ge(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||this.insertBefore(e,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var i,n=0;null!=(i=this[n]);n++)(!e||0<ge.filter(e,[i]).length)&&(t||1!==i.nodeType||ge.cleanData(Ie(i)),i.parentNode&&(t&&ge.contains(i.ownerDocument,i)&&Pe(Ie(i,"script")),i.parentNode.removeChild(i)));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&ge.cleanData(Ie(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&ge.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return ge.clone(this,e,t)})},html:function(e){return ge.access(this,function(e){var t=this[0]||{},i=0,n=this.length;if(e===E)return 1===t.nodeType?t.innerHTML.replace(de,""):E;if("string"==typeof e&&!xe.test(e)&&(ge.support.htmlSerialize||!pe.test(e))&&(ge.support.leadingWhitespace||!fe.test(e))&&!Se[(ve.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(me,"<$1></$2>");try{for(;i<n;i++)1===(t=this[i]||{}).nodeType&&(ge.cleanData(Ie(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){return ge.isFunction(e)||"string"==typeof e||(e=ge(e).not(this).detach()),this.domManip([e],!0,function(e){var t=this.nextSibling,i=this.parentNode;i&&(ge(this).remove(),i.insertBefore(e,t))})},detach:function(e){return this.remove(e,!0)},domManip:function(i,n,r){i=y.apply([],i);var e,t,o,a,s,l,c,h,u=0,d=this.length,p=this,f=d-1,m=i[0],g=ge.isFunction(m);if(g||!(d<=1||"string"!=typeof m||ge.support.checkClone)&&_e.test(m))return this.each(function(e){var t=p.eq(e);g&&(i[0]=m.call(this,e,n?t.html():E)),t.domManip(i,n,r)});if(d&&(e=(l=ge.buildFragment(i,this[0].ownerDocument,!1,this)).firstChild,1===l.childNodes.length&&(l=e),e)){for(n=n&&ge.nodeName(e,"tr"),o=(a=ge.map(Ie(l,"script"),Re)).length;u<d;u++)t=l,u!==f&&(t=ge.clone(t,!0,!0),o&&ge.merge(a,Ie(t,"script"))),r.call(n&&ge.nodeName(this[u],"table")?(c=this[u],h="tbody",c.getElementsByTagName(h)[0]||c.appendChild(c.ownerDocument.createElement(h))):this[u],t,u);if(o)for(s=a[a.length-1].ownerDocument,ge.map(a,Ae),u=0;u<o;u++)t=a[u],Ee.test(t.type||"")&&!ge._data(t,"globalEval")&&ge.contains(s,t)&&(t.src?ge.ajax({url:t.src,type:"GET",dataType:"script",async:!1,global:!1,throws:!0}):ge.globalEval((t.text||t.textContent||t.innerHTML||"").replace(Me,"")));l=e=null}return this}}),ge.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){ge.fn[e]=function(e){for(var t,i=0,n=[],r=ge(e),o=r.length-1;i<=o;i++)t=i===o?this:this.clone(!0),ge(r[i])[a](t),s.apply(n,t.get());return this.pushStack(n)}}),ge.extend({clone:function(e,t,i){var n,r,o,a,s,l=ge.contains(e.ownerDocument,e);if(ge.support.html5Clone||ge.isXMLDoc(e)||!pe.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(Ce.innerHTML=e.outerHTML,Ce.removeChild(o=Ce.firstChild)),!(ge.support.noCloneEvent&&ge.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ge.isXMLDoc(e)))for(n=Ie(o),s=Ie(e),a=0;null!=(r=s[a]);++a)n[a]&&Oe(r,n[a]);if(t)if(i)for(s=s||Ie(e),n=n||Ie(o),a=0;null!=(r=s[a]);a++)Le(r,n[a]);else Le(e,o);return 0<(n=Ie(o,"script")).length&&Pe(n,!l&&Ie(e,"script")),n=s=r=null,o},buildFragment:function(e,t,i,n){for(var r,o,a,s,l,c,h,u=e.length,d=he(t),p=[],f=0;f<u;f++)if((o=e[f])||0===o)if("object"===ge.type(o))ge.merge(p,o.nodeType?[o]:o);else if(be.test(o)){for(s=s||d.appendChild(t.createElement("div")),l=(ve.exec(o)||["",""])[1].toLowerCase(),h=Se[l]||Se._default,s.innerHTML=h[1]+o.replace(me,"<$1></$2>")+h[2],r=h[0];r--;)s=s.lastChild;if(!ge.support.leadingWhitespace&&fe.test(o)&&p.push(t.createTextNode(fe.exec(o)[0])),!ge.support.tbody)for(r=(o="table"!==l||ye.test(o)?"<table>"!==h[1]||ye.test(o)?0:s:s.firstChild)&&o.childNodes.length;r--;)ge.nodeName(c=o.childNodes[r],"tbody")&&!c.childNodes.length&&o.removeChild(c);for(ge.merge(p,s.childNodes),s.textContent="";s.firstChild;)s.removeChild(s.firstChild);s=d.lastChild}else p.push(t.createTextNode(o));for(s&&d.removeChild(s),ge.support.appendChecked||ge.grep(Ie(p,"input"),De),f=0;o=p[f++];)if((!n||-1===ge.inArray(o,n))&&(a=ge.contains(o.ownerDocument,o),s=Ie(d.appendChild(o),"script"),a&&Pe(s),i))for(r=0;o=s[r++];)Ee.test(o.type||"")&&i.push(o);return s=null,d},cleanData:function(e,t){for(var i,n,r,o,a=0,s=ge.expando,l=ge.cache,c=ge.support.deleteExpando,h=ge.event.special;null!=(i=e[a]);a++)if((t||ge.acceptData(i))&&(o=(r=i[s])&&l[r])){if(o.events)for(n in o.events)h[n]?ge.event.remove(i,n):ge.removeEvent(i,n,o.handle);l[r]&&(delete l[r],c?delete i[s]:typeof i.removeAttribute!==v?i.removeAttribute(s):i[s]=null,u.push(r))}}});var ke,Ne,He,Be=/alpha\([^)]*\)/i,Fe=/opacity\s*=\s*([^)]*)/,Ue=/^(top|right|bottom|left)$/,$e=/^(none|table(?!-c[ea]).+)/,ze=/^margin/,je=new RegExp("^("+d+")(.*)$","i"),Ve=new RegExp("^("+d+")(?!px)[a-z%]+$","i"),Ge=new RegExp("^([+-])=("+d+")","i"),We={BODY:"block"},qe={position:"absolute",visibility:"hidden",display:"block"},Xe={letterSpacing:0,fontWeight:400},Ze=["Top","Right","Bottom","Left"],Ye=["Webkit","O","Moz","ms"];function Ke(e,t){if(t in e)return t;for(var i=t.charAt(0).toUpperCase()+t.slice(1),n=t,r=Ye.length;r--;)if((t=Ye[r]+i)in e)return t;return n}function Je(e,t){return e=t||e,"none"===ge.css(e,"display")||!ge.contains(e.ownerDocument,e)}function Qe(e,t){for(var i,n,r,o=[],a=0,s=e.length;a<s;a++)(n=e[a]).style&&(o[a]=ge._data(n,"olddisplay"),i=n.style.display,t?(o[a]||"none"!==i||(n.style.display=""),""===n.style.display&&Je(n)&&(o[a]=ge._data(n,"olddisplay",nt(n.nodeName)))):o[a]||(r=Je(n),(i&&"none"!==i||!r)&&ge._data(n,"olddisplay",r?i:ge.css(n,"display"))));for(a=0;a<s;a++)(n=e[a]).style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?o[a]||"":"none"));return e}function et(e,t,i){var n=je.exec(t);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):t}function tt(e,t,i,n,r){for(var o=i===(n?"border":"content")?4:"width"===t?1:0,a=0;o<4;o+=2)"margin"===i&&(a+=ge.css(e,i+Ze[o],!0,r)),n?("content"===i&&(a-=ge.css(e,"padding"+Ze[o],!0,r)),"margin"!==i&&(a-=ge.css(e,"border"+Ze[o]+"Width",!0,r))):(a+=ge.css(e,"padding"+Ze[o],!0,r),"padding"!==i&&(a+=ge.css(e,"border"+Ze[o]+"Width",!0,r)));return a}function it(e,t,i){var n=!0,r="width"===t?e.offsetWidth:e.offsetHeight,o=Ne(e),a=ge.support.boxSizing&&"border-box"===ge.css(e,"boxSizing",!1,o);if(r<=0||null==r){if(((r=He(e,t,o))<0||null==r)&&(r=e.style[t]),Ve.test(r))return r;n=a&&(ge.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+tt(e,t,i||(a?"border":"content"),n,o)+"px"}function nt(e){var t=m,i=We[e];return i||("none"!==(i=rt(e,t))&&i||((t=((ke=(ke||ge("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement))[0].contentWindow||ke[0].contentDocument).document).write("<!doctype html><html><body>"),t.close(),i=rt(e,t),ke.detach()),We[e]=i),i}function rt(e,t){var i=ge(t.createElement(e)).appendTo(t.body),n=ge.css(i[0],"display");return i.remove(),n}ge.fn.extend({css:function(e,t){return ge.access(this,function(e,t,i){var n,r,o={},a=0;if(ge.isArray(t)){for(r=Ne(e),n=t.length;a<n;a++)o[t[a]]=ge.css(e,t[a],!1,r);return o}return i!==E?ge.style(e,t,i):ge.css(e,t)},e,t,1<arguments.length)},show:function(){return Qe(this,!0)},hide:function(){return Qe(this)},toggle:function(e){var t="boolean"==typeof e;return this.each(function(){(t?e:Je(this))?ge(this).show():ge(this).hide()})}}),ge.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=He(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:ge.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,i,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,o,a,s=ge.camelCase(t),l=e.style;if(t=ge.cssProps[s]||(ge.cssProps[s]=Ke(l,s)),a=ge.cssHooks[t]||ge.cssHooks[s],i===E)return a&&"get"in a&&(r=a.get(e,!1,n))!==E?r:l[t];if(!("string"===(o=typeof i)&&(r=Ge.exec(i))&&(i=(r[1]+1)*r[2]+parseFloat(ge.css(e,t)),o="number"),null==i||"number"===o&&isNaN(i)||("number"!==o||ge.cssNumber[s]||(i+="px"),ge.support.clearCloneStyle||""!==i||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&(i=a.set(e,i,n))===E)))try{l[t]=i}catch(e){}}},css:function(e,t,i,n){var r,o,a,s=ge.camelCase(t);return t=ge.cssProps[s]||(ge.cssProps[s]=Ke(e.style,s)),(a=ge.cssHooks[t]||ge.cssHooks[s])&&"get"in a&&(o=a.get(e,!0,i)),o===E&&(o=He(e,t,n)),"normal"===o&&t in Xe&&(o=Xe[t]),""===i||i?(r=parseFloat(o),!0===i||ge.isNumeric(r)?r||0:o):o},swap:function(e,t,i,n){var r,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];for(o in r=i.apply(e,n||[]),t)e.style[o]=a[o];return r}}),f.getComputedStyle?(Ne=function(e){return f.getComputedStyle(e,null)},He=function(e,t,i){var n,r,o,a=i||Ne(e),s=a?a.getPropertyValue(t)||a[t]:E,l=e.style;return a&&(""!==s||ge.contains(e.ownerDocument,e)||(s=ge.style(e,t)),Ve.test(s)&&ze.test(t)&&(n=l.width,r=l.minWidth,o=l.maxWidth,l.minWidth=l.maxWidth=l.width=s,s=a.width,l.width=n,l.minWidth=r,l.maxWidth=o)),s}):m.documentElement.currentStyle&&(Ne=function(e){return e.currentStyle},He=function(e,t,i){var n,r,o,a=i||Ne(e),s=a?a[t]:E,l=e.style;return null==s&&l&&l[t]&&(s=l[t]),Ve.test(s)&&!Ue.test(t)&&(n=l.left,(o=(r=e.runtimeStyle)&&r.left)&&(r.left=e.currentStyle.left),l.left="fontSize"===t?"1em":s,s=l.pixelLeft+"px",l.left=n,o&&(r.left=o)),""===s?"auto":s}),ge.each(["height","width"],function(e,r){ge.cssHooks[r]={get:function(e,t,i){if(t)return 0===e.offsetWidth&&$e.test(ge.css(e,"display"))?ge.swap(e,qe,function(){return it(e,r,i)}):it(e,r,i)},set:function(e,t,i){var n=i&&Ne(e);return et(0,t,i?tt(e,r,i,ge.support.boxSizing&&"border-box"===ge.css(e,"boxSizing",!1,n),n):0)}}}),ge.support.opacity||(ge.cssHooks.opacity={get:function(e,t){return Fe.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var i=e.style,n=e.currentStyle,r=ge.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=n&&n.filter||i.filter||"";((i.zoom=1)<=t||""===t)&&""===ge.trim(o.replace(Be,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===t||n&&!n.filter)||(i.filter=Be.test(o)?o.replace(Be,r):o+" "+r)}}),ge(function(){ge.support.reliableMarginRight||(ge.cssHooks.marginRight={get:function(e,t){if(t)return ge.swap(e,{display:"inline-block"},He,[e,"marginRight"])}}),!ge.support.pixelPosition&&ge.fn.position&&ge.each(["top","left"],function(e,i){ge.cssHooks[i]={get:function(e,t){if(t)return t=He(e,i),Ve.test(t)?ge(e).position()[i]+"px":t}}})}),ge.expr&&ge.expr.filters&&(ge.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!ge.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||ge.css(e,"display"))},ge.expr.filters.visible=function(e){return!ge.expr.filters.hidden(e)}),ge.each({margin:"",padding:"",border:"Width"},function(r,o){ge.cssHooks[r+o]={expand:function(e){for(var t=0,i={},n="string"==typeof e?e.split(" "):[e];t<4;t++)i[r+Ze[t]+o]=n[t]||n[t-2]||n[0];return i}},ze.test(r)||(ge.cssHooks[r+o].set=et)});var ot=/%20/g,at=/\[\]$/,st=/\r?\n/g,lt=/^(?:submit|button|image|reset|file)$/i,ct=/^(?:input|select|textarea|keygen)/i;function ht(i,e,n,r){var t;if(ge.isArray(e))ge.each(e,function(e,t){n||at.test(i)?r(i,t):ht(i+"["+("object"==typeof t?e:"")+"]",t,n,r)});else if(n||"object"!==ge.type(e))r(i,e);else for(t in e)ht(i+"["+t+"]",e[t],n,r)}ge.fn.extend({serialize:function(){return ge.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=ge.prop(this,"elements");return e?ge.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!ge(this).is(":disabled")&&ct.test(this.nodeName)&&!lt.test(e)&&(this.checked||!we.test(e))}).map(function(e,t){var i=ge(this).val();return null==i?null:ge.isArray(i)?ge.map(i,function(e){return{name:t.name,value:e.replace(st,"\r\n")}}):{name:t.name,value:i.replace(st,"\r\n")}}).get()}}),ge.param=function(e,t){var i,n=[],r=function(e,t){t=ge.isFunction(t)?t():null==t?"":t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(t===E&&(t=ge.ajaxSettings&&ge.ajaxSettings.traditional),ge.isArray(e)||e.jquery&&!ge.isPlainObject(e))ge.each(e,function(){r(this.name,this.value)});else for(i in e)ht(i,e[i],t,r);return n.join("&").replace(ot,"+")},ge.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,i){ge.fn[i]=function(e,t){return 0<arguments.length?this.on(i,null,e,t):this.trigger(i)}}),ge.fn.hover=function(e,t){return this.mouseenter(e).mouseleave(t||e)};var ut,dt,pt=ge.now(),ft=/\?/,mt=/#.*$/,gt=/([?&])_=[^&]*/,vt=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,yt=/^(?:GET|HEAD)$/,bt=/^\/\//,xt=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,wt=ge.fn.load,_t={},Et={},Tt="*/".concat("*");try{dt=e.href}catch(e){(dt=m.createElement("a")).href="",dt=dt.href}function Mt(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var i,n=0,r=e.toLowerCase().match(T)||[];if(ge.isFunction(t))for(;i=r[n++];)"+"===i[0]?(i=i.slice(1)||"*",(o[i]=o[i]||[]).unshift(t)):(o[i]=o[i]||[]).push(t)}}function St(t,r,o,a){var s={},l=t===Et;function c(e){var n;return s[e]=!0,ge.each(t[e]||[],function(e,t){var i=t(r,o,a);return"string"!=typeof i||l||s[i]?l?!(n=i):void 0:(r.dataTypes.unshift(i),c(i),!1)}),n}return c(r.dataTypes[0])||!s["*"]&&c("*")}function Ct(e,t){var i,n,r=ge.ajaxSettings.flatOptions||{};for(n in t)t[n]!==E&&((r[n]?e:i||(i={}))[n]=t[n]);return i&&ge.extend(!0,e,i),e}ut=xt.exec(dt.toLowerCase())||[],ge.fn.load=function(e,t,i){if("string"!=typeof e&&wt)return wt.apply(this,arguments);var n,r,o,a=this,s=e.indexOf(" ");return 0<=s&&(n=e.slice(s,e.length),e=e.slice(0,s)),ge.isFunction(t)?(i=t,t=E):t&&"object"==typeof t&&(o="POST"),0<a.length&&ge.ajax({url:e,type:o,dataType:"html",data:t}).done(function(e){r=arguments,a.html(n?ge("<div>").append(ge.parseHTML(e)).find(n):e)}).complete(i&&function(e,t){a.each(i,r||[e.responseText,t,e])}),this},ge.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){ge.fn[t]=function(e){return this.on(t,e)}}),ge.each(["get","post"],function(e,r){ge[r]=function(e,t,i,n){return ge.isFunction(t)&&(n=n||i,i=t,t=E),ge.ajax({url:e,type:r,dataType:n,data:t,success:i})}}),ge.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:dt,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(ut[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Tt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":f.String,"text html":!0,"text json":ge.parseJSON,"text xml":ge.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Ct(Ct(e,ge.ajaxSettings),t):Ct(ge.ajaxSettings,e)},ajaxPrefilter:Mt(_t),ajaxTransport:Mt(Et),ajax:function(e,t){"object"==typeof e&&(t=e,e=E),t=t||{};var i,n,h,u,d,p,f,r,m=ge.ajaxSetup({},t),g=m.context||m,v=m.context&&(g.nodeType||g.jquery)?ge(g):ge.event,y=ge.Deferred(),b=ge.Callbacks("once memory"),x=m.statusCode||{},o={},a={},w=0,s="canceled",_={readyState:0,getResponseHeader:function(e){var t;if(2===w){if(!r)for(r={};t=vt.exec(u);)r[t[1].toLowerCase()]=t[2];t=r[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===w?u:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return w||(e=a[i]=a[i]||e,o[e]=t),this},overrideMimeType:function(e){return w||(m.mimeType=e),this},statusCode:function(e){var t;if(e)if(w<2)for(t in e)x[t]=[x[t],e[t]];else _.always(e[_.status]);return this},abort:function(e){var t=e||s;return f&&f.abort(t),l(0,t),this}};if(y.promise(_).complete=b.add,_.success=_.done,_.error=_.fail,m.url=((e||m.url||dt)+"").replace(mt,"").replace(bt,ut[1]+"//"),m.type=t.method||t.type||m.method||m.type,m.dataTypes=ge.trim(m.dataType||"*").toLowerCase().match(T)||[""],null==m.crossDomain&&(i=xt.exec(m.url.toLowerCase()),m.crossDomain=!(!i||i[1]===ut[1]&&i[2]===ut[2]&&(i[3]||("http:"===i[1]?80:443))==(ut[3]||("http:"===ut[1]?80:443)))),m.data&&m.processData&&"string"!=typeof m.data&&(m.data=ge.param(m.data,m.traditional)),St(_t,m,t,_),2===w)return _;for(n in(p=m.global)&&0==ge.active++&&ge.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!yt.test(m.type),h=m.url,m.hasContent||(m.data&&(h=m.url+=(ft.test(h)?"&":"?")+m.data,delete m.data),!1===m.cache&&(m.url=gt.test(h)?h.replace(gt,"$1_="+pt++):h+(ft.test(h)?"&":"?")+"_="+pt++)),m.ifModified&&(ge.lastModified[h]&&_.setRequestHeader("If-Modified-Since",ge.lastModified[h]),ge.etag[h]&&_.setRequestHeader("If-None-Match",ge.etag[h])),(m.data&&m.hasContent&&!1!==m.contentType||t.contentType)&&_.setRequestHeader("Content-Type",m.contentType),_.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+Tt+"; q=0.01":""):m.accepts["*"]),m.headers)_.setRequestHeader(n,m.headers[n]);if(m.beforeSend&&(!1===m.beforeSend.call(g,_,m)||2===w))return _.abort();for(n in s="abort",{success:1,error:1,complete:1})_[n](m[n]);if(f=St(Et,m,t,_)){_.readyState=1,p&&v.trigger("ajaxSend",[_,m]),m.async&&0<m.timeout&&(d=setTimeout(function(){_.abort("timeout")},m.timeout));try{w=1,f.send(o,l)}catch(e){if(!(w<2))throw e;l(-1,e)}}else l(-1,"No Transport");function l(e,t,i,n){var r,o,a,s,l,c=t;2!==w&&(w=2,d&&clearTimeout(d),f=E,u=n||"",_.readyState=0<e?4:0,i&&(s=function(e,t,i){var n,r,o,a,s=e.contents,l=e.dataTypes,c=e.responseFields;for(a in c)a in i&&(t[c[a]]=i[a]);for(;"*"===l[0];)l.shift(),r===E&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(a in s)if(s[a]&&s[a].test(r)){l.unshift(a);break}if(l[0]in i)o=l[0];else{for(a in i){if(!l[0]||e.converters[a+" "+l[0]]){o=a;break}n||(n=a)}o=o||n}if(o)return o!==l[0]&&l.unshift(o),i[o]}(m,_,i)),200<=e&&e<300||304===e?(m.ifModified&&((l=_.getResponseHeader("Last-Modified"))&&(ge.lastModified[h]=l),(l=_.getResponseHeader("etag"))&&(ge.etag[h]=l)),204===e?(r=!0,c="nocontent"):304===e?(r=!0,c="notmodified"):(c=(r=function(e,t){var i,n,r,o,a={},s=0,l=e.dataTypes.slice(),c=l[0];e.dataFilter&&(t=e.dataFilter(t,e.dataType));if(l[1])for(r in e.converters)a[r.toLowerCase()]=e.converters[r];for(;n=l[++s];)if("*"!==n){if("*"!==c&&c!==n){if(!(r=a[c+" "+n]||a["* "+n]))for(i in a)if((o=i.split(" "))[1]===n&&(r=a[c+" "+o[0]]||a["* "+o[0]])){!0===r?r=a[i]:!0!==a[i]&&(n=o[0],l.splice(s--,0,n));break}if(!0!==r)if(r&&e.throws)t=r(t);else try{t=r(t)}catch(e){return{state:"parsererror",error:r?e:"No conversion from "+c+" to "+n}}}c=n}return{state:"success",data:t}}(m,s)).state,o=r.data,r=!(a=r.error))):(a=c,!e&&c||(c="error",e<0&&(e=0))),_.status=e,_.statusText=(t||c)+"",r?y.resolveWith(g,[o,c,_]):y.rejectWith(g,[_,c,a]),_.statusCode(x),x=E,p&&v.trigger(r?"ajaxSuccess":"ajaxError",[_,m,r?o:a]),b.fireWith(g,[_,c]),p&&(v.trigger("ajaxComplete",[_,m]),--ge.active||ge.event.trigger("ajaxStop")))}return _},getScript:function(e,t){return ge.get(e,E,t,"script")},getJSON:function(e,t,i){return ge.get(e,t,i,"json")}}),ge.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return ge.globalEval(e),e}}}),ge.ajaxPrefilter("script",function(e){e.cache===E&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),ge.ajaxTransport("script",function(t){if(t.crossDomain){var n,r=m.head||ge("head")[0]||m.documentElement;return{send:function(e,i){(n=m.createElement("script")).async=!0,t.scriptCharset&&(n.charset=t.scriptCharset),n.src=t.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,"success"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(E,!0)}}}});var Rt=[],At=/(=)\?(?=&|$)|\?\?/;ge.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Rt.pop()||ge.expando+"_"+pt++;return this[e]=!0,e}}),ge.ajaxPrefilter("json jsonp",function(e,t,i){var n,r,o,a=!1!==e.jsonp&&(At.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&At.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return n=e.jsonpCallback=ge.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(At,"$1"+n):!1!==e.jsonp&&(e.url+=(ft.test(e.url)?"&":"?")+e.jsonp+"="+n),e.converters["script json"]=function(){return o||ge.error(n+" was not called"),o[0]},e.dataTypes[0]="json",r=f[n],f[n]=function(){o=arguments},i.always(function(){f[n]=r,e[n]&&(e.jsonpCallback=t.jsonpCallback,Rt.push(n)),o&&ge.isFunction(r)&&r(o[0]),o=r=E}),"script"});var Pt,Lt,Ot=0,It=f.ActiveXObject&&function(){var e;for(e in Pt)Pt[e](E,!0)};function Dt(){try{return new f.XMLHttpRequest}catch(e){}}ge.ajaxSettings.xhr=f.ActiveXObject?function(){return!this.isLocal&&Dt()||function(){try{return new f.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}()}:Dt,Lt=ge.ajaxSettings.xhr(),ge.support.cors=!!Lt&&"withCredentials"in Lt,(Lt=ge.support.ajax=!!Lt)&&ge.ajaxTransport(function(c){var h;if(!c.crossDomain||ge.support.cors)return{send:function(e,a){var s,t,l=c.xhr();if(c.username?l.open(c.type,c.url,c.async,c.username,c.password):l.open(c.type,c.url,c.async),c.xhrFields)for(t in c.xhrFields)l[t]=c.xhrFields[t];c.mimeType&&l.overrideMimeType&&l.overrideMimeType(c.mimeType),c.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");try{for(t in e)l.setRequestHeader(t,e[t])}catch(e){}l.send(c.hasContent&&c.data||null),h=function(e,t){var i,n,r,o;try{if(h&&(t||4===l.readyState))if(h=E,s&&(l.onreadystatechange=ge.noop,It&&delete Pt[s]),t)4!==l.readyState&&l.abort();else{o={},i=l.status,n=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(o.text=l.responseText);try{r=l.statusText}catch(e){r=""}i||!c.isLocal||c.crossDomain?1223===i&&(i=204):i=o.text?200:404}}catch(e){t||a(-1,e)}o&&a(i,r,o,n)},c.async?4===l.readyState?setTimeout(h):(s=++Ot,It&&(Pt||(Pt={},ge(f).unload(It)),Pt[s]=h),l.onreadystatechange=h):h()},abort:function(){h&&h(E,!0)}}});var kt,Nt,Ht=/^(?:toggle|show|hide)$/,Bt=new RegExp("^(?:([+-])=|)("+d+")([a-z%]*)$","i"),Ft=/queueHooks$/,Ut=[function(t,e,i){var n,r,o,a,s,l,c,h,u,d=this,p=t.style,f={},m=[],g=t.nodeType&&Je(t);i.queue||(null==(h=ge._queueHooks(t,"fx")).unqueued&&(h.unqueued=0,u=h.empty.fire,h.empty.fire=function(){h.unqueued||u()}),h.unqueued++,d.always(function(){d.always(function(){h.unqueued--,ge.queue(t,"fx").length||h.empty.fire()})}));1===t.nodeType&&("height"in e||"width"in e)&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===ge.css(t,"display")&&"none"===ge.css(t,"float")&&(ge.support.inlineBlockNeedsLayout&&"inline"!==nt(t.nodeName)?p.zoom=1:p.display="inline-block"));i.overflow&&(p.overflow="hidden",ge.support.shrinkWrapBlocks||d.always(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]}));for(r in e)if(a=e[r],Ht.exec(a)){if(delete e[r],l=l||"toggle"===a,a===(g?"hide":"show"))continue;m.push(r)}if(o=m.length){"hidden"in(s=ge._data(t,"fxshow")||ge._data(t,"fxshow",{}))&&(g=s.hidden),l&&(s.hidden=!g),g?ge(t).show():d.done(function(){ge(t).hide()}),d.done(function(){var e;for(e in ge._removeData(t,"fxshow"),f)ge.style(t,e,f[e])});for(r=0;r<o;r++)n=m[r],c=d.createTween(n,g?s[n]:0),f[n]=s[n]||ge.style(t,n),n in s||(s[n]=c.start,g&&(c.end=c.start,c.start="width"===n||"height"===n?1:0))}}],$t={"*":[function(e,t){var i,n,r=this.createTween(e,t),o=Bt.exec(t),a=r.cur(),s=+a||0,l=1,c=20;if(o){if(i=+o[2],"px"!==(n=o[3]||(ge.cssNumber[e]?"":"px"))&&s)for(s=ge.css(r.elem,e,!0)||i||1;s/=l=l||".5",ge.style(r.elem,e,s+n),l!==(l=r.cur()/a)&&1!==l&&--c;);r.unit=n,r.start=s,r.end=o[1]?s+(o[1]+1)*i:i}return r}]};function zt(){return setTimeout(function(){kt=E}),kt=ge.now()}function jt(o,e,t){var i,a,s,n,r=0,l=Ut.length,c=ge.Deferred().always(function(){delete h.elem}),h=function(){if(a)return!1;for(var e=kt||zt(),t=Math.max(0,u.startTime+u.duration-e),i=1-(t/u.duration||0),n=0,r=u.tweens.length;n<r;n++)u.tweens[n].run(i);return c.notifyWith(o,[u,i,t]),i<1&&r?t:(c.resolveWith(o,[u]),!1)},u=c.promise({elem:o,props:ge.extend({},e),opts:ge.extend(!0,{specialEasing:{}},t),originalProperties:e,originalOptions:t,startTime:kt||zt(),duration:t.duration,tweens:[],createTween:function(e,t){var i=ge.Tween(o,u.opts,e,t,u.opts.specialEasing[e]||u.opts.easing);return u.tweens.push(i),i},stop:function(e){var t=0,i=e?u.tweens.length:0;if(a)return this;for(a=!0;t<i;t++)u.tweens[t].run(1);return e?c.resolveWith(o,[u,e]):c.rejectWith(o,[u,e]),this}}),d=u.props;for(!function(e,t){var i,n,r,o,a;for(r in e)if(n=ge.camelCase(r),o=t[n],i=e[r],ge.isArray(i)&&(o=i[1],i=e[r]=i[0]),r!==n&&(e[n]=i,delete e[r]),(a=ge.cssHooks[n])&&"expand"in a)for(r in i=a.expand(i),delete e[n],i)r in e||(e[r]=i[r],t[r]=o);else t[n]=o}(d,u.opts.specialEasing);r<l;r++)if(i=Ut[r].call(u,o,d,u.opts))return i;return s=u,n=d,ge.each(n,function(e,t){for(var i=($t[e]||[]).concat($t["*"]),n=0,r=i.length;n<r;n++)if(i[n].call(s,e,t))return}),ge.isFunction(u.opts.start)&&u.opts.start.call(o,u),ge.fx.timer(ge.extend(h,{elem:o,anim:u,queue:u.opts.queue})),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always)}function Vt(e,t,i,n,r){return new Vt.prototype.init(e,t,i,n,r)}function Gt(e,t){var i,n={height:e},r=0;for(t=t?1:0;r<4;r+=2-t)n["margin"+(i=Ze[r])]=n["padding"+i]=e;return t&&(n.opacity=n.width=e),n}function Wt(e){return ge.isWindow(e)?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}ge.Animation=ge.extend(jt,{tweener:function(e,t){for(var i,n=0,r=(e=ge.isFunction(e)?(t=e,["*"]):e.split(" ")).length;n<r;n++)i=e[n],$t[i]=$t[i]||[],$t[i].unshift(t)},prefilter:function(e,t){t?Ut.unshift(e):Ut.push(e)}}),((ge.Tween=Vt).prototype={constructor:Vt,init:function(e,t,i,n,r,o){this.elem=e,this.prop=i,this.easing=r||"swing",this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=o||(ge.cssNumber[i]?"":"px")},cur:function(){var e=Vt.propHooks[this.prop];return e&&e.get?e.get(this):Vt.propHooks._default.get(this)},run:function(e){var t,i=Vt.propHooks[this.prop];return this.options.duration?this.pos=t=ge.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):Vt.propHooks._default.set(this),this}}).init.prototype=Vt.prototype,(Vt.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=ge.css(e.elem,e.prop,""))&&"auto"!==t?t:0:e.elem[e.prop]},set:function(e){ge.fx.step[e.prop]?ge.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[ge.cssProps[e.prop]]||ge.cssHooks[e.prop])?ge.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}}).scrollTop=Vt.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ge.each(["toggle","show","hide"],function(e,n){var r=ge.fn[n];ge.fn[n]=function(e,t,i){return null==e||"boolean"==typeof e?r.apply(this,arguments):this.animate(Gt(n,!0),e,t,i)}}),ge.fn.extend({fadeTo:function(e,t,i,n){return this.filter(Je).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(t,e,i,n){var r=ge.isEmptyObject(t),o=ge.speed(e,i,n),a=function(){var e=jt(this,ge.extend({},t),o);a.finish=function(){e.stop(!0)},(r||ge._data(this,"finish"))&&e.stop(!0)};return a.finish=a,r||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(r,e,o){var a=function(e){var t=e.stop;delete e.stop,t(o)};return"string"!=typeof r&&(o=e,e=r,r=E),e&&!1!==r&&this.queue(r||"fx",[]),this.each(function(){var e=!0,t=null!=r&&r+"queueHooks",i=ge.timers,n=ge._data(this);if(t)n[t]&&n[t].stop&&a(n[t]);else for(t in n)n[t]&&n[t].stop&&Ft.test(t)&&a(n[t]);for(t=i.length;t--;)i[t].elem!==this||null!=r&&i[t].queue!==r||(i[t].anim.stop(o),e=!1,i.splice(t,1));!e&&o||ge.dequeue(this,r)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var e,t=ge._data(this),i=t[a+"queue"],n=t[a+"queueHooks"],r=ge.timers,o=i?i.length:0;for(t.finish=!0,ge.queue(this,a,[]),n&&n.cur&&n.cur.finish&&n.cur.finish.call(this),e=r.length;e--;)r[e].elem===this&&r[e].queue===a&&(r[e].anim.stop(!0),r.splice(e,1));for(e=0;e<o;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete t.finish})}}),ge.each({slideDown:Gt("show"),slideUp:Gt("hide"),slideToggle:Gt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,n){ge.fn[e]=function(e,t,i){return this.animate(n,e,t,i)}}),ge.speed=function(e,t,i){var n=e&&"object"==typeof e?ge.extend({},e):{complete:i||!i&&t||ge.isFunction(e)&&e,duration:e,easing:i&&t||t&&!ge.isFunction(t)&&t};return n.duration=ge.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in ge.fx.speeds?ge.fx.speeds[n.duration]:ge.fx.speeds._default,null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){ge.isFunction(n.old)&&n.old.call(this),n.queue&&ge.dequeue(this,n.queue)},n},ge.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},ge.timers=[],ge.fx=Vt.prototype.init,ge.fx.tick=function(){var e,t=ge.timers,i=0;for(kt=ge.now();i<t.length;i++)(e=t[i])()||t[i]!==e||t.splice(i--,1);t.length||ge.fx.stop(),kt=E},ge.fx.timer=function(e){e()&&ge.timers.push(e)&&ge.fx.start()},ge.fx.interval=13,ge.fx.start=function(){Nt||(Nt=setInterval(ge.fx.tick,ge.fx.interval))},ge.fx.stop=function(){clearInterval(Nt),Nt=null},ge.fx.speeds={slow:600,fast:200,_default:400},ge.fx.step={},ge.expr&&ge.expr.filters&&(ge.expr.filters.animated=function(t){return ge.grep(ge.timers,function(e){return t===e.elem}).length}),ge.fn.offset=function(t){if(arguments.length)return t===E?this:this.each(function(e){ge.offset.setOffset(this,t,e)});var e,i,n={top:0,left:0},r=this[0],o=r&&r.ownerDocument;return o?(e=o.documentElement,ge.contains(e,r)?(typeof r.getBoundingClientRect!==v&&(n=r.getBoundingClientRect()),i=Wt(o),{top:n.top+(i.pageYOffset||e.scrollTop)-(e.clientTop||0),left:n.left+(i.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}):n):void 0},ge.offset={setOffset:function(e,t,i){var n=ge.css(e,"position");"static"===n&&(e.style.position="relative");var r,o,a=ge(e),s=a.offset(),l=ge.css(e,"top"),c=ge.css(e,"left"),h={},u={};o=("absolute"===n||"fixed"===n)&&-1<ge.inArray("auto",[l,c])?(r=(u=a.position()).top,u.left):(r=parseFloat(l)||0,parseFloat(c)||0),ge.isFunction(t)&&(t=t.call(e,i,s)),null!=t.top&&(h.top=t.top-s.top+r),null!=t.left&&(h.left=t.left-s.left+o),"using"in t?t.using.call(e,h):a.css(h)}},ge.fn.extend({position:function(){if(this[0]){var e,t,i={top:0,left:0},n=this[0];return"fixed"===ge.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),ge.nodeName(e[0],"html")||(i=e.offset()),i.top+=ge.css(e[0],"borderTopWidth",!0),i.left+=ge.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-ge.css(n,"marginTop",!0),left:t.left-i.left-ge.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||m.documentElement;e&&!ge.nodeName(e,"html")&&"static"===ge.css(e,"position");)e=e.offsetParent;return e||m.documentElement})}}),ge.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,r){var o=/Y/.test(r);ge.fn[t]=function(e){return ge.access(this,function(e,t,i){var n=Wt(e);if(i===E)return n?r in n?n[r]:n.document.documentElement[t]:e[t];n?n.scrollTo(o?ge(n).scrollLeft():i,o?i:ge(n).scrollTop()):e[t]=i},t,e,arguments.length,null)}}),ge.each({Height:"height",Width:"width"},function(o,a){ge.each({padding:"inner"+o,content:a,"":"outer"+o},function(n,e){ge.fn[e]=function(e,t){var i=arguments.length&&(n||"boolean"!=typeof e),r=n||(!0===e||!0===t?"margin":"border");return ge.access(this,function(e,t,i){var n;return ge.isWindow(e)?e.document.documentElement["client"+o]:9===e.nodeType?(n=e.documentElement,Math.max(e.body["scroll"+o],n["scroll"+o],e.body["offset"+o],n["offset"+o],n["client"+o])):i===E?ge.css(e,t,r):ge.style(e,t,i,r)},a,i?e:E,i,null)}})}),f.jQuery=f.$=ge,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return ge})}(window),function(t,i,n){"function"==typeof define&&define.amd?define(["jquery"],function(e){return n(e,t,i),e.mobile}):n(t.jQuery,t,i)}(this,document,function(e,L,O){var o,i,n,l,r,c,h,u,a,s,d,p,f,m,t,g,v,y,b,T,x,w,_,E,M,S,C,R,A,P,I,D,k,N,H,B,F,U,$,z,j,V,G,W,q,X,Z,Y,K,J,Q,ee,te,ie,ne,re,oe,ae,se,le,ce,he,ue,de,pe,fe,me,ge,ve,ye,be,xe,we,_e,Ee,Te,Me,Se,Ce,Re,Ae,Pe,Le,Oe,Ie,De,ke,Ne,He,Be,Fe,Ue,$e,ze,je,Ve,Ge,We,qe,Xe,Ze,Ye,Ke,Je,Qe,et,tt,it,nt,rt,ot,at,st,lt,ct;e.mobile={},(ct=e).extend(ct.mobile,{version:"1.4.0",subPageUrlKey:"ui-page",hideUrlBar:!0,keepNative:":jqmData(role='none'), :jqmData(role='nojs')",activePageClass:"ui-page-active",activeBtnClass:"ui-btn-active",focusClass:"ui-focus",ajaxEnabled:!0,hashListeningEnabled:!0,linkBindingEnabled:!0,defaultPageTransition:"fade",maxTransitionWidth:!1,minScrollBack:0,defaultDialogTransition:"pop",pageLoadErrorMessage:"Error Loading Page",pageLoadErrorMessageTheme:"a",phonegapNavigationEnabled:!1,autoInitializePage:!0,pushStateEnabled:!0,ignoreContentEnabled:!1,buttonMarkup:{hoverDelay:200},dynamicBaseEnabled:!0,pageContainer:ct(),allowCrossDomainPages:!1,dialogHashKey:"&ui-state=dialog"}),ot={},at=(rt=e).find,st=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,lt=/:jqmData\(([^)]*)\)/g,rt.extend(rt.mobile,{ns:"",getAttribute:function(e,t){var i;(e=e.jquery?e[0]:e)&&e.getAttribute&&(i=e.getAttribute("data-"+rt.mobile.ns+t));try{i="true"===i||"false"!==i&&("null"===i?null:+i+""===i?+i:st.test(i)?JSON.parse(i):i)}catch(e){}return i},nsNormalizeDict:ot,nsNormalize:function(e){return ot[e]||(ot[e]=rt.camelCase(rt.mobile.ns+e))},closestPageData:function(e){return e.closest(":jqmData(role='page'), :jqmData(role='dialog')").data("mobile-page")}}),rt.fn.jqmData=function(e,t){var i;return void 0!==e&&(e&&(e=rt.mobile.nsNormalize(e)),i=arguments.length<2||void 0===t?this.data(e):this.data(e,t)),i},rt.jqmData=function(e,t,i){var n;return void 0!==t&&(n=rt.data(e,t?rt.mobile.nsNormalize(t):t,i)),n},rt.fn.jqmRemoveData=function(e){return this.removeData(rt.mobile.nsNormalize(e))},rt.jqmRemoveData=function(e,t){return rt.removeData(e,rt.mobile.nsNormalize(t))},rt.find=function(e,t,i,n){return-1<e.indexOf(":jqmData")&&(e=e.replace(lt,"[data-"+(rt.mobile.ns||"")+"$1]")),at.call(this,e,t,i,n)},rt.extend(rt.find,at),function(s,e){function n(e,t){var i,n,r,o=e.nodeName.toLowerCase();return"area"===o?(n=(i=e.parentNode).name,!(!e.href||!n||"map"!==i.nodeName.toLowerCase())&&(!!(r=s("img[usemap=#"+n+"]")[0])&&a(r))):(/input|select|textarea|button|object/.test(o)?!e.disabled:"a"===o&&e.href||t)&&a(e)}function a(e){return s.expr.filters.visible(e)&&!s(e).parents().addBack().filter(function(){return"hidden"===s.css(this,"visibility")}).length}var t,r,i=0,o=/^ui-id-\d+$/;s.ui=s.ui||{},s.extend(s.ui,{version:"c0ab71056b936627e8a7821f03c044aec6280a40",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),s.fn.extend({focus:(r=s.fn.focus,function(t,i){return"number"==typeof t?this.each(function(){var e=this;setTimeout(function(){s(e).focus(),i&&i.call(e)},t)}):r.apply(this,arguments)}),scrollParent:function(){var e;return e=s.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(s.css(this,"position"))&&/(auto|scroll)/.test(s.css(this,"overflow")+s.css(this,"overflow-y")+s.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(s.css(this,"overflow")+s.css(this,"overflow-y")+s.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!e.length?s(this[0].ownerDocument||O):e},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++i)})},removeUniqueId:function(){return this.each(function(){o.test(this.id)&&s(this).removeAttr("id")})}}),s.extend(s.expr[":"],{data:s.expr.createPseudo?s.expr.createPseudo(function(t){return function(e){return!!s.data(e,t)}}):function(e,t,i){return!!s.data(e,i[3])},focusable:function(e){return n(e,!isNaN(s.attr(e,"tabindex")))},tabbable:function(e){var t=s.attr(e,"tabindex"),i=isNaN(t);return(i||0<=t)&&n(e,!i)}}),s("<a>").outerWidth(1).jquery||s.each(["Width","Height"],function(e,i){function n(e,t,i,n){return s.each(r,function(){t-=parseFloat(s.css(e,"padding"+this))||0,i&&(t-=parseFloat(s.css(e,"border"+this+"Width"))||0),n&&(t-=parseFloat(s.css(e,"margin"+this))||0)}),t}var r="Width"===i?["Left","Right"]:["Top","Bottom"],o=i.toLowerCase(),a={innerWidth:s.fn.innerWidth,innerHeight:s.fn.innerHeight,outerWidth:s.fn.outerWidth,outerHeight:s.fn.outerHeight};s.fn["inner"+i]=function(e){return void 0===e?a["inner"+i].call(this):this.each(function(){s(this).css(o,n(this,e)+"px")})},s.fn["outer"+i]=function(e,t){return"number"!=typeof e?a["outer"+i].call(this,e):this.each(function(){s(this).css(o,n(this,e,!0,t)+"px")})}}),s.fn.addBack||(s.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),s("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(s.fn.removeData=(t=s.fn.removeData,function(e){return arguments.length?t.call(this,s.camelCase(e)):t.call(this)})),s.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),s.support.selectstart="onselectstart"in O.createElement("div"),s.fn.extend({disableSelection:function(){return this.bind((s.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(e){if(void 0!==e)return this.css("zIndex",e);if(this.length)for(var t,i,n=s(this[0]);n.length&&n[0]!==O;){if(("absolute"===(t=n.css("position"))||"relative"===t||"fixed"===t)&&(i=parseInt(n.css("zIndex"),10),!isNaN(i)&&0!==i))return i;n=n.parent()}return 0}}),s.ui.plugin={add:function(e,t,i){var n,r=s.ui[e].prototype;for(n in i)r.plugins[n]=r.plugins[n]||[],r.plugins[n].push([t,i[n]])},call:function(e,t,i,n){var r,o=e.plugins[t];if(o&&(n||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(r=0;r<o.length;r++)e.options[o[r][0]]&&o[r][1].apply(e.element,i)}}}(e),nt=this,(it=e).extend(it.mobile,{window:it(nt),document:it(O),keyCode:it.ui.keyCode,behaviors:{},silentScroll:function(e){"number"!==it.type(e)&&(e=it.mobile.defaultHomeScroll),it.event.special.scrollstart.enabled=!1,setTimeout(function(){nt.scrollTo(0,e),it.mobile.document.trigger("silentscroll",{x:0,y:e})},20),setTimeout(function(){it.event.special.scrollstart.enabled=!0},150)},getClosestBaseUrl:function(e){var t=it(e).closest(".ui-page").jqmData("url"),i=it.mobile.path.documentBase.hrefNoHash;return it.mobile.dynamicBaseEnabled&&t&&it.mobile.path.isPath(t)||(t=i),it.mobile.path.makeUrlAbsolute(t,i)},removeActiveLinkClass:function(e){!it.mobile.activeClickedLink||it.mobile.activeClickedLink.closest("."+it.mobile.activePageClass).length&&!e||it.mobile.activeClickedLink.removeClass(it.mobile.activeBtnClass),it.mobile.activeClickedLink=null},getInheritedTheme:function(e,t){for(var i,n,r=e[0],o="",a=/ui-(bar|body|overlay)-([a-z])\b/;r&&!((i=r.className||"")&&(n=a.exec(i))&&(o=n[2]));)r=r.parentNode;return o||t||"a"},enhanceable:function(e){return this.haveParents(e,"enhance")},hijackable:function(e){return this.haveParents(e,"ajax")},haveParents:function(e,t){if(!it.mobile.ignoreContentEnabled)return e;var i,n,r,o,a=e.length,s=it();for(o=0;o<a;o++){for(n=e.eq(o),r=!1,i=e[o];i;){if("false"===(i.getAttribute?i.getAttribute("data-"+it.mobile.ns+t):"")){r=!0;break}i=i.parentNode}r||(s=s.add(n))}return s},getScreenHeight:function(){return nt.innerHeight||it.mobile.window.height()},resetActivePageHeight:function(e){var t=it("."+it.mobile.activePageClass),i=t.height(),n=t.outerHeight(!0);e="number"==typeof e?e:it.mobile.getScreenHeight(),t.css("min-height",e-(n-i))},loading:function(){var e=this.loading._widget||it(it.mobile.loader.prototype.defaultHtml).loader(),t=e.loader.apply(e,arguments);return this.loading._widget=e,t}}),it.addDependents=function(e,t){var i=it(e),n=i.jqmData("dependents")||it();i.jqmData("dependents",it(n).add(t))},it.fn.extend({removeWithDependents:function(){it.removeWithDependents(this)},enhanceWithin:function(){var e,n={},r=it.mobile.page.prototype.keepNativeSelector(),o=this;for(e in it.mobile.nojs&&it.mobile.nojs(this),it.mobile.links&&it.mobile.links(this),it.mobile.degradeInputsWithin&&it.mobile.degradeInputsWithin(this),it.fn.buttonMarkup&&this.find(it.fn.buttonMarkup.initSelector).not(r).jqmEnhanceable().buttonMarkup(),it.fn.fieldcontain&&this.find(":jqmData(role='fieldcontain')").not(r).jqmEnhanceable().fieldcontain(),it.each(it.mobile.widgets,function(e,t){if(t.initSelector){var i=it.mobile.enhanceable(o.find(t.initSelector));0<i.length&&(i=i.not(r)),0<i.length&&(n[t.prototype.widgetName]=i)}}),n)n[e][e]();return this},addDependents:function(e){it.addDependents(this,e)},getEncodedText:function(){return it("<a>").text(this.text()).html()},jqmEnhanceable:function(){return it.mobile.enhanceable(this)},jqmHijackable:function(){return it.mobile.hijackable(this)}}),it.removeWithDependents=function(e){var t=it(e);(t.jqmData("dependents")||it()).remove(),t.remove()},it.addDependents=function(e,t){var i=it(e),n=i.jqmData("dependents")||it();i.jqmData("dependents",it(n).add(t))},it.find.matches=function(e,t){return it.find(e,null,null,t)},it.find.matchesSelector=function(e,t){return 0<it.find(t,null,null,[e]).length},Ke=e,Qe=0,et=Array.prototype.slice,tt=Ke.cleanData,Ke.cleanData=function(e){for(var t,i=0;null!=(t=e[i]);i++)try{Ke(t).triggerHandler("remove")}catch(e){}tt(e)},Ke.widget=function(e,i,t){var n,r,o,a,s={},l=e.split(".")[0];return e=e.split(".")[1],n=l+"-"+e,t||(t=i,i=Ke.Widget),Ke.expr[":"][n.toLowerCase()]=function(e){return!!Ke.data(e,n)},Ke[l]=Ke[l]||{},r=Ke[l][e],o=Ke[l][e]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new o(e,t)},Ke.extend(o,r,{version:t.version,_proto:Ke.extend({},t),_childConstructors:[]}),(a=new i).options=Ke.widget.extend({},a.options),Ke.each(t,function(t,n){return Ke.isFunction(n)?void(s[t]=(r=function(){return i.prototype[t].apply(this,arguments)},o=function(e){return i.prototype[t].apply(this,e)},function(){var e,t=this._super,i=this._superApply;return this._super=r,this._superApply=o,e=n.apply(this,arguments),this._super=t,this._superApply=i,e})):void(s[t]=n);var r,o}),o.prototype=Ke.widget.extend(a,{widgetEventPrefix:r&&a.widgetEventPrefix||e},s,{constructor:o,namespace:l,widgetName:e,widgetFullName:n}),r?(Ke.each(r._childConstructors,function(e,t){var i=t.prototype;Ke.widget(i.namespace+"."+i.widgetName,o,t._proto)}),delete r._childConstructors):i._childConstructors.push(o),Ke.widget.bridge(e,o),o},Ke.widget.extend=function(e){for(var t,i,n=et.call(arguments,1),r=0,o=n.length;r<o;r++)for(t in n[r])i=n[r][t],n[r].hasOwnProperty(t)&&i!==Je&&(e[t]=Ke.isPlainObject(i)?Ke.isPlainObject(e[t])?Ke.widget.extend({},e[t],i):Ke.widget.extend({},i):i);return e},Ke.widget.bridge=function(o,t){var a=t.prototype.widgetFullName||o;Ke.fn[o]=function(i){var e="string"==typeof i,n=et.call(arguments,1),r=this;return i=!e&&n.length?Ke.widget.extend.apply(null,[i].concat(n)):i,e?this.each(function(){var e,t=Ke.data(this,a);return"instance"===i?(r=t,!1):t?Ke.isFunction(t[i])&&"_"!==i.charAt(0)?(e=t[i].apply(t,n))!==t&&e!==Je?(r=e&&e.jquery?r.pushStack(e.get()):e,!1):void 0:Ke.error("no such method '"+i+"' for "+o+" widget instance"):Ke.error("cannot call methods on "+o+" prior to initialization; attempted to call method '"+i+"'")}):this.each(function(){var e=Ke.data(this,a);e?e.option(i||{})._init():Ke.data(this,a,new t(i,this))}),r}},Ke.Widget=function(){},Ke.Widget._childConstructors=[],Ke.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,t){t=Ke(t||this.defaultElement||this)[0],this.element=Ke(t),this.uuid=Qe++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=Ke.widget.extend({},this.options,this._getCreateOptions(),e),this.bindings=Ke(),this.hoverable=Ke(),this.focusable=Ke(),t!==this&&(Ke.data(t,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===t&&this.destroy()}}),this.document=Ke(t.style?t.ownerDocument:t.document||t),this.window=Ke(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:Ke.noop,_getCreateEventData:Ke.noop,_create:Ke.noop,_init:Ke.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(Ke.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:Ke.noop,widget:function(){return this.element},option:function(e,t){var i,n,r,o=e;if(0===arguments.length)return Ke.widget.extend({},this.options);if("string"==typeof e)if(o={},e=(i=e.split(".")).shift(),i.length){for(n=o[e]=Ke.widget.extend({},this.options[e]),r=0;r<i.length-1;r++)n[i[r]]=n[i[r]]||{},n=n[i[r]];if(e=i.pop(),t===Je)return n[e]===Je?null:n[e];n[e]=t}else{if(t===Je)return this.options[e]===Je?null:this.options[e];o[e]=t}return this._setOptions(o),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(a,s,e){var l,c=this;"boolean"!=typeof a&&(e=s,s=a,a=!1),e?(s=l=Ke(s),this.bindings=this.bindings.add(s)):(e=s,s=this.element,l=this.widget()),Ke.each(e,function(e,t){function i(){return a||!0!==c.options.disabled&&!Ke(this).hasClass("ui-state-disabled")?("string"==typeof t?c[t]:t).apply(c,arguments):void 0}"string"!=typeof t&&(i.guid=t.guid=t.guid||i.guid||Ke.guid++);var n=e.match(/^(\w+)\s*(.*)$/),r=n[1]+c.eventNamespace,o=n[2];o?l.delegate(o,r,i):s.bind(r,i)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){var i=this;return setTimeout(function(){return("string"==typeof e?i[e]:e).apply(i,arguments)},t||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){Ke(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){Ke(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){Ke(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){Ke(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,t,i){var n,r,o=this.options[e];if(i=i||{},(t=Ke.Event(t)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),t.target=this.element[0],r=t.originalEvent)for(n in r)n in t||(t[n]=r[n]);return this.element.trigger(t,i),!(Ke.isFunction(o)&&!1===o.apply(this.element[0],[t].concat(i))||t.isDefaultPrevented())}},Ke.each({show:"fadeIn",hide:"fadeOut"},function(o,a){Ke.Widget.prototype["_"+o]=function(t,e,i){"string"==typeof e&&(e={effect:e});var n,r=e?!0===e||"number"==typeof e?a:e.effect||a:o;"number"==typeof(e=e||{})&&(e={duration:e}),n=!Ke.isEmptyObject(e),e.complete=i,e.delay&&t.delay(e.delay),n&&Ke.effects&&Ke.effects.effect[r]?t[o](e):r!==o&&t[r]?t[r](e.duration,e.easing,i):t.queue(function(e){Ke(this)[o](),i&&i.call(t[0]),e()})}}),Ze=/[A-Z]/g,Ye=function(e){return"-"+e.toLowerCase()},(Xe=e).extend(Xe.Widget.prototype,{_getCreateOptions:function(){var e,t,i=this.element[0],n={};if(!Xe.mobile.getAttribute(i,"defaults"))for(e in this.options)null!=(t=Xe.mobile.getAttribute(i,e.replace(Ze,Ye)))&&(n[e]=t);return n}}),Xe.mobile.widget=Xe.Widget,qe=(We=e)("html"),We.widget("mobile.loader",{options:{theme:"a",textVisible:!1,html:"",text:"loading"},defaultHtml:"<div class='ui-loader'><span class='ui-icon-loading'></span><h1></h1></div>",fakeFixLoader:function(){var e=We("."+We.mobile.activeBtnClass).first();this.element.css({top:We.support.scrollTop&&this.window.scrollTop()+this.window.height()/2||e.length&&e.offset().top||100})},checkLoaderPosition:function(){var e=this.element.offset(),t=this.window.scrollTop(),i=We.mobile.getScreenHeight();(e.top<t||e.top-t>i)&&(this.element.addClass("ui-loader-fakefix"),this.fakeFixLoader(),this.window.unbind("scroll",this.checkLoaderPosition).bind("scroll",We.proxy(this.fakeFixLoader,this)))},resetHtml:function(){this.element.html(We(this.defaultHtml).html())},show:function(e,t,i){var n,r,o;this.resetHtml(),e="object"===We.type(e)?(o=We.extend({},this.options,e)).theme:(o=this.options,e||o.theme),r=t||(!1===o.text?"":o.text),qe.addClass("ui-loading"),n=o.textVisible,this.element.attr("class","ui-loader ui-corner-all ui-body-"+e+" ui-loader-"+(n||t||e.text?"verbose":"default")+(o.textonly||i?" ui-loader-textonly":"")),o.html?this.element.html(o.html):this.element.find("h1").text(r),this.element.appendTo(We.mobile.pageContainer),this.checkLoaderPosition(),this.window.bind("scroll",We.proxy(this.checkLoaderPosition,this))},hide:function(){qe.removeClass("ui-loading"),this.options.text&&this.element.removeClass("ui-loader-fakefix"),We.mobile.window.unbind("scroll",this.fakeFixLoader),We.mobile.window.unbind("scroll",this.checkLoaderPosition)}}),function(c,h,e){function u(e){return"#"+(e=e||location.href).replace(/^[^#]*#?(.*)$/,"$1")}var t,d="hashchange",p=O,i=c.event.special,n=p.documentMode,f="on"+d in h&&(void 0===n||7<n);c.fn[d]=function(e){return e?this.bind(d,e):this.trigger(d)},c.fn[d].delay=50,i[d]=c.extend(i[d],{setup:function(){return!f&&void c(t.start)},teardown:function(){return!f&&void c(t.stop)}}),t=function(){function i(){var e=u(),t=l(o);e!==o?(s(o=e,t),c(h).trigger(d)):t!==o&&(location.href=location.href.replace(/#.*/,"")+t),n=setTimeout(i,c.fn[d].delay)}var n,r,e,t={},o=u(),a=function(e){return e},s=a,l=a;return t.start=function(){n||i()},t.stop=function(){n&&clearTimeout(n),n=void 0},h.attachEvent&&!h.addEventListener&&!f&&(t.start=function(){r||(e=(e=c.fn[d].src)&&e+u(),r=c('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){e||s(u()),i()}).attr("src",e||"javascript:0").insertAfter("body")[0].contentWindow,p.onpropertychange=function(){try{"title"===event.propertyName&&(r.document.title=p.title)}catch(e){}})},t.stop=a,l=function(){return u(r.location.href)},s=function(e,t){var i=r.document,n=c.fn[d].domain;e!==t&&(i.title=p.title,i.open(),n&&i.write('<script>document.domain="'+n+'"<\/script>'),i.close(),r.location.hash=e)}),t}()}(e,this),Fe=e,L.matchMedia=L.matchMedia||(ze=(Ue=O).documentElement,je=ze.firstElementChild||ze.firstChild,Ve=Ue.createElement("body"),(Ge=Ue.createElement("div")).id="mq-test-1",Ge.style.cssText="position:absolute;top:-100em",Ve.style.background="none",Ve.appendChild(Ge),function(e){return Ge.innerHTML='&shy;<style media="'+e+'"> #mq-test-1 { width: 42px; }</style>',ze.insertBefore(Ve,je),$e=42===Ge.offsetWidth,ze.removeChild(Ve),{matches:$e,media:e}}),Fe.mobile.media=function(e){return L.matchMedia(e).matches},Be={touch:"ontouchend"in O},(He=e).mobile.support=He.mobile.support||{},He.extend(He.support,Be),He.extend(He.mobile.support,Be),(Ne=e).extend(Ne.support,{orientation:"orientation"in L&&"onorientationchange"in L}),function(o,e){function t(e){var t,i=e.charAt(0).toUpperCase()+e.substr(1),n=(e+" "+M.join(i+" ")+i).split(" ");for(t in n)if(void 0!==T[n[t]])return!0}var i,n,r,a,s,l,c,h,u,d,p,f,m,g,v,y,b,x,w,_,E=o("<body>").prependTo("html"),T=E[0].style,M=["Webkit","Moz","O"],S="palmGetResource"in L,C=L.opera,R=L.operamini&&"[object OperaMini]"==={}.toString.call(L.operamini),A=L.blackberry&&!t("-webkit-transform");o.extend(o.mobile,{browser:{}}),o.mobile.browser.oldIE=function(){for(var e=3,t=O.createElement("div"),i=t.all||[];t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><br><![endif]--\x3e",i[0];);return 4<e?e:!e}(),o.extend(o.support,{cssTransitions:"WebKitTransitionEvent"in L||function(e,t,i){var n,r,o,a,s,l,c,h=O.createElement("div"),u=function(e){return e.charAt(0).toUpperCase()+e.substr(1)},d=i||M;for(n=0;n<d.length;n++)o=d[n],a=void 0,s=(""===(a=o)?"":"-"+a.charAt(0).toLowerCase()+a.substr(1)+"-")+e+": "+t+";",l=u(o),c=l+(""===l?e:u(e)),h.setAttribute("style",s),h.style[c]&&(r=!0);return!!r}("transition","height 100ms linear",["Webkit","Moz",""])&&!o.mobile.browser.oldIE&&!C,pushState:"pushState"in history&&"replaceState"in history&&!(0<=L.navigator.userAgent.indexOf("Firefox")&&L.top!==L)&&-1===L.navigator.userAgent.search(/CriOS/),mediaquery:o.mobile.media("only all"),cssPseudoElement:!!t("content"),touchOverflow:!!t("overflowScrolling"),cssTransform3d:function(){var e,t,i,n="transform-3d",r=o.mobile.media("(-"+M.join("-"+n+"),(-")+"-"+n+"),("+n+")");if(r)return!!r;for(i in e=O.createElement("div"),t={MozTransform:"-moz-transform",transform:"transform"},E.append(e),t)void 0!==e.style[i]&&(e.style[i]="translate3d( 100px, 1px, 1px )",r=L.getComputedStyle(e).getPropertyValue(t[i]));return!!r&&"none"!==r}(),cssAnimations:!!t("animationName"),boxShadow:!!t("boxShadow")&&!A,fixedPosition:(f=L,m=navigator.userAgent,g=navigator.platform,v=m.match(/AppleWebKit\/([0-9]+)/),y=!!v&&v[1],b=m.match(/Fennec\/([0-9]+)/),x=!!b&&b[1],w=m.match(/Opera Mobi\/([0-9]+)/),_=!!w&&w[1],!((-1<g.indexOf("iPhone")||-1<g.indexOf("iPad")||-1<g.indexOf("iPod"))&&y&&y<534||f.operamini&&"[object OperaMini]"==={}.toString.call(f.operamini)||w&&_<7458||-1<m.indexOf("Android")&&y&&y<533||x&&x<6||"palmGetResource"in L&&y&&y<534||-1<m.indexOf("MeeGo")&&-1<m.indexOf("NokiaBrowser/8.5.0"))),scrollTop:("pageXOffset"in L||"scrollTop"in O.documentElement||"scrollTop"in E[0])&&!S&&!R,dynamicBaseTag:(h=location.protocol+"//"+location.host+location.pathname+"ui-dir/",u=o("head base"),d=null,p="",u.length?p=u.attr("href"):u=d=o("<base>",{href:h}).appendTo("head"),c=o("<a href='testurl' />").prependTo(E)[0].href,u[0].href=p||location.pathname,d&&d.remove(),0===c.indexOf(h)),cssPointerEvents:(a=O.createElement("x"),s=O.documentElement,l=L.getComputedStyle,"pointerEvents"in a.style&&(a.style.pointerEvents="auto",a.style.pointerEvents="x",s.appendChild(a),r=l&&"auto"===l(a,"").pointerEvents,s.removeChild(a),!!r)),boundingRect:void 0!==O.createElement("div").getBoundingClientRect,inlineSVG:function(){var e=L,t=!(!e.document.createElementNS||!e.document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect||e.opera&&-1===navigator.userAgent.indexOf("Chrome")),i=function(e){e&&t||o("html").addClass("ui-nosvg")},n=new e.Image;n.onerror=function(){i(!1)},n.onload=function(){i(1===n.width&&1===n.height)},n.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="}}),E.remove(),i=-1<(n=L.navigator.userAgent).indexOf("Nokia")&&(-1<n.indexOf("Symbian/3")||-1<n.indexOf("Series60/5"))&&-1<n.indexOf("AppleWebKit")&&n.match(/(BrowserNG|NokiaBrowser)\/7\.[0-3]/),o.mobile.gradeA=function(){return(o.support.mediaquery&&o.support.cssPseudoElement||o.mobile.browser.oldIE&&8<=o.mobile.browser.oldIE)&&(o.support.boundingRect||null!==o.fn.jquery.match(/1\.[0-7+]\.[0-9+]?/))},o.mobile.ajaxBlacklist=L.blackberry&&!L.WebKitPoint||R||i,i&&o(function(){o("head link[rel='stylesheet']").attr("rel","alternate stylesheet").attr("rel","stylesheet")}),o.support.boxShadow||o("html").addClass("ui-noboxshadow")}(e),De=(Oe=e).mobile.window,ke=function(){},Oe.event.special.beforenavigate={setup:function(){De.on("navigate",ke)},teardown:function(){De.off("navigate",ke)}},Oe.event.special.navigate=Ie={bound:!1,pushStateEnabled:!0,originalEventName:void 0,isPushStateEnabled:function(){return Oe.support.pushState&&!0===Oe.mobile.pushStateEnabled&&this.isHashChangeEnabled()},isHashChangeEnabled:function(){return!0===Oe.mobile.hashListeningEnabled},popstate:function(e){var t=new Oe.Event("navigate"),i=new Oe.Event("beforenavigate"),n=e.originalEvent.state||{};i.originalEvent=e,De.trigger(i),i.isDefaultPrevented()||(e.historyState&&Oe.extend(n,e.historyState),t.originalEvent=e,setTimeout(function(){De.trigger(t,{state:n})},0))},hashchange:function(e){var t=new Oe.Event("navigate"),i=new Oe.Event("beforenavigate");i.originalEvent=e,De.trigger(i),i.isDefaultPrevented()||(t.originalEvent=e,De.trigger(t,{state:e.hashchangeState||{}}))},setup:function(){Ie.bound||(Ie.bound=!0,Ie.isPushStateEnabled()?(Ie.originalEventName="popstate",De.bind("popstate.navigate",Ie.popstate)):Ie.isHashChangeEnabled()&&(Ie.originalEventName="hashchange",De.bind("hashchange.navigate",Ie.hashchange)))}},Le="&ui-state=dialog",(Re=e).mobile.path=Ae={uiStateKey:"&ui-state",urlParseRE:/^\s*(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,getLocation:function(e){var t=e?this.parseUrl(e):location,i=this.parseUrl(e||location.href).hash;return i="#"===i?"":i,t.protocol+"//"+t.host+t.pathname+t.search+i},getDocumentUrl:function(e){return e?Re.extend({},Ae.documentUrl):Ae.documentUrl.href},parseLocation:function(){return this.parseUrl(this.getLocation())},parseUrl:function(e){if("object"===Re.type(e))return e;var t=Ae.urlParseRE.exec(e||"")||[];return{href:t[0]||"",hrefNoHash:t[1]||"",hrefNoSearch:t[2]||"",domain:t[3]||"",protocol:t[4]||"",doubleSlash:t[5]||"",authority:t[6]||"",username:t[8]||"",password:t[9]||"",host:t[10]||"",hostname:t[11]||"",port:t[12]||"",pathname:t[13]||"",directory:t[14]||"",filename:t[15]||"",search:t[16]||"",hash:t[17]||""}},makePathAbsolute:function(e,t){var i,n,r,o;if(e&&"/"===e.charAt(0))return e;for(e=e||"",i=(t=t?t.replace(/^\/|(\/[^\/]*|[^\/]+)$/g,""):"")?t.split("/"):[],n=e.split("/"),r=0;r<n.length;r++)switch(o=n[r]){case".":break;case"..":i.length&&i.pop();break;default:i.push(o)}return"/"+i.join("/")},isSameDomain:function(e,t){return Ae.parseUrl(e).domain===Ae.parseUrl(t).domain},isRelativeUrl:function(e){return""===Ae.parseUrl(e).protocol},isAbsoluteUrl:function(e){return""!==Ae.parseUrl(e).protocol},makeUrlAbsolute:function(e,t){if(!Ae.isRelativeUrl(e))return e;void 0===t&&(t=this.documentBase);var i=Ae.parseUrl(e),n=Ae.parseUrl(t),r=i.protocol||n.protocol,o=i.protocol?i.doubleSlash:i.doubleSlash||n.doubleSlash,a=i.authority||n.authority,s=""!==i.pathname;return r+o+a+Ae.makePathAbsolute(i.pathname||n.filename,n.pathname)+(i.search||!s&&n.search||"")+i.hash},addSearchParams:function(e,t){var i=Ae.parseUrl(e),n="object"==typeof t?Re.param(t):t,r=i.search||"?";return i.hrefNoSearch+r+("?"!==r.charAt(r.length-1)?"&":"")+n+(i.hash||"")},convertUrlToDataUrl:function(e){var t=Ae.parseUrl(e);return Ae.isEmbeddedPage(t)?t.hash.split(Le)[0].replace(/^#/,"").replace(/\?.*$/,""):Ae.isSameDomain(t,this.documentBase)?t.hrefNoHash.replace(this.documentBase.domain,"").split(Le)[0]:L.decodeURIComponent(e)},get:function(e){return void 0===e&&(e=Ae.parseLocation().hash),Ae.stripHash(e).replace(/[^\/]*\.[^\/*]+$/,"")},set:function(e){location.hash=e},isPath:function(e){return/\//.test(e)},clean:function(e){return e.replace(this.documentBase.domain,"")},stripHash:function(e){return e.replace(/^#/,"")},stripQueryParams:function(e){return e.replace(/\?.*$/,"")},cleanHash:function(e){return Ae.stripHash(e.replace(/\?.*$/,"").replace(Le,""))},isHashValid:function(e){return/^#[^#]+$/.test(e)},isExternal:function(e){var t=Ae.parseUrl(e);return!(!t.protocol||t.domain===this.documentUrl.domain)},hasProtocol:function(e){return/^(:?\w+:)/.test(e)},isEmbeddedPage:function(e){var t=Ae.parseUrl(e);return""!==t.protocol?!this.isPath(t.hash)&&t.hash&&(t.hrefNoHash===this.documentUrl.hrefNoHash||this.documentBaseDiffers&&t.hrefNoHash===this.documentBase.hrefNoHash):/^#/.test(t.href)},squash:function(e,t){var i,n,r,o,a=this.isPath(e),s=this.parseUrl(e),l=s.hash,c="";return t=t||(Ae.isPath(e)?Ae.getLocation():Ae.getDocumentUrl()),n=a?Ae.stripHash(e):e,-1<(o=(n=Ae.isPath(s.hash)?Ae.stripHash(s.hash):n).indexOf(this.uiStateKey))&&(c=n.slice(o),n=n.slice(0,o)),i=Ae.makeUrlAbsolute(n,t),r=this.parseUrl(i).search,a?((Ae.isPath(l)||0===l.replace("#","").indexOf(this.uiStateKey))&&(l=""),c&&-1===l.indexOf(this.uiStateKey)&&(l+=c),-1===l.indexOf("#")&&""!==l&&(l="#"+l),i=(i=Ae.parseUrl(i)).protocol+"//"+i.host+i.pathname+r+l):i+=-1<i.indexOf("#")?c:"#"+c,i},isPreservableHash:function(e){return 0===e.replace("#","").indexOf(this.uiStateKey)},hashToSelector:function(e){var t="#"===e.substring(0,1);return t&&(e=e.substring(1)),(t?"#":"")+e.replace(/([!"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g,"\\$1")},getFilePath:function(e){var t="&"+Re.mobile.subPageUrlKey;return e&&e.split(t)[0].split(Le)[0]},isFirstPageUrl:function(e){var t=Ae.parseUrl(Ae.makeUrlAbsolute(e,this.documentBase)),i=t.hrefNoHash===this.documentUrl.hrefNoHash||this.documentBaseDiffers&&t.hrefNoHash===this.documentBase.hrefNoHash,n=Re.mobile.firstPage,r=n&&n[0]?n[0].id:void 0;return i&&(!t.hash||"#"===t.hash||r&&t.hash.replace(/^#/,"")===r)},isPermittedCrossDomainRequest:function(e,t){return Re.mobile.allowCrossDomainPages&&("file:"===e.protocol||"content:"===e.protocol)&&-1!==t.search(/^https?:/)}},Ae.documentUrl=Ae.parseLocation(),Pe=Re("head").find("base"),Ae.documentBase=Pe.length?Ae.parseUrl(Ae.makeUrlAbsolute(Pe.attr("href"),Ae.documentUrl.href)):Ae.documentUrl,Ae.documentBaseDiffers=Ae.documentUrl.hrefNoHash!==Ae.documentBase.hrefNoHash,Ae.getDocumentBase=function(e){return e?Re.extend({},Ae.documentBase):Ae.documentBase.href},Re.extend(Re.mobile,{getDocumentUrl:Ae.getDocumentUrl,getDocumentBase:Ae.getDocumentBase}),(Se=e).mobile.History=function(e,t){this.stack=e||[],this.activeIndex=t||0},Se.extend(Se.mobile.History.prototype,{getActive:function(){return this.stack[this.activeIndex]},getLast:function(){return this.stack[this.previousIndex]},getNext:function(){return this.stack[this.activeIndex+1]},getPrev:function(){return this.stack[this.activeIndex-1]},add:function(e,t){t=t||{},this.getNext()&&this.clearForward(),t.hash&&-1===t.hash.indexOf("#")&&(t.hash="#"+t.hash),t.url=e,this.stack.push(t),this.activeIndex=this.stack.length-1},clearForward:function(){this.stack=this.stack.slice(0,this.activeIndex+1)},find:function(e,t,i){var n,r,o,a=(t=t||this.stack).length;for(r=0;r<a;r++)if(n=t[r],(decodeURIComponent(e)===decodeURIComponent(n.url)||decodeURIComponent(e)===decodeURIComponent(n.hash))&&(o=r,i))return o;return o},closest:function(e){var t,i=this.activeIndex;return(t=this.find(e,this.stack.slice(0,i)))===Ce&&(t=(t=this.find(e,this.stack.slice(i),!0))===Ce?t:t+i),t},direct:function(e){var t=this.closest(e.url),i=this.activeIndex;t!==Ce&&(this.activeIndex=t,this.previousIndex=i),t<i?(e.present||e.back||Se.noop)(this.getActive(),"back"):i<t?(e.present||e.forward||Se.noop)(this.getActive(),"forward"):t===Ce&&e.missing&&e.missing(this.getActive())}}),Te=(Ee=e).mobile.path,Me=location.href,Ee.mobile.Navigator=function(e){this.history=e,this.ignoreInitialHashChange=!0,Ee.mobile.window.bind({"popstate.history":Ee.proxy(this.popstate,this),"hashchange.history":Ee.proxy(this.hashchange,this)})},Ee.extend(Ee.mobile.Navigator.prototype,{squash:function(e,t){var i,n,r=Te.isPath(e)?Te.stripHash(e):e;return n=Te.squash(e),i=Ee.extend({hash:r,url:n},t),L.history.replaceState(i,i.title||O.title,n),i},hash:function(e,t){var i,n,r;return i=Te.parseUrl(e),(n=Te.parseLocation()).pathname+n.search===i.pathname+i.search?i.hash?i.hash:i.pathname+i.search:Te.isPath(e)?(r=Te.parseUrl(t)).pathname+r.search+(Te.isPreservableHash(r.hash)?r.hash.replace("#",""):""):e},go:function(e,t,i){var n,r,o,a,s=Ee.event.special.navigate.isPushStateEnabled();r=Te.squash(e),o=this.hash(e,r),i&&o!==Te.stripHash(Te.parseLocation().hash)&&(this.preventNextHashChange=i),this.preventHashAssignPopState=!0,L.location.hash=o,this.preventHashAssignPopState=!1,n=Ee.extend({url:r,hash:o,title:O.title},t),s&&((a=new Ee.Event("popstate")).originalEvent={type:"popstate",state:null},this.squash(e,n),i||(this.ignorePopState=!0,Ee.mobile.window.trigger(a))),this.history.add(n.url,n)},popstate:function(i){var e,t;if(Ee.event.special.navigate.isPushStateEnabled())return this.preventHashAssignPopState?(this.preventHashAssignPopState=!1,void i.stopImmediatePropagation()):this.ignorePopState?void(this.ignorePopState=!1):!i.originalEvent.state&&1===this.history.stack.length&&this.ignoreInitialHashChange&&(this.ignoreInitialHashChange=!1,location.href===Me)?void i.preventDefault():(e=Te.parseLocation().hash,!i.originalEvent.state&&e?(t=this.squash(e),this.history.add(t.url,t),void(i.historyState=t)):void this.history.direct({url:(i.originalEvent.state||{}).url||e,present:function(e,t){i.historyState=Ee.extend({},e),i.historyState.direction=t}}))},hashchange:function(i){var e,t;if(Ee.event.special.navigate.isHashChangeEnabled()&&!Ee.event.special.navigate.isPushStateEnabled()){if(this.preventNextHashChange)return this.preventNextHashChange=!1,void i.stopImmediatePropagation();e=this.history,t=Te.parseLocation().hash,this.history.direct({url:t,present:function(e,t){i.hashchangeState=Ee.extend({},e),i.hashchangeState.direction=t},missing:function(){e.add(t,{hash:t,title:O.title})}})}}}),function(n){n.mobile.navigate=function(e,t,i){n.mobile.navigate.navigator.go(e,t,i)},n.mobile.navigate.history=new n.mobile.History,n.mobile.navigate.navigator=new n.mobile.Navigator(n.mobile.navigate.history);var e=n.mobile.path.parseLocation();n.mobile.navigate.history.add(e.href,{hash:e.hash})}(e),function(d,e,t,p){function f(e){for(;e&&void 0!==e.originalEvent;)e=e.originalEvent;return e}function o(e){for(var t,i,n={};e;){for(i in t=d.data(e,w))t[i]&&(n[i]=n.hasVirtualBinding=!0);e=e.parentNode}return n}function r(){D=!0}function a(){D=!1}function s(){l(),R=setTimeout(function(){B=R=0,O.length=0,I=!1,r()},d.vmouse.resetTimerDuration)}function l(){R&&(clearTimeout(R),R=0)}function c(e,t,i){var n;return(i&&i[e]||!i&&function(e,t){for(var i;e;){if((i=d.data(e,w))&&(!t||i[t]))return e;e=e.parentNode}return null}(t.target,e))&&(n=function(e,t){var i,n,r,o,a,s,l,c,h,u=e.type;if((e=d.Event(e)).type=t,i=e.originalEvent,n=d.event.props,-1<u.search(/^(mouse|click)/)&&(n=S),i)for(l=n.length;l;)e[o=n[--l]]=i[o];if(-1<u.search(/mouse(down|up)|click/)&&!e.which&&(e.which=1),-1!==u.search(/^touch/)&&(u=(r=f(i)).touches,a=r.changedTouches,s=u&&u.length?u[0]:a&&a.length?a[0]:p))for(c=0,h=T.length;c<h;c++)e[o=T[c]]=s[o];return e}(t,e),d(t.target).trigger(n)),n}function h(e){var t,i=d.data(e.target,_);I||B&&B===i||(t=c("v"+e.type,e))&&(t.isDefaultPrevented()&&e.preventDefault(),t.isPropagationStopped()&&e.stopPropagation(),t.isImmediatePropagationStopped()&&e.stopImmediatePropagation())}function u(e){var t,i,n,r=f(e).touches;r&&1===r.length&&((i=o(t=e.target)).hasVirtualBinding&&(B=H++,d.data(t,_,B),l(),a(),L=!1,n=f(e).touches[0],A=n.pageX,P=n.pageY,c("vmouseover",e,i),c("vmousedown",e,i)))}function m(e){D||(L||c("vmousecancel",e,o(e.target)),L=!0,s())}function g(e){if(!D){var t=f(e).touches[0],i=L,n=d.vmouse.moveDistanceThreshold,r=o(e.target);(L=L||Math.abs(t.pageX-A)>n||Math.abs(t.pageY-P)>n)&&!i&&c("vmousecancel",e,r),c("vmousemove",e,r),s()}}function v(e){if(!D){r();var t,i,n=o(e.target);c("vmouseup",e,n),L||(t=c("vclick",e,n))&&t.isDefaultPrevented()&&(i=f(e).changedTouches[0],O.push({touchID:B,x:i.clientX,y:i.clientY}),I=!0),c("vmouseout",e,n),L=!1,s()}}function y(e){var t,i=d.data(e,w);if(i)for(t in i)if(i[t])return!0;return!1}function b(){}function i(i){var n=i.substr(1);return{setup:function(){y(this)||d.data(this,w,{}),d.data(this,w)[i]=!0,C[i]=(C[i]||0)+1,1===C[i]&&N.bind(n,h),d(this).bind(n,b),k&&(C.touchstart=(C.touchstart||0)+1,1===C.touchstart&&N.bind("touchstart",u).bind("touchend",v).bind("touchmove",g).bind("scroll",m))},teardown:function(){--C[i],C[i]||N.unbind(n,h),k&&(--C.touchstart,C.touchstart||N.unbind("touchstart",u).unbind("touchmove",g).unbind("touchend",v).unbind("scroll",m));var e=d(this),t=d.data(this,w);t&&(t[i]=!1),e.unbind(n,b),y(this)||e.removeData(w)}}}var x,n,w="virtualMouseBindings",_="virtualTouchID",E="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),T="clientX clientY pageX pageY screenX screenY".split(" "),M=d.event.mouseHooks?d.event.mouseHooks.props:[],S=d.event.props.concat(M),C={},R=0,A=0,P=0,L=!1,O=[],I=!1,D=!1,k="addEventListener"in t,N=d(t),H=1,B=0;for(d.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500},n=0;n<E.length;n++)d.event.special[E[n]]=i(E[n]);k&&t.addEventListener("click",function(e){var t,i,n,r,o,a=O.length,s=e.target;if(a)for(t=e.clientX,i=e.clientY,x=d.vmouse.clickDistanceThreshold,n=s;n;){for(r=0;r<a;r++)if(o=O[r],0,n===s&&Math.abs(o.x-t)<x&&Math.abs(o.y-i)<x||d.data(n,_)===o.touchID)return e.preventDefault(),void e.stopPropagation();n=n.parentNode}},!0)}(e,0,O),function(c){function h(e,t,i){var n=i.type;i.type=t,c.event.dispatch.call(e,i),i.type=n}var u=c(O),e=c.mobile.support.touch,o="touchmove scroll",t=e?"touchstart":"mousedown",l=e?"touchend":"mouseup",d=e?"touchmove":"mousemove";c.each("touchstart touchmove touchend tap taphold swipe swipeleft swiperight scrollstart scrollstop".split(" "),function(e,t){c.fn[t]=function(e){return e?this.bind(t,e):this.trigger(t)},c.attrFn&&(c.attrFn[t]=!0)}),c.event.special.scrollstart={enabled:!0,setup:function(){function t(e,t){h(r,(i=t)?"scrollstart":"scrollstop",e)}var i,n,r=this;c(r).bind(o,function(e){c.event.special.scrollstart.enabled&&(i||t(e,!0),clearTimeout(n),n=setTimeout(function(){t(e,!1)},50))})},teardown:function(){c(this).unbind(o)}},c.event.special.tap={tapholdThreshold:750,emitTapOnTaphold:!0,setup:function(){var a=this,s=c(a),l=!1;s.bind("vmousedown",function(e){function t(){clearTimeout(r)}function i(){t(),s.unbind("vclick",n).unbind("vmouseup",t),u.unbind("vmousecancel",i)}function n(e){i(),l||o!==e.target?l&&e.stopPropagation():h(a,"tap",e)}if(l=!1,e.which&&1!==e.which)return!1;var r,o=e.target;s.bind("vmouseup",t).bind("vclick",n),u.bind("vmousecancel",i),r=setTimeout(function(){c.event.special.tap.emitTapOnTaphold||(l=!0),h(a,"taphold",c.Event("taphold",{target:o}))},c.event.special.tap.tapholdThreshold)})},teardown:function(){c(this).unbind("vmousedown").unbind("vclick").unbind("vmouseup"),u.unbind("vmousecancel")}},c.event.special.swipe={scrollSupressionThreshold:30,durationThreshold:1e3,horizontalDistanceThreshold:30,verticalDistanceThreshold:75,start:function(e){var t=e.originalEvent.touches?e.originalEvent.touches[0]:e;return{time:(new Date).getTime(),coords:[t.pageX,t.pageY],origin:c(e.target)}},stop:function(e){var t=e.originalEvent.touches?e.originalEvent.touches[0]:e;return{time:(new Date).getTime(),coords:[t.pageX,t.pageY]}},handleSwipe:function(e,t,i,n){if(t.time-e.time<c.event.special.swipe.durationThreshold&&Math.abs(e.coords[0]-t.coords[0])>c.event.special.swipe.horizontalDistanceThreshold&&Math.abs(e.coords[1]-t.coords[1])<c.event.special.swipe.verticalDistanceThreshold){var r=e.coords[0]>t.coords[0]?"swipeleft":"swiperight";return h(i,"swipe",c.Event("swipe",{target:n,swipestart:e,swipestop:t})),h(i,r,c.Event(r,{target:n,swipestart:e,swipestop:t})),!0}return!1},setup:function(){var a=this,s=c(a);s.bind(t,function(e){function t(e){n&&(i=c.event.special.swipe.stop(e),o||(o=c.event.special.swipe.handleSwipe(n,i,a,r)),Math.abs(n.coords[0]-i.coords[0])>c.event.special.swipe.scrollSupressionThreshold&&e.preventDefault())}var i,n=c.event.special.swipe.start(e),r=e.target,o=!1;s.bind(d,t).one(l,function(){o=!0,s.unbind(d,t)})})},teardown:function(){c(this).unbind(t).unbind(d).unbind(l)}},c.each({scrollstop:"scrollstart",taphold:"tap",swipeleft:"swipe",swiperight:"swipe"},function(e,t){c.event.special[e]={setup:function(){c(this).bind(t,c.noop)},teardown:function(){c(this).unbind(t)}}})}(e),function(e){e.event.special.throttledresize={setup:function(){e(this).bind("resize",r)},teardown:function(){e(this).unbind("resize",r)}};var t,i,n,r=function(){i=(new Date).getTime(),250<=(n=i-o)?(o=i,e(this).trigger("throttledresize")):(t&&clearTimeout(t),t=setTimeout(r,250-n))},o=0}(e),function(t,i){function e(){var e=n();e!==r&&(r=e,c.trigger(h))}var n,r,o,a,s,l,c=t(i),h="orientationchange",u={0:!0,180:!0};t.support.orientation&&(s=i.innerWidth||c.width(),50,o=(l=i.innerHeight||c.height())<s&&50<s-l,a=u[i.orientation],(o&&a||!o&&!a)&&(u={"-90":!0,90:!0})),t.event.special.orientationchange=t.extend({},t.event.special.orientationchange,{setup:function(){return!(t.support.orientation&&!t.event.special.orientationchange.disabled)&&(r=n(),void c.bind("throttledresize",e))},teardown:function(){return!(t.support.orientation&&!t.event.special.orientationchange.disabled)&&void c.unbind("throttledresize",e)},add:function(e){var t=e.handler;e.handler=function(e){return e.orientation=n(),t.apply(this,arguments)}}}),t.event.special.orientationchange.orientation=n=function(){var e=O.documentElement;return(t.support.orientation?u[i.orientation]:e&&e.clientWidth/e.clientHeight<1.1)?"portrait":"landscape"},t.fn[h]=function(e){return e?this.bind(h,e):this.trigger(h)},t.attrFn&&(t.attrFn[h]=!0)}(e,this),we=(xe=e)("head").children("base"),_e={element:we.length?we:xe("<base>",{href:xe.mobile.path.documentBase.hrefNoHash}).prependTo(xe("head")),linkSelector:"[src], link[href], a[rel='external'], :jqmData(ajax='false'), a[target]",set:function(e){xe.mobile.dynamicBaseEnabled&&xe.support.dynamicBaseTag&&_e.element.attr("href",xe.mobile.path.makeUrlAbsolute(e,xe.mobile.path.documentBase))},rewrite:function(e,t){var r=xe.mobile.path.get(e);t.find(_e.linkSelector).each(function(e,t){var i=xe(t).is("[href]")?"href":xe(t).is("[src]")?"src":"action",n=xe(t).attr(i);n=n.replace(location.protocol+"//"+location.host+location.pathname,""),/^(\w+:|#|\/)/.test(n)||xe(t).attr(i,r+n)})},reset:function(){_e.element.attr("href",xe.mobile.path.documentBase.hrefNoSearch)}},xe.mobile.base=_e,function(a,r){a.mobile.widgets={};var i,e=a.widget,s=a.mobile.keepNative;a.widget=(i=a.widget,function(){var e=i.apply(this,arguments),t=e.prototype.widgetName;return e.initSelector=e.prototype.initSelector!==r?e.prototype.initSelector:":jqmData(role='"+t+"')",a.mobile.widgets[t]=e}),a.extend(a.widget,e),a.mobile.document.on("create",function(e){a(e.target).enhanceWithin()}),a.widget("mobile.page",{options:{theme:"a",domCache:!1,keepNativeDefault:a.mobile.keepNative,contentTheme:null,enhanced:!1},_createWidget:function(){a.Widget.prototype._createWidget.apply(this,arguments),this._trigger("init")},_create:function(){return!1!==this._trigger("beforecreate")&&(this.options.enhanced||this._enhance(),this._on(this.element,{pagebeforehide:"removeContainerBackground",pagebeforeshow:"_handlePageBeforeShow"}),this.element.enhanceWithin(),void("dialog"===a.mobile.getAttribute(this.element[0],"role")&&a.mobile.dialog&&this.element.dialog()))},_enhance:function(){var i="data-"+a.mobile.ns,n=this;this.options.role&&this.element.attr("data-"+a.mobile.ns+"role",this.options.role),this.element.attr("tabindex","0").addClass("ui-page ui-page-theme-"+this.options.theme),this.element.find("["+i+"role='content']").each(function(){var e=a(this),t=this.getAttribute(i+"theme")||r;n.options.contentTheme=t||n.options.contentTheme||n.options.dialog&&n.options.theme||"dialog"===n.element.jqmData("role")&&n.options.theme,e.addClass("ui-content"),n.options.contentTheme&&e.addClass("ui-body-"+n.options.contentTheme),e.attr("role","main").addClass("ui-content")})},bindRemove:function(e){var t=this.element;!t.data("mobile-page").options.domCache&&t.is(":jqmData(external-page='true')")&&t.bind("pagehide.remove",e||function(e,t){if(!t.samePage){var i=a(this),n=new a.Event("pageremove");i.trigger(n),n.isDefaultPrevented()||i.removeWithDependents()}})},_setOptions:function(e){e.theme!==r&&this.element.removeClass("ui-body-"+this.options.theme).addClass("ui-body-"+e.theme),e.contentTheme!==r&&this.element.find("[data-"+a.mobile.ns+"='content']").removeClass("ui-body-"+this.options.contentTheme).addClass("ui-body-"+e.contentTheme)},_handlePageBeforeShow:function(){this.setContainerBackground()},removeContainerBackground:function(){this.element.closest(":mobile-pagecontainer").pagecontainer({theme:"none"})},setContainerBackground:function(e){this.element.parent().pagecontainer({theme:e||this.options.theme})},keepNativeSelector:function(){var e=this.options,t=a.trim(e.keepNative||""),i=a.trim(a.mobile.keepNative),n=a.trim(e.keepNativeDefault),r=s===i?"":i,o=""===r?n:"";return(t?[t]:[]).concat(r?[r]:[]).concat(o?[o]:[]).join(", ")}})}(e),function(g,v){g.widget("mobile.pagecontainer",{options:{theme:"a"},initSelector:!1,_create:function(){this.setLastScrollEnabled=!0,this._on(this.window,{navigate:"_filterNavigateEvents"}),this._on(this.window,{navigate:"_disableRecordScroll",scrollstop:"_delayedRecordScroll"}),this._on({pagechange:"_afterContentChange"}),this.window.one("navigate",g.proxy(function(){this.setLastScrollEnabled=!0},this))},_setOptions:function(e){e.theme!==v&&"none"!==e.theme?this.element.removeClass("ui-overlay-"+this.options.theme).addClass("ui-overlay-"+e.theme):e.theme!==v&&this.element.removeClass("ui-overlay-"+this.options.theme),this._super(e)},_disableRecordScroll:function(){this.setLastScrollEnabled=!1},_enableRecordScroll:function(){this.setLastScrollEnabled=!0},_afterContentChange:function(){this.setLastScrollEnabled=!0,this._off(this.window,"scrollstop"),this._on(this.window,{scrollstop:"_delayedRecordScroll"})},_recordScroll:function(){if(this.setLastScrollEnabled){var e,t,i,n=this._getActiveHistory();n&&(e=this._getScroll(),t=this._getMinScroll(),i=this._getDefaultScroll(),n.lastScroll=e<t?i:e)}},_delayedRecordScroll:function(){setTimeout(g.proxy(this,"_recordScroll"),100)},_getScroll:function(){return this.window.scrollTop()},_getMinScroll:function(){return g.mobile.minScrollBack},_getDefaultScroll:function(){return g.mobile.defaultHomeScroll},_filterNavigateEvents:function(e,t){var i;e.originalEvent&&e.originalEvent.isDefaultPrevented()||((i=-1<e.originalEvent.type.indexOf("hashchange")?t.state.hash:t.state.url)||(i=this._getHash()),i&&"#"!==i&&0!==i.indexOf("#"+g.mobile.path.uiStateKey)||(i=location.href),this._handleNavigate(i,t.state))},_getHash:function(){return g.mobile.path.parseLocation().hash},getActivePage:function(){return this.activePage},_getInitialContent:function(){return g.mobile.firstPage},_getHistory:function(){return g.mobile.navigate.history},_getActiveHistory:function(){return g.mobile.navigate.history.getActive()},_getDocumentBase:function(){return g.mobile.path.documentBase},back:function(){this.go(-1)},forward:function(){this.go(1)},go:function(e){if(g.mobile.hashListeningEnabled)L.history.go(e);else{var t=g.mobile.navigate.history.activeIndex,i=t+parseInt(e,10),n=g.mobile.navigate.history.stack[i].url,r=1<=e?"forward":"back";g.mobile.navigate.history.activeIndex=i,g.mobile.navigate.history.previousIndex=t,this.change(n,{direction:r,changeHash:!1,fromHashChange:!0})}},_handleDestination:function(e){var t;return"string"===g.type(e)&&(e=g.mobile.path.stripHash(e)),e&&(t=this._getHistory(),(e=g.mobile.path.isPath(e)?e:g.mobile.path.makeUrlAbsolute("#"+e,this._getDocumentBase()))===g.mobile.path.makeUrlAbsolute("#"+t.initialDst,this._getDocumentBase())&&t.stack.length&&t.stack[0].url!==t.initialDst.replace(g.mobile.dialogHashKey,"")&&(e=this._getInitialContent())),e||this._getInitialContent()},_handleDialog:function(e,t){var i,n,r=this.getActivePage();return r&&!r.hasClass("ui-dialog")?("back"===t.direction?this.back():this.forward(),!1):(i=t.pageUrl,n=this._getActiveHistory(),g.extend(e,{role:n.role,transition:n.transition,reverse:"back"===t.direction}),i)},_handleNavigate:function(e,t){var i=g.mobile.path.stripHash(e),n=this._getHistory(),r=0===n.stack.length?"none":v,o={changeHash:!1,fromHashChange:!0,reverse:"back"===t.direction};g.extend(o,t,{transition:(n.getLast()||{}).transition||r}),0<n.activeIndex&&-1<i.indexOf(g.mobile.dialogHashKey)&&n.initialDst!==i&&!1===(i=this._handleDialog(o,t))||this._changeContent(this._handleDestination(i),o)},_changeContent:function(e,t){g.mobile.changePage(e,t)},_getBase:function(){return g.mobile.base},_getNs:function(){return g.mobile.ns},_enhance:function(e,t){return e.page({role:t})},_include:function(e,t){e.appendTo(this.element),this._enhance(e,t.role),e.page("bindRemove")},_find:function(e){var t,i=this._createFileUrl(e),n=this._createDataUrl(e),r=this._getInitialContent();return 0===(t=this.element.children("[data-"+this._getNs()+"url='"+n+"']")).length&&n&&!g.mobile.path.isPath(n)&&(t=this.element.children(g.mobile.path.hashToSelector("#"+n)).attr("data-"+this._getNs()+"url",n).jqmData("url",n)),0===t.length&&g.mobile.path.isFirstPageUrl(i)&&r&&r.parent().length&&(t=g(r)),t},_getLoader:function(){return g.mobile.loading()},_showLoading:function(e,t,i,n){this._loadMsg||(this._loadMsg=setTimeout(g.proxy(function(){this._getLoader().loader("show",t,i,n),this._loadMsg=0},this),e))},_hideLoading:function(){clearTimeout(this._loadMsg),this._loadMsg=0,this._getLoader().loader("hide")},_showError:function(){this._hideLoading(),this._showLoading(0,g.mobile.pageLoadErrorMessageTheme,g.mobile.pageLoadErrorMessage,!0),setTimeout(g.proxy(this,"_hideLoading"),1500)},_parse:function(e,t){var i,n=g("<div></div>");return n.get(0).innerHTML=e,(i=n.find(":jqmData(role='page'), :jqmData(role='dialog')").first()).length||(i=g("<div data-"+this._getNs()+"role='page'>"+(e.split(/<\/?body[^>]*>/gim)[1]||"")+"</div>")),i.attr("data-"+this._getNs()+"url",g.mobile.path.convertUrlToDataUrl(t)).attr("data-"+this._getNs()+"external-page",!0),i},_setLoadedTitle:function(e,t){var i=t.match(/<title[^>]*>([^<]*)/)&&RegExp.$1;i&&!e.jqmData("title")&&(i=g("<div>"+i+"</div>").text(),e.jqmData("title",i))},_isRewritableBaseTag:function(){return g.mobile.dynamicBaseEnabled&&!g.support.dynamicBaseTag},_createDataUrl:function(e){return g.mobile.path.convertUrlToDataUrl(e)},_createFileUrl:function(e){return g.mobile.path.getFilePath(e)},_triggerWithDeprecated:function(e,t,i){var n=g.Event("page"+e),r=g.Event(this.widgetName+e);return(i||this.element).trigger(n,t),this.element.trigger(r,t),{deprecatedEvent:n,event:r}},_loadSuccess:function(a,s,l,c){var h=this._createFileUrl(a),u=this._createDataUrl(a);return g.proxy(function(e,t,i){var n,r=new RegExp("(<[^>]+\\bdata-"+this._getNs()+"role=[\"']?page[\"']?[^>]*>)"),o=new RegExp("\\bdata-"+this._getNs()+"url=[\"']?([^\"'>]*)[\"']?");r.test(e)&&RegExp.$1&&o.test(RegExp.$1)&&RegExp.$1&&(h=g.mobile.path.getFilePath(g("<div>"+RegExp.$1+"</div>").text())),l.prefetch===v&&this._getBase().set(h),n=this._parse(e,h),this._setLoadedTitle(n,e),s.xhr=i,s.textStatus=t,s.page=n,s.content=n,this._trigger("load",v,s)&&(this._isRewritableBaseTag()&&n&&this._getBase().rewrite(h,n),this._include(n,l),-1<a.indexOf("&"+g.mobile.subPageUrlKey)&&(n=this.element.children("[data-"+this._getNs()+"url='"+u+"']")),l.showLoadMsg&&this._hideLoading(),this.element.trigger("pageload"),c.resolve(a,l,n))},this)},_loadDefaults:{type:"get",data:v,reloadPage:!1,reload:!1,role:v,showLoadMsg:!1,loadMsgDelay:50},load:function(e,t){var i,n,r,o,a,s=t&&t.deferred||g.Deferred(),l=g.extend({},this._loadDefaults,t),c=g.mobile.path.makeUrlAbsolute(e,this._findBaseWithDefault());return l.reload=l.reloadPage,l.data&&"get"===l.type&&(c=g.mobile.path.addSearchParams(c,l.data),l.data=v),l.data&&"post"===l.type&&(l.reload=!0),i=this._createFileUrl(c),n=this._createDataUrl(c),0===(a=this._find(c)).length&&g.mobile.path.isEmbeddedPage(i)&&!g.mobile.path.isFirstPageUrl(i)?void s.reject(c,l):(this._getBase().reset(),a.length&&!l.reload?(this._enhance(a,l.role),s.resolve(c,l,a),void(l.prefetch||this._getBase().set(e))):(o={url:e,absUrl:c,dataUrl:n,deferred:s,options:l},(r=this._triggerWithDeprecated("beforeload",o)).deprecatedEvent.isDefaultPrevented()||r.event.isDefaultPrevented()?void 0:(l.showLoadMsg&&this._showLoading(l.loadMsgDelay),l.prefetch===v&&this._getBase().reset(),g.mobile.allowCrossDomainPages||g.mobile.path.isSameDomain(g.mobile.path.documentUrl,c)?void g.ajax({url:i,type:l.type,data:l.data,contentType:l.contentType,dataType:"html",success:this._loadSuccess(c,o,l,s),error:this._loadError(c,o,l,s)}):void s.reject(c,l))))},_loadError:function(r,o,a,s){return g.proxy(function(e,t,i){this._getBase().set(g.mobile.path.get()),o.xhr=e,o.textStatus=t,o.errorThrown=i;var n=this._triggerWithDeprecated("loadfailed",o);n.deprecatedEvent.isDefaultPrevented()||n.event.isDefaultPrevented()||(a.showLoadMsg&&this._showError(),s.reject(r,a))},this)},_getTransitionHandler:function(e){return e=g.mobile._maybeDegradeTransition(e),g.mobile.transitionHandlers[e]||g.mobile.defaultTransitionHandler},_triggerCssTransitionEvents:function(e,t,i){var n=!1;i=i||"",t&&(e[0]===t[0]&&(n=!0),this._triggerWithDeprecated(i+"hide",{nextPage:e,samePage:n},t)),this._triggerWithDeprecated(i+"show",{prevPage:t||g("")},e)},_cssTransition:function(e,t,i){var n,r=i.transition,o=i.reverse,a=i.deferred;this._triggerCssTransitionEvents(e,t,"before"),this._hideLoading(),(n=new(this._getTransitionHandler(r))(r,o,e,t).transition()).done(function(){a.resolve.apply(a,arguments)}),n.done(g.proxy(function(){this._triggerCssTransitionEvents(e,t)},this))},_releaseTransitionLock:function(){b=!1,0<y.length&&g.mobile.changePage.apply(null,y.pop())},_removeActiveLinkClass:function(e){g.mobile.removeActiveLinkClass(e)},_loadUrl:function(e,n,t){t.target=e,t.deferred=g.Deferred(),this.load(e,t),t.deferred.done(g.proxy(function(e,t,i){b=!1,t.absUrl=n.absUrl,this.transition(i,n,t)},this)),t.deferred.fail(g.proxy(function(){this._removeActiveLinkClass(!0),this._releaseTransitionLock(),this._triggerWithDeprecated("changefailed",n)},this))},_triggerPageBeforeChange:function(e,t,i){var n=new g.Event("pagebeforechange");return g.extend(t,{toPage:e,options:i}),t.absUrl="string"===g.type(e)?g.mobile.path.makeUrlAbsolute(e,this._findBaseWithDefault()):i.absUrl,this.element.trigger(n,t),!n.isDefaultPrevented()},change:function(e,t){if(b)y.unshift(arguments);else{var i=g.extend({},g.mobile.changePage.defaults,t),n={};i.fromPage=i.fromPage||this.activePage,this._triggerPageBeforeChange(e,n,i)&&(e=n.toPage,"string"===g.type(e)?(b=!0,this._loadUrl(e,n,i)):this.transition(e,n,i))}},transition:function(o,a,s){var e,t,i,n,r,l,c,h,u,d,p,f,m;if(b)y.unshift([o,s]);else if(this._triggerPageBeforeChange(o,a,s)&&(!(m=this._triggerWithDeprecated("beforetransition",a)).deprecatedEvent.isDefaultPrevented()&&!m.event.isDefaultPrevented())){if(b=!0,o[0]!==g.mobile.firstPage[0]||s.dataUrl||(s.dataUrl=g.mobile.path.documentUrl.hrefNoHash),e=s.fromPage,i=t=s.dataUrl&&g.mobile.path.convertUrlToDataUrl(s.dataUrl)||o.jqmData("url"),g.mobile.path.getFilePath(t),n=g.mobile.navigate.history.getActive(),r=0===g.mobile.navigate.history.activeIndex,l=0,c=O.title,h=("dialog"===s.role||"dialog"===o.jqmData("role"))&&!0!==o.jqmData("dialog"),e&&e[0]===o[0]&&!s.allowSamePageTransition)return b=!1,this._triggerWithDeprecated("transition",a),this.element.trigger("pagechange",a),void(s.fromHashChange&&g.mobile.navigate.history.direct({url:t}));o.page({role:s.role}),s.fromHashChange&&(l="back"===s.direction?-1:1);try{O.activeElement&&"body"!==O.activeElement.nodeName.toLowerCase()?g(O.activeElement).blur():g("input:focus, textarea:focus, select:focus").blur()}catch(e){}u=!1,h&&n&&(n.url&&-1<n.url.indexOf(g.mobile.dialogHashKey)&&this.activePage&&!this.activePage.hasClass("ui-dialog")&&0<g.mobile.navigate.history.activeIndex&&(u=!(s.changeHash=!1)),t=n.url||"",t+=!u&&-1<t.indexOf("#")?g.mobile.dialogHashKey:"#"+g.mobile.dialogHashKey,0===g.mobile.navigate.history.activeIndex&&t===g.mobile.navigate.history.initialDst&&(t+=g.mobile.dialogHashKey)),(d=n?o.jqmData("title")||o.children(":jqmData(role='header')").find(".ui-title").text():c)&&c===O.title&&(c=d),o.jqmData("title")||o.jqmData("title",c),s.transition=s.transition||(l&&!r?n.transition:v)||(h?g.mobile.defaultDialogTransition:g.mobile.defaultPageTransition),!l&&u&&(g.mobile.navigate.history.getActive().pageUrl=i),t&&!s.fromHashChange&&(!g.mobile.path.isPath(t)&&t.indexOf("#")<0&&(t="#"+t),!(p={transition:s.transition,title:c,pageUrl:i,role:s.role})!==s.changeHash&&g.mobile.hashListeningEnabled?g.mobile.navigate(t,p,!0):o[0]!==g.mobile.firstPage[0]&&g.mobile.navigate.history.add(t,p)),O.title=c,g.mobile.activePage=o,this.activePage=o,s.reverse=s.reverse||l<0,f=g.Deferred(),this._cssTransition(o,e,{transition:s.transition,reverse:s.reverse,deferred:f}),f.done(g.proxy(function(e,t,i,n,r){g.mobile.removeActiveLinkClass(),s.duplicateCachedPage&&s.duplicateCachedPage.remove(),r||g.mobile.focusPage(o),this._releaseTransitionLock(),this.element.trigger("pagechange",a),this._triggerWithDeprecated("transition",a)},this))}},_findBaseWithDefault:function(){return this.activePage&&g.mobile.getClosestBaseUrl(this.activePage)||g.mobile.path.documentBase.hrefNoHash}}),g.mobile.navreadyDeferred=g.Deferred();var y=[],b=!1}(e),function(c,h){function u(e){for(;e&&("string"!=typeof e.nodeName||"a"!==e.nodeName.toLowerCase());)e=e.parentNode;return e}var e=c.Deferred(),d=c.mobile.path.documentUrl,s=null;c.mobile.loadPage=function(e,t){var i;return i=(t=t||{}).pageContainer||c.mobile.pageContainer,t.deferred=c.Deferred(),i.pagecontainer("load",e,t),t.deferred.promise()},c.mobile.back=function(){var e=L.navigator;this.phonegapNavigationEnabled&&e&&e.app&&e.app.backHistory?e.app.backHistory():c.mobile.pageContainer.pagecontainer("back")},c.mobile.focusPage=function(e){var t=e.find("[autofocus]"),i=e.find(".ui-title:eq(0)");return t.length?void t.focus():void(i.length?i.focus():e.focus())},c.mobile._maybeDegradeTransition=c.mobile._maybeDegradeTransition||function(e){return e},c.fn.animationComplete=function(e){return c.support.cssTransitions?c(this).one("webkitAnimationEnd animationend",e):(setTimeout(e,0),c(this))},c.mobile.changePage=function(e,t){c.mobile.pageContainer.pagecontainer("change",e,t)},c.mobile.changePage.defaults={transition:h,reverse:!1,changeHash:!0,fromHashChange:!1,role:h,duplicateCachedPage:h,pageContainer:h,showLoadMsg:!0,dataUrl:h,fromPage:h,allowSamePageTransition:!1},c.mobile._registerInternalEvents=function(){var o=function(e,t){var i,n,r,o,a=!0;return!(!c.mobile.ajaxEnabled||e.is(":jqmData(ajax='false')")||!e.jqmHijackable().length||e.attr("target"))&&(i=s&&s.attr("formaction")||e.attr("action"),o=(e.attr("method")||"get").toLowerCase(),i||(i=c.mobile.getClosestBaseUrl(e),"get"===o&&(i=c.mobile.path.parseUrl(i).hrefNoSearch),i===c.mobile.path.documentBase.hrefNoHash&&(i=d.hrefNoSearch)),i=c.mobile.path.makeUrlAbsolute(i,c.mobile.getClosestBaseUrl(e)),!(c.mobile.path.isExternal(i)&&!c.mobile.path.isPermittedCrossDomainRequest(d,i))&&(t||(n=e.serializeArray(),s&&s[0].form===e[0]&&((r=s.attr("name"))&&(c.each(n,function(e,t){return t.name===r?(r="",!1):void 0}),r&&n.push({name:r,value:s.attr("value")}))),a={url:i,options:{type:o,data:c.param(n),transition:e.jqmData("transition"),reverse:"reverse"===e.jqmData("direction"),reloadPage:!0}}),a))};c.mobile.document.delegate("form","submit",function(e){var t;e.isDefaultPrevented()||(t=o(c(this)))&&(c.mobile.changePage(t.url,t.options),e.preventDefault())}),c.mobile.document.bind("vclick",function(e){var t,i,n=e.target,r=!1;if(!(1<e.which)&&c.mobile.linkBindingEnabled){if(s=c(n),c.data(n,"mobile-button")){if(!o(c(n).closest("form"),!0))return;n.parentNode&&(n=n.parentNode)}else{if(!(n=u(n))||"#"===c.mobile.path.parseUrl(n.getAttribute("href")||"#").hash)return;if(!c(n).jqmHijackable().length)return}~n.className.indexOf("ui-link-inherit")?n.parentNode&&(i=c.data(n.parentNode,"buttonElements")):i=c.data(n,"buttonElements"),i?n=i.outer:r=!0,t=c(n),r&&(t=t.closest(".ui-btn")),0<t.length&&!t.hasClass("ui-state-disabled")&&(c.mobile.removeActiveLinkClass(!0),c.mobile.activeClickedLink=t,c.mobile.activeClickedLink.addClass(c.mobile.activeBtnClass))}}),c.mobile.document.bind("click",function(e){if(c.mobile.linkBindingEnabled&&!e.isDefaultPrevented()){var t,i,n,r,o,a=u(e.target),s=c(a),l=function(){L.setTimeout(function(){c.mobile.removeActiveLinkClass(!0)},200)};if(c.mobile.activeClickedLink&&c.mobile.activeClickedLink[0]===e.target.parentNode&&l(),a&&!(1<e.which)&&s.jqmHijackable().length){if(s.is(":jqmData(rel='back')"))return c.mobile.back(),!1;if(t=c.mobile.getClosestBaseUrl(s),i=c.mobile.path.makeUrlAbsolute(s.attr("href")||"#",t),!c.mobile.ajaxEnabled&&!c.mobile.path.isEmbeddedPage(i))return void l();if(-1!==i.search("#")){if(!(i=i.replace(/[^#]*#/,"")))return void e.preventDefault();i=c.mobile.path.isPath(i)?c.mobile.path.makeUrlAbsolute(i,t):c.mobile.path.makeUrlAbsolute("#"+i,d.hrefNoHash)}if(s.is("[rel='external']")||s.is(":jqmData(ajax='false')")||s.is("[target]")||c.mobile.path.isExternal(i)&&!c.mobile.path.isPermittedCrossDomainRequest(d,i))return void l();n=s.jqmData("transition"),r="reverse"===s.jqmData("direction")||s.jqmData("back"),o=s.attr("data-"+c.mobile.ns+"rel")||h,c.mobile.changePage(i,{transition:n,reverse:r,role:o,link:s}),e.preventDefault()}}}),c.mobile.document.delegate(".ui-page","pageshow.prefetch",function(){var i=[];c(this).find("a:jqmData(prefetch)").each(function(){var e=c(this),t=e.attr("href");t&&-1===c.inArray(t,i)&&(i.push(t),c.mobile.loadPage(t,{role:e.attr("data-"+c.mobile.ns+"rel"),prefetch:!0}))})}),c.mobile.pageContainer.pagecontainer(),c.mobile.document.bind("pageshow",c.mobile.resetActivePageHeight),c.mobile.window.bind("throttledresize",c.mobile.resetActivePageHeight)},c(function(){e.resolve()}),c.when(e,c.mobile.navreadyDeferred).done(function(){c.mobile._registerInternalEvents()})}(e),be=this,(ye=e).mobile.Transition=function(){this.init.apply(this,arguments)},ye.extend(ye.mobile.Transition.prototype,{toPreClass:" ui-page-pre-in",init:function(e,t,i,n){ye.extend(this,{name:e,reverse:t,$to:i,$from:n,deferred:new ye.Deferred})},cleanFrom:function(){this.$from.removeClass(ye.mobile.activePageClass+" out in reverse "+this.name).height("")},beforeDoneIn:function(){},beforeDoneOut:function(){},beforeStartOut:function(){},doneIn:function(){this.beforeDoneIn(),this.$to.removeClass("out in reverse "+this.name).height(""),this.toggleViewportClass(),ye.mobile.window.scrollTop()!==this.toScroll&&this.scrollPage(),this.sequential||this.$to.addClass(ye.mobile.activePageClass),this.deferred.resolve(this.name,this.reverse,this.$to,this.$from,!0)},doneOut:function(e,t,i,n){this.beforeDoneOut(),this.startIn(e,t,i,n)},hideIn:function(e){this.$to.css("z-index",-10),e.call(this),this.$to.css("z-index","")},scrollPage:function(){ye.event.special.scrollstart.enabled=!1,(ye.mobile.hideUrlBar||this.toScroll!==ye.mobile.defaultHomeScroll)&&be.scrollTo(0,this.toScroll),setTimeout(function(){ye.event.special.scrollstart.enabled=!0},150)},startIn:function(e,t,i,n){this.hideIn(function(){this.$to.addClass(ye.mobile.activePageClass+this.toPreClass),n||ye.mobile.focusPage(this.$to),this.$to.height(e+this.toScroll),i||this.scrollPage()}),i||this.$to.animationComplete(ye.proxy(function(){this.doneIn()},this)),this.$to.removeClass(this.toPreClass).addClass(this.name+" in "+t),i&&this.doneIn()},startOut:function(e,t,i){this.beforeStartOut(e,t,i),this.$from.height(e+ye.mobile.window.scrollTop()).addClass(this.name+" out"+t)},toggleViewportClass:function(){ye.mobile.pageContainer.toggleClass("ui-mobile-viewport-transitioning viewport-"+this.name)},transition:function(){var e=this.reverse?" reverse":"",t=ye.mobile.getScreenHeight(),i=!1!==ye.mobile.maxTransitionWidth&&ye.mobile.window.width()>ye.mobile.maxTransitionWidth,n=!ye.support.cssTransitions||!ye.support.cssAnimations||i||!this.name||"none"===this.name||Math.max(ye.mobile.window.scrollTop(),this.toScroll)>ye.mobile.getMaxScrollForTransition();return this.toScroll=ye.mobile.navigate.history.getActive().lastScroll||ye.mobile.defaultHomeScroll,this.toggleViewportClass(),this.$from&&!n?this.startOut(t,e,n):this.doneOut(t,e,n,!0),this.deferred.promise()}}),(ve=e).mobile.SerialTransition=function(){this.init.apply(this,arguments)},ve.extend(ve.mobile.SerialTransition.prototype,ve.mobile.Transition.prototype,{sequential:!0,beforeDoneOut:function(){this.$from&&this.cleanFrom()},beforeStartOut:function(e,t,i){this.$from.animationComplete(ve.proxy(function(){this.doneOut(e,t,i)},this))}}),(ge=e).mobile.ConcurrentTransition=function(){this.init.apply(this,arguments)},ge.extend(ge.mobile.ConcurrentTransition.prototype,ge.mobile.Transition.prototype,{sequential:!1,beforeDoneIn:function(){this.$from&&this.cleanFrom()},beforeStartOut:function(e,t,i){this.doneOut(e,t,i)}}),(me=e).mobile.transitionHandlers={sequential:me.mobile.SerialTransition,simultaneous:me.mobile.ConcurrentTransition},me.mobile.defaultTransitionHandler=me.mobile.transitionHandlers.sequential,me.mobile.transitionFallbacks={},me.mobile._maybeDegradeTransition=function(e){return e&&!me.support.cssTransform3d&&me.mobile.transitionFallbacks[e]&&(e=me.mobile.transitionFallbacks[e]),e},me.mobile.getMaxScrollForTransition=me.mobile.getMaxScrollForTransition||function(){return 3*me.mobile.getScreenHeight()},e.mobile.transitionFallbacks.flip="fade",e.mobile.transitionFallbacks.flow="fade",e.mobile.transitionFallbacks.pop="fade",(fe=e).mobile.transitionHandlers.slide=fe.mobile.transitionHandlers.simultaneous,fe.mobile.transitionFallbacks.slide="fade",e.mobile.transitionFallbacks.slidedown="fade",e.mobile.transitionFallbacks.slidefade="fade",e.mobile.transitionFallbacks.slideup="fade",e.mobile.transitionFallbacks.turn="fade",(pe=e).mobile.degradeInputs={color:!1,date:!1,datetime:!1,"datetime-local":!1,email:!1,month:!1,number:!1,range:"number",search:"text",tel:!1,time:!1,url:!1,week:!1},pe.mobile.page.prototype.options.degradeInputs=pe.mobile.degradeInputs,pe.mobile.degradeInputsWithin=function(e){(e=pe(e)).find("input").not(pe.mobile.page.prototype.keepNativeSelector()).each(function(){var e,t,i,n,r=pe(this),o=this.getAttribute("type"),a=pe.mobile.degradeInputs[o]||"text";pe.mobile.degradeInputs[o]&&(i=(t=-1<(e=pe("<div>").html(r.clone()).html()).indexOf(" type="))?/\s+type=["']?\w+['"]?/:/\/?>/,n=' type="'+a+'" data-'+pe.mobile.ns+'type="'+o+'"'+(t?"":">"),r.replaceWith(e.replace(i,n)))})},(ue=e).widget("mobile.page",ue.mobile.page,{options:{closeBtn:"left",closeBtnText:"Close",overlayTheme:"a",corners:!0,dialog:!1},_create:function(){this._super(),this.options.dialog&&(ue.extend(this,{_inner:this.element.children(),_headerCloseButton:null}),this.options.enhanced||this._setCloseBtn(this.options.closeBtn))},_enhance:function(){this._super(),this.options.dialog&&this.element.addClass("ui-dialog").wrapInner(ue("<div/>",{role:"dialog",class:"ui-dialog-contain ui-overlay-shadow"+(this.options.corners?" ui-corner-all":"")}))},_setOptions:function(e){var t,i,n=this.options;e.corners!==de&&this._inner.toggleClass("ui-corner-all",!!e.corners),e.overlayTheme!==de&&ue.mobile.activePage[0]===this.element[0]&&(n.overlayTheme=e.overlayTheme,this._handlePageBeforeShow()),e.closeBtnText!==de&&(t=n.closeBtn,i=e.closeBtnText),e.closeBtn!==de&&(t=e.closeBtn),t&&this._setCloseBtn(t,i),this._super(e)},_handlePageBeforeShow:function(){this.options.overlayTheme&&this.options.dialog?(this.removeContainerBackground(),this.setContainerBackground(this.options.overlayTheme)):this._super()},_setCloseBtn:function(e,t){var i,n=this._headerCloseButton;"none"==(e="left"===e?"left":"right"===e?"right":"none")?n&&(n.remove(),n=null):n?(n.removeClass("ui-btn-left ui-btn-right").addClass("ui-btn-"+e),t&&n.text(t)):(i=this._inner.find(":jqmData(role='header')").first(),n=ue("<a></a>",{href:"#",class:"ui-btn ui-corner-all ui-icon-delete ui-btn-icon-notext ui-btn-"+e}).attr("data-"+ue.mobile.ns+"rel","back").text(t||this.options.closeBtnText||"").prependTo(i),this._on(n,{click:"close"})),this._headerCloseButton=n}}),(ce=e).widget("mobile.dialog",{options:{closeBtn:"left",closeBtnText:"Close",overlayTheme:"a",corners:!0},_handlePageBeforeShow:function(){this._isCloseable=!0,this.options.overlayTheme&&this.element.page("removeContainerBackground").page("setContainerBackground",this.options.overlayTheme)},_handlePageBeforeHide:function(){this._isCloseable=!1},_handleVClickSubmit:function(e){var t,i=ce(e.target).closest("vclick"===e.type?"a":"form");i.length&&!i.jqmData("transition")&&((t={})["data-"+ce.mobile.ns+"transition"]=(ce.mobile.navigate.history.getActive()||{}).transition||ce.mobile.defaultDialogTransition,t["data-"+ce.mobile.ns+"direction"]="reverse",i.attr(t))},_create:function(){var e=this.element,t=this.options;e.addClass("ui-dialog").wrapInner(ce("<div/>",{role:"dialog",class:"ui-dialog-contain ui-overlay-shadow"+(t.corners?" ui-corner-all":"")})),ce.extend(this,{_isCloseable:!1,_inner:e.children(),_headerCloseButton:null}),this._on(e,{vclick:"_handleVClickSubmit",submit:"_handleVClickSubmit",pagebeforeshow:"_handlePageBeforeShow",pagebeforehide:"_handlePageBeforeHide"}),this._setCloseBtn(t.closeBtn)},_setOptions:function(e){var t,i,n=this.options;e.corners!==he&&this._inner.toggleClass("ui-corner-all",!!e.corners),e.overlayTheme!==he&&ce.mobile.activePage[0]===this.element[0]&&(n.overlayTheme=e.overlayTheme,this._handlePageBeforeShow()),e.closeBtnText!==he&&(t=n.closeBtn,i=e.closeBtnText),e.closeBtn!==he&&(t=e.closeBtn),t&&this._setCloseBtn(t,i),this._super(e)},_setCloseBtn:function(e,t){var i,n=this._headerCloseButton;"none"==(e="left"===e?"left":"right"===e?"right":"none")?n&&(n.remove(),n=null):n?(n.removeClass("ui-btn-left ui-btn-right").addClass("ui-btn-"+e),t&&n.text(t)):(i=this._inner.find(":jqmData(role='header')").first(),n=ce("<a></a>",{role:"button",href:"#",class:"ui-btn ui-corner-all ui-icon-delete ui-btn-icon-notext ui-btn-"+e}).text(t||this.options.closeBtnText||"").prependTo(i),this._on(n,{click:"close"})),this._headerCloseButton=n},close:function(){var e=ce.mobile.navigate.history;this._isCloseable&&(this._isCloseable=!1,ce.mobile.hashListeningEnabled&&0<e.activeIndex?ce.mobile.back():ce.mobile.pageContainer.pagecontainer("back"))}}),le=/([A-Z])/g,(ae=e).widget("mobile.collapsible",{options:{enhanced:!1,expandCueText:null,collapseCueText:null,collapsed:!0,heading:"h1,h2,h3,h4,h5,h6,legend",collapsedIcon:null,expandedIcon:null,iconpos:null,theme:null,contentTheme:null,inset:null,corners:null,mini:null},_create:function(){var e=this.element,t={accordion:e.closest(":jqmData(role='collapsible-set')"+(ae.mobile.collapsibleset?", :mobile-collapsibleset":"")).addClass("ui-collapsible-set")};ae.extend(this,{_ui:t}),this.options.enhanced?(t.heading=ae(".ui-collapsible-heading",this.element[0]),t.content=t.heading.next(),t.anchor=ae("a",t.heading[0]).first(),t.status=t.anchor.children(".ui-collapsible-heading-status")):this._enhance(e,t),this._on(t.heading,{tap:function(){t.heading.find("a").first().addClass(ae.mobile.activeBtnClass)},click:function(e){this._handleExpandCollapse(!t.heading.hasClass("ui-collapsible-heading-collapsed")),e.preventDefault(),e.stopPropagation()}})},_getOptions:function(e){var t,i=this._ui.accordion,n=this._ui.accordionWidget;for(t in e=ae.extend({},e),i.length&&!n&&(this._ui.accordionWidget=n=i.data("mobile-collapsibleset")),e)e[t]=null!=e[t]?e[t]:n?n.options[t]:i.length?ae.mobile.getAttribute(i[0],t.replace(le,"-$1").toLowerCase()):null,null==e[t]&&(e[t]=ae.mobile.collapsible.defaults[t]);return e},_themeClassFromOption:function(e,t){return t?"none"===t?"":e+t:""},_enhance:function(e,t){var i,n=this._getOptions(this.options),r=this._themeClassFromOption("ui-body-",n.contentTheme);return e.addClass("ui-collapsible "+(n.inset?"ui-collapsible-inset ":"")+(n.inset&&n.corners?"ui-corner-all ":"")+(r?"ui-collapsible-themed-content ":"")),t.originalHeading=e.children(this.options.heading).first(),t.content=e.wrapInner("<div class='ui-collapsible-content "+r+"'></div>").children(".ui-collapsible-content"),t.heading=t.originalHeading,t.heading.is("legend")&&(t.heading=ae("<div role='heading'>"+t.heading.html()+"</div>"),t.placeholder=ae("<div>\x3c!-- placeholder for legend --\x3e</div>").insertBefore(t.originalHeading),t.originalHeading.remove()),i=n.collapsed?n.collapsedIcon?"ui-icon-"+n.collapsedIcon:"":n.expandedIcon?"ui-icon-"+n.expandedIcon:"",t.status=ae("<span class='ui-collapsible-heading-status'></span>"),t.anchor=t.heading.detach().addClass("ui-collapsible-heading").append(t.status).wrapInner("<a href='#' class='ui-collapsible-heading-toggle'></a>").find("a").first().addClass("ui-btn "+(i?i+" ":"")+(i?"ui-btn-icon-"+("right"===n.iconpos?"right":"left")+" ":"")+this._themeClassFromOption("ui-btn-",n.theme)+" "+(n.mini?"ui-mini ":"")),t.heading.insertBefore(t.content),this._handleExpandCollapse(this.options.collapsed),t},refresh:function(){var e,t={};for(e in ae.mobile.collapsible.defaults)t[e]=this.options[e];this._setOptions(t)},_setOptions:function(e){var t,i,n,r=this.element,o=this._getOptions(this.options),a=this._ui,s=a.anchor,l=a.status,c=this._getOptions(e);e.collapsed!==se&&this._handleExpandCollapse(e.collapsed),r.hasClass("ui-collapsible-collapsed")?(c.expandCueText!==se&&l.text(c.expandCueText),c.collapsedIcon!==se&&(o.collapsedIcon&&s.removeClass("ui-icon-"+o.collapsedIcon),c.collapsedIcon&&s.addClass("ui-icon-"+c.collapsedIcon))):(c.collapseCueText!==se&&l.text(c.collapseCueText),c.expandedIcon!==se&&(o.expandedIcon&&s.removeClass("ui-icon-"+o.expandedIcon),c.expandedIcon&&s.addClass("ui-icon-"+c.expandedIcon))),c.iconpos!==se&&(s.removeClass("ui-btn-icon-"+("right"===o.iconPos?"right":"left")),s.addClass("ui-btn-icon-"+("right"===c.iconPos?"right":"left"))),c.theme!==se&&(i=this._themeClassFromOption("ui-btn-",o.theme),t=this._themeClassFromOption("ui-btn-",c.theme),s.removeClass(i).addClass(t)),c.contentTheme!==se&&(i=this._themeClassFromOption("ui-body-",o.theme),t=this._themeClassFromOption("ui-body-",c.theme),a.content.removeClass(i).addClass(t)),c.inset!==se&&(r.toggleClass("ui-collapsible-inset",c.inset),n=!(!c.inset||!c.corners&&!o.corners)),c.corners!==se&&(n=!(!c.corners||!c.inset&&!o.inset)),n!==se&&r.toggleClass("ui-corner-all",n),c.mini!==se&&s.toggleClass("ui-mini",c.mini),this._super(e)},_handleExpandCollapse:function(e){var t=this._getOptions(this.options),i=this._ui;i.status.text(e?t.expandCueText:t.collapseCueText),i.heading.toggleClass("ui-collapsible-heading-collapsed",e).find("a").first().toggleClass("ui-icon-"+t.expandedIcon,!e).toggleClass("ui-icon-"+t.collapsedIcon,e||t.expandedIcon===t.collapsedIcon).removeClass(ae.mobile.activeBtnClass),this.element.toggleClass("ui-collapsible-collapsed",e),i.content.toggleClass("ui-collapsible-content-collapsed",e).attr("aria-hidden",e).trigger("updatelayout"),this.options.collapsed=e,this._trigger(e?"collapse":"expand")},expand:function(){this._handleExpandCollapse(!1)},collapse:function(){this._handleExpandCollapse(!0)},_destroy:function(){var e=this._ui;this.options.enhanced||(e.placeholder?(e.originalHeading.insertBefore(e.placeholder),e.placeholder.remove(),e.heading.remove()):(e.status.remove(),e.heading.removeClass("ui-collapsible-heading ui-collapsible-heading-collapsed").children().contents().unwrap()),e.anchor.contents().unwrap(),e.content.contents().unwrap(),this.element.removeClass("ui-collapsible ui-collapsible-collapsed ui-collapsible-themed-content ui-collapsible-inset ui-corner-all"))}}),ae.mobile.collapsible.defaults={expandCueText:" click to expand contents",collapseCueText:" click to collapse contents",collapsedIcon:"plus",contentTheme:"inherit",expandedIcon:"minus",iconpos:"left",inset:!0,corners:!0,theme:"inherit",mini:!1},e.mobile.behaviors.addFirstLastClasses={_getVisibles:function(e,t){var i;return t?i=e.not(".ui-screen-hidden"):0===(i=e.filter(":visible")).length&&(i=e.not(".ui-screen-hidden")),i},_addFirstLastClasses:function(e,t,i){e.removeClass("ui-first-child ui-last-child"),t.eq(0).addClass("ui-first-child").end().last().addClass("ui-last-child"),i||this.element.trigger("updatelayout")},_removeFirstLastClasses:function(e){e.removeClass("ui-first-child ui-last-child")}},oe=":mobile-collapsible, "+(re=e).mobile.collapsible.initSelector,re.widget("mobile.collapsibleset",re.extend({initSelector:":jqmData(role='collapsible-set'),:jqmData(role='collapsibleset')",options:re.extend({enhanced:!1},re.mobile.collapsible.defaults),_handleCollapsibleExpand:function(e){var t=re(e.target).closest(".ui-collapsible");t.parent().is(":mobile-collapsibleset, :jqmData(role='collapsible-set')")&&t.siblings(".ui-collapsible:not(.ui-collapsible-collapsed)").collapsible("collapse")},_create:function(){var e=this.element,t=this.options;re.extend(this,{_classes:""}),t.enhanced||(e.addClass("ui-collapsible-set "+this._themeClassFromOption("ui-group-theme-",t.theme)+" "+(t.corners&&t.inset?"ui-corner-all ":"")),this.element.find(re.mobile.collapsible.initSelector).collapsible()),this._on(e,{collapsibleexpand:"_handleCollapsibleExpand"})},_themeClassFromOption:function(e,t){return t?"none"===t?"":e+t:""},_init:function(){this._refresh(!0),this.element.children(oe).filter(":jqmData(collapsed='false')").collapsible("expand")},_setOptions:function(e){var t,i,n=this.element,r=this._themeClassFromOption("ui-group-theme-",e.theme);return r&&n.removeClass(this._themeClassFromOption("ui-group-theme-",this.options.theme)).addClass(r),void 0!==e.inset&&(i=!(!e.inset||!e.corners&&!this.options.corners)),void 0!==e.corners&&(i=!(!e.corners||!e.inset&&!this.options.inset)),void 0!==i&&n.toggleClass("ui-corner-all",i),t=this._super(e),this.element.children(":mobile-collapsible").collapsible("refresh"),t},_destroy:function(){var e=this.element;this._removeFirstLastClasses(e.children(oe)),e.removeClass("ui-collapsible-set ui-corner-all "+this._themeClassFromOption("ui-group-theme-",this.options.theme)).children(":mobile-collapsible").collapsible("destroy")},_refresh:function(e){var t=this.element.children(oe);this.element.find(re.mobile.collapsible.initSelector).not(".ui-collapsible").collapsible(),this._addFirstLastClasses(t,this._getVisibles(t,e),e)},refresh:function(){this._refresh(!1)}},re.mobile.behaviors.addFirstLastClasses)),e.fn.fieldcontain=function(){return this.addClass("ui-field-contain")},(ne=e).fn.grid=function(s){return this.each(function(){var e,t,i=ne(this),n=ne.extend({grid:null},s),r=i.children(),o={solo:1,a:2,b:3,c:4,d:5},a=n.grid;if(!a)if(r.length<=5)for(t in o)o[t]===r.length&&(a=t);else a="a",i.addClass("ui-grid-duo");e=o[a],i.addClass("ui-grid-"+a),r.filter(":nth-child("+e+"n+1)").addClass("ui-block-a"),1<e&&r.filter(":nth-child("+e+"n+2)").addClass("ui-block-b"),2<e&&r.filter(":nth-child("+e+"n+3)").addClass("ui-block-c"),3<e&&r.filter(":nth-child("+e+"n+4)").addClass("ui-block-d"),4<e&&r.filter(":nth-child("+e+"n+5)").addClass("ui-block-e")})},(ie=e).widget("mobile.navbar",{options:{iconpos:"top",grid:null},_create:function(){var e=this.element,t=e.find("a"),n=t.filter(":jqmData(icon)").length?this.options.iconpos:void 0;e.addClass("ui-navbar").attr("role","navigation").find("ul").jqmEnhanceable().grid({grid:this.options.grid}),t.each(function(){var e=ie.mobile.getAttribute(this,"icon"),t=ie.mobile.getAttribute(this,"theme"),i="ui-btn";t&&(i+=" ui-btn-"+t),e&&(i+=" ui-icon-"+e+" ui-btn-icon-"+n),ie(this).addClass(i)}),e.delegate("a","vclick",function(){var e=ie(this);e.hasClass("ui-state-disabled")||e.hasClass("ui-disabled")||e.hasClass(ie.mobile.activeBtnClass)||(t.removeClass(ie.mobile.activeBtnClass),e.addClass(ie.mobile.activeBtnClass),ie(O).one("pagehide",function(){e.removeClass(ie.mobile.activeBtnClass)}))}),e.closest(".ui-page").bind("pagebeforeshow",function(){t.filter(".ui-state-persist").addClass(ie.mobile.activeBtnClass)})}}),te=(ee=e).mobile.getAttribute,ee.widget("mobile.listview",ee.extend({options:{theme:null,countTheme:null,dividerTheme:null,icon:"carat-r",splitIcon:"carat-r",splitTheme:null,corners:!0,shadow:!0,inset:!1},_create:function(){var e="";e+=this.options.inset?" ui-listview-inset":"",this.options.inset&&(e+=this.options.corners?" ui-corner-all":"",e+=this.options.shadow?" ui-shadow":""),this.element.addClass(" ui-listview"+e),this.refresh(!0)},_findFirstElementByTagName:function(e,t,i,n){var r={};for(r[i]=r[n]=!0;e;){if(r[e.nodeName])return e;e=e[t]}return null},_addThumbClasses:function(e){var t,i,n=e.length;for(t=0;t<n;t++)(i=ee(this._findFirstElementByTagName(e[t].firstChild,"nextSibling","img","IMG"))).length&&ee(this._findFirstElementByTagName(i[0].parentNode,"parentNode","li","LI")).addClass(i.hasClass("ui-li-icon")?"ui-li-has-icon":"ui-li-has-thumb")},_getChildrenByTagName:function(e,t,i){var n=[],r={};for(r[t]=r[i]=!0,e=e.firstChild;e;)r[e.nodeName]&&n.push(e),e=e.nextSibling;return ee(n)},_beforeListviewRefresh:ee.noop,_afterListviewRefresh:ee.noop,refresh:function(e){var t,i,n,r,o,a,s,l,c,h,u,d,p,f,m,g,v,y,b=this.options,x=this.element,w=!!ee.nodeName(x[0],"ol"),_=x.attr("start"),E={},T=x.find(".ui-li-count"),M=te(x[0],"counttheme")||this.options.countTheme,S=M?"ui-body-"+M:"ui-body-inherit";for(b.theme&&x.addClass("ui-group-theme-"+b.theme),w&&(_||0===_)&&(u=parseInt(_,10)-1,x.css("counter-reset","listnumbering "+u)),this._beforeListviewRefresh(),i=0,n=(y=this._getChildrenByTagName(x[0],"li","LI")).length;i<n;i++)r=y.eq(i),o="",(e||r[0].className.search(/\bui-li-static\b|\bui-li-divider\b/)<0)&&(c=this._getChildrenByTagName(r[0],"a","A"),h="list-divider"===te(r[0],"role"),p=r.attr("value"),a=te(r[0],"theme"),c.length&&c[0].className.search(/\bui-btn\b/)<0&&!h?(l=!1!==(s=te(r[0],"icon"))&&(s||b.icon),c.removeClass("ui-link"),t="ui-btn",a&&(t+=" ui-btn-"+a),1<c.length?(o="ui-li-has-alt",f=c.last(),g=(m=te(f[0],"theme")||b.splitTheme||te(r[0],"theme",!0))?" ui-btn-"+m:"",v="ui-btn ui-btn-icon-notext ui-icon-"+(te(f[0],"icon")||te(r[0],"icon")||b.splitIcon)+g,f.attr("title",ee.trim(f.getEncodedText())).addClass(v).empty()):l&&(t+=" ui-btn-icon-right ui-icon-"+l),c.first().addClass(t)):h?(o="ui-li-divider ui-bar-"+(te(r[0],"theme")||b.dividerTheme||b.theme||"inherit"),r.attr("role","heading")):c.length<=0&&(o="ui-li-static ui-body-"+(a||"inherit")),w&&p&&(d=parseInt(p,10)-1,r.css("counter-reset","listnumbering "+d))),E[o]||(E[o]=[]),E[o].push(r[0]);for(o in E)ee(E[o]).addClass(o);T.each(function(){ee(this).closest("li").addClass("ui-li-has-count")}),S&&T.addClass(S),this._addThumbClasses(y),this._addThumbClasses(y.find(".ui-btn")),this._afterListviewRefresh(),this._addFirstLastClasses(y,this._getVisibles(y,e),e)}},ee.mobile.behaviors.addFirstLastClasses)),(Q=e).widget("mobile.listview",Q.mobile.listview,{options:{autodividers:!1,autodividersSelector:function(e){var t=Q.trim(e.text())||null;return t?t=t.slice(0,1).toUpperCase():null}},_beforeListviewRefresh:function(){this.options.autodividers&&(this._replaceDividers(),this._superApply(arguments))},_replaceDividers:function(){var e,t,i,n,r,o=null,a=this.element;for(a.children("li:jqmData(role='list-divider')").remove(),t=a.children("li"),e=0;e<t.length;e++)i=t[e],(n=this.options.autodividersSelector(Q(i)))&&o!==n&&((r=O.createElement("li")).appendChild(O.createTextNode(n)),r.setAttribute("data-"+Q.mobile.ns+"role","list-divider"),i.parentNode.insertBefore(r,i)),o=n}}),K=/(^|\s)ui-li-divider($|\s)/,J=/(^|\s)ui-screen-hidden($|\s)/,(Y=e).widget("mobile.listview",Y.mobile.listview,{options:{hideDividers:!1},_afterListviewRefresh:function(){var e,t,i,n=!0;if(this._superApply(arguments),this.options.hideDividers)for(t=(e=this._getChildrenByTagName(this.element[0],"li","LI")).length-1;-1<t;t--)(i=e[t]).className.match(K)?(n&&(i.className=i.className+" ui-screen-hidden"),n=!0):i.className.match(J)||(n=!1)}}),(Z=e).mobile.nojs=function(e){Z(":jqmData(role='nojs')",e).addClass("ui-nojs")},e.mobile.behaviors.formReset={_handleFormReset:function(){this._on(this.element.closest("form"),{reset:function(){this._delay("_reset")}})}},(q=e).widget("mobile.checkboxradio",q.extend({initSelector:"input:not( :jqmData(role='flipswitch' ) )[type='checkbox'],input[type='radio']:not( :jqmData(role='flipswitch' ))",options:{theme:"inherit",mini:!1,wrapperClass:null,enhanced:!1,iconpos:"left"},_create:function(){var e=this.element,t=this.options,i=function(e,t){return e.jqmData(t)||e.closest("form, fieldset").jqmData(t)},n=e.closest("label"),r=n.length?n:e.closest("form, fieldset, :jqmData(role='page'), :jqmData(role='dialog')").find("label").filter("[for='"+q.mobile.path.hashToSelector(e[0].id)+"']").first(),o=e[0].type,a="ui-"+o+"-on",s="ui-"+o+"-off";("checkbox"===o||"radio"===o)&&(this.element[0].disabled&&(this.options.disabled=!0),t.iconpos=i(e,"iconpos")||r.attr("data-"+q.mobile.ns+"iconpos")||t.iconpos,t.mini=i(e,"mini")||t.mini,q.extend(this,{input:e,label:r,parentLabel:n,inputtype:o,checkedClass:a,uncheckedClass:s}),this.options.enhanced||this._enhance(),this._on(r,{vmouseover:"_handleLabelVMouseOver",vclick:"_handleLabelVClick"}),this._on(e,{vmousedown:"_cacheVals",vclick:"_handleInputVClick",focus:"_handleInputFocus",blur:"_handleInputBlur"}),this._handleFormReset(),this.refresh())},_enhance:function(){this.label.addClass("ui-btn ui-corner-all"),0<this.parentLabel.length?this.input.add(this.label).wrapAll(this._wrapper()):(this.element.wrap(this._wrapper()),this.element.parent().prepend(this.label)),this._setOptions({theme:this.options.theme,iconpos:this.options.iconpos,mini:this.options.mini})},_wrapper:function(){return q("<div class='"+(this.options.wrapperClass?this.options.wrapperClass:"")+" ui-"+this.inputtype+(this.options.disabled?" ui-state-disabled":"")+"' >")},_handleInputFocus:function(){this.label.addClass(q.mobile.focusClass)},_handleInputBlur:function(){this.label.removeClass(q.mobile.focusClass)},_handleInputVClick:function(){var e=this.element;e.is(":checked")?(e.prop("checked",!0),this._getInputSet().not(e).prop("checked",!1)):e.prop("checked",!1),this._updateAll()},_handleLabelVMouseOver:function(e){this.label.parent().hasClass("ui-state-disabled")&&e.stopPropagation()},_handleLabelVClick:function(e){var t=this.element;return t.is(":disabled")?void e.preventDefault():(this._cacheVals(),t.prop("checked","radio"===this.inputtype||!t.prop("checked")),t.triggerHandler("click"),this._getInputSet().not(t).prop("checked",!1),this._updateAll(),!1)},_cacheVals:function(){this._getInputSet().each(function(){q(this).attr("data-"+q.mobile.ns+"cacheVal",this.checked)})},_getInputSet:function(){return"checkbox"===this.inputtype?this.element:this.element.closest("form, :jqmData(role='page'), :jqmData(role='dialog')").find("input[name='"+this.element[0].name+"'][type='"+this.inputtype+"']")},_updateAll:function(){var t=this;this._getInputSet().each(function(){var e=q(this);(this.checked||"checkbox"===t.inputtype)&&e.trigger("change")}).checkboxradio("refresh")},_reset:function(){this.refresh()},_hasIcon:function(){var e,t,i=q.mobile.controlgroup;return!(i&&0<(e=this.element.closest(":mobile-controlgroup,"+i.prototype.initSelector)).length)||"horizontal"!==((t=q.data(e[0],"mobile-controlgroup"))?t.options.type:e.attr("data-"+q.mobile.ns+"type"))},refresh:function(){var e=this._hasIcon(),t=this.element[0].checked,i=q.mobile.activeBtnClass,n="ui-btn-icon-"+this.options.iconpos,r=[],o=[];e?(o.push(i),r.push(n)):(o.push(n),(t?r:o).push(i)),t?(r.push(this.checkedClass),o.push(this.uncheckedClass)):(r.push(this.uncheckedClass),o.push(this.checkedClass)),this.label.addClass(r.join(" ")).removeClass(o.join(" "))},widget:function(){return this.label.parent()},_setOptions:function(e){var t=this.label,i=this.options,n=this.widget(),r=this._hasIcon();e.disabled!==X&&(this.input.prop("disabled",!!e.disabled),n.toggleClass("ui-state-disabled",!!e.disabled)),e.mini!==X&&n.toggleClass("ui-mini",!!e.mini),e.theme!==X&&t.removeClass("ui-btn-"+i.theme).addClass("ui-btn-"+e.theme),e.wrapperClass!==X&&n.removeClass(i.wrapperClass).addClass(e.wrapperClass),e.iconpos!==X&&r?t.removeClass("ui-btn-icon-"+i.iconpos).addClass("ui-btn-icon-"+e.iconpos):r||t.removeClass("ui-btn-icon-"+i.iconpos),this._super(e)}},q.mobile.behaviors.formReset)),(G=e).widget("mobile.button",{initSelector:"input[type='button'], input[type='submit'], input[type='reset']",options:{theme:null,icon:null,iconpos:"left",iconshadow:!1,corners:!0,shadow:!0,inline:null,mini:null,wrapperClass:null,enhanced:!1},_create:function(){this.element.is(":disabled")&&(this.options.disabled=!0),this.options.enhanced||this._enhance(),G.extend(this,{wrapper:this.element.parent()}),this._on({focus:function(){this.widget().addClass(G.mobile.focusClass)},blur:function(){this.widget().removeClass(G.mobile.focusClass)}}),this.refresh(!0)},_enhance:function(){this.element.wrap(this._button())},_button:function(){var e=this.options,t=this._getIconClasses(this.options);return G("<div class='ui-btn ui-input-btn"+(e.wrapperClass?" "+e.wrapperClass:"")+(e.theme?" ui-btn-"+e.theme:"")+(e.corners?" ui-corner-all":"")+(e.shadow?" ui-shadow":"")+(e.inline?" ui-btn-inline":"")+(e.mini?" ui-mini":"")+(e.disabled?" ui-state-disabled":"")+(t?" "+t:"")+"' >"+this.element.val()+"</div>")},widget:function(){return this.wrapper},_destroy:function(){this.element.insertBefore(this.button),this.button.remove()},_getIconClasses:function(e){return e.icon?"ui-icon-"+e.icon+(e.iconshadow?" ui-shadow-icon":"")+" ui-btn-icon-"+e.iconpos:""},_setOptions:function(e){var t=this.widget();e.theme!==W&&t.removeClass(this.options.theme).addClass("ui-btn-"+e.theme),e.corners!==W&&t.toggleClass("ui-corner-all",e.corners),e.shadow!==W&&t.toggleClass("ui-shadow",e.shadow),e.inline!==W&&t.toggleClass("ui-btn-inline",e.inline),e.mini!==W&&t.toggleClass("ui-mini",e.mini),e.disabled!==W&&(this.element.prop("disabled",e.disabled),t.toggleClass("ui-state-disabled",e.disabled)),(e.icon!==W||e.iconshadow!==W||e.iconpos!==W)&&t.removeClass(this._getIconClasses(this.options)).addClass(this._getIconClasses(G.extend({},this.options,e))),this._super(e)},refresh:function(e){if(this.options.icon&&"notext"===this.options.iconpos&&this.element.attr("title")&&this.element.attr("title",this.element.val()),!e){var t=this.element.detach();G(this.wrapper).text(this.element.val()).append(t)}}}),U=(F=e)("meta[name=viewport]"),$=U.attr("content"),z=$+",maximum-scale=1, user-scalable=no",j=$+",maximum-scale=10, user-scalable=yes",V=/(user-scalable[\s]*=[\s]*no)|(maximum-scale[\s]*=[\s]*1)[$,\s]/.test($),F.mobile.zoom=F.extend({},{enabled:!V,locked:!1,disable:function(e){V||F.mobile.zoom.locked||(U.attr("content",z),F.mobile.zoom.enabled=!1,F.mobile.zoom.locked=e||!1)},enable:function(e){V||F.mobile.zoom.locked&&!0!==e||(U.attr("content",j),F.mobile.zoom.enabled=!0,F.mobile.zoom.locked=!1)},restore:function(){V||(U.attr("content",$),F.mobile.zoom.enabled=!0)}}),(H=e).widget("mobile.textinput",{initSelector:"input[type='text'],input[type='search'],:jqmData(type='search'),input[type='number'],:jqmData(type='number'),input[type='password'],input[type='email'],input[type='url'],input[type='tel'],textarea,input[type='time'],input[type='date'],input[type='month'],input[type='week'],input[type='datetime'],input[type='datetime-local'],input[type='color'],input:not([type]),input[type='file']",options:{theme:null,corners:!0,mini:!1,preventFocusZoom:/iPhone|iPad|iPod/.test(navigator.platform)&&-1<navigator.userAgent.indexOf("AppleWebKit"),wrapperClass:"",enhanced:!1},_create:function(){var e=this.options,t=this.element.is("[type='search'], :jqmData(type='search')"),i="TEXTAREA"===this.element[0].tagName,n=this.element.is("[data-"+(H.mobile.ns||"")+"type='range']"),r=(this.element.is("input")||this.element.is("[data-"+(H.mobile.ns||"")+"type='search']"))&&!n;this.element.prop("disabled")&&(e.disabled=!0),H.extend(this,{classes:this._classesFromOptions(),isSearch:t,isTextarea:i,isRange:n,inputNeedsWrap:r}),this._autoCorrect(),e.enhanced||this._enhance(),this._on({focus:"_handleFocus",blur:"_handleBlur"})},refresh:function(){this.setOptions({disabled:this.element.is(":disabled")})},_enhance:function(){var e=[];this.isTextarea&&e.push("ui-input-text"),(this.isTextarea||this.isRange)&&e.push("ui-shadow-inset"),this.inputNeedsWrap?this.element.wrap(this._wrap()):e=e.concat(this.classes),this.element.addClass(e.join(" "))},widget:function(){return this.inputNeedsWrap?this.element.parent():this.element},_classesFromOptions:function(){var e=this.options,t=[];return t.push("ui-body-"+(null===e.theme?"inherit":e.theme)),e.corners&&t.push("ui-corner-all"),e.mini&&t.push("ui-mini"),e.disabled&&t.push("ui-state-disabled"),e.wrapperClass&&t.push(e.wrapperClass),t},_wrap:function(){return H("<div class='"+(this.isSearch?"ui-input-search ":"ui-input-text ")+this.classes.join(" ")+" ui-shadow-inset'></div>")},_autoCorrect:function(){void 0===this.element[0].autocorrect||H.support.touchOverflow||(this.element[0].setAttribute("autocorrect","off"),this.element[0].setAttribute("autocomplete","off"))},_handleBlur:function(){this.widget().removeClass(H.mobile.focusClass),this.options.preventFocusZoom&&H.mobile.zoom.enable(!0)},_handleFocus:function(){this.options.preventFocusZoom&&H.mobile.zoom.disable(!0),this.widget().addClass(H.mobile.focusClass)},_setOptions:function(e){var t=this.widget();this._super(e),(e.disabled!==B||e.mini!==B||e.corners!==B||e.theme!==B||e.wrapperClass!==B)&&(t.removeClass(this.classes.join(" ")),this.classes=this._classesFromOptions(),t.addClass(this.classes.join(" "))),e.disabled!==B&&this.element.prop("disabled",!!e.disabled)},_destroy:function(){this.options.enhanced||(this.inputNeedsWrap&&this.element.unwrap(),this.element.removeClass("ui-input-text "+this.classes.join(" ")))}}),(k=e).widget("mobile.slider",k.extend({initSelector:"input[type='range'], :jqmData(type='range'), :jqmData(role='slider')",widgetEventPrefix:"slide",options:{theme:null,trackTheme:null,corners:!0,mini:!1,highlight:!1},_create:function(){var e,t,i,n,r,o,a,s,l,c,h,u=this.element,d=this.options.trackTheme||k.mobile.getAttribute(u[0],"theme"),p=d?" ui-bar-"+d:" ui-bar-inherit",f=this.options.corners||u.jqmData("corners")?" ui-corner-all":"",m=this.options.mini||u.jqmData("mini")?" ui-mini":"",g=u[0].nodeName.toLowerCase(),v="select"===g,y=u.parent().is(":jqmData(role='rangeslider')"),b=v?"ui-slider-switch":"",x=u.attr("id"),w=k("[for='"+x+"']"),_=w.attr("id")||x+"-label",E=v?0:parseFloat(u.attr("min")),T=v?u.find("option").length-1:parseFloat(u.attr("max")),M=L.parseFloat(u.attr("step")||1),S=O.createElement("a"),C=k(S),R=O.createElement("div"),A=k(R),P=!(!this.options.highlight||v)&&((h=O.createElement("div")).className="ui-slider-bg "+k.mobile.activeBtnClass,k(h).prependTo(A));if(w.attr("id",_),this.isToggleSwitch=v,S.setAttribute("href","#"),R.setAttribute("role","application"),R.className=[this.isToggleSwitch?"ui-slider ui-slider-track ui-shadow-inset ":"ui-slider-track ui-shadow-inset ",b,p,f,m].join(""),S.className="ui-slider-handle",R.appendChild(S),C.attr({role:"slider","aria-valuemin":E,"aria-valuemax":T,"aria-valuenow":this._value(),"aria-valuetext":this._value(),title:this._value(),"aria-labelledby":_}),k.extend(this,{slider:A,handle:C,control:u,type:g,step:M,max:T,min:E,valuebg:P,isRangeslider:y,dragging:!1,beforeStart:null,userModified:!1,mouseMoved:!1}),v){for((a=u.attr("tabindex"))&&C.attr("tabindex",a),u.attr("tabindex","-1").focus(function(){k(this).blur(),C.focus()}),(t=O.createElement("div")).className="ui-slider-inneroffset",i=0,n=R.childNodes.length;i<n;i++)t.appendChild(R.childNodes[i]);for(R.appendChild(t),C.addClass("ui-slider-handle-snapping"),r=0,o=(e=u.find("option")).length;r<o;r++)s=r?"a":"b",l=r?" "+k.mobile.activeBtnClass:"",(c=O.createElement("span")).className=["ui-slider-label ui-slider-label-",s,l].join(""),c.setAttribute("role","img"),c.appendChild(O.createTextNode(e[r].innerHTML)),k(c).prependTo(A);this._labels=k(".ui-slider-label",A)}u.addClass(v?"ui-slider-switch":"ui-slider-input"),this._on(u,{change:"_controlChange",keyup:"_controlKeyup",blur:"_controlBlur",vmouseup:"_controlVMouseUp"}),A.bind("vmousedown",k.proxy(this._sliderVMouseDown,this)).bind("vclick",!1),this._on(O,{vmousemove:"_preventDocumentDrag"}),this._on(A.add(O),{vmouseup:"_sliderVMouseUp"}),A.insertAfter(u),v||y||(t=this.options.mini?"<div class='ui-slider ui-mini'>":"<div class='ui-slider'>",u.add(A).wrapAll(t)),this._on(this.handle,{vmousedown:"_handleVMouseDown",keydown:"_handleKeydown",keyup:"_handleKeyup"}),this.handle.bind("vclick",!1),this._handleFormReset(),this.refresh(N,N,!0)},_setOptions:function(e){e.theme!==N&&this._setTheme(e.theme),e.trackTheme!==N&&this._setTrackTheme(e.trackTheme),e.corners!==N&&this._setCorners(e.corners),e.mini!==N&&this._setMini(e.mini),e.highlight!==N&&this._setHighlight(e.highlight),e.disabled!==N&&this._setDisabled(e.disabled),this._super(e)},_controlChange:function(e){return!1!==this._trigger("controlchange",e)&&void(this.mouseMoved||this.refresh(this._value(),!0))},_controlKeyup:function(){this.refresh(this._value(),!0,!0)},_controlBlur:function(){this.refresh(this._value(),!0)},_controlVMouseUp:function(){this._checkedRefresh()},_handleVMouseDown:function(){this.handle.focus()},_handleKeydown:function(e){var t=this._value();if(!this.options.disabled){switch(e.keyCode){case k.mobile.keyCode.HOME:case k.mobile.keyCode.END:case k.mobile.keyCode.PAGE_UP:case k.mobile.keyCode.PAGE_DOWN:case k.mobile.keyCode.UP:case k.mobile.keyCode.RIGHT:case k.mobile.keyCode.DOWN:case k.mobile.keyCode.LEFT:e.preventDefault(),this._keySliding||(this._keySliding=!0,this.handle.addClass("ui-state-active"))}switch(e.keyCode){case k.mobile.keyCode.HOME:this.refresh(this.min);break;case k.mobile.keyCode.END:this.refresh(this.max);break;case k.mobile.keyCode.PAGE_UP:case k.mobile.keyCode.UP:case k.mobile.keyCode.RIGHT:this.refresh(t+this.step);break;case k.mobile.keyCode.PAGE_DOWN:case k.mobile.keyCode.DOWN:case k.mobile.keyCode.LEFT:this.refresh(t-this.step)}}},_handleKeyup:function(){this._keySliding&&(this._keySliding=!1,this.handle.removeClass("ui-state-active"))},_sliderVMouseDown:function(e){return this.options.disabled||1!==e.which&&0!==e.which&&e.which!==N||!1===this._trigger("beforestart",e)||(this.dragging=!0,this.userModified=!1,this.mouseMoved=!1,this.isToggleSwitch&&(this.beforeStart=this.element[0].selectedIndex),this.refresh(e),this._trigger("start")),!1},_sliderVMouseUp:function(){return this.dragging?(this.dragging=!1,this.isToggleSwitch&&(this.handle.addClass("ui-slider-handle-snapping"),this.mouseMoved?this.userModified?this.refresh(0===this.beforeStart?1:0):this.refresh(this.beforeStart):this.refresh(0===this.beforeStart?1:0)),this.mouseMoved=!1,this._trigger("stop"),!1):void 0},_preventDocumentDrag:function(e){return!1!==this._trigger("drag",e)&&(this.dragging&&!this.options.disabled?(this.mouseMoved=!0,this.isToggleSwitch&&this.handle.removeClass("ui-slider-handle-snapping"),this.refresh(e),this.userModified=this.beforeStart!==this.element[0].selectedIndex,!1):void 0)},_checkedRefresh:function(){this.value!==this._value()&&this.refresh(this._value())},_value:function(){return this.isToggleSwitch?this.element[0].selectedIndex:parseFloat(this.element.val())},_reset:function(){this.refresh(N,!1,!0)},refresh:function(e,t,i){var n,r,o,a,s,l,c,h,u,d,p,f,m,g,v,y,b,x,w,_,E=this,T=k.mobile.getAttribute(this.element[0],"theme"),M=this.options.theme||T,S=M?" ui-btn-"+M:"",C=this.options.trackTheme||T,R=C?" ui-bar-"+C:" ui-bar-inherit",A=this.options.corners?" ui-corner-all":"",P=this.options.mini?" ui-mini":"";if(E.slider[0].className=[this.isToggleSwitch?"ui-slider ui-slider-switch ui-slider-track ui-shadow-inset":"ui-slider-track ui-shadow-inset",R,A,P].join(""),(this.options.disabled||this.element.prop("disabled"))&&this.disable(),this.value=this._value(),this.options.highlight&&!this.isToggleSwitch&&0===this.slider.find(".ui-slider-bg").length&&(this.valuebg=((_=O.createElement("div")).className="ui-slider-bg "+k.mobile.activeBtnClass,k(_).prependTo(E.slider))),this.handle.addClass("ui-btn"+S+" ui-shadow"),l=this.element,h=(c=!this.isToggleSwitch)?[]:l.find("option"),u=c?parseFloat(l.attr("min")):0,d=c?parseFloat(l.attr("max")):h.length-1,p=c&&0<parseFloat(l.attr("step"))?parseFloat(l.attr("step")):1,"object"==typeof e){if(o=e,n=this.slider.offset().left,a=(r=this.slider.width())/((d-u)/p),!this.dragging||o.pageX<n-8||o.pageX>n+r+8)return;s=1<a?(o.pageX-n)/r*100:Math.round((o.pageX-n)/r*100)}else null==e&&(e=c?parseFloat(l.val()||0):l[0].selectedIndex),s=(parseFloat(e)-u)/(d-u)*100;if(!isNaN(s)&&(g=(f=s/100*(d-u)+u)-(m=(f-u)%p),2*Math.abs(m)>=p&&(g+=0<m?p:-p),v=100/((d-u)/p),f=parseFloat(g.toFixed(5)),void 0===a&&(a=r/((d-u)/p)),1<a&&c&&(s=(f-u)*v*(1/p)),s<0&&(s=0),100<s&&(s=100),f<u&&(f=u),d<f&&(f=d),this.handle.css("left",s+"%"),this.handle[0].setAttribute("aria-valuenow",c?f:h.eq(f).attr("value")),this.handle[0].setAttribute("aria-valuetext",c?f:h.eq(f).getEncodedText()),this.handle[0].setAttribute("title",c?f:h.eq(f).getEncodedText()),this.valuebg&&this.valuebg.css("width",s+"%"),this._labels&&(y=this.handle.width()/this.slider.width()*100,b=s&&y+(100-y)*s/100,x=100===s?0:Math.min(y+100-b,100),this._labels.each(function(){var e=k(this).hasClass("ui-slider-label-a");k(this).width((e?b:x)+"%")})),!i)){if(w=!1,c?(w=l.val()!==f,l.val(f)):(w=l[0].selectedIndex!==f,l[0].selectedIndex=f),!1===this._trigger("beforechange",e))return!1;!t&&w&&l.trigger("change")}},_setHighlight:function(e){(e=!!e)?(this.options.highlight=!!e,this.refresh()):this.valuebg&&(this.valuebg.remove(),this.valuebg=!1)},_setTheme:function(e){this.handle.removeClass("ui-btn-"+this.options.theme).addClass("ui-btn-"+e);var t=this.options.theme?this.options.theme:"inherit",i=e||"inherit";this.control.removeClass("ui-body-"+t).addClass("ui-body-"+i)},_setTrackTheme:function(e){var t=this.options.trackTheme?this.options.trackTheme:"inherit",i=e||"inherit";this.slider.removeClass("ui-body-"+t).addClass("ui-body-"+i)},_setMini:function(e){e=!!e,this.isToggleSwitch||this.isRangeslider||(this.slider.parent().toggleClass("ui-mini",e),this.element.toggleClass("ui-mini",e)),this.slider.toggleClass("ui-mini",e)},_setCorners:function(e){this.slider.toggleClass("ui-corner-all",e),this.isToggleSwitch||this.control.toggleClass("ui-corner-all",e)},_setDisabled:function(e){e=!!e,this.element.prop("disabled",e),this.slider.toggleClass("ui-state-disabled").attr("aria-disabled",e)}},k.mobile.behaviors.formReset)),(I=e).widget("mobile.slider",I.mobile.slider,{options:{popupEnabled:!1,showValue:!1},_create:function(){this._super(),I.extend(this,{_currentValue:null,_popup:null,_popupVisible:!1}),this._setOption("popupEnabled",this.options.popupEnabled),this._on(this.handle,{vmousedown:"_showPopup"}),this._on(this.slider.add(this.document),{vmouseup:"_hidePopup"}),this._refresh()},_positionPopup:function(){var e=this.handle.offset();this._popup.offset({left:e.left+(this.handle.width()-this._popup.width())/2,top:e.top-this._popup.outerHeight()-5})},_setOption:function(e,t){this._super(e,t),"showValue"===e?this.handle.html(t&&!this.options.mini?this._value():""):"popupEnabled"===e&&t&&!this._popup&&(this._popup=(D||(D=I("<div></div>",{class:"ui-slider-popup ui-shadow ui-corner-all"})),D.clone()).addClass("ui-body-"+(this.options.theme||"a")).insertBefore(this.element))},refresh:function(){this._super.apply(this,arguments),this._refresh()},_refresh:function(){var e,t=this.options;t.popupEnabled&&this.handle.removeAttr("title"),(e=this._value())!==this._currentValue&&(this._currentValue=e,t.popupEnabled&&this._popup?(this._positionPopup(),this._popup.html(e)):t.showValue&&!this.options.mini&&this.handle.html(e))},_showPopup:function(){this.options.popupEnabled&&!this._popupVisible&&(this.handle.html(""),this._popup.show(),this._positionPopup(),this._popupVisible=!0)},_hidePopup:function(){var e=this.options;e.popupEnabled&&this._popupVisible&&(e.showValue&&!e.mini&&this.handle.html(this._value()),this._popup.hide(),this._popupVisible=!1)}}),(A=e).widget("mobile.flipswitch",A.extend({options:{onText:"On",offText:"Off",theme:null,enhanced:!1,wrapperClass:null,corners:!0,mini:!1},_create:function(){this.options.enhanced?A.extend(this,{flipswitch:this.element.parent(),on:this.element.find(".ui-flipswitch-on").eq(0),off:this.element.find(".ui-flipswitch-off").eq(0),type:this.element.get(0).tagName}):this._enhance(),this._handleFormReset(),this.element.is(":disabled")&&this._setOptions({disabled:!0}),this._on(this.flipswitch,{click:"_toggle",swipeleft:"_left",swiperight:"_right"}),this._on(this.on,{keydown:"_keydown"}),this._on({change:"refresh"})},widget:function(){return this.flipswitch},_left:function(){this.flipswitch.removeClass("ui-flipswitch-active"),"SELECT"===this.type?this.element.get(0).selectedIndex=0:this.element.prop("checked",!1),this.element.trigger("change")},_right:function(){this.flipswitch.addClass("ui-flipswitch-active"),"SELECT"===this.type?this.element.get(0).selectedIndex=1:this.element.prop("checked",!0),this.element.trigger("change")},_enhance:function(){var e=A("<div>"),t=this.options,i=this.element,n=t.theme?t.theme:"inherit",r=A("<span></span>",{tabindex:1}),o=A("<span></span>"),a=i.get(0).tagName,s="INPUT"===a?t.onText:i.find("option").eq(1).text(),l="INPUT"===a?t.offText:i.find("option").eq(0).text();r.addClass("ui-flipswitch-on ui-btn ui-shadow ui-btn-inherit").text(s),o.addClass("ui-flipswitch-off").text(l),e.addClass("ui-flipswitch ui-shadow-inset ui-bar-"+n+" "+(t.wrapperClass?t.wrapperClass:"")+" "+(i.is(":checked")||i.find("option").eq(1).is(":selected")?"ui-flipswitch-active":"")+(i.is(":disabled")?" ui-state-disabled":"")+(t.corners?" ui-corner-all":"")+(t.mini?" ui-mini":"")).append(r,o),i.addClass("ui-flipswitch-input").after(e).appendTo(e),A.extend(this,{flipswitch:e,on:r,off:o,type:a})},_reset:function(){this.refresh()},refresh:function(){var e,t=this.flipswitch.hasClass("ui-flipswitch-active")?"_right":"_left";(e="SELECT"===this.type?0<this.element.get(0).selectedIndex?"_right":"_left":this.element.prop("checked")?"_right":"_left")!==t&&this[e]()},_toggle:function(){var e=this.flipswitch.hasClass("ui-flipswitch-active")?"_left":"_right";this[e]()},_keydown:function(e){e.which===A.mobile.keyCode.LEFT?this._left():e.which===A.mobile.keyCode.RIGHT?this._right():e.which===A.mobile.keyCode.SPACE&&(this._toggle(),e.preventDefault())},_setOptions:function(e){if(e.theme!==P){var t=e.theme?e.theme:"inherit",i=e.theme?e.theme:"inherit";this.widget().removeClass("ui-bar-"+t).addClass("ui-bar-"+i)}e.onText!==P&&this.on.text(e.onText),e.offText!==P&&this.off.text(e.offText),e.disabled!==P&&this.widget().toggleClass("ui-state-disabled",e.disabled),e.mini!==P&&this.widget().toggleClass("ui-mini",e.mini),e.corners!==P&&this.widget().toggleClass("ui-corner-all",e.corners),this._super(e)},_destroy:function(){this.options.enhanced||(this.on.remove(),this.off.remove(),this.element.unwrap(),this.flipswitch.remove(),this.removeClass("ui-flipswitch-input"))}},A.mobile.behaviors.formReset)),(C=e).widget("mobile.rangeslider",C.extend({options:{theme:null,trackTheme:null,corners:!0,mini:!1,highlight:!0},_create:function(){var e=this.element,t=this.options.mini?"ui-rangeslider ui-mini":"ui-rangeslider",i=e.find("input").first(),n=e.find("input").last(),r=e.find("label").first(),o=C.data(i.get(0),"mobile-slider")||C.data(i.slider().get(0),"mobile-slider"),a=C.data(n.get(0),"mobile-slider")||C.data(n.slider().get(0),"mobile-slider"),s=o.slider,l=a.slider,c=o.handle,h=C("<div class='ui-rangeslider-sliders' />").appendTo(e);i.addClass("ui-rangeslider-first"),n.addClass("ui-rangeslider-last"),e.addClass(t),s.appendTo(h),l.appendTo(h),r.insertBefore(e),c.prependTo(l),C.extend(this,{_inputFirst:i,_inputLast:n,_sliderFirst:s,_sliderLast:l,_label:r,_targetVal:null,_sliderTarget:!1,_sliders:h,_proxy:!1}),this.refresh(),this._on(this.element.find("input.ui-slider-input"),{slidebeforestart:"_slidebeforestart",slidestop:"_slidestop",slidedrag:"_slidedrag",slidebeforechange:"_change",blur:"_change",keyup:"_change"}),this._on({mousedown:"_change"}),this._on(this.element.closest("form"),{reset:"_handleReset"}),this._on(c,{vmousedown:"_dragFirstHandle"})},_handleReset:function(){var e=this;setTimeout(function(){e._updateHighlight()},0)},_dragFirstHandle:function(e){return C.data(this._inputFirst.get(0),"mobile-slider").dragging=!0,C.data(this._inputFirst.get(0),"mobile-slider").refresh(e),!1},_slidedrag:function(e){var t=C(e.target).is(this._inputFirst),i=t?this._inputLast:this._inputFirst;return this._sliderTarget=!1,"first"===this._proxy&&t||"last"===this._proxy&&!t?(C.data(i.get(0),"mobile-slider").dragging=!0,C.data(i.get(0),"mobile-slider").refresh(e),!1):void 0},_slidestop:function(e){var t=C(e.target).is(this._inputFirst);this._proxy=!1,this.element.find("input").trigger("vmouseup"),this._sliderFirst.css("z-index",t?1:"")},_slidebeforestart:function(e){this._sliderTarget=!1,C(e.originalEvent.target).hasClass("ui-slider-track")&&(this._sliderTarget=!0,this._targetVal=C(e.target).val())},_setOptions:function(e){e.theme!==R&&this._setTheme(e.theme),e.trackTheme!==R&&this._setTrackTheme(e.trackTheme),e.mini!==R&&this._setMini(e.mini),e.highlight!==R&&this._setHighlight(e.highlight),this._super(e),this.refresh()},refresh:function(){var e=this.element,t=this.options;(this._inputFirst.is(":disabled")||this._inputLast.is(":disabled"))&&(this.options.disabled=!0),e.find("input").slider({theme:t.theme,trackTheme:t.trackTheme,disabled:t.disabled,corners:t.corners,mini:t.mini,highlight:t.highlight}).slider("refresh"),this._updateHighlight()},_change:function(e){if("keyup"===e.type)return this._updateHighlight(),!1;var t=this,i=parseFloat(this._inputFirst.val(),10),n=parseFloat(this._inputLast.val(),10),r=C(e.target).hasClass("ui-rangeslider-first"),o=r?this._inputFirst:this._inputLast,a=r?this._inputLast:this._inputFirst;if(this._inputFirst.val()>this._inputLast.val()&&"mousedown"===e.type&&!C(e.target).hasClass("ui-slider-handle"))o.blur();else if("mousedown"===e.type)return;return n<i&&!this._sliderTarget?(o.val(r?n:i).slider("refresh"),this._trigger("normalize")):n<i&&(o.val(this._targetVal).slider("refresh"),setTimeout(function(){a.val(r?i:n).slider("refresh"),C.data(a.get(0),"mobile-slider").handle.focus(),t._sliderFirst.css("z-index",r?"":1),t._trigger("normalize")},0),this._proxy=r?"first":"last"),i===n?(C.data(o.get(0),"mobile-slider").handle.css("z-index",1),C.data(a.get(0),"mobile-slider").handle.css("z-index",0)):(C.data(a.get(0),"mobile-slider").handle.css("z-index",""),C.data(o.get(0),"mobile-slider").handle.css("z-index","")),this._updateHighlight(),!(n<=i)&&void 0},_updateHighlight:function(){var e=parseInt(C.data(this._inputFirst.get(0),"mobile-slider").handle.get(0).style.left,10),t=parseInt(C.data(this._inputLast.get(0),"mobile-slider").handle.get(0).style.left,10)-e;this.element.find(".ui-slider-bg").css({"margin-left":e+"%",width:t+"%"})},_setTheme:function(e){this._inputFirst.slider("option","theme",e),this._inputLast.slider("option","theme",e)},_setTrackTheme:function(e){this._inputFirst.slider("option","trackTheme",e),this._inputLast.slider("option","trackTheme",e)},_setMini:function(e){this._inputFirst.slider("option","mini",e),this._inputLast.slider("option","mini",e),this.element.toggleClass("ui-mini",!!e)},_setHighlight:function(e){this._inputFirst.slider("option","highlight",e),this._inputLast.slider("option","highlight",e)},_destroy:function(){this._label.prependTo(this.element),this.element.removeClass("ui-rangeslider ui-mini"),this._inputFirst.after(this._sliderFirst),this._inputLast.after(this._sliderLast),this._sliders.remove(),this.element.find("input").removeClass("ui-rangeslider-first ui-rangeslider-last").slider("destroy")}},C.mobile.behaviors.formReset)),(S=e).widget("mobile.textinput",S.mobile.textinput,{options:{clearBtn:!1,clearBtnText:"Clear text"},_create:function(){this._super(),(this.options.clearBtn||this.isSearch)&&this._addClearBtn()},clearButton:function(){return S("<a href='#' class='ui-input-clear ui-btn ui-icon-delete ui-btn-icon-notext ui-corner-all' title='"+this.options.clearBtnText+"'>"+this.options.clearBtnText+"</a>")},_clearBtnClick:function(e){this.element.val("").focus().trigger("change"),this._clearBtn.addClass("ui-input-clear-hidden"),e.preventDefault()},_addClearBtn:function(){this.options.enhanced||this._enhanceClear(),S.extend(this,{_clearBtn:this.widget().find("a.ui-input-clear")}),this._bindClearEvents(),this._toggleClear()},_enhanceClear:function(){this.clearButton().appendTo(this.widget()),this.widget().addClass("ui-input-has-clear")},_bindClearEvents:function(){this._on(this._clearBtn,{click:"_clearBtnClick"}),this._on({keyup:"_toggleClear",change:"_toggleClear",input:"_toggleClear",focus:"_toggleClear",blur:"_toggleClear",cut:"_toggleClear",paste:"_toggleClear"})},_unbindClear:function(){this._off(this._clearBtn,"click"),this._off(this.element,"keyup change input focus blur cut paste")},_setOptions:function(e){this._super(e),void 0===e.clearbtn||this.element.is("textarea, :jqmData(type='range')")||(e.clearBtn?this._addClearBtn():this._destroyClear()),void 0!==e.clearBtnText&&void 0!==this._clearBtn&&this._clearBtn.text(e.clearBtnText)},_toggleClear:function(){this._delay("_toggleClearClass",0)},_toggleClearClass:function(){this._clearBtn.toggleClass("ui-input-clear-hidden",!this.element.val())},_destroyClear:function(){this.element.removeClass("ui-input-has-clear"),this._unbindClear()._clearBtn.remove()},_destroy:function(){this._super(),this._destroyClear()}}),(M=e).widget("mobile.textinput",M.mobile.textinput,{options:{autogrow:!0,keyupTimeoutBuffer:100},_create:function(){this._super(),this.options.autogrow&&this.isTextarea&&this._autogrow()},_autogrow:function(){this._on({keyup:"_timeout",change:"_timeout",input:"_timeout",paste:"_timeout"}),this._on(!0,this.document,{pageshow:"_handleShow",popupbeforeposition:"_handleShow",updatelayout:"_handleShow",panelopen:"_handleShow"})},_handleShow:function(e){M.contains(e.target,this.element[0])&&this.element.is(":visible")&&("popupbeforeposition"!==e.type&&this.element.addClass("ui-textinput-autogrow-resize").one("transitionend webkitTransitionEnd oTransitionEnd",M.proxy(function(){this.element.removeClass("ui-textinput-autogrow-resize")},this)),this._prepareHeightUpdate())},_unbindAutogrow:function(){this._off(this.element,"keyup change input paste"),this._off(this.document,"pageshow popupbeforeposition updatelayout panelopen")},keyupTimeout:null,_prepareHeightUpdate:function(e){this.keyupTimeout&&clearTimeout(this.keyupTimeout),void 0===e?this._updateHeight():this.keyupTimeout=this._delay("_updateHeight",e)},_timeout:function(){this._prepareHeightUpdate(this.options.keyupTimeoutBuffer)},_updateHeight:function(){this.keyupTimeout=0,this.element.css({height:0,"min-height":0,"max-height":0});var e=this.element[0].scrollHeight,t=this.element[0].clientHeight,i=e+(parseFloat(this.element.css("border-top-width"))+parseFloat(this.element.css("border-bottom-width")))+15;0===t&&(i+=parseFloat(this.element.css("padding-top"))+parseFloat(this.element.css("padding-bottom"))),this.element.css({height:i,"min-height":"","max-height":""})},refresh:function(){this.options.autogrow&&this.isTextarea&&this._updateHeight()},_setOptions:function(e){this._super(e),void 0!==e.autogrow&&this.isTextarea&&(e.autogrow?this._autogrow():this._unbindAutogrow())}}),(E=e).widget("mobile.selectmenu",E.extend({initSelector:"select:not( :jqmData(role='slider')):not( :jqmData(role='flipswitch') )",options:{theme:null,icon:"carat-d",iconpos:"right",inline:!1,corners:!0,shadow:!0,iconshadow:!1,overlayTheme:null,dividerTheme:null,hidePlaceholderMenuItems:!0,closeText:"Close",nativeMenu:!0,preventFocusZoom:/iPhone|iPad|iPod/.test(navigator.platform)&&-1<navigator.userAgent.indexOf("AppleWebKit"),mini:!1},_button:function(){return E("<div/>")},_setDisabled:function(e){return this.element.attr("disabled",e),this.button.attr("aria-disabled",e),this._setOption("disabled",e)},_focusButton:function(){var e=this;setTimeout(function(){e.button.focus()},40)},_selectOptions:function(){return this.select.find("option")},_preExtension:function(){var e=this.options.inline||this.element.jqmData("inline"),t=this.options.mini||this.element.jqmData("mini"),i="";~this.element[0].className.indexOf("ui-btn-left")&&(i=" ui-btn-left"),~this.element[0].className.indexOf("ui-btn-right")&&(i=" ui-btn-right"),e&&(i+=" ui-btn-inline"),t&&(i+=" ui-mini"),this.select=this.element.removeClass("ui-btn-left ui-btn-right").wrap("<div class='ui-select"+i+"'>"),this.selectId=this.select.attr("id")||"select-"+this.uuid,this.buttonId=this.selectId+"-button",this.label=E("label[for='"+this.selectId+"']"),this.isMultiple=this.select[0].multiple},_destroy:function(){var e=this.element.parents(".ui-select");0<e.length&&(e.is(".ui-btn-left, .ui-btn-right")&&this.element.addClass(e.hasClass("ui-btn-left")?"ui-btn-left":"ui-btn-right"),this.element.insertAfter(e),e.remove())},_create:function(){this._preExtension(),this.button=this._button();var e=this,t=this.options,i=!!t.icon&&(t.iconpos||this.select.jqmData("iconpos")),n=this.button.insertBefore(this.select).attr("id",this.buttonId).addClass("ui-btn"+(t.icon?" ui-icon-"+t.icon+" ui-btn-icon-"+i+(t.iconshadow?" ui-shadow-icon":""):"")+(t.theme?" ui-btn-"+t.theme:"")+(t.corners?" ui-corner-all":"")+(t.shadow?" ui-shadow":""));this.setButtonText(),t.nativeMenu&&L.opera&&L.opera.version&&n.addClass("ui-select-nativeonly"),this.isMultiple&&(this.buttonCount=E("<span>").addClass("ui-li-count ui-body-inherit").hide().appendTo(n.addClass("ui-li-has-count"))),(t.disabled||this.element.attr("disabled"))&&this.disable(),this.select.change(function(){e.refresh(),t.nativeMenu&&this.blur()}),this._handleFormReset(),this._on(this.button,{keydown:"_handleKeydown"}),this.build()},build:function(){var e=this;this.select.appendTo(e.button).bind("vmousedown",function(){e.button.addClass(E.mobile.activeBtnClass)}).bind("focus",function(){e.button.addClass(E.mobile.focusClass)}).bind("blur",function(){e.button.removeClass(E.mobile.focusClass)}).bind("focus vmouseover",function(){e.button.trigger("vmouseover")}).bind("vmousemove",function(){e.button.removeClass(E.mobile.activeBtnClass)}).bind("change blur vmouseout",function(){e.button.trigger("vmouseout").removeClass(E.mobile.activeBtnClass)}),e.button.bind("vmousedown",function(){e.options.preventFocusZoom&&E.mobile.zoom.disable(!0)}),e.label.bind("click focus",function(){e.options.preventFocusZoom&&E.mobile.zoom.disable(!0)}),e.select.bind("focus",function(){e.options.preventFocusZoom&&E.mobile.zoom.disable(!0)}),e.button.bind("mouseup",function(){e.options.preventFocusZoom&&setTimeout(function(){E.mobile.zoom.enable(!0)},0)}),e.select.bind("blur",function(){e.options.preventFocusZoom&&E.mobile.zoom.enable(!0)})},selected:function(){return this._selectOptions().filter(":selected")},selectedIndices:function(){var e=this;return this.selected().map(function(){return e._selectOptions().index(this)}).get()},setButtonText:function(){var e=this,t=this.selected(),i=this.placeholder,n=E(O.createElement("span"));this.button.children("span").not(".ui-li-count").remove().end().end().prepend(((i=t.length?t.map(function(){return E(this).text()}).get().join(", "):e.placeholder)?n.text(i):n.html("&nbsp;"),n.addClass(e.select.attr("class")).addClass(t.attr("class")).removeClass("ui-screen-hidden")))},setButtonCount:function(){var e=this.selected();this.isMultiple&&this.buttonCount[1<e.length?"show":"hide"]().text(e.length)},_handleKeydown:function(){this._delay("_refreshButton")},_reset:function(){this.refresh()},_refreshButton:function(){this.setButtonText(),this.setButtonCount()},refresh:function(){this._refreshButton()},open:E.noop,close:E.noop,disable:function(){this._setDisabled(!0),this.button.addClass("ui-state-disabled")},enable:function(){this._setDisabled(!1),this.button.removeClass("ui-state-disabled")}},E.mobile.behaviors.formReset)),(_=e).mobile.links=function(e){_(e).find("a").jqmEnhanceable().filter(":jqmData(rel='popup')[href][href!='']").each(function(){var e=this.getAttribute("href").substring(1);e&&(this.setAttribute("aria-haspopup",!0),this.setAttribute("aria-owns",e),this.setAttribute("aria-expanded",!1))}).end().not(".ui-btn, :jqmData(role='none'), :jqmData(role='nojs')").addClass("ui-link")},function(c,r){function o(e,t,i,n){return e<t?i+(e-t)/2:Math.min(Math.max(i,n-t/2),i+e-t)}function s(e){return{x:e.scrollLeft(),y:e.scrollTop(),cx:e[0].innerWidth||e.width(),cy:e[0].innerHeight||e.height()}}c.widget("mobile.popup",{options:{wrapperClass:null,theme:null,overlayTheme:null,shadow:!0,corners:!0,transition:"none",positionTo:"origin",tolerance:null,closeLinkSelector:"a:jqmData(rel='back')",closeLinkEvents:"click.popup",navigateEvents:"navigate.popup",closeEvents:"navigate.popup pagebeforechange.popup",dismissible:!0,enhanced:!1,history:!c.mobile.browser.oldIE},_create:function(){var e=this.element,t=e.attr("id"),i=this.options;i.history=i.history&&c.mobile.ajaxEnabled&&c.mobile.hashListeningEnabled,c.extend(this,{_scrollTop:0,_page:e.closest(".ui-page"),_ui:null,_fallbackTransition:"",_currentTransition:!1,_prerequisites:null,_isOpen:!1,_tolerance:null,_resizeData:null,_ignoreResizeTo:0,_orientationchangeInProgress:!1}),0===this._page.length&&(this._page=c("body")),i.enhanced?this._ui={container:e.parent(),screen:e.parent().prev(),placeholder:c(this.document[0].getElementById(t+"-placeholder"))}:(this._ui=this._enhance(e,t),this._applyTransition(i.transition)),this._setTolerance(i.tolerance)._ui.focusElement=this._ui.container,this._on(this._ui.screen,{vclick:"_eatEventAndClose"}),this._on(this.window,{orientationchange:c.proxy(this,"_handleWindowOrientationchange"),resize:c.proxy(this,"_handleWindowResize"),keyup:c.proxy(this,"_handleWindowKeyUp")}),this._on(this.document,{focusin:"_handleDocumentFocusIn"})},_enhance:function(e,t){var i=this.options,n=i.wrapperClass,r={screen:c("<div class='ui-screen-hidden ui-popup-screen "+this._themeClassFromOption("ui-overlay-",i.overlayTheme)+"'></div>"),placeholder:c("<div style='display: none;'>\x3c!-- placeholder --\x3e</div>"),container:c("<div class='ui-popup-container ui-popup-hidden ui-popup-truncate"+(n?" "+n:"")+"'></div>")},o=this.document[0].createDocumentFragment();return o.appendChild(r.screen[0]),o.appendChild(r.container[0]),t&&(r.screen.attr("id",t+"-screen"),r.container.attr("id",t+"-popup"),r.placeholder.attr("id",t+"-placeholder").html("\x3c!-- placeholder for "+t+" --\x3e")),this._page[0].appendChild(o),r.placeholder.insertAfter(e),e.detach().addClass("ui-popup "+this._themeClassFromOption("ui-body-",i.theme)+" "+(i.shadow?"ui-overlay-shadow ":"")+(i.corners?"ui-corner-all ":"")).appendTo(r.container),r},_eatEventAndClose:function(e){return e.preventDefault(),e.stopImmediatePropagation(),this.options.dismissible&&this.close(),!1},_resizeScreen:function(){var e=this._ui.screen,t=this._ui.container.outerHeight(!0),i=e.removeAttr("style").height(),n=this.document.height()-1;i<n?e.height(n):i<t&&e.height(t)},_handleWindowKeyUp:function(e){return this._isOpen&&e.keyCode===c.mobile.keyCode.ESCAPE?this._eatEventAndClose(e):void 0},_expectResizeEvent:function(){var e=s(this.window);if(this._resizeData){if(e.x===this._resizeData.windowCoordinates.x&&e.y===this._resizeData.windowCoordinates.y&&e.cx===this._resizeData.windowCoordinates.cx&&e.cy===this._resizeData.windowCoordinates.cy)return!1;clearTimeout(this._resizeData.timeoutId)}return this._resizeData={timeoutId:this._delay("_resizeTimeout",200),windowCoordinates:e},!0},_resizeTimeout:function(){this._isOpen?this._expectResizeEvent()||(this._ui.container.hasClass("ui-popup-hidden")&&(this._ui.container.removeClass("ui-popup-hidden ui-popup-truncate"),this.reposition({positionTo:"window"}),this._ignoreResizeEvents()),this._resizeScreen(),this._resizeData=null,this._orientationchangeInProgress=!1):(this._resizeData=null,this._orientationchangeInProgress=!1)},_stopIgnoringResizeEvents:function(){this._ignoreResizeTo=0},_ignoreResizeEvents:function(){this._ignoreResizeTo&&clearTimeout(this._ignoreResizeTo),this._ignoreResizeTo=this._delay("_stopIgnoringResizeEvents",1e3)},_handleWindowResize:function(){this._isOpen&&0===this._ignoreResizeTo&&(!this._expectResizeEvent()&&!this._orientationchangeInProgress||this._ui.container.hasClass("ui-popup-hidden")||this._ui.container.addClass("ui-popup-hidden ui-popup-truncate").removeAttr("style"))},_handleWindowOrientationchange:function(){!this._orientationchangeInProgress&&this._isOpen&&0===this._ignoreResizeTo&&(this._expectResizeEvent(),this._orientationchangeInProgress=!0)},_handleDocumentFocusIn:function(e){var t,i=e.target,n=this._ui;if(this._isOpen){if(i!==n.container[0]){if(0===(t=c(i)).parents().filter(n.container[0]).length)return c(this.document[0].activeElement).one("focus",function(){t.blur()}),n.focusElement.focus(),e.preventDefault(),e.stopImmediatePropagation(),!1;n.focusElement[0]===n.container[0]&&(n.focusElement=t)}this._ignoreResizeEvents()}},_themeClassFromOption:function(e,t){return t?"none"===t?"":e+t:e+"inherit"},_applyTransition:function(e){return e&&(this._ui.container.removeClass(this._fallbackTransition),"none"!==e&&(this._fallbackTransition=c.mobile._maybeDegradeTransition(e),"none"===this._fallbackTransition&&(this._fallbackTransition=""),this._ui.container.addClass(this._fallbackTransition))),this},_setOptions:function(e){var t=this.options,i=this.element,n=this._ui.screen;return e.wrapperClass!==r&&this._ui.container.removeClass(t.wrapperClass).addClass(e.wrapperClass),e.theme!==r&&i.removeClass(this._themeClassFromOption("ui-body-",t.theme)).addClass(this._themeClassFromOption("ui-body-",e.theme)),e.overlayTheme!==r&&(n.removeClass(this._themeClassFromOption("ui-overlay-",t.overlayTheme)).addClass(this._themeClassFromOption("ui-overlay-",e.overlayTheme)),this._isOpen&&n.addClass("in")),e.shadow!==r&&i.toggleClass("ui-overlay-shadow",e.shadow),e.corners!==r&&i.toggleClass("ui-corner-all",e.corners),e.transition!==r&&(this._currentTransition||this._applyTransition(e.transition)),e.tolerance!==r&&this._setTolerance(e.tolerance),e.disabled!==r&&e.disabled&&this.close(),this._super(e)},_setTolerance:function(e){var i,t={t:30,r:15,b:30,l:15};if(e!==r)switch(i=String(e).split(","),c.each(i,function(e,t){i[e]=parseInt(t,10)}),i.length){case 1:isNaN(i[0])||(t.t=t.r=t.b=t.l=i[0]);break;case 2:isNaN(i[0])||(t.t=t.b=i[0]),isNaN(i[1])||(t.l=t.r=i[1]);break;case 4:isNaN(i[0])||(t.t=i[0]),isNaN(i[1])||(t.r=i[1]),isNaN(i[2])||(t.b=i[2]),isNaN(i[3])||(t.l=i[3])}return this._tolerance=t,this},_clampPopupWidth:function(e){var t=s(this.window),i={x:this._tolerance.l,y:t.y+this._tolerance.t,cx:t.cx-this._tolerance.l-this._tolerance.r,cy:t.cy-this._tolerance.t-this._tolerance.b};return e||this._ui.container.css("max-width",i.cx),{rc:i,menuSize:{cx:this._ui.container.outerWidth(!0),cy:this._ui.container.outerHeight(!0)}}},_calculateFinalLocation:function(e,t){var i,n=t.rc,r=t.menuSize;return(i={left:o(n.cx,r.cx,n.x,e.x),top:o(n.cy,r.cy,n.y,e.y)}).top=Math.max(0,i.top),i.top-=Math.min(i.top,Math.max(0,i.top+r.cy-this.document.height())),i},_placementCoords:function(e){return this._calculateFinalLocation(e,this._clampPopupWidth())},_createPrerequisites:function(e,t,i){var n,r=this;(n={screen:c.Deferred(),container:c.Deferred()}).screen.then(function(){n===r._prerequisites&&e()}),n.container.then(function(){n===r._prerequisites&&t()}),c.when(n.screen,n.container).done(function(){n===r._prerequisites&&(r._prerequisites=null,i())}),r._prerequisites=n},_animate:function(e){return this._ui.screen.removeClass(e.classToRemove).addClass(e.screenClassToAdd),e.prerequisites.screen.resolve(),e.transition&&"none"!==e.transition&&(e.applyTransition&&this._applyTransition(e.transition),this._fallbackTransition)?void this._ui.container.animationComplete(c.proxy(e.prerequisites.container,"resolve")).addClass(e.containerClassToAdd).removeClass(e.classToRemove):(this._ui.container.removeClass(e.classToRemove),void e.prerequisites.container.resolve())},_desiredCoords:function(e){var t,i=null,n=s(this.window),r=e.x,o=e.y,a=e.positionTo;if(a&&"origin"!==a)if("window"===a)r=n.cx/2+n.x,o=n.cy/2+n.y;else{try{i=c(a)}catch(e){i=null}i&&(i.filter(":visible"),0===i.length&&(i=null))}return i&&(r=(t=i.offset()).left+i.outerWidth()/2,o=t.top+i.outerHeight()/2),("number"!==c.type(r)||isNaN(r))&&(r=n.cx/2+n.x),("number"!==c.type(o)||isNaN(o))&&(o=n.cy/2+n.y),{x:r,y:o}},_reposition:function(e){e={x:e.x,y:e.y,positionTo:e.positionTo},this._trigger("beforeposition",r,e),this._ui.container.offset(this._placementCoords(this._desiredCoords(e)))},reposition:function(e){this._isOpen&&this._reposition(e)},_openPrerequisitesComplete:function(){var e=this.element.attr("id");this._ui.container.addClass("ui-popup-active"),this._isOpen=!0,this._resizeScreen(),this._ui.container.attr("tabindex","0").focus(),this._ignoreResizeEvents(),e&&this.document.find("[aria-haspopup='true'][aria-owns='"+e+"']").attr("aria-expanded",!0),this._trigger("afteropen")},_open:function(e){var t,i,n,r,o,a,s=c.extend({},this.options,e),l=(t=navigator.userAgent,i=t.match(/AppleWebKit\/([0-9\.]+)/),n=!!i&&i[1],r=t.match(/Android (\d+(?:\.\d+))/),o=!!r&&r[1],a=-1<t.indexOf("Chrome"),!(!(null!==r&&"4.0"===o&&n&&534.13<n)||a));this._createPrerequisites(c.noop,c.noop,c.proxy(this,"_openPrerequisitesComplete")),this._currentTransition=s.transition,this._applyTransition(s.transition),this._ui.screen.removeClass("ui-screen-hidden"),this._ui.container.removeClass("ui-popup-truncate"),this._reposition(s),this._ui.container.removeClass("ui-popup-hidden"),this.options.overlayTheme&&l&&this.element.closest(".ui-page").addClass("ui-popup-open"),this._animate({additionalCondition:!0,transition:s.transition,classToRemove:"",screenClassToAdd:"in",containerClassToAdd:"in",applyTransition:!1,prerequisites:this._prerequisites})},_closePrerequisiteScreen:function(){this._ui.screen.removeClass("out").addClass("ui-screen-hidden")},_closePrerequisiteContainer:function(){this._ui.container.removeClass("reverse out").addClass("ui-popup-hidden ui-popup-truncate").removeAttr("style")},_closePrerequisitesDone:function(){var e=this._ui.container,t=this.element.attr("id");e.removeAttr("tabindex"),c.mobile.popup.active=r,c(":focus",e[0]).add(e[0]).blur(),t&&this.document.find("[aria-haspopup='true'][aria-owns='"+t+"']").attr("aria-expanded",!1),this._trigger("afterclose")},_close:function(e){this._ui.container.removeClass("ui-popup-active"),this._page.removeClass("ui-popup-open"),this._isOpen=!1,this._createPrerequisites(c.proxy(this,"_closePrerequisiteScreen"),c.proxy(this,"_closePrerequisiteContainer"),c.proxy(this,"_closePrerequisitesDone")),this._animate({additionalCondition:this._ui.screen.hasClass("in"),transition:e?"none":this._currentTransition,classToRemove:"in",screenClassToAdd:"out",containerClassToAdd:"reverse out",applyTransition:!0,prerequisites:this._prerequisites})},_unenhance:function(){this.options.enhanced||(this._setOptions({theme:c.mobile.popup.prototype.options.theme}),this.element.detach().insertAfter(this._ui.placeholder).removeClass("ui-popup ui-overlay-shadow ui-corner-all ui-body-inherit"),this._ui.screen.remove(),this._ui.container.remove(),this._ui.placeholder.remove())},_destroy:function(){return c.mobile.popup.active===this?(this.element.one("popupafterclose",c.proxy(this,"_unenhance")),this.close()):this._unenhance(),this},_closePopup:function(e,t){var i,n,r=this.options,o=!1;e&&e.isDefaultPrevented()||c.mobile.popup.active!==this||(L.scrollTo(0,this._scrollTop),e&&"pagebeforechange"===e.type&&t&&(i="string"==typeof t.toPage?t.toPage:t.toPage.jqmData("url"),n=(i=c.mobile.path.parseUrl(i)).pathname+i.search+i.hash,this._myUrl!==c.mobile.path.makeUrlAbsolute(n)?o=!0:e.preventDefault()),this.window.off(r.closeEvents),this.element.undelegate(r.closeLinkSelector,r.closeLinkEvents),this._close(o))},_bindContainerClose:function(){this.window.on(this.options.closeEvents,c.proxy(this,"_closePopup"))},widget:function(){return this._ui.container},open:function(t){var e,i,n,r,o,a=this,s=this.options;return c.mobile.popup.active||s.disabled||((c.mobile.popup.active=this)._scrollTop=this.window.scrollTop(),s.history?(o=c.mobile.navigate.history,i=c.mobile.dialogHashKey,r=!!(n=c.mobile.activePage)&&n.hasClass("ui-dialog"),this._myUrl=e=o.getActive().url,-1<e.indexOf(i)&&!r&&0<o.activeIndex?(a._open(t),a._bindContainerClose()):(-1!==e.indexOf(i)||r?e=c.mobile.path.parseLocation().hash+i:e+=-1<e.indexOf("#")?i:"#"+i,0===o.activeIndex&&e===o.initialDst&&(e+=i),this.window.one("beforenavigate",function(e){e.preventDefault(),a._open(t),a._bindContainerClose()}),this.urlAltered=!0,c.mobile.navigate(e,{role:"dialog"}))):(a._open(t),a._bindContainerClose(),a.element.delegate(s.closeLinkSelector,s.closeLinkEvents,function(e){a.close(),e.preventDefault()}))),this},close:function(){return c.mobile.popup.active!==this||(this._scrollTop=this.window.scrollTop(),this.options.history&&this.urlAltered?(c.mobile.back(),this.urlAltered=!1):this._closePopup()),this}}),c.mobile.popup.handleLink=function(e){var t,i=c.mobile.path,n=c(i.hashToSelector(i.parseUrl(e.attr("href")).hash)).first();0<n.length&&n.data("mobile-popup")&&(t=e.offset(),n.popup("open",{x:t.left+e.outerWidth()/2,y:t.top+e.outerHeight()/2,transition:e.jqmData("transition"),positionTo:e.jqmData("position-to")})),setTimeout(function(){e.removeClass(c.mobile.activeBtnClass)},300)},c.mobile.document.on("pagebeforechange",function(e,t){"popup"===t.options.role&&(c.mobile.popup.handleLink(t.options.link),e.preventDefault())})}(e),x=".ui-disabled,.ui-state-disabled,.ui-li-divider,.ui-screen-hidden,:jqmData(role='placeholder')",w=function(e,t,i){var n=e[i+"All"]().not(x).first();n.length&&(t.blur().attr("tabindex","-1"),n.find("a").first().focus())},(T=e).widget("mobile.selectmenu",T.mobile.selectmenu,{_create:function(){var e=this.options;return e.nativeMenu=e.nativeMenu||0<this.element.parents(":jqmData(role='popup'),:mobile-popup").length,this._super()},_handleSelectFocus:function(){this.element.blur(),this.button.focus()},_handleKeydown:function(e){this._super(e),this._handleButtonVclickKeydown(e)},_handleButtonVclickKeydown:function(e){this.options.disabled||this.isOpen||("vclick"===e.type||e.keyCode&&(e.keyCode===T.mobile.keyCode.ENTER||e.keyCode===T.mobile.keyCode.SPACE))&&(this._decideFormat(),"overlay"===this.menuType?this.button.attr("href","#"+this.popupId).attr("data-"+(T.mobile.ns||"")+"rel","popup"):this.button.attr("href","#"+this.dialogId).attr("data-"+(T.mobile.ns||"")+"rel","dialog"),this.isOpen=!0)},_handleListFocus:function(e){var t="focusin"===e.type?{tabindex:"0",event:"vmouseover"}:{tabindex:"-1",event:"vmouseout"};T(e.target).attr("tabindex",t.tabindex).trigger(t.event)},_handleListKeydown:function(e){var t=T(e.target),i=t.closest("li");switch(e.keyCode){case 38:return w(i,t,"prev"),!1;case 40:return w(i,t,"next"),!1;case 13:case 32:return t.trigger("click"),!1}},_handleMenuPageHide:function(){this.thisPage.page("bindRemove")},_handleHeaderCloseClick:function(){return"overlay"===this.menuType?(this.close(),!1):void 0},build:function(){var e,t,i,n,r,o,a,s,l,c,h,u,d,p,f,m,g,v=this.options;return v.nativeMenu?this._super():(t=(e=(g=this).selectId)+"-listbox",i=e+"-dialog",n=this.label,r=this.element.closest(".ui-page"),o=this.element[0].multiple,a=e+"-menu",s=v.theme?" data-"+T.mobile.ns+"theme='"+v.theme+"'":"",l=v.overlayTheme?" data-"+T.mobile.ns+"theme='"+v.overlayTheme+"'":"",c=v.dividerTheme&&o?" data-"+T.mobile.ns+"divider-theme='"+v.dividerTheme+"'":"",h=T("<div data-"+T.mobile.ns+"role='dialog' class='ui-selectmenu' id='"+i+"'"+s+l+"><div data-"+T.mobile.ns+"role='header'><div class='ui-title'>"+n.getEncodedText()+"</div></div><div data-"+T.mobile.ns+"role='content'></div></div>"),u=T("<div id='"+t+"' class='ui-selectmenu'>").insertAfter(this.select).popup({theme:v.overlayTheme}),d=T("<ul class='ui-selectmenu-list' id='"+a+"' role='listbox' aria-labelledby='"+this.buttonId+"'"+s+c+">").appendTo(u),p=T("<div class='ui-header ui-bar-"+(v.theme?v.theme:"inherit")+"'>").prependTo(u),f=T("<h1 class='ui-title'>").appendTo(p),this.isMultiple&&(m=T("<a>",{role:"button",text:v.closeText,href:"#",class:"ui-btn ui-corner-all ui-btn-left ui-btn-icon-notext ui-icon-delete"}).appendTo(p)),T.extend(this,{selectId:e,menuId:a,popupId:t,dialogId:i,thisPage:r,menuPage:h,label:n,isMultiple:o,theme:v.theme,listbox:u,list:d,header:p,headerTitle:f,headerClose:m,menuPageContent:void 0,menuPageClose:void 0,placeholder:""}),this.refresh(),void 0===this._origTabIndex&&(this._origTabIndex=null!==this.select[0].getAttribute("tabindex")&&this.select.attr("tabindex")),this.select.attr("tabindex","-1"),this._on(this.select,{focus:"_handleSelectFocus"}),this._on(this.button,{vclick:"_handleButtonVclickKeydown"}),this.list.attr("role","listbox"),this._on(this.list,{focusin:"_handleListFocus",focusout:"_handleListFocus",keydown:"_handleListKeydown"}),this.list.delegate("li:not(.ui-disabled,.ui-state-disabled,.ui-li-divider)","click",function(e){var t=g.select[0].selectedIndex,i=T.mobile.getAttribute(this,"option-index"),n=g._selectOptions().eq(i)[0];n.selected=!g.isMultiple||!n.selected,g.isMultiple&&T(this).find("a").toggleClass("ui-checkbox-on",n.selected).toggleClass("ui-checkbox-off",!n.selected),(g.isMultiple||t!==i)&&g.select.trigger("change"),g.isMultiple?g.list.find("li:not(.ui-li-divider)").eq(i).find("a").first().focus():g.close(),e.preventDefault()}),this._on(this.menuPage,{pagehide:"_handleMenuPageHide"}),this._on(this.listbox,{popupafterclose:"close"}),this.isMultiple&&this._on(this.headerClose,{click:"_handleHeaderCloseClick"}),this)},_isRebuildRequired:function(){var e=this.list.find("li");return this._selectOptions().not(".ui-screen-hidden").text()!==e.text()},selected:function(){return this._selectOptions().filter(":selected:not( :jqmData(placeholder='true') )")},refresh:function(e){var i,n;return this.options.nativeMenu?this._super(e):(i=this,(e||this._isRebuildRequired())&&i._buildList(),n=this.selectedIndices(),i.setButtonText(),i.setButtonCount(),void i.list.find("li:not(.ui-li-divider)").find("a").removeClass(T.mobile.activeBtnClass).end().attr("aria-selected",!1).each(function(e){if(-1<T.inArray(e,n)){var t=T(this);t.attr("aria-selected",!0),i.isMultiple?t.find("a").removeClass("ui-checkbox-off").addClass("ui-checkbox-on"):t.hasClass("ui-screen-hidden")?t.next().find("a").addClass(T.mobile.activeBtnClass):t.find("a").addClass(T.mobile.activeBtnClass)}}))},close:function(){!this.options.disabled&&this.isOpen&&("page"===this.menuType?(this.menuPage.dialog("close"),this.list.appendTo(this.listbox)):this.listbox.popup("close"),this._focusButton(),this.isOpen=!1)},open:function(){this.button.click()},_focusMenuItem:function(){var e=this.list.find("a."+T.mobile.activeBtnClass);0===e.length&&(e=this.list.find("li:not("+x+") a.ui-btn")),e.first().focus()},_decideFormat:function(){var e=this,t=this.window,i=e.list.parent().outerHeight(),n=t.scrollTop(),r=e.button.offset().top,o=t.height();o-80<i||!T.support.scrollTop?(e.menuPage.appendTo(T.mobile.pageContainer).page(),e.menuPageContent=e.menuPage.find(".ui-content"),e.menuPageClose=e.menuPage.find(".ui-header a"),e.thisPage.unbind("pagehide.remove"),0===n&&o<r&&e.thisPage.one("pagehide",function(){T(this).jqmData("lastScroll",r)}),e.menuPage.one({pageshow:T.proxy(this,"_focusMenuItem"),pagehide:T.proxy(this,"close")}),e.menuType="page",e.menuPageContent.append(e.list),e.menuPage.find("div .ui-title").text(e.label.text())):(e.menuType="overlay",e.listbox.one({popupafteropen:T.proxy(this,"_focusMenuItem")}))},_buildList:function(){var e,t,i,n,r,o,a,s,l,c,h,u,d,p,f=this.options,m=this.placeholder,g=!0,v="data-"+T.mobile.ns,y=v+"option-index",b=v+"icon",x=v+"role",w=v+"placeholder",_=O.createDocumentFragment(),E=!1;for(this.list.empty().filter(".ui-listview").listview("destroy"),t=(e=this._selectOptions()).length,i=this.select[0],r=0;r<t;r++,E=!1)o=e[r],(a=T(o)).hasClass("ui-screen-hidden")||(s=o.parentNode,l=a.text(),h=[],(c=O.createElement("a")).setAttribute("href","#"),c.appendChild(O.createTextNode(l)),s!==i&&"optgroup"===s.nodeName.toLowerCase()&&(u=s.getAttribute("label"))!==n&&((d=O.createElement("li")).setAttribute(x,"list-divider"),d.setAttribute("role","option"),d.setAttribute("tabindex","-1"),d.appendChild(O.createTextNode(u)),_.appendChild(d),n=u),!g||o.getAttribute("value")&&0!==l.length&&!a.jqmData("placeholder")||(E=!(g=!1),null===o.getAttribute(w)&&(this._removePlaceholderAttr=!0),o.setAttribute(w,!0),f.hidePlaceholderMenuItems&&h.push("ui-screen-hidden"),m!==l&&(m=this.placeholder=l)),p=O.createElement("li"),o.disabled&&(h.push("ui-state-disabled"),p.setAttribute("aria-disabled",!0)),p.setAttribute(y,r),p.setAttribute(b,"false"),E&&p.setAttribute(w,!0),p.className=h.join(" "),p.setAttribute("role","option"),c.setAttribute("tabindex","-1"),this.isMultiple&&T(c).addClass("ui-btn ui-checkbox-off ui-btn-icon-right"),p.appendChild(c),_.appendChild(p));this.list[0].appendChild(_),this.isMultiple||m.length?this.headerTitle.text(this.placeholder):this.header.addClass("ui-screen-hidden"),this.list.listview()},_button:function(){return this.options.nativeMenu?this._super():T("<a>",{href:"#",role:"button",id:this.buttonId,"aria-haspopup":"true","aria-owns":this.menuId})},_destroy:function(){this.options.nativeMenu||(this.close(),void 0!==this._origTabIndex&&(!1!==this._origTabIndex?this.select.attr("tabindex",this._origTabIndex):this.select.removeAttr("tabindex")),this._removePlaceholderAttr&&this._selectOptions().removeAttr("data-"+T.mobile.ns+"placeholder"),this.listbox.remove(),this.menuPage.remove()),this._super()}}),function(u,d){function p(e){var t,i,n,r=!1,o=!0,a={icon:"",inline:!1,shadow:!1,corners:!1,iconshadow:!1,mini:!1},s=[];for(e=e.split(" "),t=0;t<e.length;t++)n=!0,(i=l[e[t]])!==d?(n=!1,a[i]=!0):0===e[t].indexOf("ui-btn-icon-")?(o=n=!1,a.iconpos=e[t].substring(12)):0===e[t].indexOf("ui-icon-")?(n=!1,a.icon=e[t].substring(8)):0===e[t].indexOf("ui-btn-")&&8===e[t].length?(n=!1,a.theme=e[t].substring(7)):"ui-btn"===e[t]&&(r=!(n=!1)),n&&s.push(e[t]);return o&&(a.icon=""),{options:a,unknownClasses:s,alreadyEnhanced:r}}function f(e){return"-"+e.toLowerCase()}var l={"ui-shadow":"shadow","ui-corner-all":"corners","ui-btn-inline":"inline","ui-shadow-icon":"iconshadow","ui-mini":"mini"},m=function(){var e=u.mobile.getAttribute.apply(this,arguments);return null==e?d:e},g=/[A-Z]/g;u.fn.buttonMarkup=function(e,t){var i,n,r,o,a,s,l,c,h=u.fn.buttonMarkup.defaults;for(i=0;i<this.length;i++){if(r=this[i],n=t?{alreadyEnhanced:!1,unknownClasses:[]}:p(r.className),o=u.extend({},n.alreadyEnhanced?n.options:{},e),!n.alreadyEnhanced)for(a in h)o[a]===d&&(o[a]=m(r,a.replace(g,f)));r.className=(s=u.extend({},h,o),l=n.unknownClasses,c=void 0,c=l||[],c.push("ui-btn"),s.theme&&c.push("ui-btn-"+s.theme),s.icon&&(c=c.concat(["ui-icon-"+s.icon,"ui-btn-icon-"+s.iconpos]),s.iconshadow&&c.push("ui-shadow-icon")),s.inline&&c.push("ui-btn-inline"),s.shadow&&c.push("ui-shadow"),s.corners&&c.push("ui-corner-all"),s.mini&&c.push("ui-mini"),c).join(" "),"button"!==r.tagName.toLowerCase()&&r.setAttribute("role","button")}return this},u.fn.buttonMarkup.defaults={icon:"",iconpos:"left",theme:null,inline:!1,shadow:!0,corners:!0,iconshadow:!1,mini:!1},u.extend(u.fn.buttonMarkup,{initSelector:"a:jqmData(role='button'), .ui-bar > a, .ui-bar > :jqmData(role='controlgroup') > a, button"})}(e),(y=e).widget("mobile.controlgroup",y.extend({options:{enhanced:!1,theme:null,shadow:!1,corners:!0,excludeInvisible:!0,type:"vertical",mini:!1},_create:function(){var e=this.element,t=this.options;y.fn.buttonMarkup&&this.element.find(y.fn.buttonMarkup.initSelector).buttonMarkup(),y.each(this._childWidgets,y.proxy(function(e,t){y.mobile[t]&&this.element.find(y.mobile[t].initSelector).not(y.mobile.page.prototype.keepNativeSelector())[t]()},this)),y.extend(this,{_ui:null,_initialRefresh:!0}),this._ui=t.enhanced?{groupLegend:e.children(".ui-controlgroup-label").children(),childWrapper:e.children(".ui-controlgroup-controls")}:this._enhance()},_childWidgets:["checkboxradio","selectmenu","button"],_themeClassFromOption:function(e){return e?"none"===e?"":"ui-group-theme-"+e:""},_enhance:function(){var e=this.element,t=this.options,i={groupLegend:e.children("legend"),childWrapper:e.addClass("ui-controlgroup ui-controlgroup-"+("horizontal"===t.type?"horizontal":"vertical")+" "+this._themeClassFromOption(t.theme)+" "+(t.corners?"ui-corner-all ":"")+(t.mini?"ui-mini ":"")).wrapInner("<div class='ui-controlgroup-controls "+(!0===t.shadow?"ui-shadow":"")+"'></div>").children()};return 0<i.groupLegend.length&&y("<div role='heading' class='ui-controlgroup-label'></div>").append(i.groupLegend).prependTo(e),i},_init:function(){this.refresh()},_setOptions:function(e){var t,i,n=this.element;return e.type!==b&&(n.removeClass("ui-controlgroup-horizontal ui-controlgroup-vertical").addClass("ui-controlgroup-"+("horizontal"===e.type?"horizontal":"vertical")),t=!0),e.theme!==b&&n.removeClass(this._themeClassFromOption(this.options.theme)).addClass(this._themeClassFromOption(e.theme)),e.corners!==b&&n.toggleClass("ui-corner-all",e.corners),e.mini!==b&&n.toggleClass("ui-mini",e.mini),e.shadow!==b&&this._ui.childWrapper.toggleClass("ui-shadow",e.shadow),e.excludeInvisible!==b&&(this.options.excludeInvisible=e.excludeInvisible,t=!0),i=this._super(e),t&&this.refresh(),i},container:function(){return this._ui.childWrapper},refresh:function(){var e=this.container(),t=e.find(".ui-btn").not(".ui-slider-handle"),i=this._initialRefresh;y.mobile.checkboxradio&&e.find(":mobile-checkboxradio").checkboxradio("refresh"),this._addFirstLastClasses(t,this.options.excludeInvisible?this._getVisibles(t,i):t,i),this._initialRefresh=!1},_destroy:function(){var e,t,i=this.options;return i.enhanced?this:(e=this._ui,t=this.element.removeClass("ui-controlgroup ui-controlgroup-horizontal ui-controlgroup-vertical ui-corner-all ui-mini "+this._themeClassFromOption(i.theme)).find(".ui-btn").not(".ui-slider-handle"),this._removeFirstLastClasses(t),e.groupLegend.unwrap(),void e.childWrapper.children().unwrap())}},y.mobile.behaviors.addFirstLastClasses)),(v=e).widget("mobile.toolbar",{initSelector:":jqmData(role='footer'), :jqmData(role='header')",options:{theme:null,addBackBtn:!1,backBtnTheme:null,backBtnText:"Back"},_create:function(){var e=this.element.is(":jqmData(role='header')")?"header":"footer",t=this.element.closest(".ui-page");0===t.length&&(t=!1,this._on(this.document,{pageshow:"refresh"})),v.extend(this,{role:e,page:t,leftbtn:void 0,rightbtn:void 0,backBtn:null}),this.element.attr("role","header"===e?"banner":"contentinfo").addClass("ui-"+e),this.refresh(),this._setOptions(this.options)},_setOptions:function(e){if(void 0!==e.addBackBtn&&(this.options.addBackBtn&&"header"===this.role&&1<v(".ui-page").length&&this.page[0].getAttribute("data-"+v.mobile.ns+"url")!==v.mobile.path.stripHash(location.hash)&&!this.leftbtn?this._addBackButton():this.element.find(".ui-toolbar-back-btn").remove()),null!=e.backBtnTheme&&this.element.find(".ui-toolbar-back-btn").addClass("ui-btn ui-btn-"+e.backBtnTheme),void 0!==e.backBtnText&&this.element.find(".ui-toolbar-back-btn .ui-btn-text").text(e.backBtnText),void 0!==e.theme){var t=this.options.theme?this.options.theme:"inherit",i=e.theme?e.theme:"inherit";this.element.removeClass("ui-bar-"+t).addClass("ui-bar-"+i)}this._super(e)},refresh:function(){"header"===this.role&&this._addHeaderButtonClasses(),this.page||(this._setRelative(),"footer"===this.role&&this.element.appendTo("body")),this._addHeadingClasses(),this._btnMarkup()},_setRelative:function(){v("[data-"+v.mobile.ns+"role='page']").css({position:"relative"})},_btnMarkup:function(){this.element.children("a").attr("data-"+v.mobile.ns+"role","button"),this.element.trigger("create")},_addHeaderButtonClasses:function(){var e=this.element.children("a, button");this.leftbtn=e.hasClass("ui-btn-left"),this.rightbtn=e.hasClass("ui-btn-right"),this.leftbtn=this.leftbtn||e.eq(0).not(".ui-btn-right").addClass("ui-btn-left").length,this.rightbtn=this.rightbtn||e.eq(1).addClass("ui-btn-right").length},_addBackButton:function(){var e,t=this.options;this.backBtn||(e=t.backBtnTheme||t.theme,this.backBtn=v("<a role='button' href='javascript:void(0);' class='ui-btn ui-corner-all ui-shadow ui-btn-left "+(e?"ui-btn-"+e+" ":"")+"ui-toolbar-back-btn ui-icon-carat-l ui-btn-icon-left' data-"+v.mobile.ns+"rel='back'>"+t.backBtnText+"</a>").prependTo(this.element))},_addHeadingClasses:function(){this.element.children("h1, h2, h3, h4, h5, h6").addClass("ui-title").attr({role:"heading","aria-level":"1"})}}),(g=e).widget("mobile.toolbar",g.mobile.toolbar,{options:{position:null,visibleOnPageShow:!0,disablePageZoom:!0,transition:"slide",fullscreen:!1,tapToggle:!0,tapToggleBlacklist:"a, button, input, select, textarea, .ui-header-fixed, .ui-footer-fixed, .ui-flipswitch, .ui-popup, .ui-panel, .ui-panel-dismiss-open",hideDuringFocus:"input, textarea, select",updatePagePadding:!0,trackPersistentToolbars:!0,supportBlacklist:function(){return!g.support.fixedPosition}},_create:function(){this._super(),"fixed"!==this.options.position||this.options.supportBlacklist()||this._makeFixed()},_makeFixed:function(){this.element.addClass("ui-"+this.role+"-fixed"),this.updatePagePadding(),this._addTransitionClass(),this._bindPageEvents(),this._bindToggleHandlers(),this._setOptions(this.options)},_setOptions:function(e){if("fixed"===e.position&&"fixed"!==this.options.position&&this._makeFixed(),"fixed"===this.options.position&&!this.options.supportBlacklist()){var t=this.page?this.page:0<g(".ui-page-active").length?g(".ui-page-active"):g(".ui-page").eq(0);void 0!==e.fullscreen&&(e.fullscreen?(this.element.addClass("ui-"+this.role+"-fullscreen"),t.addClass("ui-page-"+this.role+"-fullscreen")):(this.element.removeClass("ui-"+this.role+"-fullscreen"),t.removeClass("ui-page-"+this.role+"-fullscreen").addClass("ui-page-"+this.role+"-fixed")))}this._super(e)},_addTransitionClass:function(){var e=this.options.transition;e&&"none"!==e&&("slide"===e&&(e=this.element.hasClass("ui-header")?"slidedown":"slideup"),this.element.addClass(e))},_bindPageEvents:function(){var e=this.page?this.element.closest(".ui-page"):this.document;this._on(e,{pagebeforeshow:"_handlePageBeforeShow",webkitAnimationStart:"_handleAnimationStart",animationstart:"_handleAnimationStart",updatelayout:"_handleAnimationStart",pageshow:"_handlePageShow",pagebeforehide:"_handlePageBeforeHide"})},_handlePageBeforeShow:function(){var e=this.options;e.disablePageZoom&&g.mobile.zoom.disable(!0),e.visibleOnPageShow||this.hide(!0)},_handleAnimationStart:function(){this.options.updatePagePadding&&this.updatePagePadding(this.page?this.page:".ui-page-active")},_handlePageShow:function(){this.updatePagePadding(this.page?this.page:".ui-page-active"),this.options.updatePagePadding&&this._on(this.window,{throttledresize:"updatePagePadding"})},_handlePageBeforeHide:function(e,t){var i,n,r,o,a=this.options;a.disablePageZoom&&g.mobile.zoom.enable(!0),a.updatePagePadding&&this._off(this.window,"throttledresize"),a.trackPersistentToolbars&&(i=g(".ui-footer-fixed:jqmData(id)",this.page),n=g(".ui-header-fixed:jqmData(id)",this.page),r=i.length&&t.nextPage&&g(".ui-footer-fixed:jqmData(id='"+i.jqmData("id")+"')",t.nextPage)||g(),o=n.length&&t.nextPage&&g(".ui-header-fixed:jqmData(id='"+n.jqmData("id")+"')",t.nextPage)||g(),(r.length||o.length)&&(r.add(o).appendTo(g.mobile.pageContainer),t.nextPage.one("pageshow",function(){o.prependTo(this),r.appendTo(this)})))},_visible:!0,updatePagePadding:function(e){var t=this.element,i="header"===this.role,n=parseFloat(t.css(i?"top":"bottom"));this.options.fullscreen||(e=e&&void 0===e.type&&e||this.page||t.closest(".ui-page"),e=this.page?this.page:".ui-page-active",g(e).css("padding-"+(i?"top":"bottom"),t.outerHeight()+n))},_useTransition:function(e){var t=this.window,i=this.element,n=t.scrollTop(),r=i.height(),o=this.page?i.closest(".ui-page").height():g(".ui-page-active").height(),a=g.mobile.getScreenHeight();return!e&&(this.options.transition&&"none"!==this.options.transition&&("header"===this.role&&!this.options.fullscreen&&r<n||"footer"===this.role&&!this.options.fullscreen&&n+a<o-r)||this.options.fullscreen)},show:function(e){var t="ui-fixed-hidden",i=this.element;this._useTransition(e)?i.removeClass("out "+t).addClass("in").animationComplete(function(){i.removeClass("in")}):i.removeClass(t),this._visible=!0},hide:function(e){var t="ui-fixed-hidden",i=this.element,n="out"+("slide"===this.options.transition?" reverse":"");this._useTransition(e)?i.addClass(n).removeClass("in").animationComplete(function(){i.addClass(t).removeClass(n)}):i.addClass(t).removeClass(n),this._visible=!1},toggle:function(){this[this._visible?"hide":"show"]()},_bindToggleHandlers:function(){var t,i,n=this,r=n.options,o=!0;(this.page?this.page:g(".ui-page")).bind("vclick",function(e){r.tapToggle&&!g(e.target).closest(r.tapToggleBlacklist).length&&n.toggle()}).bind("focusin focusout",function(e){screen.width<1025&&g(e.target).is(r.hideDuringFocus)&&!g(e.target).closest(".ui-header-fixed, .ui-footer-fixed").length&&("focusout"!==e.type||o?"focusin"===e.type&&o&&(clearTimeout(t),o=!1,i=setTimeout(function(){n.hide()},0)):(o=!0,clearTimeout(i),t=setTimeout(function(){n.show()},0)))})},_setRelative:function(){"fixed"!==this.options.position&&g("[data-"+g.mobile.ns+"role='page']").css({position:"relative"})},_destroy:function(){var e=this.element,t=e.hasClass("ui-header");e.closest(".ui-page").css("padding-"+(t?"top":"bottom"),""),e.removeClass("ui-header-fixed ui-footer-fixed ui-header-fullscreen ui-footer-fullscreen in out fade slidedown slideup ui-fixed-hidden"),e.closest(".ui-page").removeClass("ui-page-header-fixed ui-page-footer-fixed ui-page-header-fullscreen ui-page-footer-fullscreen")}}),(t=e).widget("mobile.toolbar",t.mobile.toolbar,{_makeFixed:function(){this._super(),this._workarounds()},_workarounds:function(){var e=navigator.userAgent,t=navigator.platform,i=e.match(/AppleWebKit\/([0-9]+)/),n=!!i&&i[1],r=null;if(-1<t.indexOf("iPhone")||-1<t.indexOf("iPad")||-1<t.indexOf("iPod"))r="ios";else{if(!(-1<e.indexOf("Android")))return;r="android"}if("ios"===r)this._bindScrollWorkaround();else{if(!("android"===r&&n&&n<534))return;this._bindScrollWorkaround(),this._bindListThumbWorkaround()}},_viewportOffset:function(){var e=this.element,t=e.hasClass("ui-header"),i=Math.abs(e.offset().top-this.window.scrollTop());return t||(i=Math.round(i-this.window.height()+e.outerHeight())-60),i},_bindScrollWorkaround:function(){var e=this;this._on(this.window,{scrollstop:function(){2<e._viewportOffset()&&e._visible&&e._triggerRedraw()}})},_bindListThumbWorkaround:function(){this.element.closest(".ui-page").addClass("ui-android-2x-fixed")},_triggerRedraw:function(){var e=parseFloat(t(".ui-page-active").css("padding-bottom"));t(".ui-page-active").css("padding-bottom",e+1+"px"),setTimeout(function(){t(".ui-page-active").css("padding-bottom",e+"px")},0)},destroy:function(){this._super(),this.element.closest(".ui-page-active").removeClass("ui-android-2x-fix")}}),p=(d=e).mobile.browser.oldIE&&d.mobile.browser.oldIE<=8,f=d("<div class='ui-popup-arrow-guide'></div><div class='ui-popup-arrow-container"+(p?" ie":"")+"'><div class='ui-popup-arrow'><div class='ui-popup-arrow-background'></div></div></div>"),m=Math.sqrt(2)/2,d.widget("mobile.popup",d.mobile.popup,{options:{arrow:""},_create:function(){var e=this._super();return this.options.arrow&&(this._ui.arrow=this._addArrow()),e},_addArrow:function(){var e,t,i,n,r,o,a=this.options,s=(t=f.clone(),i=t.eq(0),n=t.eq(1),r=n.children(),o=r.children(),{arEls:n.add(i),gd:i,ct:n,ar:r,bg:o});return e=this._themeClassFromOption("ui-body-",a.theme),s.ar.addClass(e+(a.shadow?" ui-overlay-shadow":"")),s.bg.addClass(e),s.arEls.hide().appendTo(this.element),s},_unenhance:function(){var e=this._ui.arrow;return e&&e.arEls.remove(),this._super()},_tryAnArrow:function(e,t,i,n,r){var o,a,s,l={},c={};return n.arFull[e.dimKey]>n.guideDims[e.dimKey]||(l[e.fst]=i[e.fst]+(n.arHalf[e.oDimKey]+n.menuHalf[e.oDimKey])*e.offsetFactor-n.contentBox[e.fst]+(n.clampInfo.menuSize[e.oDimKey]-n.contentBox[e.oDimKey])*e.arrowOffsetFactor,l[e.snd]=i[e.snd],a={x:(o=n.result||this._calculateFinalLocation(l,n.clampInfo)).left,y:o.top},c[e.fst]=a[e.fst]+n.contentBox[e.fst]+e.tipOffset,c[e.snd]=Math.max(o[e.prop]+n.guideOffset[e.prop]+n.arHalf[e.dimKey],Math.min(o[e.prop]+n.guideOffset[e.prop]+n.guideDims[e.dimKey]-n.arHalf[e.dimKey],i[e.snd])),s=Math.abs(i.x-c.x)+Math.abs(i.y-c.y),(!r||s<r.diff)&&(c[e.snd]-=n.arHalf[e.dimKey]+o[e.prop]+n.contentBox[e.snd],r={dir:t,diff:s,result:o,posProp:e.prop,posVal:c[e.snd]})),r},_getPlacementState:function(e){var t,i,n=this._ui.arrow,r={clampInfo:this._clampPopupWidth(!e),arFull:{cx:n.ct.width(),cy:n.ct.height()},guideDims:{cx:n.gd.width(),cy:n.gd.height()},guideOffset:n.gd.offset()};return t=this.element.offset(),n.gd.css({left:0,top:0,right:0,bottom:0}),i=n.gd.offset(),r.contentBox={x:i.left-t.left,y:i.top-t.top,cx:n.gd.width(),cy:n.gd.height()},n.gd.removeAttr("style"),r.guideOffset={left:r.guideOffset.left-t.left,top:r.guideOffset.top-t.top},r.arHalf={cx:r.arFull.cx/2,cy:r.arFull.cy/2},r.menuHalf={cx:r.clampInfo.menuSize.cx/2,cy:r.clampInfo.menuSize.cy/2},r},_placementCoords:function(i){var n,r,o,e,t,a,s,l=this.options.arrow,c=this._ui.arrow;return c?(c.arEls.show(),s={},n=this._getPlacementState(!0),o={l:{fst:"x",snd:"y",prop:"top",dimKey:"cy",oDimKey:"cx",offsetFactor:1,tipOffset:-n.arHalf.cx,arrowOffsetFactor:0},r:{fst:"x",snd:"y",prop:"top",dimKey:"cy",oDimKey:"cx",offsetFactor:-1,tipOffset:n.arHalf.cx+n.contentBox.cx,arrowOffsetFactor:1},b:{fst:"y",snd:"x",prop:"left",dimKey:"cx",oDimKey:"cy",offsetFactor:-1,tipOffset:n.arHalf.cy+n.contentBox.cy,arrowOffsetFactor:1},t:{fst:"y",snd:"x",prop:"left",dimKey:"cx",oDimKey:"cy",offsetFactor:1,tipOffset:-n.arHalf.cy,arrowOffsetFactor:0}},d.each((!0===l?"l,t,r,b":l).split(","),d.proxy(function(e,t){r=this._tryAnArrow(o[t],t,i,n,r)},this)),r?(c.ct.removeClass("ui-popup-arrow-l ui-popup-arrow-t ui-popup-arrow-r ui-popup-arrow-b").addClass("ui-popup-arrow-"+r.dir).removeAttr("style").css(r.posProp,r.posVal).show(),p||(t=this.element.offset(),s[o[r.dir].fst]=c.ct.offset(),s[o[r.dir].snd]={left:t.left+n.contentBox.x,top:t.top+n.contentBox.y},e=c.bg.removeAttr("style").css("cx"===o[r.dir].dimKey?"width":"height",n.contentBox[o[r.dir].dimKey]).offset(),a={dx:s.x.left-e.left,dy:s.y.top-e.top},c.bg.css({left:m*a.dy+m*a.dx,top:m*a.dy-m*a.dx})),r.result):(c.arEls.hide(),this._super(i))):this._super(i)},_setOptions:function(e){var t,i=this.options.theme,n=this._ui.arrow,r=this._super(e);if(void 0!==e.arrow){if(!n&&e.arrow)return void(this._ui.arrow=this._addArrow());n&&!e.arrow&&(n.arEls.remove(),this._ui.arrow=null)}return(n=this._ui.arrow)&&(void 0!==e.theme&&(i=this._themeClassFromOption("ui-body-",i),t=this._themeClassFromOption("ui-body-",e.theme),n.ar.removeClass(i).addClass(t),n.bg.removeClass(i).addClass(t)),void 0!==e.shadow&&n.ar.toggleClass("ui-overlay-shadow",e.shadow)),r},_destroy:function(){var e=this._ui.arrow;return e&&e.arEls.remove(),this._super()}}),(s=e).widget("mobile.panel",{options:{classes:{panel:"ui-panel",panelOpen:"ui-panel-open",panelClosed:"ui-panel-closed",panelFixed:"ui-panel-fixed",panelInner:"ui-panel-inner",modal:"ui-panel-dismiss",modalOpen:"ui-panel-dismiss-open",pageContainer:"ui-panel-page-container",pageWrapper:"ui-panel-wrapper",pageFixedToolbar:"ui-panel-fixed-toolbar",pageContentPrefix:"ui-panel-page-content",animate:"ui-panel-animate"},animate:!0,theme:null,position:"left",dismissible:!0,display:"reveal",swipeClose:!0,positionFixed:!1},_panelID:null,_closeLink:null,_parentPage:null,_page:null,_modal:null,_panelInner:null,_wrapper:null,_fixedToolbars:null,_create:function(){var e=this.element,t=e.closest(":jqmData(role='page')");s.extend(this,{_panelID:e.attr("id"),_closeLink:e.find(":jqmData(rel='close')"),_parentPage:0<t.length&&t,_page:this._getPage,_panelInner:this._getPanelInner(),_wrapper:this._getWrapper,_fixedToolbars:this._getFixedToolbars}),this._addPanelClasses(),s.support.cssTransform3d&&this.options.animate&&this.element.addClass(this.options.classes.animate),this._bindUpdateLayout(),this._bindCloseEvents(),this._bindLinkListeners(),this._bindPageEvents(),this.options.dismissible&&this._createModal(),this._bindSwipeEvents()},_getPanelInner:function(){var e=this.element.find("."+this.options.classes.panelInner);return 0===e.length&&(e=this.element.children().wrapAll("<div class='"+this.options.classes.panelInner+"' />").parent()),e},_createModal:function(){var e=this,t=e._parentPage?e._parentPage.parent():e.element.parent();e._modal=s("<div class='"+e.options.classes.modal+"' data-panelid='"+e._panelID+"'></div>").on("mousedown",function(){e.close()}).appendTo(t)},_getPage:function(){return this._parentPage?this._parentPage:s("."+s.mobile.activePageClass)},_getWrapper:function(){var e=this._page().find("."+this.options.classes.pageWrapper);return 0===e.length&&(e=this._page().children(".ui-header:not(.ui-header-fixed), .ui-content:not(.ui-popup), .ui-footer:not(.ui-footer-fixed)").wrapAll("<div class='"+this.options.classes.pageWrapper+"'></div>").parent()),e},_getFixedToolbars:function(){var e=s("body").children(".ui-header-fixed, .ui-footer-fixed"),t=this._page().find(".ui-header-fixed, .ui-footer-fixed");return e.add(t).addClass(this.options.classes.pageFixedToolbar)},_getPosDisplayClasses:function(e){return e+"-position-"+this.options.position+" "+e+"-display-"+this.options.display},_getPanelClasses:function(){var e=this.options.classes.panel+" "+this._getPosDisplayClasses(this.options.classes.panel)+" "+this.options.classes.panelClosed+" ui-body-"+(this.options.theme?this.options.theme:"inherit");return this.options.positionFixed&&(e+=" "+this.options.classes.panelFixed),e},_addPanelClasses:function(){this.element.addClass(this._getPanelClasses())},_bindCloseEvents:function(){var t=this;t._closeLink.on("click.panel",function(e){return e.preventDefault(),t.close(),!1}),t.element.on("click.panel","a:jqmData(ajax='false')",function(){t.close()})},_positionPanel:function(){var e=this._panelInner.outerHeight(),t=e>s.mobile.getScreenHeight();t||!this.options.positionFixed?(t&&(this._unfixPanel(),s.mobile.resetActivePageHeight(e)),L.scrollTo(0,s.mobile.defaultHomeScroll)):this._fixPanel()},_bindFixListener:function(){this._on(s(L),{throttledresize:"_positionPanel"})},_unbindFixListener:function(){this._off(s(L),"throttledresize")},_unfixPanel:function(){this.options.positionFixed&&s.support.fixedPosition&&this.element.removeClass(this.options.classes.panelFixed)},_fixPanel:function(){this.options.positionFixed&&s.support.fixedPosition&&this.element.addClass(this.options.classes.panelFixed)},_bindUpdateLayout:function(){var e=this;e.element.on("updatelayout",function(){e._open&&e._positionPanel()})},_bindLinkListeners:function(){this._on("body",{"click a":"_handleClick"})},_handleClick:function(e){if(e.currentTarget.href.split("#")[1]===this._panelID&&void 0!==this._panelID){e.preventDefault();var t=s(e.target);return t.hasClass("ui-btn")&&(t.addClass(s.mobile.activeBtnClass),this.element.one("panelopen panelclose",function(){t.removeClass(s.mobile.activeBtnClass)})),this.toggle(),!1}},_bindSwipeEvents:function(){var e=this,t=e._modal?e.element.add(e._modal):e.element;e.options.swipeClose&&("left"===e.options.position?t.on("swipeleft.panel",function(){e.close()}):t.on("swiperight.panel",function(){e.close()}))},_bindPageEvents:function(){var t=this;this.document.on("panelbeforeopen",function(e){t._open&&e.target!==t.element[0]&&t.close()}).on("keyup.panel",function(e){27===e.keyCode&&t._open&&t.close()}),t._parentPage?this.document.on("pagehide",":jqmData(role='page')",function(){t._open&&t.close(!0)}):this.document.on("pagebeforehide",function(){t._open&&t.close(!0)})},_open:!1,_pageContentOpenClasses:null,_modalOpenClasses:null,open:function(e){if(!this._open){var t=this,i=t.options,n=function(){t.document.off("panelclose"),t._page().jqmData("panel","open"),s.support.cssTransform3d&&i.animate&&"overlay"!==i.display&&(t._wrapper().addClass(i.classes.animate),t._fixedToolbars().addClass(i.classes.animate)),!e&&s.support.cssTransform3d&&i.animate?t.document.on(t._transitionEndEvents,r):setTimeout(r,0),i.theme&&"overlay"!==i.display&&t._page().parent().addClass(i.classes.pageContainer+"-themed "+i.classes.pageContainer+"-"+i.theme),t.element.removeClass(i.classes.panelClosed).addClass(i.classes.panelOpen),t._positionPanel(),t._pageContentOpenClasses=t._getPosDisplayClasses(i.classes.pageContentPrefix),"overlay"!==i.display&&(t._page().parent().addClass(i.classes.pageContainer),t._wrapper().addClass(t._pageContentOpenClasses),t._fixedToolbars().addClass(t._pageContentOpenClasses)),t._modalOpenClasses=t._getPosDisplayClasses(i.classes.modal)+" "+i.classes.modalOpen,t._modal&&t._modal.addClass(t._modalOpenClasses).height(Math.max(t._modal.height(),t.document.height()))},r=function(){t.document.off(t._transitionEndEvents,r),"overlay"!==i.display&&(t._wrapper().addClass(i.classes.pageContentPrefix+"-open"),t._fixedToolbars().addClass(i.classes.pageContentPrefix+"-open")),t._bindFixListener(),t._trigger("open")};t._trigger("beforeopen"),"open"===t._page().jqmData("panel")?t.document.on("panelclose",function(){n()}):n(),t._open=!0}},close:function(e){if(this._open){var t=this,i=this.options,n=function(){t.document.off(t._transitionEndEvents,n),i.theme&&"overlay"!==i.display&&t._page().parent().removeClass(i.classes.pageContainer+"-themed "+i.classes.pageContainer+"-"+i.theme),t.element.addClass(i.classes.panelClosed),"overlay"!==i.display&&(t._page().parent().removeClass(i.classes.pageContainer),t._wrapper().removeClass(i.classes.pageContentPrefix+"-open"),t._fixedToolbars().removeClass(i.classes.pageContentPrefix+"-open")),s.support.cssTransform3d&&i.animate&&"overlay"!==i.display&&(t._wrapper().removeClass(i.classes.animate),t._fixedToolbars().removeClass(i.classes.animate)),t._fixPanel(),t._unbindFixListener(),s.mobile.resetActivePageHeight(),t._page().jqmRemoveData("panel"),t._trigger("close")};t._trigger("beforeclose"),!e&&s.support.cssTransform3d&&i.animate?t.document.on(t._transitionEndEvents,n):setTimeout(n,0),t.element.removeClass(i.classes.panelOpen),"overlay"!==i.display&&(t._wrapper().removeClass(t._pageContentOpenClasses),t._fixedToolbars().removeClass(t._pageContentOpenClasses)),t._modal&&t._modal.removeClass(t._modalOpenClasses),t._open=!1}},toggle:function(){this[this._open?"close":"open"]()},_transitionEndEvents:"webkitTransitionEnd oTransitionEnd otransitionend transitionend msTransitionEnd",_destroy:function(){var e=this.options,t=1<s("body > :mobile-panel").length+s.mobile.activePage.find(":mobile-panel").length;"overlay"!==e.display&&(0===s("body > :mobile-panel").add(s.mobile.activePage.find(":mobile-panel")).not(".ui-panel-display-overlay").not(this.element).length&&this._wrapper().children().unwrap(),this._open&&(this._fixedToolbars().removeClass(e.classes.pageContentPrefix+"-open"),s.support.cssTransform3d&&e.animate&&this._fixedToolbars().removeClass(e.classes.animate),this._page().parent().removeClass(e.classes.pageContainer),e.theme&&this._page().parent().removeClass(e.classes.pageContainer+"-themed "+e.classes.pageContainer+"-"+e.theme))),t||(this.document.off("panelopen panelclose"),this._open&&(this.document.off(this._transitionEndEvents),s.mobile.resetActivePageHeight())),this._open&&this._page().jqmRemoveData("panel"),this._panelInner.children().unwrap(),this.element.removeClass([this._getPanelClasses(),e.classes.panelOpen,e.classes.animate].join(" ")).off("swipeleft.panel swiperight.panel").off("panelbeforeopen").off("panelhide").off("keyup.panel").off("updatelayout").off(this._transitionEndEvents),this._closeLink.off("click.panel"),this._modal&&this._modal.remove()}}),(a=e).widget("mobile.table",{options:{classes:{table:"ui-table"},enhanced:!1},_create:function(){this.options.enhanced||this.element.addClass(this.options.classes.table),a.extend(this,{headers:void 0,allHeaders:void 0}),this._refresh(!0)},_setHeaders:function(){var e=this.element.find("thead tr");this.headers=this.element.find("tr:eq(0)").children(),this.allHeaders=this.headers.add(e.children())},refresh:function(){this._refresh()},rebuild:a.noop,_refresh:function(){var r=this.element,o=r.find("thead tr");this._setHeaders(),o.each(function(){var n=0;a(this).children().each(function(){var e,t=parseInt(this.getAttribute("colspan"),10),i=":nth-child("+(n+1)+")";if(this.setAttribute("data-"+a.mobile.ns+"colstart",n+1),t)for(e=0;e<t-1;e++)i+=", :nth-child("+(++n+1)+")";a(this).jqmData("cells",r.find("tr").not(o.eq(0)).not(this).children(i)),n++})})}}),(u=e).widget("mobile.table",u.mobile.table,{options:{mode:"columntoggle",columnBtnTheme:null,columnPopupTheme:null,columnBtnText:"Columns...",classes:u.extend(u.mobile.table.prototype.options.classes,{popup:"ui-table-columntoggle-popup",columnBtn:"ui-table-columntoggle-btn",priorityPrefix:"ui-table-priority-",columnToggleTable:"ui-table-columntoggle"})},_create:function(){this._super(),"columntoggle"===this.options.mode&&(u.extend(this,{_menu:null}),this.options.enhanced?(this._menu=u(this.document[0].getElementById(this._id()+"-popup")).children().first(),this._addToggles(this._menu,!0),this._bindToggles(this._menu)):(this._menu=this._enhanceColToggle(),this.element.addClass(this.options.classes.columnToggleTable)),this._setupEvents(),this._setToggleState())},_id:function(){return this.element.attr("id")||this.widgetName+this.uuid},_setupEvents:function(){this._on(this.window,{throttledresize:"_setToggleState"})},_bindToggles:function(e){var t=e.find("input");this._on(t,{change:"_menuInputChange"})},_addToggles:function(e,n){var r,o=0,a=this.options,s=e.controlgroup("container");n?r=e.find("input"):s.empty(),this.headers.not("td").each(function(){var e=u(this),t=u.mobile.getAttribute(this,"priority"),i=e.add(e.jqmData("cells"));t&&(i.addClass(a.classes.priorityPrefix+t),(n?r.eq(o++):u("<label><input type='checkbox' checked />"+(e.children("abbr").first().attr("title")||e.text())+"</label>").appendTo(s).children(0).checkboxradio({theme:a.columnPopupTheme})).jqmData("cells",i))}),n||(e.controlgroup("refresh"),this._bindToggles(e))},_menuInputChange:function(e){var t=u(e.target),i=t[0].checked;t.jqmData("cells").toggleClass("ui-table-cell-hidden",!i).toggleClass("ui-table-cell-visible",i),t[0].getAttribute("locked")?(t.removeAttr("locked"),this._unlockCells(t.jqmData("cells"))):t.attr("locked",!0)},_unlockCells:function(e){e.removeClass("ui-table-cell-hidden ui-table-cell-visible")},_enhanceColToggle:function(){var e,t,i,n,r=this.element,o=this.options,a=u.mobile.ns,s=this.document[0].createDocumentFragment();return e=this._id()+"-popup",t=u("<a href='#"+e+"' class='"+o.classes.columnBtn+" ui-btn ui-btn-"+(o.columnBtnTheme||"a")+" ui-corner-all ui-shadow ui-mini' data-"+a+"rel='popup'>"+o.columnBtnText+"</a>"),i=u("<div class='"+o.classes.popup+"' id='"+e+"'></div>"),n=u("<fieldset></fieldset>").controlgroup(),this._addToggles(n,!1),n.appendTo(i),s.appendChild(i[0]),s.appendChild(t[0]),r.before(s),i.popup(),n},rebuild:function(){this._super(),"columntoggle"===this.options.mode&&this._refresh(!1)},_refresh:function(e){this._super(e),e||"columntoggle"!==this.options.mode||(this._unlockCells(this.allHeaders),this._addToggles(this._menu,e),this._setToggleState())},_setToggleState:function(){this._menu.find("input").each(function(){var e=u(this);this.checked="table-cell"===e.jqmData("cells").eq(0).css("display"),e.checkboxradio("refresh")})},_destroy:function(){this._super()}}),(h=e).widget("mobile.table",h.mobile.table,{options:{mode:"reflow",classes:h.extend(h.mobile.table.prototype.options.classes,{reflowTable:"ui-table-reflow",cellLabels:"ui-table-cell-label"})},_create:function(){this._super(),"reflow"===this.options.mode&&(this.options.enhanced||(this.element.addClass(this.options.classes.reflowTable),this._updateReflow()))},rebuild:function(){this._super(),"reflow"===this.options.mode&&this._refresh(!1)},_refresh:function(e){this._super(e),e||"reflow"!==this.options.mode||this._updateReflow()},_updateReflow:function(){var a=this,s=this.options;h(a.allHeaders.get().reverse()).each(function(){var e,t,i=h(this).jqmData("cells"),n=h.mobile.getAttribute(this,"colstart"),r=i.not(this).filter("thead th").length&&" ui-table-cell-label-top",o=h(this).text();""!==o&&(r?(t="",(e=parseInt(this.getAttribute("colspan"),10))&&(t="td:nth-child("+e+"n + "+n+")"),a._addLabels(i.filter(t),s.classes.cellLabels+r,o)):a._addLabels(i,s.classes.cellLabels,o))})},_addLabels:function(e,t,i){e.not(":has(b."+t+")").prepend("<b class='"+t+"'>"+i+"</b>")}}),c=function(e,t){return-1===(""+(l.mobile.getAttribute(this,"filtertext")||l(this).text())).toLowerCase().indexOf(t)},(l=e).widget("mobile.filterable",{initSelector:":jqmData(filter='true')",options:{filterReveal:!1,filterCallback:c,enhanced:!1,input:null,children:"> li, > option, > optgroup option, > tbody tr, > .ui-controlgroup-controls > .ui-btn, > .ui-controlgroup-controls > .ui-checkbox, > .ui-controlgroup-controls > .ui-radio"},_create:function(){var e=this.options;l.extend(this,{_search:null,_timer:0}),this._setInput(e.input),e.enhanced||this._filterItems((this._search&&this._search.val()||"").toLowerCase())},_onKeyUp:function(){var e,t,i=this._search;if(i){if(e=i.val().toLowerCase(),(t=l.mobile.getAttribute(i[0],"lastval")+"")&&t===e)return;this._timer&&(L.clearTimeout(this._timer),this._timer=0),this._timer=this._delay(function(){this._trigger("beforefilter","beforefilter",{input:i}),i[0].setAttribute("data-"+l.mobile.ns+"lastval",e),this._filterItems(e),this._timer=0},250)}},_getFilterableItems:function(){var e=this.element,t=this.options.children,i=t?l.isFunction(t)?t():t.nodeName?l(t):t.jquery?t:this.element.find(t):{length:0};return 0===i.length&&(i=e.children()),i},_filterItems:function(e){var t,i,n,r=[],o=[],a=this.options,s=this._getFilterableItems();if(null!=e)for(i=a.filterCallback||c,n=s.length,t=0;t<n;t++)(i.call(s[t],t,e)?o:r).push(s[t]);0===o.length?s[a.filterReveal?"addClass":"removeClass"]("ui-screen-hidden"):(l(o).addClass("ui-screen-hidden"),l(r).removeClass("ui-screen-hidden")),this._refreshChildWidget()},_refreshChildWidget:function(){var e,t,i=["collapsibleset","selectmenu","controlgroup","listview"];for(t=i.length-1;-1<t;t--)e=i[t],l.mobile[e]&&(e=this.element.data("mobile-"+e))&&l.isFunction(e.refresh)&&e.refresh()},_setInput:function(e){var t=this._search;this._timer&&(L.clearTimeout(this._timer),this._timer=0),t&&(this._off(t,"keyup change input"),t=null),e&&(t=e.jquery?e:e.nodeName?l(e):this.document.find(e),this._on(t,{keyup:"_onKeyUp",change:"_onKeyUp",input:"_onKeyUp"})),this._search=t},_setOptions:function(e){var t=!(e.filterReveal===r&&e.filterCallback===r&&e.children===r);this._super(e),e.input!==r&&(this._setInput(e.input),t=!0),t&&this.refresh()},_destroy:function(){var e=this.options,t=this._getFilterableItems();e.enhanced?t.toggleClass("ui-screen-hidden",e.filterReveal):t.removeClass("ui-screen-hidden")},refresh:function(){this._timer&&(L.clearTimeout(this._timer),this._timer=0),this._filterItems((this._search&&this._search.val()||"").toLowerCase())}}),i=/(^|\s)ui-li-divider(\s|$)/,n=(o=e).mobile.filterable.prototype.options.filterCallback,o.mobile.filterable.prototype.options.filterCallback=function(e,t){return!this.className.match(i)&&n.call(this,e,t)},o.widget("mobile.filterable",o.mobile.filterable,{options:{filterPlaceholder:"Filter items...",filterTheme:null},_create:function(){var e,t,i=this.element,n=["collapsibleset","selectmenu","controlgroup","listview"],r={};for(this._super(),o.extend(this,{_widget:null}),e=n.length-1;-1<e;e--)if(t=n[e],o.mobile[t]){if(this._setWidget(i.data("mobile-"+t)))break;r[t+"create"]="_handleCreate"}this._widget||this._on(i,r)},_handleCreate:function(e){this._setWidget(this.element.data("mobile-"+e.type.substring(0,e.type.length-6)))},_setWidget:function(e){return!this._widget&&e&&(this._widget=e,this._widget._setOptions=(i=(t=this)._widget._setOptions,function(e){i.call(this,e),t._syncTextInputOptions(e)})),this._widget&&(this._syncTextInputOptions(this._widget.options),"listview"===this._widget.widgetName&&(this._widget.options.hidedividers=!0,this._widget.element.listview("refresh"))),!!this._widget;var t,i},_isSearchInternal:function(){return this._search&&this._search.jqmData("ui-filterable-"+this.uuid+"-internal")},_setInput:function(t){var e=this.options,i=!0,n={};if(!t){if(this._isSearchInternal())return;i=!1,t=o("<input data-"+o.mobile.ns+"type='search' placeholder='"+e.filterPlaceholder+"'></input>").jqmData("ui-filterable-"+this.uuid+"-internal",!0),o("<form class='ui-filterable'></form>").append(t).submit(function(e){e.preventDefault(),t.blur()}).insertBefore(this.element),o.mobile.textinput&&(null!=this.options.filterTheme&&(n.theme=e.filterTheme),t.textinput(n))}this._super(t),this._isSearchInternal()&&i&&this._search.attr("placeholder",this.options.filterPlaceholder)},_setOptions:function(e){var t=this._super(e);return void 0!==e.filterPlaceholder&&this._isSearchInternal()&&this._search.attr("placeholder",e.filterPlaceholder),void 0!==e.filterTheme&&this._search&&o.mobile.textinput&&this._search.textinput("option","theme",e.filterTheme),t},_destroy:function(){this._isSearchInternal()&&this._search.remove(),this._super()},_syncTextInputOptions:function(e){var t,i={};if(this._isSearchInternal()&&o.mobile.textinput){for(t in o.mobile.textinput.prototype.options)void 0!==e[t]&&(i[t]="theme"===t&&null!=this.options.filterTheme?this.options.filterTheme:e[t]);this._search.textinput("option",i)}}}),function(c,e){function h(e){return 1<e.hash.length&&decodeURIComponent(e.href.replace(i,""))===decodeURIComponent(location.href.replace(i,""))}var t=0,i=/#.*$/;c.widget("ui.tabs",{version:"fadf2b312a05040436451c64bbfaf4814bc62c56",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var t=this,e=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",e.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(e){c(this).is(".ui-state-disabled")&&e.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){c(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),e.active=this._initialActive(),c.isArray(e.disabled)&&(e.disabled=c.unique(e.disabled.concat(c.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.active=!1!==this.options.active&&this.anchors.length?this._findActive(e.active):c(),this._refresh(),this.active.length&&this.load(e.active)},_initialActive:function(){var i=this.options.active,e=this.options.collapsible,n=location.hash.substring(1);return null===i&&(n&&this.tabs.each(function(e,t){return c(t).attr("aria-controls")===n?(i=e,!1):void 0}),null===i&&(i=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===i||-1===i)&&(i=!!this.tabs.length&&0)),!1!==i&&(-1===(i=this.tabs.index(this.tabs.eq(i)))&&(i=!e&&0)),!e&&!1===i&&this.anchors.length&&(i=0),i},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):c()}},_tabKeydown:function(e){var t=c(this.document[0].activeElement).closest("li"),i=this.tabs.index(t),n=!0;if(!this._handlePageNav(e)){switch(e.keyCode){case c.ui.keyCode.RIGHT:case c.ui.keyCode.DOWN:i++;break;case c.ui.keyCode.UP:case c.ui.keyCode.LEFT:n=!1,i--;break;case c.ui.keyCode.END:i=this.anchors.length-1;break;case c.ui.keyCode.HOME:i=0;break;case c.ui.keyCode.SPACE:return e.preventDefault(),clearTimeout(this.activating),void this._activate(i);case c.ui.keyCode.ENTER:return e.preventDefault(),clearTimeout(this.activating),void this._activate(i!==this.options.active&&i);default:return}e.preventDefault(),clearTimeout(this.activating),i=this._focusNextTab(i,n),e.ctrlKey||(t.attr("aria-selected","false"),this.tabs.eq(i).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",i)},this.delay))}},_panelKeydown:function(e){this._handlePageNav(e)||e.ctrlKey&&e.keyCode===c.ui.keyCode.UP&&(e.preventDefault(),this.active.focus())},_handlePageNav:function(e){return e.altKey&&e.keyCode===c.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):e.altKey&&e.keyCode===c.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(e,t){for(var i=this.tabs.length-1;-1!==c.inArray((i<e&&(e=0),e<0&&(e=i),e),this.options.disabled);)e=t?e+1:e-1;return e},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return"active"===e?void this._activate(t):"disabled"===e?void this._setupDisabled(t):(this._super(e,t),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",t),t||!1!==this.options.active||this._activate(0)),"event"===e&&this._setupEvents(t),void("heightStyle"===e&&this._setupHeightStyle(t)))},_tabId:function(e){return e.attr("aria-controls")||"ui-tabs-"+ ++t},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,t=this.tablist.children(":has(a[href])");e.disabled=c.map(t.filter(".ui-state-disabled"),function(e){return t.index(e)}),this._processTabs(),!1!==e.active&&this.anchors.length?this.active.length&&!c.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=c()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active):(e.active=!1,this.active=c()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var l=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return c("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=c(),this.anchors.each(function(e,t){var i,n,r,o=c(t).uniqueId().attr("id"),a=c(t).closest("li"),s=a.attr("aria-controls");h(t)?(i=t.hash,n=l.element.find(l._sanitizeSelector(i))):(i="#"+(r=l._tabId(a)),(n=l.element.find(i)).length||(n=l._createPanel(r)).insertAfter(l.panels[e-1]||l.tablist),n.attr("aria-live","polite")),n.length&&(l.panels=l.panels.add(n)),s&&a.data("ui-tabs-aria-controls",s),a.attr({"aria-controls":i.substring(1),"aria-labelledby":o}),n.attr("aria-labelledby",o)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(e){return c("<div>").attr("id",e).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(e){c.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1);for(var t,i=0;t=this.tabs[i];i++)!0===e||-1!==c.inArray(i,e)?c(t).addClass("ui-state-disabled").attr("aria-disabled","true"):c(t).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=e},_setupEvents:function(e){var i={click:function(e){e.preventDefault()}};e&&c.each(e.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(e){var i,t=this.element.parent();"fill"===e?(i=t.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var e=c(this),t=e.css("position");"absolute"!==t&&"fixed"!==t&&(i-=e.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=c(this).outerHeight(!0)}),this.panels.each(function(){c(this).height(Math.max(0,i-c(this).innerHeight()+c(this).height()))}).css("overflow","auto")):"auto"===e&&(i=0,this.panels.each(function(){i=Math.max(i,c(this).height("").height())}).height(i))},_eventHandler:function(e){var t=this.options,i=this.active,n=c(e.currentTarget).closest("li"),r=n[0]===i[0],o=r&&t.collapsible,a=o?c():this._getPanelForTab(n),s=i.length?this._getPanelForTab(i):c(),l={oldTab:i,oldPanel:s,newTab:o?c():n,newPanel:a};e.preventDefault(),n.hasClass("ui-state-disabled")||n.hasClass("ui-tabs-loading")||this.running||r&&!t.collapsible||!1===this._trigger("beforeActivate",e,l)||(t.active=!o&&this.tabs.index(n),this.active=r?c():n,this.xhr&&this.xhr.abort(),s.length||a.length||c.error("jQuery UI Tabs: Mismatching fragment identifier."),a.length&&this.load(this.tabs.index(n),e),this._toggle(e,l))},_toggle:function(e,t){function i(){r.running=!1,r._trigger("activate",e,t)}function n(){t.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),o.length&&r.options.show?r._show(o,r.options.show,i):(o.show(),i())}var r=this,o=t.newPanel,a=t.oldPanel;this.running=!0,a.length&&this.options.hide?this._hide(a,this.options.hide,function(){t.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),n()}):(t.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),a.hide(),n()),a.attr({"aria-expanded":"false","aria-hidden":"true"}),t.oldTab.attr("aria-selected","false"),o.length&&a.length?t.oldTab.attr("tabIndex",-1):o.length&&this.tabs.filter(function(){return 0===c(this).attr("tabIndex")}).attr("tabIndex",-1),o.attr({"aria-expanded":"true","aria-hidden":"false"}),t.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(e){var t,i=this._findActive(e);i[0]!==this.active[0]&&(i.length||(i=this.active),t=i.find(".ui-tabs-anchor")[0],this._eventHandler({target:t,currentTarget:t,preventDefault:c.noop}))},_findActive:function(e){return!1===e?c():this.tabs.eq(e)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){c.data(this,"ui-tabs-destroy")?c(this).remove():c(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var e=c(this),t=e.data("ui-tabs-aria-controls");t?e.attr("aria-controls",t).removeData("ui-tabs-aria-controls"):e.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(i){var e=this.options.disabled;!1!==e&&(e=void 0!==i&&(i=this._getIndex(i),c.isArray(e)?c.map(e,function(e){return e!==i?e:null}):c.map(this.tabs,function(e,t){return t!==i?t:null})),this._setupDisabled(e))},disable:function(e){var t=this.options.disabled;if(!0!==t){if(void 0===e)t=!0;else{if(e=this._getIndex(e),-1!==c.inArray(e,t))return;t=c.isArray(t)?c.merge([e],t).sort():[e]}this._setupDisabled(t)}},load:function(e,t){e=this._getIndex(e);var i=this,n=this.tabs.eq(e),r=n.find(".ui-tabs-anchor"),o=this._getPanelForTab(n),a={tab:n,panel:o};h(r[0])||(this.xhr=c.ajax(this._ajaxSettings(r,t,a)),this.xhr&&"canceled"!==this.xhr.statusText&&(n.addClass("ui-tabs-loading"),o.attr("aria-busy","true"),this.xhr.success(function(e){setTimeout(function(){o.html(e),i._trigger("load",t,a)},1)}).complete(function(e,t){setTimeout(function(){"abort"===t&&i.panels.stop(!1,!0),n.removeClass("ui-tabs-loading"),o.removeAttr("aria-busy"),e===i.xhr&&delete i.xhr},1)})))},_ajaxSettings:function(e,i,n){var r=this;return{url:e.attr("href"),beforeSend:function(e,t){return r._trigger("beforeLoad",i,c.extend({jqXHR:e,ajaxSettings:t},n))}}},_getPanelForTab:function(e){var t=c(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+t))}})}(e),function(e,t){function i(e){r=e.originalEvent,l=r.accelerationIncludingGravity,o=Math.abs(l.x),a=Math.abs(l.y),s=Math.abs(l.z),!t.orientation&&(7<o||(6<s&&a<8||s<8&&6<a)&&5<o)?n.enabled&&n.disable():n.enabled||n.enable()}e.mobile.iosorientationfixEnabled=!0;var n,r,o,a,s,l,c=navigator.userAgent;/iPhone|iPad|iPod/.test(navigator.platform)&&/OS [1-5]_[0-9_]* like Mac OS X/i.test(c)&&-1<c.indexOf("AppleWebKit")?(n=e.mobile.zoom,e.mobile.document.on("mobileinit",function(){e.mobile.iosorientationfixEnabled&&e.mobile.window.bind("orientationchange.iosorientationfix",n.enable).bind("devicemotion.iosorientationfix",i)})):e.mobile.iosorientationfixEnabled=!1}(e,this),function(r,e){function o(){t.removeClass("ui-mobile-rendering")}var t=r("html"),a=r.mobile.window;r(e.document).trigger("mobileinit"),r.mobile.gradeA()&&(r.mobile.ajaxBlacklist&&(r.mobile.ajaxEnabled=!1),t.addClass("ui-mobile ui-mobile-rendering"),setTimeout(o,5e3),r.extend(r.mobile,{initializePage:function(){var e=r.mobile.path,t=r(":jqmData(role='page'), :jqmData(role='dialog')"),i=e.stripHash(e.stripQueryParams(e.parseLocation().hash)),n=O.getElementById(i);t.length||(t=r("body").wrapInner("<div data-"+r.mobile.ns+"role='page'></div>").children(0)),t.each(function(){var e=r(this);e[0].getAttribute("data-"+r.mobile.ns+"url")||e.attr("data-"+r.mobile.ns+"url",e.attr("id")||location.pathname+location.search)}),r.mobile.firstPage=t.first(),r.mobile.pageContainer=r.mobile.firstPage.parent().addClass("ui-mobile-viewport").pagecontainer(),r.mobile.navreadyDeferred.resolve(),a.trigger("pagecontainercreate"),r.mobile.loading("show"),o(),r.mobile.hashListeningEnabled&&r.mobile.path.isHashValid(location.hash)&&(r(n).is(":jqmData(role='page')")||r.mobile.path.isPath(i)||i===r.mobile.dialogHashKey)?r.event.special.navigate.isPushStateEnabled()?(r.mobile.navigate.history.stack=[],r.mobile.navigate(r.mobile.path.isPath(location.hash)?location.hash:location.href)):a.trigger("hashchange",[!0]):(r.mobile.path.isHashValid(location.hash)&&(r.mobile.navigate.history.initialDst=i.replace("#","")),r.event.special.navigate.isPushStateEnabled()&&r.mobile.navigate.navigator.squash(e.parseLocation().href),r.mobile.changePage(r.mobile.firstPage,{transition:"none",reverse:!0,changeHash:!1,fromHashChange:!0}))}}),r(function(){r.support.inlineSVG(),r.mobile.hideUrlBar&&e.scrollTo(0,1),r.mobile.defaultHomeScroll=r.support.scrollTop&&1!==r.mobile.window.scrollTop()?1:0,r.mobile.autoInitializePage&&r.mobile.initializePage(),r.mobile.hideUrlBar&&a.load(r.mobile.silentScroll),r.support.cssPointerEvents||r.mobile.document.delegate(".ui-state-disabled,.ui-disabled","vclick",function(e){e.preventDefault(),e.stopImmediatePropagation()})}))}(e,this)});var ROSLIB=ROSLIB||{REVISION:"6"};function xml2json(e,t){var l={toObj:function(e){var t={};if(1==e.nodeType){if(e.attributes.length)for(var i=0;i<e.attributes.length;i++)t["@"+e.attributes[i].nodeName]=(e.attributes[i].nodeValue||"").toString();if(e.firstChild){for(var n=0,r=0,o=!1,a=e.firstChild;a;a=a.nextSibling)1==a.nodeType?o=!0:3==a.nodeType&&a.nodeValue.match(/[^ \f\n\r\t\v]/)?n++:4==a.nodeType&&r++;if(o)if(n<2&&r<2){l.removeWhite(e);for(a=e.firstChild;a;a=a.nextSibling)3==a.nodeType?t["#text"]=l.escape(a.nodeValue):4==a.nodeType?t["#cdata"]=l.escape(a.nodeValue):t[a.nodeName]?t[a.nodeName]instanceof Array?t[a.nodeName][t[a.nodeName].length]=l.toObj(a):t[a.nodeName]=[t[a.nodeName],l.toObj(a)]:t[a.nodeName]=l.toObj(a)}else e.attributes.length?t["#text"]=l.escape(l.innerXml(e)):t=l.escape(l.innerXml(e));else if(n)e.attributes.length?t["#text"]=l.escape(l.innerXml(e)):t=l.escape(l.innerXml(e));else if(r)if(1<r)t=l.escape(l.innerXml(e));else for(a=e.firstChild;a;a=a.nextSibling)t["#cdata"]=l.escape(a.nodeValue)}e.attributes.length||e.firstChild||(t=null)}else 9==e.nodeType?t=l.toObj(e.documentElement):8==e.nodeType||alert("unhandled node type: "+e.nodeType);return t},toJson:function(e,t,i){var n=t?'"'+t+'"':"";if(e instanceof Array){for(var r=0,o=e.length;r<o;r++)e[r]=l.toJson(e[r],"",i+"\t");n+=(t?":[":"[")+(1<e.length?"\n"+i+"\t"+e.join(",\n"+i+"\t")+"\n"+i:e.join(""))+"]"}else if(null==e)n+=(t&&":")+"null";else if("object"==typeof e){var a=[];for(var s in e)a[a.length]=l.toJson(e[s],s,i+"\t");n+=(t?":{":"{")+(1<a.length?"\n"+i+"\t"+a.join(",\n"+i+"\t")+"\n"+i:a.join(""))+"}"}else n+="string"==typeof e?(t&&":")+'"'+e.toString()+'"':(t&&":")+e.toString();return n},innerXml:function(e){var t="";if("innerHTML"in e)t=e.innerHTML;else for(var r=function(e){var t="";if(1==e.nodeType){t+="<"+e.nodeName;for(var i=0;i<e.attributes.length;i++)t+=" "+e.attributes[i].nodeName+'="'+(e.attributes[i].nodeValue||"").toString()+'"';if(e.firstChild){t+=">";for(var n=e.firstChild;n;n=n.nextSibling)t+=r(n);t+="</"+e.nodeName+">"}else t+="/>"}else 3==e.nodeType?t+=e.nodeValue:4==e.nodeType&&(t+="<![CDATA["+e.nodeValue+"]]>");return t},i=e.firstChild;i;i=i.nextSibling)t+=r(i);return t},escape:function(e){return e.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(e){e.normalize();for(var t=e.firstChild;t;)if(3==t.nodeType)if(t.nodeValue.match(/[^ \f\n\r\t\v]/))t=t.nextSibling;else{var i=t.nextSibling;e.removeChild(t),t=i}else t=(1==t.nodeType&&l.removeWhite(t),t.nextSibling);return e}};9==e.nodeType&&(e=e.documentElement);var i=l.toJson(l.toObj(l.removeWhite(e)),e.nodeName,"\t");return"{\n"+t+(t?i.replace(/\t/g,t):i.replace(/\t|\n/g,""))+"\n}"}ROSLIB.URDF_SPHERE=0,ROSLIB.URDF_BOX=1,ROSLIB.URDF_CYLINDER=2,ROSLIB.URDF_MESH=3,ROSLIB.ActionClient=function(e){var i=this;e=e||{},this.ros=e.ros,this.serverName=e.serverName,this.actionName=e.actionName,this.timeout=e.timeout;var t=!(this.goals={}),n=new ROSLIB.Topic({ros:this.ros,name:this.serverName+"/feedback",messageType:this.actionName+"Feedback"}),r=new ROSLIB.Topic({ros:this.ros,name:this.serverName+"/status",messageType:"actionlib_msgs/GoalStatusArray"}),o=new ROSLIB.Topic({ros:this.ros,name:this.serverName+"/result",messageType:this.actionName+"Result"});this.goalTopic=new ROSLIB.Topic({ros:this.ros,name:this.serverName+"/goal",messageType:this.actionName+"Goal"}),this.cancelTopic=new ROSLIB.Topic({ros:this.ros,name:this.serverName+"/cancel",messageType:"actionlib_msgs/GoalID"}),this.goalTopic.advertise(),this.cancelTopic.advertise(),r.subscribe(function(e){t=!0,e.status_list.forEach(function(e){var t=i.goals[e.goal_id.id];t&&t.emit("status",e)})}),n.subscribe(function(e){var t=i.goals[e.status.goal_id.id];t&&(t.emit("status",e.status),t.emit("feedback",e.feedback))}),o.subscribe(function(e){var t=i.goals[e.status.goal_id.id];t&&(t.emit("status",e.status),t.emit("result",e.result))}),this.timeout&&setTimeout(function(){t||i.emit("timeout")},this.timeout)},ROSLIB.ActionClient.prototype.__proto__=EventEmitter2.prototype,ROSLIB.ActionClient.prototype.cancel=function(){var e=new ROSLIB.Message;this.cancelTopic.publish(e)},ROSLIB.Goal=function(e){var t=this;this.actionClient=e.actionClient,this.goalMessage=e.goalMessage,this.isFinished=!1;var i=new Date;this.goalID="goal_"+Math.random()+"_"+i.getTime(),this.goalMessage=new ROSLIB.Message({goal_id:{stamp:{secs:0,nsecs:0},id:this.goalID},goal:this.goalMessage}),this.on("status",function(e){t.status=e}),this.on("result",function(e){t.isFinished=!0,t.result=e}),this.on("feedback",function(e){t.feedback=e}),this.actionClient.goals[this.goalID]=this},ROSLIB.Goal.prototype.__proto__=EventEmitter2.prototype,ROSLIB.Goal.prototype.send=function(e){var t=this;t.actionClient.goalTopic.publish(t.goalMessage),e&&setTimeout(function(){t.isFinished||t.emit("timeout")},e)},ROSLIB.Goal.prototype.cancel=function(){var e=new ROSLIB.Message({id:this.goalID});this.actionClient.cancelTopic.publish(e)},ROSLIB.Message=function(t){var i=this;t=t||{},Object.keys(t).forEach(function(e){i[e]=t[e]})},ROSLIB.Param=function(e){e=e||{},this.ros=e.ros,this.name=e.name},ROSLIB.Param.prototype.get=function(i){var e=new ROSLIB.Service({ros:this.ros,name:"/rosapi/get_param",serviceType:"rosapi/GetParam"}),t=new ROSLIB.ServiceRequest({name:this.name,value:JSON.stringify("")});e.callService(t,function(e){var t=JSON.parse(e.value);i(t)})},ROSLIB.Param.prototype.set=function(e){var t=new ROSLIB.Service({ros:this.ros,name:"/rosapi/set_param",serviceType:"rosapi/SetParam"}),i=new ROSLIB.ServiceRequest({name:this.name,value:JSON.stringify(e)});t.callService(i,function(){})},ROSLIB.Ros=function(e){var t=(e=e||{}).url;this.socket=null,this.idCounter=0,this.setMaxListeners(0),t&&this.connect(t)},ROSLIB.Ros.prototype.__proto__=EventEmitter2.prototype,ROSLIB.Ros.prototype.connect=function(e){var r=this;this.socket=new WebSocket(e),this.socket.onopen=function(e){r.emit("connection",e)},this.socket.onclose=function(e){r.emit("close",e)},this.socket.onerror=function(e){r.emit("error",e)},this.socket.onmessage=function(e){function t(e){"publish"===e.op?r.emit(e.topic,e.msg):"service_response"===e.op&&r.emit(e.id,e.values)}var i,a,s,n=JSON.parse(e.data);"png"===n.op?(i=n,a=function(e){t(e)},(s=new Image).onload=function(){var e=document.createElement("canvas"),t=e.getContext("2d");e.width=s.width,e.height=s.height,t.drawImage(s,0,0);for(var i=t.getImageData(0,0,s.width,s.height).data,n="",r=0;r<i.length;r+=4)n+=String.fromCharCode(i[r],i[r+1],i[r+2]);var o=JSON.parse(n);a(o)},s.src="data:image/png;base64,"+i.data):t(n)}},ROSLIB.Ros.prototype.close=function(){this.socket&&this.socket.close()},ROSLIB.Ros.prototype.authenticate=function(e,t,i,n,r,o,a){var s={op:"auth",mac:e,client:t,dest:i,rand:n,t:r,level:o,end:a};this.callOnConnection(s)},ROSLIB.Ros.prototype.callOnConnection=function(e){var t=this,i=JSON.stringify(e);this.socket&&this.socket.readyState===WebSocket.OPEN?t.socket.send(i):t.once("connection",function(){t.socket.send(i)})},ROSLIB.Ros.prototype.getTopics=function(t){var e=new ROSLIB.Service({ros:this,name:"/rosapi/topics",serviceType:"rosapi/Topics"}),i=new ROSLIB.ServiceRequest;e.callService(i,function(e){t(e.topics)})},ROSLIB.Ros.prototype.getServices=function(t){var e=new ROSLIB.Service({ros:this,name:"/rosapi/services",serviceType:"rosapi/Services"}),i=new ROSLIB.ServiceRequest;e.callService(i,function(e){t(e.services)})},ROSLIB.Ros.prototype.getParams=function(t){var e=new ROSLIB.Service({ros:this,name:"/rosapi/get_param_names",serviceType:"rosapi/GetParamNames"}),i=new ROSLIB.ServiceRequest;e.callService(i,function(e){t(e.names)})},ROSLIB.Service=function(e){e=e||{},this.ros=e.ros,this.name=e.name,this.serviceType=e.serviceType},ROSLIB.Service.prototype.callService=function(t,i){this.ros.idCounter++;var e="call_service:"+this.name+":"+this.ros.idCounter;this.ros.once(e,function(e){var t=new ROSLIB.ServiceResponse(e);i(t)});var n=[];Object.keys(t).forEach(function(e){n.push(t[e])});var r={op:"call_service",id:e,service:this.name,args:n};this.ros.callOnConnection(r)},ROSLIB.ServiceRequest=function(t){var i=this;t=t||{},Object.keys(t).forEach(function(e){i[e]=t[e]})},ROSLIB.ServiceResponse=function(t){var i=this;t=t||{},Object.keys(t).forEach(function(e){i[e]=t[e]})},ROSLIB.Topic=function(e){e=e||{},this.ros=e.ros,this.name=e.name,this.messageType=e.messageType,this.isAdvertised=!1,this.compression=e.compression||"none",this.throttle_rate=e.throttle_rate||0,this.compression&&"png"!==this.compression&&"none"!==this.compression&&this.emit("warning",this.compression+" compression is not supported. No compression will be used."),this.throttle_rate<0&&(this.emit("warning",this.throttle_rate+" is not allowed. Set to 0"),this.throttle_rate=0)},ROSLIB.Topic.prototype.__proto__=EventEmitter2.prototype,ROSLIB.Topic.prototype.subscribe=function(t){var i=this;this.on("message",function(e){t(e)}),this.ros.on(this.name,function(e){var t=new ROSLIB.Message(e);i.emit("message",t)}),this.ros.idCounter++;var e={op:"subscribe",id:"subscribe:"+this.name+":"+this.ros.idCounter,type:this.messageType,topic:this.name,compression:this.compression,throttle_rate:this.throttle_rate};this.ros.callOnConnection(e)},ROSLIB.Topic.prototype.unsubscribe=function(){this.ros.removeAllListeners([this.name]),this.ros.idCounter++;var e={op:"unsubscribe",id:"unsubscribe:"+this.name+":"+this.ros.idCounter,topic:this.name};this.ros.callOnConnection(e)},ROSLIB.Topic.prototype.advertise=function(){this.ros.idCounter++;var e={op:"advertise",id:"advertise:"+this.name+":"+this.ros.idCounter,type:this.messageType,topic:this.name};this.ros.callOnConnection(e),this.isAdvertised=!0},ROSLIB.Topic.prototype.unadvertise=function(){this.ros.idCounter++;var e={op:"unadvertise",id:"unadvertise:"+this.name+":"+this.ros.idCounter,topic:this.name};this.ros.callOnConnection(e),this.isAdvertised=!1},ROSLIB.Topic.prototype.publish=function(e){this.isAdvertised||this.advertise(),this.ros.idCounter++;var t={op:"publish",id:"publish:"+this.name+":"+this.ros.idCounter,topic:this.name,msg:e};this.ros.callOnConnection(t)},ROSLIB.Pose=function(e){e=e||{},this.position=new ROSLIB.Vector3(e.position),this.orientation=new ROSLIB.Quaternion(e.orientation)},ROSLIB.Pose.prototype.applyTransform=function(e){this.position.multiplyQuaternion(e.rotation),this.position.add(e.translation);var t=e.rotation.clone();t.multiply(this.orientation),this.orientation=t},ROSLIB.Pose.prototype.clone=function(){return new ROSLIB.Pose(this)},ROSLIB.Quaternion=function(e){e=e||{},this.x=e.x||0,this.y=e.y||0,this.z=e.z||0,this.w=e.w||1},ROSLIB.Quaternion.prototype.conjugate=function(){this.x*=-1,this.y*=-1,this.z*=-1},ROSLIB.Quaternion.prototype.normalize=function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);0===e?(this.x=0,this.y=0,this.z=0,this.w=1):(e=1/e,this.x=this.x*e,this.y=this.y*e,this.z=this.z*e,this.w=this.w*e)},ROSLIB.Quaternion.prototype.invert=function(){this.conjugate(),this.normalize()},ROSLIB.Quaternion.prototype.multiply=function(e){var t=this.x*e.w+this.y*e.z-this.z*e.y+this.w*e.x,i=-this.x*e.z+this.y*e.w+this.z*e.x+this.w*e.y,n=this.x*e.y-this.y*e.x+this.z*e.w+this.w*e.z,r=-this.x*e.x-this.y*e.y-this.z*e.z+this.w*e.w;this.x=t,this.y=i,this.z=n,this.w=r},ROSLIB.Quaternion.prototype.clone=function(){return new ROSLIB.Quaternion(this)},ROSLIB.Transform=function(e){e=e||{},this.translation=new ROSLIB.Vector3(e.translation),this.rotation=new ROSLIB.Quaternion(e.rotation)},ROSLIB.Transform.prototype.clone=function(){return new ROSLIB.Transform(this)},ROSLIB.Vector3=function(e){e=e||{},this.x=e.x||0,this.y=e.y||0,this.z=e.z||0},ROSLIB.Vector3.prototype.add=function(e){this.x+=e.x,this.y+=e.y,this.z+=e.z},ROSLIB.Vector3.prototype.subtract=function(e){this.x-=e.x,this.y-=e.y,this.z-=e.z},ROSLIB.Vector3.prototype.multiplyQuaternion=function(e){var t=e.w*this.x+e.y*this.z-e.z*this.y,i=e.w*this.y+e.z*this.x-e.x*this.z,n=e.w*this.z+e.x*this.y-e.y*this.x,r=-e.x*this.x-e.y*this.y-e.z*this.z;this.x=t*e.w+r*-e.x+i*-e.z-n*-e.y,this.y=i*e.w+r*-e.y+n*-e.x-t*-e.z,this.z=n*e.w+r*-e.z+t*-e.y-i*-e.x},ROSLIB.Vector3.prototype.clone=function(){return new ROSLIB.Vector3(this)},ROSLIB.TFClient=function(e){e=e||{},this.ros=e.ros,this.fixedFrame=e.fixedFrame||"/base_link",this.angularThres=e.angularThres||2,this.transThres=e.transThres||.01,this.rate=e.rate||10,this.goalUpdateDelay=e.goalUpdateDelay||50,this.currentGoal=!1,this.frameInfos={},this.goalUpdateRequested=!1,this.actionClient=new ROSLIB.ActionClient({ros:this.ros,serverName:"/tf2_web_republisher",actionName:"tf2_web_republisher/TFSubscriptionAction"})},ROSLIB.TFClient.prototype.processFeedback=function(e){var n=this;e.transforms.forEach(function(e){var t=e.child_frame_id,i=n.frameInfos[t];void 0!==i&&(i.transform=new ROSLIB.Transform({translation:e.transform.translation,rotation:e.transform.rotation}),i.cbs.forEach(function(e){e(i.transform)}))})},ROSLIB.TFClient.prototype.updateGoal=function(){this.currentGoal&&this.currentGoal.cancel();var e={source_frames:[],target_frame:this.fixedFrame,angular_thres:this.angularThres,trans_thres:this.transThres,rate:this.rate};for(var t in this.frameInfos)e.source_frames.push(t);this.currentGoal=new ROSLIB.Goal({actionClient:this.actionClient,goalMessage:e}),this.currentGoal.on("feedback",this.processFeedback.bind(this)),this.currentGoal.send(),this.goalUpdateRequested=!1},ROSLIB.TFClient.prototype.subscribe=function(e,t){"/"===e[0]&&(e=e.substring(1)),void 0===this.frameInfos[e]?(this.frameInfos[e]={cbs:[]},this.goalUpdateRequested||(setTimeout(this.updateGoal.bind(this),this.goalUpdateDelay),this.goalUpdateRequested=!0)):void 0!==this.frameInfos[e].transform&&t(this.frameInfos[e].transform),this.frameInfos[e].cbs.push(t)},ROSLIB.TFClient.prototype.unsubscribe=function(e,t){var i=this.frameInfos[e];if(void 0!==i){var n=i.cbs.indexOf(t);0<=n&&(i.cbs.splice(n,1),0===i.cbs.length&&delete this.frameInfos[e],this.needUpdate=!0)}},ROSLIB.UrdfBox=function(e){var i=this,t=(e=e||{}).xml;this.dimension=null,this.type=null;!function(e){this.type=ROSLIB.URDF_BOX;var t=e.getAttribute("size").split(" ");i.dimension=new ROSLIB.Vector3({x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2])})}(t)},ROSLIB.UrdfColor=function(e){var t=this,i=(e=e||{}).xml;this.r=null,this.g=null,this.b=null,this.a=null;var n;n=i.getAttribute("rgba").split(" "),t.r=parseFloat(n[0]),t.g=parseFloat(n[1]),t.b=parseFloat(n[2]),t.a=parseFloat(n[3])},ROSLIB.UrdfCylinder=function(e){var t=this,i=(e=e||{}).xml;this.type=null,this.length=null,this.radius=null;var n;n=i,t.type=ROSLIB.URDF_CYLINDER,t.length=parseFloat(n.getAttribute("length")),t.radius=parseFloat(n.getAttribute("radius"))},ROSLIB.UrdfLink=function(e){var i=this,t=(e=e||{}).xml;this.name=null,this.visual=null;!function(e){i.name=e.getAttribute("name");var t=e.getElementsByTagName("visual");0<t.length&&(i.visual=new ROSLIB.UrdfVisual({xml:t[0]}))}(t)},ROSLIB.UrdfMaterial=function(e){var n=this,t=(e=e||{}).xml;this.name=null,this.textureFilename=null,this.color=null;!function(e){n.name=e.getAttribute("name");var t=e.getElementsByTagName("texture");0<t.length&&(n.textureFilename=t[0].getAttribute("filename"));var i=e.getElementsByTagName("color");0<i.length&&(n.color=new ROSLIB.UrdfColor({xml:i[0]}))}(t)},ROSLIB.UrdfMesh=function(e){var n=this,t=(e=e||{}).xml;this.filename=null,this.scale=null,this.type=null;!function(e){n.type=ROSLIB.URDF_MESH,n.filename=e.getAttribute("filename");var t=e.getAttribute("scale");if(t){var i=t.split(" ");n.scale=new ROSLIB.Vector3({x:parseFloat(i[0]),y:parseFloat(i[1]),z:parseFloat(i[2])})}}(t)},ROSLIB.UrdfModel=function(e){var a=this,t=(e=e||{}).xml,i=e.string;this.materials=[],this.links=[];i&&(t=(new DOMParser).parseFromString(i,"text/xml"));!function(e){var t=e.evaluate("//robot",e,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;for(var i in a.name=t.getAttribute("name"),t.childNodes){var n=t.childNodes[i];if("material"===n.tagName){var r=new ROSLIB.UrdfMaterial({xml:n});a.materials[r.name]?console.warn("Material "+r.name+"is not unique."):a.materials[r.name]=r}else if("link"===n.tagName){var o=new ROSLIB.UrdfLink({xml:n});a.links[o.name]?console.warn("Link "+o.name+" is not unique."):(o.visual&&o.visual.material&&(a.materials[o.visual.material.name]?o.visual.material=a.materials[o.visual.material.name]:o.visual.material&&(a.materials[o.visual.material.name]=o.visual.material)),a.links[o.name]=o)}}}(t)},ROSLIB.UrdfSphere=function(e){var t=this,i=(e=e||{}).xml;this.radius=null,this.type=null;var n;n=i,t.type=ROSLIB.URDF_SPHERE,t.radius=parseFloat(n.getAttribute("radius"))},ROSLIB.UrdfVisual=function(e){var b=this,t=(e=e||{}).xml;this.origin=null,this.geometry=null,this.material=null;!function(e){var t=e.getElementsByTagName("origin");if(0===t.length)b.origin=new ROSLIB.Pose;else{var i=t[0].getAttribute("xyz"),n=new ROSLIB.Vector3;i&&(i=i.split(" "),n=new ROSLIB.Vector3({x:parseFloat(i[0]),y:parseFloat(i[1]),z:parseFloat(i[2])}));var r=t[0].getAttribute("rpy"),o=new ROSLIB.Quaternion;if(r){r=r.split(" ");var a=parseFloat(r[0])/2,s=parseFloat(r[1])/2,l=parseFloat(r[2])/2,c=Math.sin(a)*Math.cos(s)*Math.cos(l)-Math.cos(a)*Math.sin(s)*Math.sin(l),h=Math.cos(a)*Math.sin(s)*Math.cos(l)+Math.sin(a)*Math.cos(s)*Math.sin(l),u=Math.cos(a)*Math.cos(s)*Math.sin(l)-Math.sin(a)*Math.sin(s)*Math.cos(l),d=Math.cos(a)*Math.cos(s)*Math.cos(l)+Math.sin(a)*Math.sin(s)*Math.sin(l);(o=new ROSLIB.Quaternion({x:c,y:h,z:u,w:d})).normalize()}b.origin=new ROSLIB.Pose({position:n,orientation:o})}var p=e.getElementsByTagName("geometry");if(0<p.length){var f=null;for(var m in p[0].childNodes){var g=p[0].childNodes[m];if(1===g.nodeType){f=g;break}}var v=f.nodeName;"sphere"===v?b.geometry=new ROSLIB.UrdfSphere({xml:f}):"box"===v?b.geometry=new ROSLIB.UrdfBox({xml:f}):"cylinder"===v?b.geometry=new ROSLIB.UrdfCylinder({xml:f}):"mesh"===v?b.geometry=new ROSLIB.UrdfMesh({xml:f}):console.warn("Unknown geometry type "+v)}var y=e.getElementsByTagName("material");0<y.length&&(b.material=new ROSLIB.UrdfMaterial({xml:y[0]}))}(t)};var GZ3D=GZ3D||{REVISION:"1"},globalEmitter=new EventEmitter2({verboseMemoryLeak:!0}),isTouchDevice=/Mobi/.test(navigator.userAgent),emUnits=function(e){return e*parseFloat($("body").css("font-size"))},isWideScreen=function(){return 35<$(window).width()/emUnits(1)},isTallScreen=function(){return 35<$(window).height()/emUnits(1)},lastOpenMenu={mainMenu:"mainMenu",insertMenu:"insertMenu",treeMenu:"treeMenu"},tabColors={selected:"rgb(34, 170, 221)",unselected:"rgb(42, 42, 42)"},modelList=[{path:"buildings",title:"Buildings",examplePath1:"fast_food",examplePath2:"kitchen_dining",examplePath3:"house_1",models:[{modelPath:"fast_food",modelTitle:"Fast Food"},{modelPath:"gas_station",modelTitle:"Gas Station"},{modelPath:"house_1",modelTitle:"House 1"},{modelPath:"house_2",modelTitle:"House 2"},{modelPath:"house_3",modelTitle:"House 3"},{modelPath:"iss",modelTitle:"International Space Station"},{modelPath:"iss_half",modelTitle:"ISS half"},{modelPath:"kitchen_dining",modelTitle:"Kitchen and Dining"},{modelPath:"office_building",modelTitle:"Office Building"},{modelPath:"powerplant",modelTitle:"Power Plant"},{modelPath:"starting_pen",modelTitle:"Starting Pen"},{modelPath:"willowgarage",modelTitle:"Willow Garage"},{modelPath:"cafe",modelTitle:"Cafe"},{modelPath:"box_target_green",modelTitle:"Box target (green)"},{modelPath:"box_target_red",modelTitle:"Box target (red)"},{modelPath:"hoop_red",modelTitle:"Hoop (red)"},{modelPath:"control_console",modelTitle:"Control Console"}]},{path:"furniture",title:"Furniture",examplePath1:"hinged_door",examplePath2:"bookshelf",examplePath3:"table",models:[{modelPath:"bookshelf",modelTitle:"Book Shelf"},{modelPath:"cabinet",modelTitle:"Cabinet"},{modelPath:"drc_practice_door_4x8",modelTitle:"4x8 Doorway"},{modelPath:"drc_practice_ladder",modelTitle:"Ladder"},{modelPath:"hinged_door",modelTitle:"Hinged Door"},{modelPath:"table",modelTitle:"Table"},{modelPath:"table_marble",modelTitle:"Table Marble"},{modelPath:"cafe_table",modelTitle:"Cafe table"},{modelPath:"drc_practice_ball_valve",modelTitle:"Ball Valve"},{modelPath:"drc_practice_handle_wheel_valve",modelTitle:"Handle Wheel Valve"},{modelPath:"drc_practice_hand_wheel_valve",modelTitle:"Hand Wheel Valve"},{modelPath:"drc_practice_wheel_valve",modelTitle:"Wheel Valve"},{modelPath:"drc_practice_wheel_valve_large",modelTitle:"Wheel Valve Large"},{modelPath:"door_handle",modelTitle:"Door Handle"},{modelPath:"drc_practice_ball_valve_wall",modelTitle:"Wall (Ball Valve)"},{modelPath:"drc_practice_handle_wheel_valve_wall",modelTitle:"Wall (Handle Wheel Valve)"},{modelPath:"drc_practice_hand_wheel_valve_wall",modelTitle:"Wall (Hand Wheel Valve)"},{modelPath:"drc_practice_valve_wall",modelTitle:"Wall (Valve)"},{modelPath:"drc_practice_wheel_valve_wall",modelTitle:"Wall (Wheel Valve)"},{modelPath:"drc_practice_wheel_valve_large_wall",modelTitle:"Wall (Wheel Valve Large)"},{modelPath:"grey_wall",modelTitle:"Grey Wall"},{modelPath:"asphalt_plane",modelTitle:"Asphalt Plane"},{modelPath:"drc_practice_base_4x8",modelTitle:"Debris base"},{modelPath:"ground_plane",modelTitle:"Ground Plane"},{modelPath:"nist_maze_wall_120",modelTitle:"120 Maze Wall"},{modelPath:"nist_maze_wall_240",modelTitle:"240 Maze Wall"},{modelPath:"nist_maze_wall_triple_holes_120",modelTitle:"120 Maze Wall Triple Holes"},{modelPath:"nist_simple_ramp_120",modelTitle:"Simple Ramp"},{modelPath:"nist_stairs_120",modelTitle:"Stairs"}]},{path:"kitchen",title:"Kitchen",examplePath1:"saucepan",examplePath2:"beer",examplePath3:"bowl",models:[{modelPath:"beer",modelTitle:"Beer"},{modelPath:"bowl",modelTitle:"Bowl"},{modelPath:"coke_can",modelTitle:"Coke Can"},{modelPath:"saucepan",modelTitle:"Saucepan"},{modelPath:"plastic_cup",modelTitle:"Plastic Cup"}]},{path:"robocup",title:"Robocup",examplePath1:"robocup_3Dsim_ball",examplePath2:"robocup14_spl_goal",examplePath3:"robocup09_spl_field",models:[{modelPath:"robocup09_spl_field",modelTitle:"2009 SPL Field"},{modelPath:"robocup14_spl_field",modelTitle:"2014 SPL Field"},{modelPath:"robocup_3Dsim_field",modelTitle:"3D Sim. Field"},{modelPath:"robocup14_spl_goal",modelTitle:"SPL Goal"},{modelPath:"robocup_3Dsim_goal",modelTitle:"3D Sim. Goal"},{modelPath:"robocup_spl_ball",modelTitle:"SPL Ball"},{modelPath:"robocup_3Dsim_ball",modelTitle:"3D Sim. Ball"}]},{path:"first",title:"FIRST",examplePath1:"frc2016_field",examplePath2:"frc2016_chevaldefrise",examplePath3:"frc_field_2015",models:[{modelPath:"frc2016_chevaldefrise",modelTitle:"Cheval de Frise"},{modelPath:"frc2016_drawbridge",modelTitle:"Draw Bridge"},{modelPath:"frc2016_field",modelTitle:"2016 Field"},{modelPath:"frc2016_lowbar",modelTitle:"Low Bar"},{modelPath:"frc2016_moat",modelTitle:"Moat"},{modelPath:"frc2016_portcullis",modelTitle:"Portcullis"},{modelPath:"frc2016_ramparts",modelTitle:"Ramparts"},{modelPath:"frc2016_rockwall",modelTitle:"Rockwall"},{modelPath:"frc2016_roughterrain",modelTitle:"Rough Terrain"},{modelPath:"frc2016_sallyport",modelTitle:"Sallyport"},{modelPath:"frc_field_2015",modelTitle:"2015 Field"}]},{path:"robots",title:"Robots",examplePath1:"pioneer3at",examplePath2:"turtlebot",examplePath3:"pr2",models:[{modelPath:"create",modelTitle:"Create"},{modelPath:"husky",modelTitle:"Husky"},{modelPath:"irobot_hand",modelTitle:"iRobot Hand"},{modelPath:"pioneer2dx",modelTitle:"Pioneer 2DX"},{modelPath:"pioneer3at",modelTitle:"Pioneer 3AT"},{modelPath:"pr2",modelTitle:"PR2"},{modelPath:"robonaut",modelTitle:"Robonaut"},{modelPath:"simple_arm",modelTitle:"Simple Arm"},{modelPath:"simple_arm_gripper",modelTitle:"Simple Arm and Gripper"},{modelPath:"simple_gripper",modelTitle:"Simple Gripper"},{modelPath:"turtlebot",modelTitle:"TurtleBot"},{modelPath:"youbot",modelTitle:"YouBot"},{modelPath:"cart_rigid_suspension",modelTitle:"Cart: rigid suspension"},{modelPath:"cart_soft_suspension",modelTitle:"Cart: soft suspension"},{modelPath:"cessna",modelTitle:"Cessna"},{modelPath:"follower_vehicle",modelTitle:"Follower Vehicle"},{modelPath:"iris_with_standoffs",modelTitle:"Iris with Standoffs"},{modelPath:"iris_with_standoffs_demo",modelTitle:"Iris with Standoffs (demo)"},{modelPath:"mpl_right_arm",modelTitle:"MPL right arm"},{modelPath:"mpl_right_forearm",modelTitle:"MPL right forearm"},{modelPath:"parrot_bebop_2",modelTitle:"Parrot Bebop 2"},{modelPath:"quadrotor",modelTitle:"Quadrotor"},{modelPath:"submarine",modelTitle:"Submarine"},{modelPath:"submarine_buoyant",modelTitle:"Submarine (buoyant)"},{modelPath:"submarine_sinking",modelTitle:"Submarine (sinking)"},{modelPath:"warehouse_robot",modelTitle:"Warehouse Robot"},{modelPath:"zephyr_delta_wing",modelTitle:"Zephyr Delta Wing"}]},{path:"sensors",title:"Sensors",examplePath1:"camera",examplePath2:"hokuyo",examplePath3:"kinect",models:[{modelPath:"camera",modelTitle:"Camera"},{modelPath:"stereo_camera",modelTitle:"Stereo Camera"},{modelPath:"hokuyo",modelTitle:"Hokuyo"},{modelPath:"kinect",modelTitle:"Kinect"},{modelPath:"depth_camera",modelTitle:"Depth Camera"},{modelPath:"gimbal_small_2d",modelTitle:"Gimbal Small 2D"},{modelPath:"velodyne_hdl32",modelTitle:"Velodyne HDL-32"}]},{path:"street",title:"Street",examplePath1:"dumpster",examplePath2:"drc_practice_angled_barrier_45",examplePath3:"fire_hydrant",models:[{modelPath:"cinder_block",modelTitle:"Cinder Block"},{modelPath:"cinder_block_2",modelTitle:"Cinder Block 2"},{modelPath:"cinder_block_wide",modelTitle:"Cinder Block Wide"},{modelPath:"construction_barrel",modelTitle:"Construction Barrel"},{modelPath:"construction_cone",modelTitle:"Construction Cone"},{modelPath:"drc_practice_angled_barrier_45",modelTitle:"Angled Barrier 45"},{modelPath:"drc_practice_angled_barrier_135",modelTitle:"Angled Barrier 135"},{modelPath:"drc_practice_block_wall",modelTitle:"Block Wall"},{modelPath:"drc_practice_orange_jersey_barrier",modelTitle:"Jersey Barrier (Orange)"},{modelPath:"drc_practice_white_jersey_barrier",modelTitle:"Jersey Barrier (White)"},{modelPath:"drc_practice_truss",modelTitle:"Truss"},{modelPath:"drc_practice_yellow_parking_block",modelTitle:"Parking Block"},{modelPath:"dumpster",modelTitle:"Dumpster"},{modelPath:"fire_hydrant",modelTitle:"Fire Hydrant"},{modelPath:"jersey_barrier",modelTitle:"Jersey Barrier"},{modelPath:"lamp_post",modelTitle:"Lamp Post"},{modelPath:"mailbox",modelTitle:"Mailbox"},{modelPath:"mud_box",modelTitle:"Mud Box"},{modelPath:"nist_fiducial_barrel",modelTitle:"Fiducial Barrel"},{modelPath:"speed_limit_sign",modelTitle:"Speed Limit Sign"},{modelPath:"stop_sign",modelTitle:"Stop Sign"},{modelPath:"first_2015_trash_can",modelTitle:"Trash Can"},{modelPath:"person_standing",modelTitle:"Person Standning"},{modelPath:"person_walking",modelTitle:"Person Walking"}]},{path:"tools",title:"Tools",examplePath1:"hammer",examplePath2:"polaris_ranger_ev",examplePath3:"cordless_drill",models:[{modelPath:"cordless_drill",modelTitle:"Cordless Drill"},{modelPath:"fire_hose_long",modelTitle:"Fire Hose"},{modelPath:"fire_hose_long_curled",modelTitle:"Fire Hose Long Curled"},{modelPath:"hammer",modelTitle:"Hammer"},{modelPath:"monkey_wrench",modelTitle:"Monkey Wrench"},{modelPath:"polaris_ranger_ev",modelTitle:"Polaris Ranger EV"},{modelPath:"polaris_ranger_xp900",modelTitle:"Polaris Ranger XP900"},{modelPath:"polaris_ranger_xp900_no_roll_cage",modelTitle:"Polaris Ranger without roll cage"},{modelPath:"utility_cart",modelTitle:"Utility Cart"},{modelPath:"car_wheel",modelTitle:"Car Wheel"},{modelPath:"arm_part",modelTitle:"Arm Part"},{modelPath:"gear_part",modelTitle:"Gear Part"},{modelPath:"gasket_part",modelTitle:"Gasket Part"},{modelPath:"disk_part",modelTitle:"Disk Part"},{modelPath:"pulley_part",modelTitle:"Pulley Part"},{modelPath:"piston_rod_part",modelTitle:"Piston Rod Part"},{modelPath:"t_brace_part",modelTitle:"T Brace Part"},{modelPath:"u_joint_part",modelTitle:"U Joint Part"}]},{path:"misc",title:"Misc.",examplePath1:"brick_box_3x1x3",examplePath2:"drc_practice_4x4x20",examplePath3:"double_pendulum_with_base",models:[{modelPath:"double_pendulum_with_base",modelTitle:"Double Pendulum With Base"},{modelPath:"breakable_test",modelTitle:"Breakable_test"},{modelPath:"brick_box_3x1x3",modelTitle:"Brick Box 3x1x3"},{modelPath:"cardboard_box",modelTitle:"Cardboard Box"},{modelPath:"cube_20k",modelTitle:"Cube 20k"},{modelPath:"cricket_ball",modelTitle:"Cricket Ball"},{modelPath:"marble_1_5cm",modelTitle:"Marble 1.5 cm"},{modelPath:"metal_peg",modelTitle:"Metal Peg"},{modelPath:"metal_peg_board",modelTitle:"Metal Peg Board"},{modelPath:"mars_rover",modelTitle:"Mars Rover"},{modelPath:"stone_10_2_5_1cm",modelTitle:"Stone 10 x 2.5 x 1 cm"},{modelPath:"tube_2_25cm",modelTitle:"Tube 2.25 cm"},{modelPath:"tube_9_5mm",modelTitle:"Tube 9.5 mm"},{modelPath:"wood_block_10_2_1cm",modelTitle:"Wood Block 10 x 2 x 1 cm"},{modelPath:"wood_cube_10cm",modelTitle:"Wood Cube 10 cm"},{modelPath:"wood_cube_2_5cm",modelTitle:"Wood Cube 2.5 cm"},{modelPath:"wood_cube_5cm",modelTitle:"Wood Cube 5 cm"},{modelPath:"wood_cube_7_5cm",modelTitle:"Wood Cube 7.5 cm"},{modelPath:"wooden_board",modelTitle:"Wooden Board"},{modelPath:"wooden_case",modelTitle:"Wooden Case"},{modelPath:"wooden_case_metal_peg",modelTitle:"Wooden Case Metal Peg "},{modelPath:"wooden_case_wooden_peg",modelTitle:"Wooden Case Wooden Peg"},{modelPath:"wooden_peg",modelTitle:"Wooden Peg"},{modelPath:"wooden_peg_board",modelTitle:"Wooden Peg Board"},{modelPath:"drc_practice_2x4",modelTitle:"2x4 Lumber"},{modelPath:"drc_practice_2x6",modelTitle:"2x6 Lumber"},{modelPath:"drc_practice_4x4x20",modelTitle:"4x4x20 Lumber"},{modelPath:"drc_practice_4x4x40",modelTitle:"4x4x40 Lumber"},{modelPath:"drc_practice_blue_cylinder",modelTitle:"Blue Cylinder"},{modelPath:"drc_practice_wood_slats",modelTitle:"Wood Slats"},{modelPath:"nist_elevated_floor_120",modelTitle:"Elevated Floor 120"},{modelPath:"number1",modelTitle:"Number 1"},{modelPath:"number2",modelTitle:"Number 2"},{modelPath:"number3",modelTitle:"Number 3"},{modelPath:"number4",modelTitle:"Number 4"},{modelPath:"number5",modelTitle:"Number 5"},{modelPath:"number6",modelTitle:"Number 6"},{modelPath:"number7",modelTitle:"Number 7"},{modelPath:"number8",modelTitle:"Number 8"},{modelPath:"number9",modelTitle:"Number 9"},{modelPath:"ragdoll",modelTitle:"Ragdoll"},{modelPath:"textured_shapes",modelTitle:"Textured shapes"}]}];function getNameFromPath(e){if("box"===e)return"Box";if("sphere"===e)return"Sphere";if("cylinder"===e)return"Cylinder";if("pointlight"===e)return"Point Light";if("spotlight"===e)return"Spot Light";if("directionallight"===e)return"Directional Light";for(var t=0;t<modelList.length;++t)for(var i=0;i<modelList[t].models.length;++i)if(modelList[t].models[i].modelPath===e)return modelList[t].models[i].modelTitle}$(function(){if(("ontouchstart"in window||"onmsgesturechange"in window)&&$("body").addClass("isTouchDevice"),$("#view-collisions").buttonMarkup({icon:"false"}),$("#snap-to-grid").buttonMarkup({icon:"false"}),$("#open-tree-when-selected").buttonMarkup({icon:"false"}),$("#view-transparent").buttonMarkup({icon:"false"}),$("#view-wireframe").buttonMarkup({icon:"false"}),$("#view-joints").buttonMarkup({icon:"false"}),$("#view-com").buttonMarkup({icon:"false"}),globalEmitter.emit("toggle_notifications"),globalEmitter.emit("show_orbit_indicator"),$("#clock-touch").popup("option","arrow","t"),$("#notification-popup-screen").remove(),$(".tab").css("border-left-color",tabColors.unselected),isWideScreen()&&globalEmitter.emit("openTab","mainMenu","mainMenu"),isTallScreen()&&($(".collapsible_header").click(),$("#expand-MODELS").click(),$("#expand-LIGHTS").click()),isTouchDevice){$("#logplay-slider").css("width","100%"),$(".mouse-only").css("display","none"),$("#play-header-fieldset").css("position","absolute").css("right","13.6em").css("top","0em").css("z-index","1000"),$("#clock-header-fieldset").css("position","absolute").css("right","10.2em").css("top","0em").css("z-index","1000"),$("#mode-header-fieldset").css("position","absolute").css("right","0.5em").css("top","0.15em").css("z-index","1000"),$(".gzGUI").touchstart(function(e){globalEmitter.emit("pointerOnMenu")}),$(".gzGUI").touchend(function(e){globalEmitter.emit("pointerOffMenu")});$("#container").on("touchstart",function(e){$(this).data("checkdown",setTimeout(function(){globalEmitter.emit("longpress_container_start",e)},400))}).on("touchend",function(e){clearTimeout($(this).data("checkdown")),globalEmitter.emit("longpress_container_end",e,!1)}).on("touchmove",function(e){clearTimeout($(this).data("checkdown")),$(this).data("checkdown",setTimeout(function(){globalEmitter.emit("longpress_container_start",e)},400)),globalEmitter.emit("longpress_container_move",e)});$('[id^="insert-entity-"]').on("touchstart",function(e){var t=$(this).attr("id");t=t.substring(14),$(this).data("checkdown",setTimeout(function(){globalEmitter.emit("longpress_insert_start",e,t)},400))}).on("touchend",function(e){clearTimeout($(this).data("checkdown")),globalEmitter.emit("longpress_insert_end",e,!1)}).on("touchmove",function(e){clearTimeout($(this).data("checkdown")),globalEmitter.emit("longpress_insert_move",e)})}else $(".touch-only").css("display","none"),$('[id^="insert-entity-"]').click(function(e){var t=$(this).attr("id");t=t.substring(14),globalEmitter.emit("spawn_entity_start",t)}).on("mousedown",function(e){e.preventDefault()}),$("#play-header-fieldset").css("position","absolute").css("right","41.2em").css("top","0em").css("z-index","1000"),$("#clock-mouse").css("position","absolute").css("right","29.0em").css("top","0.5em").css("z-index","100").css("width","11.5em").css("height","2.5em").css("background-color","#333333").css("padding","3px").css("border-radius","5px"),$("#mode-header-fieldset").css("position","absolute").css("right","24.4em").css("top","0.15em").css("z-index","1000"),$("#box-header-fieldset").css("position","absolute").css("right","15.5em").css("top","0em").css("z-index","1000"),$("#sphere-header-fieldset").css("position","absolute").css("right","12.5em").css("top","0em").css("z-index","1000"),$("#cylinder-header-fieldset").css("position","absolute").css("right","9.5em").css("top","0em").css("z-index","1000"),$("#pointlight-header-fieldset").css("position","absolute").css("right","6.5em").css("top","0em").css("z-index","1000"),$("#spotlight-header-fieldset").css("position","absolute").css("right","3.5em").css("top","0em").css("z-index","1000"),$("#directionallight-header-fieldset").css("position","absolute").css("right","0.5em").css("top","0em").css("z-index","1000"),$(".gzGUI").mouseenter(function(e){globalEmitter.emit("pointerOnMenu")}),$(".gzGUI").mouseleave(function(e){globalEmitter.emit("pointerOffMenu")}),$("#container").mousedown(function(e){e.preventDefault(),3===e.which&&globalEmitter.emit("right_click",e)}),$("#model-popup-screen").mousedown(function(e){$("#model-popup").popup("close")});$(".tab").click(function(){var e=$(this).attr("id"),t=e.substring(0,e.indexOf("Tab"));$("#"+e).css("border-left-color")===tabColors.unselected?globalEmitter.emit("openTab",lastOpenMenu[t],t):globalEmitter.emit("closeTabs",!0)}),$(".closePanels").click(function(){globalEmitter.emit("closeTabs",!0)}),$("#view-mode").click(function(){globalEmitter.emit("manipulation_mode","view")}),$("#translate-mode").click(function(){globalEmitter.emit("manipulation_mode","translate")}),$("#rotate-mode").click(function(){globalEmitter.emit("manipulation_mode","rotate")}),$('[id^="header-insert-"]').click(function(){var e=$(this).attr("id");e=e.substring(14),globalEmitter.emit("closeTabs",!1),globalEmitter.emit("spawn_entity_start",e)}),$("#play").click(function(){-1!==$("#playText").html().indexOf("Play")?(globalEmitter.emit("pause",!1),globalEmitter.emit("notification_popup","Physics engine running")):(globalEmitter.emit("pause",!0),globalEmitter.emit("notification_popup","Physics engine paused"))}),$("#clock").click(function(){if($.mobile.activePage.find("#clock-touch").parent().hasClass("ui-popup-active"))$("#clock-touch").popup("close");else{var e=$("#clock").offset();$("#notification-popup").popup("close"),$("#clock-touch").popup("open",{x:e.left+emUnits(1.6),y:emUnits(4)})}}),$("#reset-model").click(function(){globalEmitter.emit("reset","model"),globalEmitter.emit("closeTabs",!1)}),$("#reset-world").click(function(){globalEmitter.emit("reset","world"),globalEmitter.emit("closeTabs",!1)}),$("#reset-view").click(function(){globalEmitter.emit("view_reset"),globalEmitter.emit("closeTabs",!1)}),$("#view-grid").click(function(){globalEmitter.emit("show_grid","toggle"),globalEmitter.emit("closeTabs",!1)}),$("#view-collisions").click(function(){globalEmitter.emit("show_collision"),globalEmitter.emit("closeTabs",!1)}),$("#view-orbit-indicator").click(function(){globalEmitter.emit("show_orbit_indicator"),globalEmitter.emit("closeTabs",!1)}),$("#snap-to-grid").click(function(){globalEmitter.emit("snap_to_grid"),globalEmitter.emit("closeTabs",!1)}),$("#open-tree-when-selected").click(function(){globalEmitter.emit("openTreeWhenSelected"),globalEmitter.emit("closeTabs",!1)}),$("#toggle-notifications").click(function(){globalEmitter.emit("toggle_notifications"),globalEmitter.emit("closeTabs",!1)}),$("body").on("keyup",function(e){if(27===e.which)return!1}),$("#view-transparent").click(function(){$("#model-popup").popup("close"),globalEmitter.emit("set_view_as","transparent")}),$("#view-wireframe").click(function(){$("#model-popup").popup("close"),globalEmitter.emit("set_view_as","wireframe")}),$("#view-joints").click(function(){"rgb(255, 255, 255)"===$("#view-joints a").css("color")&&($("#model-popup").popup("close"),globalEmitter.emit("view_joints"))}),$("#view-com").click(function(){"rgb(255, 255, 255)"===$("#view-com a").css("color")&&($("#model-popup").popup("close"),globalEmitter.emit("view_com"))}),$("#view-inertia").click(function(){"rgb(255, 255, 255)"===$("#view-inertia a").css("color")&&($("#model-popup").popup("close"),globalEmitter.emit("view_inertia"))}),$("#delete-entity").click(function(){globalEmitter.emit("delete_entity")}),$(window).resize(function(){globalEmitter.emit("resizePanel")}),$("#logplay-slider-input").on("slidestop",function(e,t){globalEmitter.emit("logPlaySlideStop",$("#logplay-slider-input").val())}),$("#logplay-slider-input").on("slidestart",function(e,t){globalEmitter.emit("logPlaySlideStart")}),$("#logplay-rewind").click(function(){globalEmitter.emit("logPlayRewind")}),$("#logplay-stepback").click(function(){globalEmitter.emit("logPlayStepback")}),$("#logplay-play").click(function(){-1!==$("#logplay-playText").html().indexOf("Play")?globalEmitter.emit("pause",!1):globalEmitter.emit("pause",!0)}),$("#logplay-stepforward").click(function(){globalEmitter.emit("logPlayStepforward")}),$("#logplay-forward").click(function(){globalEmitter.emit("logPlayForward")})});var gzangular=angular.module("gzangular",[]);gzangular.directive("ngRightClick",function(r){return function(t,e,i){var n=r(i.ngRightClick);e.bind("contextmenu",function(e){t.$apply(function(){e.preventDefault(),n(t,{$event:e})})})}}),gzangular.controller("treeControl",["$scope",function(e){e.updateStats=function(){e.models=modelStats,e.lights=lightStats,e.scene=sceneStats,e.physics=physicsStats,e.$$phase||e.$apply()},e.selectEntity=function(e){$("#model-popup").popup("close"),globalEmitter.emit("openTab","propertyPanel-"+convertNameId(e),"treeMenu"),globalEmitter.emit("selectEntity",e)},e.openEntityMenu=function(e,t){$("#model-popup").popup("close"),globalEmitter.emit("openEntityPopup",e,t)},e.openTab=function(e){globalEmitter.emit("openTab",e,"treeMenu")},e.expandTree=function(e){var t="expandable-"+e,i="expand-"+e;$("#"+t).is(":visible")?($("#"+t).hide(),$("#"+i+" img").css("transform","rotate(0deg)").css("-webkit-transform","rotate(0deg)").css("-ms-transform","rotate(0deg)")):($("#"+t).show(),$("#"+i+" img").css("transform","rotate(90deg)").css("-webkit-transform","rotate(90deg)").css("-ms-transform","rotate(90deg)"))},e.expandProperty=function(e,t,i,n,r){var o,a,s=convertNameId(t),l="expandable-"+e+"-"+s,c="expand-"+e+"-"+s;i&&(l=(o=l)+"-"+i,c=(a=c)+"-"+i),$("#"+l).is(":visible")?($("#"+l).hide(),$("#"+c+" img").css("transform","rotate(0deg)").css("-webkit-transform","rotate(0deg)").css("-ms-transform","rotate(0deg)")):(!i||"link"!==e&&"joint"!==e||($('[id^="'+o+'-"]').hide(),$('[id^="'+a+'-"] img').css("transform","rotate(0deg)").css("-webkit-transform","rotate(0deg)").css("-ms-transform","rotate(0deg)")),$("#"+l).show(),$("#"+c+" img").css("transform","rotate(90deg)").css("-webkit-transform","rotate(90deg)").css("-ms-transform","rotate(90deg)"),"pose"===e&&"link"===r&&globalEmitter.emit("setPoseStats",t,n))},e.changePose=function(e,t,i,n){globalEmitter.emit("setPose",e,t,convertNameId(i),n)},e.changeLight=function(e,t,i){globalEmitter.emit("setLight",e,convertNameId(t),i)},e.toggleProperty=function(e,t,i){globalEmitter.emit("toggleProperty",e,t,i)}}]),gzangular.controller("insertControl",["$scope",function(e){e.categories=modelList,e.spawnEntity=function(e){globalEmitter.emit("spawn_entity_start",e)},e.openTab=function(e){globalEmitter.emit("openTab",e,"insertMenu")}}]),GZ3D.Gui=function(e){this.emitter=globalEmitter||new EventEmitter2({verboseMemoryLeak:!0}),this.scene=e,this.domElement=e.getDomElement(),this.spawnState=null,this.longPressContainerState=null,this.showNotifications=!1,this.openTreeWhenSelected=!1,this.modelStatsDirty=!1,this.logPlay=new GZ3D.LogPlay;var i,s=this;setInterval(function(){s.modelStatsDirty&&(s.updateStats(),s.modelStatsDirty=!1)},20),this.emitter.on("manipulation_mode",function(e){s.scene.setManipulationMode(e);var t=s.scene.modelManipulator.space;"view"===e?s.emitter.emit("notification_popup","View mode"):s.emitter.emit("notification_popup",e.charAt(0).toUpperCase()+e.substring(1)+" mode in "+t.charAt(0).toUpperCase()+t.substring(1)+" space")}),this.emitter.on("spawn_entity_start",function(t){s.scene.setManipulationMode("view"),$("#view-mode").prop("checked",!0),$('input[type="radio"]').checkboxradio("refresh");var e=getNameFromPath(t);s.spawnState="START",s.scene.spawnModel.start(t,function(e){s.emitter.emit("entityCreated",e,t)}),s.emitter.emit("notification_popup","Place "+e+" at the desired position")}),this.emitter.on("spawn_entity_move",function(e){s.spawnState="MOVE",s.scene.spawnModel.onTouchMove(e,!1)}),this.emitter.on("spawn_entity_end",function(){"MOVE"===s.spawnState&&s.scene.spawnModel.onTouchEnd(),s.spawnState=null}),this.emitter.on("reset",function(e){"world"===e?s.emitter.emit("notification_popup","Reset world"):"model"===e&&s.emitter.emit("notification_popup","Reset model poses")}),this.emitter.on("model_reset",function(){s.emitter.emit("reset","model"),s.emitter.emit("notification_popup","Reset model poses")}),this.emitter.on("view_reset",function(){s.scene.resetView(),s.emitter.emit("notification_popup","Reset view")}),this.emitter.on("show_collision",function(){s.scene.showCollision(!s.scene.showCollisions),s.scene.showCollisions?($("#view-collisions").buttonMarkup({icon:"check"}),s.emitter.emit("notification_popup","Viewing collisions")):($("#view-collisions").buttonMarkup({icon:"false"}),s.emitter.emit("notification_popup","Hiding collisions"))}),this.emitter.on("show_grid",function(e){"show"===e?s.scene.grid.visible=!0:"hide"===e?s.scene.grid.visible=!1:"toggle"===e&&(s.scene.grid.visible=!s.scene.grid.visible),s.scene.grid.visible?($("#view-grid").buttonMarkup({icon:"check"}),s.emitter.emit("notification_popup","Viewing grid")):($("#view-grid").buttonMarkup({icon:"false"}),s.emitter.emit("notification_popup","Hiding grid"))}),this.emitter.on("show_orbit_indicator",function(){s.scene.controls.showTargetIndicator=!s.scene.controls.showTargetIndicator,s.scene.controls.showTargetIndicator?($("#view-orbit-indicator").buttonMarkup({icon:"check"}),s.emitter.emit("notification_popup","Viewing orbit indicator")):($("#view-orbit-indicator").buttonMarkup({icon:"false"}),s.emitter.emit("notification_popup","Hiding orbit indicator"))}),this.emitter.on("snap_to_grid",function(){null===s.scene.modelManipulator.snapDist?($("#snap-to-grid").buttonMarkup({icon:"check"}),s.scene.modelManipulator.snapDist=.5,s.scene.spawnModel.snapDist=s.scene.modelManipulator.snapDist,s.emitter.emit("notification_popup","Snapping to grid")):($("#snap-to-grid").buttonMarkup({icon:"false"}),s.scene.modelManipulator.snapDist=null,s.scene.spawnModel.snapDist=null,s.emitter.emit("notification_popup","Not snapping to grid"))}),this.emitter.on("openTreeWhenSelected",function(){s.openTreeWhenSelected=!s.openTreeWhenSelected,s.openTreeWhenSelected?$("#open-tree-when-selected").buttonMarkup({icon:"check"}):$("#open-tree-when-selected").buttonMarkup({icon:"false"})}),this.emitter.on("toggle_notifications",function(){s.showNotifications=!s.showNotifications,s.showNotifications?$("#toggle-notifications").buttonMarkup({icon:"check"}):$("#toggle-notifications").buttonMarkup({icon:"false"})}),this.emitter.on("longpress_container_start",function(e){1!==e.originalEvent.touches.length||s.scene.modelManipulator.hovered||s.scene.spawnModel.active?s.emitter.emit("longpress_container_end",e.originalEvent,!0):(s.scene.showRadialMenu(e),s.longPressContainerState="START")}),this.emitter.on("longpress_container_end",function(e,t){"START"===s.longPressContainerState?(s.longPressContainerState="END",s.scene.radialMenu.showing&&(t?s.scene.radialMenu.hide(e):s.scene.radialMenu.hide(e,function(e,t){"delete"===e?(s.emitter.emit("deleteEntity",t),s.scene.setManipulationMode("view"),$("#view-mode").prop("checked",!0),$('input[type="radio"]').checkboxradio("refresh")):"translate"===e?($("#translate-mode").click(),$('input[type="radio"]').checkboxradio("refresh"),s.scene.attachManipulator(t,e)):"rotate"===e?($("#rotate-mode").click(),$('input[type="radio"]').checkboxradio("refresh"),s.scene.attachManipulator(t,e)):"transparent"===e?s.emitter.emit("set_view_as","transparent"):"wireframe"===e?s.emitter.emit("set_view_as","wireframe"):"joints"===e&&(s.scene.selectEntity(t),s.emitter.emit("view_joints"))}))):s.longPressContainerState="END"}),this.emitter.on("longpress_container_move",function(e){if(1!==e.originalEvent.touches.length)s.emitter.emit("longpress_container_end",e.originalEvent,!0);else{if("START"!==s.longPressContainerState)return;s.scene.radialMenu.showing&&s.scene.radialMenu.onLongPressMove(e)}}),this.emitter.on("longpress_insert_start",function(e,t){navigator.vibrate(50),s.emitter.emit("spawn_entity_start",t),e.stopPropagation()}),this.emitter.on("longpress_insert_end",function(e){s.emitter.emit("spawn_entity_end")}),this.emitter.on("longpress_insert_move",function(e){s.emitter.emit("spawn_entity_move",e),e.stopPropagation()}),this.emitter.on("notification_popup",function(e,t){s.showNotifications&&(clearTimeout(i),$("#notification-popup").popup("close"),$("#notification-popup").html("&nbsp;"+e+"&nbsp;"),$("#notification-popup").popup("open",{y:window.innerHeight-50}),void 0===t&&(t=2e3),i=setTimeout(function(){$("#notification-popup").popup("close")},t))}),this.emitter.on("right_click",function(t){s.scene.onRightClick(t,function(e){s.openEntityPopup(t,e)})}),this.emitter.on("set_view_as",function(e){s.scene.setViewAs(s.scene.selectedEntity,e)}),this.emitter.on("view_joints",function(){s.scene.viewJoints(s.scene.selectedEntity)}),this.emitter.on("view_inertia",function(){s.scene.viewInertia(s.scene.selectedEntity)}),this.emitter.on("view_com",function(){s.scene.viewCOM(s.scene.selectedEntity)}),this.emitter.on("delete_entity",function(){s.emitter.emit("deleteEntity",s.scene.selectedEntity),$("#model-popup").popup("close"),s.scene.selectEntity(null)}),this.emitter.on("pointerOnMenu",function(){s.scene.pointerOnMenu=!0}),this.emitter.on("pointerOffMenu",function(){s.scene.pointerOnMenu=!1}),this.emitter.on("openTab",function(e,t){if(lastOpenMenu[t]=e,$(".leftPanels").hide(),$("#"+e).show(),$(".tab").css("border-left-color",tabColors.unselected),$("#"+t+"Tab").css("border-left-color",tabColors.selected),0<=e.indexOf("propertyPanel-")){var i=e.substring(e.indexOf("-")+1),n=s.scene.getByName(convertNameId(i,!0)),r={};r.name=i,r.pose={},r.pose.position={x:n.position.x,y:n.position.y,z:n.position.z},r.pose.orientation={x:n.quaternion._x,y:n.quaternion._y,z:n.quaternion._z,w:n.quaternion._w}}s.emitter.emit("resizePanel")}),this.emitter.on("closeTabs",function(e){!e&&isWideScreen()||($(".leftPanels").hide(),$(".tab").css("left","0em"),$(".tab").css("border-left-color",tabColors.unselected))}),this.emitter.on("setTreeSelected",function(e){for(var t=0;t<modelStats.length;++t)modelStats[t].name===e?(modelStats[t].selected="selectedTreeItem",s.openTreeWhenSelected&&s.emitter.emit("openTab","propertyPanel-"+convertNameId(e),"treeMenu")):modelStats[t].selected="unselectedTreeItem";for(t=0;t<lightStats.length;++t)lightStats[t].name===e?(lightStats[t].selected="selectedTreeItem",s.openTreeWhenSelected&&s.emitter.emit("openTab","propertyPanel-"+convertNameId(e),"treeMenu")):lightStats[t].selected="unselectedTreeItem";s.updateStats()}),this.emitter.on("setTreeDeselected",function(){for(var e=0;e<modelStats.length;++e)modelStats[e].selected="unselectedTreeItem";for(e=0;e<lightStats.length;++e)lightStats[e].selected="unselectedTreeItem";s.updateStats()}),this.emitter.on("selectEntity",function(e){var t=s.scene.getByName(e);s.scene.selectEntity(t)}),this.emitter.on("openEntityPopup",function(e,t){if(!isTouchDevice){var i=s.scene.getByName(t);s.openEntityPopup(e,i)}}),this.emitter.on("setPoseStats",function(e,t){var i;i=void 0===t?s.scene.getByName(e):s.scene.getByName(t);var n={};n.name=i.name,n.pose={},n.pose.position={x:i.position.x,y:i.position.y,z:i.position.z},n.pose.orientation={x:i.quaternion._x,y:i.quaternion._y,z:i.quaternion._z,w:i.quaternion._w},i.children[0]instanceof THREE.Light?s.setLightStats(n,"update"):s.setModelStats(n,"update")}),this.emitter.on("resizePanel",function(){if($(".leftPanels").is(":visible")&&(isWideScreen()?$(".tab").css("left","23em"):$(".tab").css("left","10.5em")),$(".propertyPanels").is(":visible")){var e=$(window).width();isWideScreen()&&(e=emUnits(23)),$(".propertyPanels").css("width",e)}}),this.emitter.on("setPose",function(e,t,i,n){if(void 0!==n){var r=s.scene.getByName(i);if("orientation"===e?(r.rotation["_"+t]=n,r.quaternion.setFromEuler(r.rotation)):r[e][t]=n,r.updateMatrixWorld(),r.children[0]&&(r.children[0]instanceof THREE.SpotLight||r.children[0]instanceof THREE.DirectionalLight)){var o=r.children[0],a=new THREE.Vector3(0,0,0);a.copy(r.direction),r.localToWorld(a),o.target.position.copy(a)}s.scene.emitter.emit("entityChanged",r)}}),this.emitter.on("setLight",function(e,t,i){if(void 0!==i){var n=s.scene.getByName(t),r=n.children[0];"diffuse"===e?r.color=new THREE.Color(i):"specular"===e?n.serverProperties.specular=new THREE.Color(i):"range"===e?r.distance=i:"attenuation_constant"===e?n.serverProperties.attenuation_constant=i:"attenuation_linear"===e?(n.serverProperties.attenuation_linear=i,r.intensity=r.intensity/(1+i)):"attenuation_quadratic"===e&&(n.serverProperties.attenuation_quadratic=i,r.intensity=r.intensity/(1+i)),s.scene.emitter.emit("entityChanged",n)}}),this.emitter.on("toggleProperty",function(e,t){var i=s.scene.getByName(t);i.serverProperties[e]=!i.serverProperties[e],s.scene.emitter.emit("linkChanged",i)}),this.emitter.on("setLightStats",function(e,t){s.setLightStats(e,t)}),this.emitter.on("setModelStats",function(e,t){s.setModelStats(e,t)}),this.emitter.on("setSceneStats",function(e){s.setSceneStats(e)}),this.emitter.on("setPhysicsStats",function(e){s.setPhysicsStats(e)}),this.emitter.on("setPaused",function(e){s.setPaused(e)}),this.emitter.on("setLogPlayVisible",function(e){s.setLogPlayVisible(e)}),this.emitter.on("setLogPlayStats",function(e,t,i){s.setLogPlayStats(e,t,i)}),this.emitter.on("setRealTime",function(e){s.setRealTime(e)}),this.emitter.on("setSimTime",function(e){s.setSimTime(e)})},GZ3D.Gui.prototype.setPaused=function(e){e?$("#playText").html('<img style="height:1.2em" src="style/images/play.png" title="Play">'):$("#playText").html('<img style="height:1.2em" src="style/images/pause.png" title="Pause">'),this.emitter.emit("paused",e)},GZ3D.Gui.prototype.setRealTime=function(e){$(".real-time-value").text(formatTime(e))},GZ3D.Gui.prototype.setSimTime=function(e){$(".sim-time-value").text(formatTime(e))};var sceneStats={};GZ3D.Gui.prototype.setSceneStats=function(e){sceneStats.ambient=this.round(e.ambient,!0),sceneStats.background=this.round(e.background,!0)};var physicsStats={};GZ3D.Gui.prototype.setPhysicsStats=function(e){(physicsStats=e).enable_physics=this.trueOrFalse(physicsStats.enable_physics),physicsStats.max_step_size=this.round(physicsStats.max_step_size,!1,3),physicsStats.gravity=this.round(physicsStats.gravity,!1,3),physicsStats.sor=this.round(physicsStats.sor,!1,3),physicsStats.cfm=this.round(physicsStats.cfm,!1,3),physicsStats.erp=this.round(physicsStats.erp,!1,3),physicsStats.contact_max_correcting_vel=this.round(physicsStats.contact_max_correcting_vel,!1,3),physicsStats.contact_surface_layer=this.round(physicsStats.contact_surface_layer,!1,3),this.updateStats()};var modelStats=[];GZ3D.Gui.prototype.setModelStats=function(e,t){var i,n=e.name;if(0<=e.name.indexOf("::")&&(n=e.name.substring(0,e.name.indexOf("::")),i=e.name.substring(e.name.lastIndexOf("::")+2)),"update"===t){var r,o=$.grep(modelStats,function(e){return e.name===n});if(0===o.length){var a=this.findModelThumbnail(n);r=this.formatStats(e),modelStats.push({name:n,id:convertNameId(n),thumbnail:a,selected:"unselectedTreeItem",is_static:this.trueOrFalse(e.is_static),position:r.pose.position,orientation:r.pose.orientation,links:[],joints:[]});var s=modelStats[modelStats.length-1];if(e.link)for(var l=0;l<e.link.length;++l){var c=e.link[l].name.substring(e.link[l].name.lastIndexOf("::")+2);r=this.formatStats(e.link[l]),s.links.push({name:e.link[l].name,shortName:c,self_collide:this.trueOrFalse(e.link[l].self_collide),gravity:this.trueOrFalse(e.link[l].gravity),kinematic:this.trueOrFalse(e.link[l].kinematic),canonical:this.trueOrFalse(e.link[l].canonical),position:r.pose.position,orientation:r.pose.orientation,inertial:r.inertial})}if(e.joint)for(var h=0;h<e.joint.length;++h){var u,d=e.joint[h].name.substring(e.joint[h].name.lastIndexOf("::")+2),p=e.joint[h].parent.substring(e.joint[h].parent.lastIndexOf("::")+2),f=e.joint[h].child.substring(e.joint[h].child.lastIndexOf("::")+2);switch(e.joint[h].type){case 1:u="Revolute";break;case 2:u="Revolute2";break;case 3:u="Prismatic";break;case 4:u="Universal";break;case 5:u="Ball";break;case 6:u="Screw";break;case 7:u="Gearbox";break;default:u="Unknown"}r=this.formatStats(e.joint[h]),s.joints.push({name:e.joint[h].name,shortName:d,type:u,parent:e.joint[h].parent,parentShortName:p,child:e.joint[h].child,childShortName:f,position:r.pose.position,orientation:r.pose.orientation,axis1:r.axis1,axis2:r.axis2})}this.updateStats()}else{var m;if(e.link&&e.link[0]){var g=e.link[0].name;(m=$.grep(o[0].links,function(e){return e.shortName===g}))[0]&&(m[0].self_collide&&(m[0].self_collide=this.trueOrFalse(e.link[0].self_collide)),m[0].gravity&&(m[0].gravity=this.trueOrFalse(e.link[0].gravity)),m[0].kinematic&&(m[0].kinematic=this.trueOrFalse(e.link[0].kinematic)))}var v=convertNameId(n);i&&!$("#expandable-pose-"+v+"-"+i).is(":visible")||!i&&!$("#expandable-pose-"+v).is(":visible")||$("#expandable-pose-"+v+" input").is(":focus")||(e.position&&(e.pose={},e.pose.position=e.position,e.pose.orientation=e.orientation),e.pose&&(r=this.formatStats(e),void 0===i?(o[0].position=r.pose.position,o[0].orientation=r.pose.orientation):((m=$.grep(o[0].links,function(e){return e.shortName===i}))[0].position=r.pose.position,m[0].orientation=r.pose.orientation)),this.updateModelStatsAsync())}}else"delete"===t&&(this.deleteFromStats("model",n),this.updateStats())};var lightStats=[];GZ3D.Gui.prototype.setLightStats=function(e,t){var i=e.name;if("update"===t){var n,r=$.grep(lightStats,function(e){return e.name===i});if(0===r.length){var o,a;switch(e.type){case 2:o="style/images/spotlight.png";break;case 3:o="style/images/directionallight.png";break;default:o="style/images/pointlight.png"}e.attenuation={constant:e.attenuation_constant,linear:e.attenuation_linear,quadratic:e.attenuation_quadratic},n=this.formatStats(e),e.direction&&(a=e.direction),lightStats.push({name:i,id:convertNameId(i),thumbnail:o,selected:"unselectedTreeItem",position:n.pose.position,orientation:n.pose.orientation,diffuse:n.diffuse,specular:n.specular,color:n.color,range:e.range,attenuation:this.round(e.attenuation,!1,null),direction:a})}else n=this.formatStats(e),e.pose&&(r[0].position=n.pose.position,r[0].orientation=n.pose.orientation),e.diffuse&&(r[0].diffuse=n.diffuse),e.specular&&(r[0].specular=n.specular)}else"delete"===t&&this.deleteFromStats("light",i);this.updateStats()},GZ3D.Gui.prototype.findModelThumbnail=function(e){for(var t=0;t<modelList.length;++t)for(var i=0;i<modelList[t].models.length;++i){var n=modelList[t].models[i].modelPath;if(0<=e.indexOf(n))return"/assets/"+n+"/thumbnails/0.png"}return 0<=e.indexOf("box")?"style/images/box.png":0<=e.indexOf("sphere")?"style/images/sphere.png":0<=e.indexOf("cylinder")?"style/images/cylinder.png":"style/images/box.png"},GZ3D.Gui.prototype.updateStats=function(){angular.element($("#treeMenu")).scope().updateStats()},GZ3D.Gui.prototype.updateModelStatsAsync=function(){this.modelStatsDirty=!0},GZ3D.Gui.prototype.openEntityPopup=function(e,t){this.scene.selectEntity(t),$(".ui-popup").popup("close"),t.children[0]instanceof THREE.Light?($("#view-transparent").css("visibility","collapse"),$("#view-wireframe").css("visibility","collapse"),$("#view-joints").css("visibility","collapse"),$("#view-com").css("visibility","collapse"),$("#view-inertia").css("visibility","collapse"),$("#model-popup").popup("open",{x:e.clientX+emUnits(6),y:e.clientY+emUnits(-8)})):("transparent"===this.scene.selectedEntity.viewAs?$("#view-transparent").buttonMarkup({icon:"check"}):$("#view-transparent").buttonMarkup({icon:"false"}),"wireframe"===this.scene.selectedEntity.viewAs?$("#view-wireframe").buttonMarkup({icon:"check"}):$("#view-wireframe").buttonMarkup({icon:"false"}),0===t.children.length?($("#view-inertia a").css("color","#888888"),$("#view-inertia").buttonMarkup({icon:"false"}),$("#view-com a").css("color","#888888"),$("#view-com").buttonMarkup({icon:"false"})):($("#view-inertia a").css("color","#ffffff"),$("#view-com a").css("color","#ffffff"),t.getObjectByName("INERTIA_VISUAL",!0)?$("#view-inertia").buttonMarkup({icon:"check"}):$("#view-inertia").buttonMarkup({icon:"false"}),t.getObjectByName("COM_VISUAL",!0)?$("#view-com").buttonMarkup({icon:"check"}):$("#view-com").buttonMarkup({icon:"false"})),void 0===t.joint||0===t.joint.length?($("#view-joints a").css("color","#888888"),$("#view-joints").buttonMarkup({icon:"false"})):($("#view-joints a").css("color","#ffffff"),t.getObjectByName("JOINT_VISUAL",!0)?$("#view-joints").buttonMarkup({icon:"check"}):$("#view-joints").buttonMarkup({icon:"false"})),$("#view-transparent").css("visibility","visible"),$("#view-wireframe").css("visibility","visible"),$("#view-joints").css("visibility","visible"),$("#view-com").css("visibility","visible"),$("#view-inertia").css("visibility","visible"),$("#model-popup").popup("open",{x:e.clientX+emUnits(6),y:e.clientY+emUnits(0)}))},GZ3D.Gui.prototype.formatStats=function(e){var t,i,n,r,o,a,s,l;if(e.pose&&(t=this.round(e.pose.position,!1,null),n=new THREE.Quaternion(e.pose.orientation.x,e.pose.orientation.y,e.pose.orientation.z,e.pose.orientation.w),(r=new THREE.Euler).setFromQuaternion(n),i={roll:r._x,pitch:r._y,yaw:r._z},i=this.round(i,!1,null)),e.inertial){o=this.round(e.inertial,!1,3);var c=e.inertial.pose;o.pose={},o.pose.position={x:c.position.x,y:c.position.y,z:c.position.z},o.pose.position=this.round(o.pose.position,!1,3),n=new THREE.Quaternion(c.orientation.x,c.orientation.y,c.orientation.z,c.orientation.w),(r=new THREE.Euler).setFromQuaternion(n),o.pose.orientation={roll:r._x,pitch:r._y,yaw:r._z},o.pose.orientation=this.round(o.pose.orientation,!1,3)}var h,u,d,p={};if(e.diffuse){for(l in s={},a=this.round(e.diffuse,!0))s[l]=a[l].toString(16),1===s[l].length&&(s[l]="0"+s[l]);p.diffuse="#"+s.r+s.g+s.b}if(e.specular){for(l in s={},h=this.round(e.specular,!0))s[l]=h[l].toString(16),1===s[l].length&&(s[l]="0"+s[l]);p.specular="#"+s.r+s.g+s.b}return e.axis1&&(u={},(u=this.round(e.axis1)).direction=this.round(e.axis1.xyz,!1,3)),e.axis2&&(d={},(d=this.round(e.axis2)).direction=this.round(e.axis2.xyz,!1,3)),{pose:{position:t,orientation:i},inertial:o,diffuse:a,specular:h,color:p,axis1:u,axis2:d}},GZ3D.Gui.prototype.round=function(e,t,i){var n=e;return n="number"==typeof n?this.roundNumber(n,t,i):this.roundArray(n,t,i)},GZ3D.Gui.prototype.roundNumber=function(e,t,i){var n=e;return n=t?Math.round(255*n):null===i?Math.round(1e3*n)/1e3:n.toFixed(i)},GZ3D.Gui.prototype.roundArray=function(e,t,i){var n=e;for(var r in n)"number"==typeof n[r]&&(n[r]=this.roundNumber(n[r],t,i));return n},GZ3D.Gui.prototype.trueOrFalse=function(e){return e?{icon:"true",title:"True"}:{icon:"false",title:"False"}},GZ3D.Gui.prototype.deleteFromStats=function(e,t){for(var i="model"===e?modelStats:lightStats,n=0;n<i.length;++n)if(i[n].name===t){$("#propertyPanel-"+convertNameId(t)).is(":visible")&&this.emitter.emit("openTab","treeMenu","treeMenu"),i.splice(n,1);break}},GZ3D.Gui.prototype.setLogPlayVisible=function(e){e!==this.logPlay.isVisible()&&(this.logPlay.setVisible(e),e?($("#editMenu").hide(),$("#insertMenuTab").hide(),$("#manipulatorModeFieldset").hide(),$("#simpleShapesFieldset").hide(),$("#lightsFieldset").hide(),$("#clock-mouse").hide(),$("#clock-header-fieldset").hide(),$("#play-header-fieldset").hide()):($("#editMenu").show(),$("#insertMenuTab").show(),$("#manipulatorModeFieldset").show(),$("#simpleShapesFieldset").show(),$("#lightsFieldset").show(),$("#clock-mouse").show(),$("#clock-header-fieldset").show(),$("#play-header-fieldset").show()))},GZ3D.Gui.prototype.setLogPlayStats=function(e,t,i){this.logPlay.setStats(e,t,i),$(".end-time-value").text(formatTime(i))};var convertNameId=function(e,t){return t?e.replace(new RegExp("_gzspace_","g")," "):e.replace(new RegExp(" ","g"),"_gzspace_")},formatTime=function(e){var t=e.sec,i=e.nsec;t-=86400*Math.floor(t/86400);var n=Math.floor(t/3600);t-=3600*n;var r=Math.floor(t/60);t-=60*r;var o=Math.floor(1e-6*i),a="";return n<10&&(a+="0"),a+=n.toFixed(0)+":",r<10&&(a+="0"),a+=r.toFixed(0)+":",t<10&&(a+="0"),a+=t.toFixed(0)+".",a+=("00"+o.toFixed(0)).slice(-3)};GZ3D.GZIface=function(e,t){this.emitter=globalEmitter||new EventEmitter2({verboseMemoryLeak:!0}),this.scene=e,this.url=t||location.hostname+":"+location.port,this.isConnected=!1,this.material=[],this.entityMaterial={},this.connect(),this.visualsToAdd=[],this.numConnectionTrials=0,this.maxConnectionTrials=30,this.timeToSleepBtwTrials=1e3},GZ3D.GZIface.prototype.connect=function(){this.webSocket=new ROSLIB.Ros({url:"ws://"+this.url});var e=this;this.webSocket.on("connection",function(){e.onConnected()}),this.webSocket.on("error",function(){e.onError()}),this.numConnectionTrials++},GZ3D.GZIface.prototype.onError=function(){1===this.numConnectionTrials&&this.emitter.emit("connectionError");var e=this;this.numConnectionTrials<this.maxConnectionTrials&&setTimeout(function(){e.connect()},this.timeToSleepBtwTrials)},GZ3D.GZIface.prototype.onConnected=function(){this.isConnected=!0,this.emitter.emit("connection"),this.heartbeatTopic=new ROSLIB.Topic({ros:this.webSocket,name:"~/heartbeat",messageType:"heartbeat"});var s=this;setInterval(function(){s.heartbeatTopic.publish({alive:1})},5e3);new ROSLIB.Topic({ros:this.webSocket,name:"~/status",messageType:"status"}).subscribe(function(e){"error"===e.status&&(s.isConnected=!1,this.emitter.emit("gzstatus","error"))}.bind(this));new ROSLIB.Topic({ros:this.webSocket,name:"~/material",messageType:"material"}).subscribe(function(e){this.material=e,this.emitter.emit("material",this.material)}.bind(this)),this.sceneTopic=new ROSLIB.Topic({ros:this.webSocket,name:"~/scene",messageType:"scene"});this.sceneTopic.subscribe(function(e){if(e.name&&(this.scene.name=e.name),!0===e.grid&&this.emitter.emit("show_grid","show"),e.ambient){var t=new THREE.Color;t.r=e.ambient.r,t.g=e.ambient.g,t.b=e.ambient.b,this.scene.ambient.color=t}if(e.background){var i=new THREE.Color;i.r=e.background.r,i.g=e.background.g,i.b=e.background.b,this.scene.renderer.clear(),this.scene.renderer.setClearColor(i,1)}for(var n=0;n<e.light.length;++n){var r=e.light[n],o=this.createLightFromMsg(r);this.scene.add(o),this.emitter.emit("setLightStats",r,"update")}for(var a=0;a<e.model.length;++a){var s=e.model[a],l=this.createModelFromMsg(s);this.scene.add(l),this.emitter.emit("setModelStats",s,"update")}this.emitter.emit("setSceneStats",e),this.sceneTopic.unsubscribe()}.bind(this)),this.physicsTopic=new ROSLIB.Topic({ros:this.webSocket,name:"~/physics",messageType:"physics"});this.physicsTopic.subscribe(function(e){this.emitter.emit("setPhysicsStats",e)}.bind(this));new ROSLIB.Topic({ros:this.webSocket,name:"~/pose/info",messageType:"pose"}).subscribe(function(e){var t=this.scene.getByName(e.name);t&&t!==this.scene.modelManipulator.object&&t.parent!==this.scene.modelManipulator.object&&(this.scene.updatePose(t,e.position,e.orientation),this.emitter.emit("setModelStats",e,"update"))}.bind(this));new ROSLIB.Topic({ros:this.webSocket,name:"~/request",messageType:"request"}).subscribe(function(e){if("entity_delete"===e.request){var t=this.scene.getByName(e.data);t&&(t.children[0]instanceof THREE.Light?this.emitter.emit("setLightStats",{name:e.data},"delete"):this.emitter.emit("setModelStats",{name:e.data},"delete"),this.emitter.emit("notification_popup",e.data+" deleted"),this.scene.remove(t))}}.bind(this));new ROSLIB.Topic({ros:this.webSocket,name:"~/model/info",messageType:"model"}).subscribe(function(e){if(!this.scene.getByName(e.name)){var t=this.createModelFromMsg(e);t&&(this.scene.add(t),this.emitter.emit("notification_popup",e.name+" inserted"));for(var i=this.visualsToAdd.length,n=0,r=0;n<i;){var o=this.visualsToAdd[r].parent_name;if(0<=o.indexOf(t.name)){var a=this.scene.getByName(o),s=this.createVisualFromMsg(this.visualsToAdd[r]);a.add(s),this.visualsToAdd.splice(r,1)}else r++;n++}}this.emitter.emit("setModelStats",e,"update")}.bind(this));new ROSLIB.Topic({ros:this.webSocket,name:"~/visual",messageType:"visual"}).subscribe(function(e){if(!this.scene.getByName(e.name)){if(e.name.indexOf("COLLISION_VISUAL")<0)return;var t=this.scene.getByName(e.parent_name);if(e.parent_name&&!t)this.visualsToAdd.push(e);else{var i=this.createVisualFromMsg(e);t.add(i)}}}.bind(this));new ROSLIB.Topic({ros:this.webSocket,name:"~/world_stats",messageType:"world_stats"}).subscribe(function(e){this.forwardWorldStats(e)}.bind(this));new ROSLIB.Topic({ros:this.webSocket,name:"~/factory/light",messageType:"light"}).subscribe(function(e){if(!this.scene.getByName(e.name)){var t=this.createLightFromMsg(e);this.scene.add(t);var i=[];this.scene.scene.getDescendants(i);for(var n=0;n<i.length;++n)i[n].material&&(i[n].material.needsUpdate=!0);this.emitter.emit("notification_popup",e.name+" inserted")}this.emitter.emit("setLightStats",e,"update")}.bind(this));new ROSLIB.Topic({ros:this.webSocket,name:"~/light/modify",messageType:"light"}).subscribe(function(e){var t=this.scene.getByName(e.name);t&&t!==this.scene.modelManipulator.object&&t.parent!==this.scene.modelManipulator.object&&(this.scene.updateLight(t,e),this.emitter.emit("setLightStats",e,"update"))}.bind(this)),this.heightmapDataService=new ROSLIB.Service({ros:this.webSocket,name:"~/heightmap_data",serviceType:"heightmap_data"}),this.roadService=new ROSLIB.Service({ros:this.webSocket,name:"~/roads",serviceType:"roads"});var e=new ROSLIB.ServiceRequest({name:"roads"});this.roadService.callService(e,function(e){var t=s.createRoadsFromMsg(e);this.scene.add(t)}),this.modelModifyTopic=new ROSLIB.Topic({ros:this.webSocket,name:"~/model/modify",messageType:"model"}),this.lightModifyTopic=new ROSLIB.Topic({ros:this.webSocket,name:"~/light/modify",messageType:"light"});this.emitter.on("entityChanged",function(e){var t=e.matrixWorld,i=new THREE.Vector3,n=new THREE.Quaternion,r=new THREE.Vector3;t.decompose(i,n,r);var o={name:e.name,id:e.userData.id,createEntity:0,position:{x:i.x,y:i.y,z:i.z},orientation:{w:n.w,x:n.x,y:n.y,z:n.z}};e.children[0]&&e.children[0]instanceof THREE.Light?(o.diffuse={r:e.children[0].color.r,g:e.children[0].color.g,b:e.children[0].color.b},o.specular={r:e.serverProperties.specular.r,g:e.serverProperties.specular.g,b:e.serverProperties.specular.b},o.direction=e.direction,o.range=e.children[0].distance,o.attenuation_constant=e.serverProperties.attenuation_constant,o.attenuation_linear=e.serverProperties.attenuation_linear,o.attenuation_quadratic=e.serverProperties.attenuation_quadratic,s.lightModifyTopic.publish(o)):s.modelModifyTopic.publish(o)}),this.linkModifyTopic=new ROSLIB.Topic({ros:this.webSocket,name:"~/link",messageType:"link"});this.emitter.on("linkChanged",function(e,t){var i={name:e.parent.name,id:e.parent.userData.id,link:{name:e.name,id:e.userData.id,self_collide:e.serverProperties.self_collide,gravity:e.serverProperties.gravity,kinematic:e.serverProperties.kinematic}};s.linkModifyTopic.publish(i)}),this.factoryTopic=new ROSLIB.Topic({ros:this.webSocket,name:"~/factory",messageType:"factory"}),this.lightFactoryTopic=new ROSLIB.Topic({ros:this.webSocket,name:"~/factory/light",messageType:"light"});this.deleteTopic=new ROSLIB.Topic({ros:this.webSocket,name:"~/entity_delete",messageType:"entity_delete"});this.emitter.on("deleteEntity",function(e){var t;t={name:e.name},s.deleteTopic.publish(t)}),this.worldControlTopic=new ROSLIB.Topic({ros:this.webSocket,name:"~/world_control",messageType:"world_control"});var t=function(e,t){var i={};null!==e&&(i.pause=e),t&&(i.reset=t),s.worldControlTopic.publish(i)};this.emitter.on("entityCreated",function(e,t){var i=e.matrixWorld,n=new THREE.Vector3,r=new THREE.Quaternion,o=new THREE.Vector3;i.decompose(n,r,o);var a={name:e.name,type:t,createEntity:1,position:{x:n.x,y:n.y,z:n.z},orientation:{w:r.w,x:r.x,y:r.y,z:r.z}};e.children[0].children[0]instanceof THREE.Light?s.lightFactoryTopic.publish(a):s.factoryTopic.publish(a)}),this.emitter.on("reset",function(e){t(null,e)}),this.emitter.on("pause",function(e){t(e,null)}),this.playbackControlTopic=new ROSLIB.Topic({ros:this.webSocket,name:"~/playback_control",messageType:"playback_control"});this.emitter.on("logPlayChanged",function(e){s.playbackControlTopic.publish(e)})},GZ3D.GZIface.prototype.forwardWorldStats=function(e){void 0!==e.paused&&this.emitter.emit("setPaused",e.paused),e.log_playback_stats?(this.emitter.emit("setLogPlayVisible",!0),this.emitter.emit("setLogPlayStats",e.sim_time,e.log_playback_stats.start_time,e.log_playback_stats.end_time)):(this.emitter.emit("setLogPlayVisible",!1),this.emitter.emit("setRealTime",e.real_time)),this.emitter.emit("setSimTime",e.sim_time)},GZ3D.GZIface.prototype.createModelFromMsg=function(e){var t=new THREE.Object3D;t.name=e.name,t.userData.id=e.id,e.pose&&this.scene.setPose(t,e.pose.position,e.pose.orientation);for(var i=0;i<e.link.length;++i){var n=e.link[i],r=new THREE.Object3D;if(r.name=n.name,r.userData.id=n.id,r.serverProperties={self_collide:n.self_collide,gravity:n.gravity,kinematic:n.kinematic},n.inertial){var o,a,s={};r.userData.inertial={},o=n.inertial.pose,a=n.inertial.mass,s.ixx=n.inertial.ixx,s.ixy=n.inertial.ixy,s.ixz=n.inertial.ixz,s.iyy=n.inertial.iyy,s.iyz=n.inertial.iyz,s.izz=n.inertial.izz,r.userData.inertial.inertia=s,a&&(r.userData.inertial.mass=a),o&&(r.userData.inertial.pose=o)}n.pose&&this.scene.setPose(r,n.pose.position,n.pose.orientation),t.add(r);for(var l=0;l<n.visual.length;++l){var c=n.visual[l],h=this.createVisualFromMsg(c);h&&!h.parent&&r.add(h)}for(var u=0;u<n.collision.length;++u){n.collision[u];for(var d=0;d<n.collision[u].visual.length;++d){var p=n.collision[u].visual[d],f=this.createVisualFromMsg(p);f&&!f.parent&&r.add(f)}}}return e.joint&&(t.joint=e.joint),t},GZ3D.GZIface.prototype.createVisualFromMsg=function(e){if(e.geometry){var t=e.geometry,i=new THREE.Object3D;return i.name=e.name,e.pose&&this.scene.setPose(i,e.pose.position,e.pose.orientation),i.castShadow=e.cast_shadows,i.receiveShadow=e.receive_shadows,this.createGeom(t,e.material,i),i}},GZ3D.GZIface.prototype.createLightFromMsg=function(e){var t,i;1===e.type?(i=null,t=e.range):2===e.type?(i=e.direction,t=e.range):3===e.type&&(i=e.direction,t=null);var n=e.attenuation_linear,r=e.attenuation_quadratic,o=1/(1+1*n)*1*(Math.pow(1,2)/(Math.pow(1,2)+r*Math.pow(1,2)));return this.scene.createLight(e.type,e.diffuse,o,e.pose,t,e.cast_shadows,e.name,i,e.specular,e.attenuation_constant,e.attenuation_linear,e.attenuation_quadratic)},GZ3D.GZIface.prototype.createRoadsFromMsg=function(e){var t=new THREE.Object3D,i=this.material["Gazebo/Road"],n=null;i&&(n=this.parseUri("media/materials/textures/"+i.texture));var r=this.scene.createRoads(e.point,e.width,n);return t.add(r),t},GZ3D.GZIface.prototype.parseUri=function(e){var t=e.indexOf("://");return 0<t&&(t+=3),"assets/"+e.substring(t)},GZ3D.GZIface.prototype.createGeom=function(i,e,n){var t,r=this,o=this.parseMaterial(e);if(i.box)t=this.scene.createBox(i.box.size.x,i.box.size.y,i.box.size.z);else if(i.cylinder)t=this.scene.createCylinder(i.cylinder.radius,i.cylinder.length);else if(i.sphere)t=this.scene.createSphere(i.sphere.radius);else if(i.plane)t=this.scene.createPlane(i.plane.normal.x,i.plane.normal.y,i.plane.normal.z,i.plane.size.x,i.plane.size.y);else if(i.mesh){for(var a=n;a.parent;)a=a.parent;var s=i.mesh.filename,l=i.mesh.submesh,c=i.mesh.center_submesh,h=s.substring(0,s.indexOf("://")),u="";if("file"===h||"model"===h)u=s.substring(s.indexOf("://")+3);else if(0<s.length&&"/"===s[0]){var d=s.indexOf("/meshes/");1<d&&(u=s.substring(s.lastIndexOf("/",d-1)))}if(0<u.length){i.mesh.scale&&(n.scale.x=i.mesh.scale.x,n.scale.y=i.mesh.scale.y,n.scale.z=i.mesh.scale.z);var p="assets/"+u;if(-1!==p.indexOf(".dae")&&isTouchDevice){p=p.substring(0,p.indexOf(".dae"));var f=new XMLHttpRequest;f.open("HEAD",p+"_coarse.dae",!1),f.send(),404===f.status?p+=".dae":p+="_coarse.dae"}var m=p.substr(-4).toLowerCase(),g=n.name+"::"+p;this.entityMaterial[g]=o,p="http://"+this.url+"/"+p,this.scene.loadMeshFromUri(p,l,c,function(e){if(o)if(-1===p.indexOf(".stl")){var t=[];e.getDescendants(t);for(var i=0;i<t.length;++i)if(t[i]instanceof THREE.Mesh){r.scene.setMaterial(t[i],o);break}}else r.scene.setMaterial(e,o);else".stl"===m&&r.scene.setMaterial(e,{ambient:[1,1,1,1]});n.add(e),x(n)})}}else if(i.heightmap){for(var v=new ROSLIB.ServiceRequest({name:r.scene.name}),y=i.heightmap.texture,b=0;b<y.length;++b)y[b].diffuse=this.parseUri(y[b].diffuse),y[b].normal=this.parseUri(y[b].normal);i.heightmap.size;this.heightmapDataService.callService(v,function(e){var t=e.heightmap;r.scene.loadHeightmap(t.heights,t.size.x,t.size.y,t.width,t.height,t.origin,y,i.heightmap.blend,n)})}function x(e){var t=[];e.getDescendants(t);for(var i=0;i<t.length;++i)if(t[i]instanceof THREE.Mesh){t[i].castShadow=!0,t[i].receiveShadow=!0,e.castShadows&&(t[i].castShadow=e.castShadows),e.receiveShadows&&(t[i].receiveShadow=e.receiveShadows),0<=e.name.indexOf("COLLISION_VISUAL")&&(t[i].castShadow=!1,t[i].receiveShadow=!1,t[i].visible=this.scene.showCollisions);break}}t&&(o&&this.scene.setMaterial(t,o),t.updateMatrix(),n.add(t),x(n))},GZ3D.GZIface.prototype.parseMaterial=function(e){if(!e)return null;var t,i,n,r,o,a,s,l,c,h,u="http://"+this.url+"/assets",d=e.script;if(d&&d.name&&(c=this.material[d.name])){r=c.ambient,o=c.diffuse,a=c.specular,s=c.opacity,l=c.scale;var p=c.texture;if(p){for(var f=0;f<d.uri.length;++f){var m=d.uri[f];"__default__"===m&&(m="file://media/materials/scripts/gazebo.material");var g=m.substring(0,m.indexOf("://"));if("model"===g){if(0<m.indexOf("textures")){n=m.substring(m.indexOf("://")+3);break}}else if("file"===g&&0<m.indexOf("materials")){n=m.substring(m.indexOf("://")+3,m.indexOf("materials")+9)+"/textures";break}}n&&(t=u+"/"+n+"/"+p)}}if(e.normal_map&&(h=0<e.normal_map.indexOf("://")?e.normal_map.substring(e.normal_map.indexOf("://")+3,e.normal_map.lastIndexOf("/")):n)){var v=e.normal_map.lastIndexOf("/")+1;v<0&&(v=0),i=u+"/"+h+"/"+e.normal_map.substr(v,e.normal_map.lastIndexOf(".")-v)+".png"}return{texture:t,normalMap:i,ambient:r,diffuse:o,specular:a,opacity:s,scale:l}};var nsInSec=1e9,correctTime=function(e){var t=0;0<e.sec&&e.nsec<0&&(t=Math.floor(Math.abs(e.nsec/nsInSec)+1),e.sec-=t,e.nsec+=t*nsInSec),e.sec<0&&0<e.nsec&&(t=Math.floor(Math.abs(e.nsec/nsInSec)+1),e.sec+=t,e.nsec-=t*nsInSec),e.sec+=Math.floor(e.nsec/nsInSec),e.nsec=Math.floor(e.nsec%nsInSec)},subtractTime=function(e,t){var i={};return i.sec=e.sec-t.sec,i.nsec=e.nsec-t.nsec,correctTime(i),i};GZ3D.LogPlay=function(){this.emitter=globalEmitter||new EventEmitter2({verboseMemoryLeak:!0}),this.visible=null,this.startTime=null,this.endTime=null,this.active=!1,this.sliderRange=100,this.visible=!1;var r=this;this.emitter.on("logPlaySlideStop",function(e){if(r.startTime&&r.endTime){var t=e/r.sliderRange,i=r.startTime.sec+1e-9*r.startTime.nsec+t*(r.totalTime.sec+1e-9*r.totalTime.nsec),n={seek:{}};n.seek.sec=Math.floor(i),n.seek.nsec=Math.round((i-n.seek.sec)*nsInSec),r.emitter.emit("logPlayChanged",n),r.active=!1}}),this.emitter.on("logPlaySlideStart",function(){r.active=!0}),this.emitter.on("logPlayRewind",function(){var e={rewind:!0};r.emitter.emit("logPlayChanged",e)}),this.emitter.on("logPlayForward",function(){var e={forward:!0};r.emitter.emit("logPlayChanged",e)}),this.emitter.on("logPlayStepforward",function(){var e={multi_step:1};r.emitter.emit("logPlayChanged",e)}),this.emitter.on("logPlayStepback",function(){var e={multi_step:-1};r.emitter.emit("logPlayChanged",e)}),this.emitter.on("paused",function(e){e?$("#logplay-playText").html('<img style="height:1.2em" src="style/images/play.png" title="Play">'):$("#logplay-playText").html('<img style="height:1.2em" src="style/images/pause.png" title="Pause">')})},GZ3D.LogPlay.prototype.isVisible=function(){return this.visible},GZ3D.LogPlay.prototype.setVisible=function(e){e!==this.visible&&(this.visible=e,this.visible?$("#logplay").show():$("#logplay").hide())},GZ3D.LogPlay.prototype.setStats=function(e,t,i){if(this.simTime=e,this.startTime&&this.endTime&&this.totalTime&&this.startTime.sec===t.sec&&this.startTime.nsec===t.nsec&&this.endTime.sec===i.sec&&this.endTime.nsec===i.nsec||(this.startTime=t,this.endTime=i,this.totalTime=subtractTime(i,t)),!this.active){var n=subtractTime(this.simTime,this.startTime),r=(n.sec+1e-9*n.nsec)/(this.totalTime.sec+1e-9*this.totalTime.nsec);r=Math.max(r,0),$("#logplay-slider-input").val(r*this.sliderRange).slider("refresh"),$("#logplay-slider-input").text(r*this.sliderRange).slider("refresh")}},GZ3D.Manipulator=function(e,t,s,i){this.camera=e,this.domElement=void 0!==s?s:document,this.document=void 0!==i?i:document,this.mobile=void 0!==t&&t,this.object=void 0,this.mode="translate",this.space="world",this.hovered=!1,this.selected="null",this.scale=1,this.snapDist=null,this.modifierAxis=new THREE.Vector3(1,1,1),this.gizmo=new THREE.Object3D,this.pickerNames=[];var l=this,r={type:"change"},c=new THREE.Raycaster,h=new THREE.Vector2,n=new THREE.Vector3,o=new THREE.Vector3,a=new THREE.Vector3,u=new THREE.Vector3,d=new THREE.Matrix4,p=new THREE.Vector3,f=new THREE.Matrix4,m=new THREE.Vector3,g=new THREE.Quaternion,v=new THREE.Vector3(1,0,0),y=new THREE.Vector3(0,1,0),b=new THREE.Vector3(0,0,1),x=new THREE.Quaternion,w=new THREE.Quaternion,_=new THREE.Quaternion,E=new THREE.Quaternion,T=new THREE.Quaternion,M=new THREE.Vector3,S=new THREE.Matrix4,C=new THREE.Matrix4,R=new THREE.Vector3,A=new THREE.Vector3,P=(new THREE.Vector3,new THREE.Matrix4),L=new THREE.Vector3,O=null,I=new THREE.Color,D=null,k=new THREE.Color,N={},H=["XY","YZ","XZ"],B="XY",F=new THREE.Object3D;this.gizmo.add(F);var U=new THREE.MeshBasicMaterial({visible:!1,side:THREE.DoubleSide});for(var $ in H)N[H[$]]=new THREE.Mesh(new THREE.PlaneGeometry(500,500),U),N[H[$]].material.side=THREE.DoubleSide,F.add(N[H[$]]);N.YZ.rotation.set(0,Math.PI/2,0),N.XZ.rotation.set(-Math.PI/2,0,0),me(N.YZ),me(N.XZ);var z,j,V={},G={},W=function(e,t){var i=new THREE.MeshBasicMaterial;return t&&(i.side=THREE.DoubleSide,i.depthTest=!1,i.depthWrite=!1),i.transparent=!0,i.setValues(e),void 0===e.opacity&&(i.opacity=.5),i},q=function(e,t){var i=new THREE.LineBasicMaterial;return i.color=e,i.depthTest=!1,i.depthWrite=!1,i.opacity=void 0!==t?t:1,i.transparent=!0,i},X=new THREE.Color(16777215),Z=new THREE.Color(8421504),Y=new THREE.Color(16711680),K=new THREE.Color(65280),J=new THREE.Color(255),Q=new THREE.Color(65535),ee=new THREE.Color(16711935),te=new THREE.Color(16776960);if(V.translate=new THREE.Object3D,G.translate=new THREE.Object3D,this.gizmo.add(V.translate),this.gizmo.add(G.translate),z=this.mobile?new THREE.CylinderGeometry(.5,.01,1.4,10,1,!1):new THREE.CylinderGeometry(.2,.1,.8,4,1,!1),(j=new THREE.Mesh(z,new W({color:Y,visible:!1,transparent:!1}))).position.x=.7,j.rotation.z=-Math.PI/2,me(j),j.name="TX",V.translate.add(j),this.pickerNames.push(j.name),(j=new THREE.Mesh(z,new W({color:K,visible:!1,transparent:!1}))).position.y=.7,me(j),j.name="TY",V.translate.add(j),this.pickerNames.push(j.name),(j=new THREE.Mesh(z,new W({color:J,visible:!1,transparent:!1}))).position.z=.7,j.rotation.x=Math.PI/2,me(j),j.name="TZ",V.translate.add(j),this.pickerNames.push(j.name),this.mobile){z=new THREE.CylinderGeometry(.1,.1,1,10,1,!1);var ie=new W({color:Y,transparent:!0},!0);(j=new THREE.Mesh(z,ie)).position.x=.5,j.rotation.z=-Math.PI/2,me(j),j.name="TX",G.translate.add(j);var ne=new W({color:K,transparent:!0},!0);(j=new THREE.Mesh(z,ne)).position.y=.5,me(j),j.name="TY",G.translate.add(j);var re=new W({color:J,transparent:!0},!0);(j=new THREE.Mesh(z,re)).position.z=.5,j.rotation.x=Math.PI/2,me(j),j.name="TZ",G.translate.add(j),z=new THREE.CylinderGeometry(0,.15,.4,10,1,!1),(j=new THREE.Mesh(z,ie)).position.x=1.2,j.rotation.z=-Math.PI/2,me(j),j.name="TX",G.translate.add(j),(j=new THREE.Mesh(z,ne)).position.y=1.2,me(j),j.name="TY",G.translate.add(j),(j=new THREE.Mesh(z,re)).position.z=1.2,j.rotation.x=Math.PI/2,me(j),j.name="TZ",G.translate.add(j)}else{(z=new THREE.Geometry).vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(1,0,0),new THREE.Vector3(0,0,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,1)),z.colors.push(Y,Y,K,K,J,J);var oe=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});j=new THREE.Line(z,oe,THREE.LineSegments),G.translate.add(j),z=new THREE.CylinderGeometry(0,.05,.2,4,1,!0),(j=new THREE.Mesh(z,new W({color:Y,opacity:1},!0))).position.x=1.1,j.rotation.z=-Math.PI/2,me(j),j.name="TX",G.translate.add(j),(j=new THREE.Mesh(z,new W({color:K,opacity:1},!0))).position.y=1.1,me(j),j.name="TY",G.translate.add(j),(j=new THREE.Mesh(z,new W({color:J,opacity:1},!0))).position.z=1.1,j.rotation.x=Math.PI/2,me(j),j.name="TZ",G.translate.add(j),(j=new THREE.Mesh(new THREE.OctahedronGeometry(.1,0),new W({color:X,opacity:.25},!0))).name="TXYZ",this.pickerNames.push(j.name),G.translate.add(j),(j=new THREE.Mesh(new THREE.OctahedronGeometry(.1,0),new W({color:X,visible:!1},!0))).name="TXYZ",V.translate.add(j),z=new THREE.PlaneGeometry(.3,.3),(j=new THREE.Mesh(z,new W({color:te,opacity:.25},!0))).position.set(.15,.15,0),me(j),j.name="TXY",this.pickerNames.push(j.name),G.translate.add(j),(j=new THREE.Mesh(z,new W({color:te,visible:!1},!0))).position.set(.15,.15,0),me(j),j.name="TXY",V.translate.add(j),(j=new THREE.Mesh(z,new W({color:Q,opacity:.25},!0))).position.set(0,.15,.15),j.rotation.y=Math.PI/2,me(j),j.name="TYZ",this.pickerNames.push(j.name),G.translate.add(j),(j=new THREE.Mesh(z,new W({color:Q,visible:!1},!0))).position.set(0,.15,.15),j.rotation.y=Math.PI/2,me(j),j.name="TYZ",V.translate.add(j),(j=new THREE.Mesh(z,new W({color:ee,opacity:.25},!0))).position.set(.15,0,.15),j.rotation.x=Math.PI/2,me(j),j.name="TXZ",this.pickerNames.push(j.name),G.translate.add(j),(j=new THREE.Mesh(z,new W({color:ee,visible:!1},!0))).position.set(.15,0,.15),j.rotation.x=Math.PI/2,me(j),j.name="TXZ",V.translate.add(j)}if(V.rotate=new THREE.Object3D,G.rotate=new THREE.Object3D,this.gizmo.add(V.rotate),this.gizmo.add(G.rotate),z=this.mobile?new THREE.TorusGeometry(1,.3,4,36,2*Math.PI):new THREE.TorusGeometry(1,.15,4,6,Math.PI),(j=new THREE.Mesh(z,new W({color:Y,visible:!1,transparent:!1},!1))).rotation.z=-Math.PI/2,j.rotation.y=-Math.PI/2,me(j),j.name="RX",V.rotate.add(j),this.pickerNames.push(j.name),(j=new THREE.Mesh(z,new W({color:K,visible:!1,transparent:!1},!1))).rotation.z=Math.PI,j.rotation.x=-Math.PI/2,me(j),j.name="RY",V.rotate.add(j),this.pickerNames.push(j.name),(j=new THREE.Mesh(z,new W({color:J,visible:!1,transparent:!1},!1))).rotation.z=-Math.PI/2,me(j),j.name="RZ",V.rotate.add(j),this.pickerNames.push(j.name),this.mobile)z=new THREE.TorusGeometry(1,.1,4,36,2*Math.PI),(j=new THREE.Mesh(z,new W({color:J},!1))).rotation.z=-Math.PI/2,me(j),j.name="RZ",G.rotate.add(j),(j=new THREE.Mesh(z,new W({color:Y},!1))).rotation.z=-Math.PI/2,j.rotation.y=-Math.PI/2,me(j),j.name="RX",G.rotate.add(j),(j=new THREE.Mesh(z,new W({color:K},!1))).rotation.z=Math.PI,j.rotation.x=-Math.PI/2,me(j),j.name="RY",G.rotate.add(j);else{var ae=function(e,t,i){z=new THREE.Geometry,i=i||1;for(var n=0;n<=64*i;++n)"x"===t&&z.vertices.push(new THREE.Vector3(0,Math.cos(n/32*Math.PI),Math.sin(n/32*Math.PI)).multiplyScalar(e)),"y"===t&&z.vertices.push(new THREE.Vector3(Math.cos(n/32*Math.PI),0,Math.sin(n/32*Math.PI)).multiplyScalar(e)),"z"===t&&z.vertices.push(new THREE.Vector3(Math.sin(n/32*Math.PI),Math.cos(n/32*Math.PI),0).multiplyScalar(e));return z};(j=new THREE.Line(new ae(1,"x",.5),new q(Y))).name="RX",G.rotate.add(j),(j=new THREE.Line(new ae(1,"y",.5),new q(K))).name="RY",G.rotate.add(j),(j=new THREE.Line(new ae(1,"z",.5),new q(J))).name="RZ",G.rotate.add(j),(j=new THREE.Line(new ae(1,"z"),new q(Z))).name="RXYZE",this.pickerNames.push(j.name),G.rotate.add(j),(j=new THREE.Line(new ae(1.25,"z"),new q(te,.25))).name="RE",this.pickerNames.push(j.name),G.rotate.add(j),(j=new THREE.Mesh(new THREE.SphereGeometry(.95,12,12),new W({color:Z,visible:!1},!0))).name="RXYZE",V.rotate.add(j),this.pickerNames.push(j.name),N.SPHERE=new THREE.Mesh(new THREE.SphereGeometry(.95,12,12),new W({color:X,visible:!1},!0)),F.add(N.SPHERE),(j=new THREE.Mesh(new THREE.TorusGeometry(1.3,.15,4,12),new W({color:te,visible:!1},!0))).name="RE",V.rotate.add(j),this.pickerNames.push(j.name)}function se(e){e.preventDefault();var t=pe(e,V[l.mode].children);if(t){if(D!==t.object){var i=null;null!==D&&(i=G[l.mode].getObjectByName(D.name))&&i.material.color.copy(k),D=t.object,k.copy(D.material.color),(i=G[l.mode].getObjectByName(D.name))&&i.material.color.offsetHSL(0,0,-.3),l.dispatchEvent(r)}l.selected=D.name,l.hovered=!0,l.update(),l.setIntersectionPlane();var n=pe(e,[N[B]]);n&&(M.copy(l.object.position),S.extractRotation(l.object.matrix),P.extractRotation(l.object.matrixWorld),C.extractRotation(l.object.parent.matrixWorld),R.setFromMatrixScale(f.getInverse(l.object.parent.matrixWorld)),o.copy(n.point))}l.document.addEventListener("touchmove",ue,!1),l.document.addEventListener("touchend",le,!1)}function le(){if(D){var e=G[l.mode].getObjectByName(D.name);e&&e.material.color.copy(k)}D=null,l.dispatchEvent(r),l.selected="null",l.hovered=!1,l.document.removeEventListener("touchmove",ue,!1),l.document.removeEventListener("touchend",le,!1)}function ce(e){if(e.preventDefault(),0===e.button&&"null"===l.selected){var t=pe(e,V[l.mode].children),i=null;t?(O!==t.object&&(null!==O&&(i=G[l.mode].getObjectByName(O.name))&&i.material.color.copy(I),D=t.object,O=t.object,I.copy(O.material.color),(i=G[l.mode].getObjectByName(O.name))&&i.material.color.offsetHSL(0,0,-.3),l.dispatchEvent(r)),l.hovered=!0):null!==O&&((i=G[l.mode].getObjectByName(O.name))&&i.material.color.copy(I),O=null,l.dispatchEvent(r),l.hovered=!1)}l.document.addEventListener("mousemove",ue,!1),l.document.addEventListener("mouseup",de,!1)}function he(e){if(e.preventDefault(),0===e.button){if(pe(e,V[l.mode].children)){l.selected=D.name,l.update(),l.setIntersectionPlane();var t=pe(e,[N[B]]);t&&(M.copy(l.object.position),S.extractRotation(l.object.matrix),P.extractRotation(l.object.matrixWorld),C.extractRotation(l.object.parent.matrixWorld),R.setFromMatrixScale(f.getInverse(l.object.parent.matrixWorld)),o.copy(t.point))}l.document.addEventListener("mousemove",ue,!1),l.document.addEventListener("mouseup",de,!1)}}function ue(e){if("null"!==l.selected){e.preventDefault();var t=pe(e,[N[B]]);t&&(n.copy(t.point),"translate"===l.mode&&fe("T")?(n.sub(o),n.multiply(R),"local"===l.space&&(n.applyMatrix4(f.getInverse(P)),fe("X")&&1===l.modifierAxis.x||(n.x=0),fe("Y")&&1===l.modifierAxis.y||(n.y=0),fe("Z")&&1===l.modifierAxis.z||(n.z=0),fe("XYZ")&&n.set(0,0,0),n.applyMatrix4(S),l.object.position.copy(M),l.object.position.add(n)),("world"===l.space||fe("XYZ"))&&(fe("X")&&1===l.modifierAxis.x||(n.x=0),fe("Y")&&1===l.modifierAxis.y||(n.y=0),fe("Z")&&1===l.modifierAxis.z||(n.z=0),n.applyMatrix4(f.getInverse(C)),l.object.position.copy(M),l.object.position.add(n),l.snapDist&&(fe("X")&&(l.object.position.x=Math.round(l.object.position.x/l.snapDist)*l.snapDist),fe("Y")&&(l.object.position.y=Math.round(l.object.position.y/l.snapDist)*l.snapDist),fe("Z")&&(l.object.position.z=Math.round(l.object.position.z/l.snapDist)*l.snapDist)))):"rotate"===l.mode&&fe("R")&&(n.sub(A),n.multiply(R),m.copy(o).sub(A),m.multiply(R),"RE"===l.selected?(n.applyMatrix4(f.getInverse(d)),m.applyMatrix4(f.getInverse(d)),a.set(Math.atan2(n.z,n.y),Math.atan2(n.x,n.z),Math.atan2(n.y,n.x)),u.set(Math.atan2(m.z,m.y),Math.atan2(m.x,m.z),Math.atan2(m.y,m.x)),g.setFromRotationMatrix(f.getInverse(C)),T.setFromAxisAngle(p,a.z-u.z),x.setFromRotationMatrix(P),g.multiplyQuaternions(g,T),g.multiplyQuaternions(g,x),l.object.quaternion.copy(g)):"RXYZE"===l.selected?(T.setFromEuler(n.clone().cross(m).normalize()),g.setFromRotationMatrix(f.getInverse(C)),w.setFromAxisAngle(T,-n.clone().angleTo(m)),x.setFromRotationMatrix(P),g.multiplyQuaternions(g,w),g.multiplyQuaternions(g,x),l.object.quaternion.copy(g)):"local"===l.space?(n.applyMatrix4(f.getInverse(P)),m.applyMatrix4(f.getInverse(P)),a.set(Math.atan2(n.z,n.y),Math.atan2(n.x,n.z),Math.atan2(n.y,n.x)),u.set(Math.atan2(m.z,m.y),Math.atan2(m.x,m.z),Math.atan2(m.y,m.x)),x.setFromRotationMatrix(S),w.setFromAxisAngle(v,a.x-u.x),_.setFromAxisAngle(y,a.y-u.y),E.setFromAxisAngle(b,a.z-u.z),"RX"===l.selected&&x.multiplyQuaternions(x,w),"RY"===l.selected&&x.multiplyQuaternions(x,_),"RZ"===l.selected&&x.multiplyQuaternions(x,E),l.object.quaternion.copy(x)):"world"===l.space&&(a.set(Math.atan2(n.z,n.y),Math.atan2(n.x,n.z),Math.atan2(n.y,n.x)),u.set(Math.atan2(m.z,m.y),Math.atan2(m.x,m.z),Math.atan2(m.y,m.x)),g.setFromRotationMatrix(f.getInverse(C)),w.setFromAxisAngle(v,a.x-u.x),_.setFromAxisAngle(y,a.y-u.y),E.setFromAxisAngle(b,a.z-u.z),x.setFromRotationMatrix(P),"RX"===l.selected&&g.multiplyQuaternions(g,w),"RY"===l.selected&&g.multiplyQuaternions(g,_),"RZ"===l.selected&&g.multiplyQuaternions(g,E),g.multiplyQuaternions(g,x),l.object.quaternion.copy(g)))),l.update(),l.dispatchEvent(r)}}function de(e){l.selected="null",l.document.removeEventListener("mousemove",ue,!1),l.document.removeEventListener("mouseup",de,!1)}function pe(e,t){var i=e.touches?e.touches[0]:e,n=s.getBoundingClientRect(),r=(i.clientX-n.left)/n.width,o=(i.clientY-n.top)/n.height;h.set(2*r-1,2*-o+1),c.setFromCamera(h,l.camera);var a=c.intersectObjects(t,!0);return!!a[0]&&a[0]}function fe(e){return-1!==l.selected.search(e)}function me(e){var t=new THREE.Geometry;e.updateMatrix(),t.merge(e.geometry,e.matrix),e.geometry=t,e.position.set(0,0,0),e.rotation.set(0,0,0),e.scale.set(1,1,1)}j=null,this.attach=function(e){this.object=e,this.setMode(l.mode),this.mobile?this.domElement.addEventListener("touchstart",se,!1):(this.domElement.addEventListener("mousedown",he,!1),this.domElement.addEventListener("mousemove",ce,!1))},this.detach=function(e){this.object=void 0,this.selected="null",this.hide(),this.mobile?this.domElement.removeEventListener("touchstart",se,!1):(this.domElement.removeEventListener("mousedown",he,!1),this.domElement.removeEventListener("mousemove",ce,!1))},this.update=function(){if(void 0!==this.object){this.object.updateMatrixWorld(),A.setFromMatrixPosition(this.object.matrixWorld),this.camera.updateMatrixWorld(),L.setFromMatrixPosition(this.camera.matrixWorld);var e=A.distanceTo(L)/6*this.scale;for(var t in this.gizmo.position.copy(A),this.gizmo.scale.set(e,e,e),this.gizmo.children)for(var i in this.gizmo.children[t].children){var n=this.gizmo.children[t].children[i],r=n.name;-1!==r.search("E")?(d.lookAt(L,A,m.set(0,1,0)),n.rotation.setFromRotationMatrix(d)):(p.copy(L).sub(A).normalize(),"local"===this.space?(g.setFromRotationMatrix(f.extractRotation(this.object.matrixWorld)),-1!==r.search("R")&&(f.makeRotationFromQuaternion(g).getInverse(f),p.applyMatrix4(f),"RX"===r&&(w.setFromAxisAngle(v,Math.atan2(-p.y,p.z)),g.multiplyQuaternions(g,w)),"RY"===r&&(_.setFromAxisAngle(y,Math.atan2(p.x,p.z)),g.multiplyQuaternions(g,_)),"RZ"===r&&(E.setFromAxisAngle(b,Math.atan2(p.y,p.x)),g.multiplyQuaternions(g,E))),n.quaternion.copy(g)):"world"===this.space&&(n.rotation.set(0,0,0),"RX"===r&&(n.rotation.x=Math.atan2(-p.y,p.z)),"RY"===r&&(n.rotation.y=Math.atan2(p.x,p.z)),"RZ"===r&&(n.rotation.z=Math.atan2(p.y,p.x))))}}},this.hide=function(){for(var e in G)for(var t in G[e].children)G[e].children[t].visible=!1},this.setMode=function(e){for(var t in l.mode=e,this.hide(),G[this.mode].children)G[this.mode].children[t].visible=!0;l.update()},this.setIntersectionPlane=function(){p.copy(L).sub(A).normalize(),"local"===this.space&&p.applyMatrix4(f.getInverse(l.object.matrixWorld)),fe("TXYZ")?B=Math.abs(p.x)>Math.abs(p.y)&&Math.abs(p.x)>Math.abs(p.z)?"YZ":Math.abs(p.y)>Math.abs(p.x)&&Math.abs(p.y)>Math.abs(p.z)?"XZ":"XY":fe("RX")||fe("TYZ")?B="YZ":fe("RY")||fe("TXZ")?B="XZ":fe("RZ")||fe("TXY")?B="XY":fe("X")?B=Math.abs(p.y)>Math.abs(p.z)?"XZ":"XY":fe("Y")?B=Math.abs(p.x)>Math.abs(p.z)?"YZ":"XY":fe("Z")&&(B=Math.abs(p.x)>Math.abs(p.y)?"YZ":"XZ")}},GZ3D.Manipulator.prototype=Object.create(THREE.EventDispatcher.prototype),GZ3D.RadialMenu=function(e){this.domElement=void 0!==e?e:document,this.init()},GZ3D.RadialMenu.prototype.init=function(){this.radius=84,this.speed=12,this.bgSize=48,this.bgSizeSelected=81.6,this.highlightSize=54,this.iconProportion=.6,this.textureLoader=new THREE.TextureLoader,this.bgShape=this.textureLoader.load("style/images/icon_background.png"),this.layers={ICON:0,BACKGROUND:1,HIGHLIGHT:2},this.moving=!1,this.startPosition=null,this.showing=!1,this.selectedColor=new THREE.Color(2271965),this.plainColor=new THREE.Color(3355443),this.highlightColor=new THREE.Color(2271965),this.disabledColor=new THREE.Color(8947848),this.selected=null,this.model=null,this.menu=new THREE.Group,this.addItem("delete","style/images/trash.png"),this.addItem("translate","style/images/translate.png"),this.addItem("rotate","style/images/rotate.png"),this.addItem("transparent","style/images/transparent.png"),this.addItem("wireframe","style/images/wireframe.png"),this.addItem("joints","style/images/joints.png"),this.setNumberOfItems(this.menu.children.length),this.hide()},GZ3D.RadialMenu.prototype.hide=function(e,t){for(var i=0;i<this.numberOfItems;i++){var n=this.menu.children[i];n.children[this.layers.ICON].visible=!1,n.children[this.layers.ICON].scale.set(this.bgSize*this.iconProportion,this.bgSize*this.iconProportion,1),n.children[this.layers.BACKGROUND].visible=!1,n.children[this.layers.BACKGROUND].material.color=this.plainColor,n.children[this.layers.BACKGROUND].scale.set(this.bgSize,this.bgSize,1),n.children[this.layers.HIGHLIGHT].visible=!1}this.showing=!1,this.moving=!1,this.startPosition=null,t&&this.model&&this.selected&&(t(this.selected,this.model),this.model=null),this.selected=null},GZ3D.RadialMenu.prototype.show=function(e,t){if(!this.showing){(this.model=t).children[0]instanceof THREE.Light?this.setNumberOfItems(3):this.setNumberOfItems(6);var i=this.getPointer(e);this.startPosition=i,this.menu.getObjectByName("transparent").isHighlighted=!1,this.menu.getObjectByName("wireframe").isHighlighted=!1,this.menu.getObjectByName("joints").isHighlighted=!1,this.menu.getObjectByName("joints").isDisabled=!1,"transparent"===this.model.viewAs&&(this.menu.getObjectByName("transparent").isHighlighted=!0),"wireframe"===this.model.viewAs&&(this.menu.getObjectByName("wireframe").isHighlighted=!0),void 0===this.model.joint||0===this.model.joint.length?this.menu.getObjectByName("joints").isDisabled=!0:this.model.getObjectByName("JOINT_VISUAL",!0)&&(this.menu.getObjectByName("joints").isHighlighted=!0);for(var n=0;n<this.numberOfItems;n++){var r=this.menu.children[n];r.children[this.layers.ICON].visible=!0,r.children[this.layers.ICON].position.set(i.x,i.y,1),r.children[this.layers.BACKGROUND].visible=!0,r.children[this.layers.BACKGROUND].position.set(i.x,i.y,1),r.isDisabled&&(r.children[this.layers.BACKGROUND].material.color=this.disabledColor),r.children[this.layers.HIGHLIGHT].visible=r.isHighlighted,r.children[this.layers.HIGHLIGHT].position.set(i.x,i.y,1)}this.moving=!0,this.showing=!0}},GZ3D.RadialMenu.prototype.update=function(){if(this.moving)for(var e=0;e<this.numberOfItems;e++){var t=this.menu.children[e],i=t.children[this.layers.ICON].position.x-this.startPosition.x,n=t.children[this.layers.ICON].position.y-this.startPosition.y;Math.sqrt(Math.pow(i,2)+Math.pow(n,2))<this.radius?(i-=this.speed*Math.sin((this.offset-e)*Math.PI/4),n+=this.speed*Math.cos((this.offset-e)*Math.PI/4)):this.moving=!1;var r=i+this.startPosition.x,o=n+this.startPosition.y;t.children[this.layers.ICON].position.x=r,t.children[this.layers.ICON].position.y=o,t.children[this.layers.BACKGROUND].position.x=r,t.children[this.layers.BACKGROUND].position.y=o,t.children[this.layers.HIGHLIGHT].position.x=r,t.children[this.layers.HIGHLIGHT].position.y=o}},GZ3D.RadialMenu.prototype.getPointer=function(e){e.originalEvent&&(e=e.originalEvent);var t=e.touches?e.touches[0]:e,i=this.domElement.getBoundingClientRect(),n=t.clientX-i.left,r=t.clientY-i.top;return{x:n-=.5*i.width,y:r=-(r-.5*i.height)}},GZ3D.RadialMenu.prototype.onLongPressMove=function(e){var t=this.getPointer(e),i=t.x-this.startPosition.x,n=t.y-this.startPosition.y,r=Math.atan2(n,i),o=null;r>-7*Math.PI/8&&r<-5*Math.PI/8?o=1:r>-8*Math.PI/8&&r<-7*Math.PI/8||r>7*Math.PI/8&&r<8*Math.PI/8?o=2:r>5*Math.PI/8&&r<7*Math.PI/8?o=3:r>3*Math.PI/8&&r<5*Math.PI/8?o=4:r>1*Math.PI/8&&r<3*Math.PI/8?o=5:r>-1*Math.PI/8&&r<1*Math.PI/8?o=6:r>-3*Math.PI/8&&r<-1*Math.PI/8?o=7:r>-5*Math.PI/8&&r<-3*Math.PI/8&&(o=8);var a=o-4+this.offset;(a>=this.numberOfItems||a<0)&&(a=this.selected=null);for(var s=0,l=0;l<this.numberOfItems;l++){var c=this.menu.children[l];s===a?(c.children[this.layers.ICON].scale.set(this.bgSizeSelected*this.iconProportion,this.bgSizeSelected*this.iconProportion,1),this.selected=c.children[this.layers.ICON].name,c.isDisabled||(c.children[this.layers.BACKGROUND].material.color=this.selectedColor),c.children[this.layers.BACKGROUND].scale.set(this.bgSizeSelected,this.bgSizeSelected,1)):(c.children[this.layers.ICON].scale.set(this.bgSize*this.iconProportion,this.bgSize*this.iconProportion,1),c.children[this.layers.BACKGROUND].scale.set(this.bgSize,this.bgSize,1),c.isDisabled||(c.children[this.layers.BACKGROUND].material.color=this.plainColor)),s++}},GZ3D.RadialMenu.prototype.addItem=function(e,t){t=this.textureLoader.load(t);var i=new THREE.SpriteMaterial({map:t}),n=new THREE.Sprite(i);n.scale.set(this.bgSize*this.iconProportion,this.bgSize*this.iconProportion,1),n.name=e,n.position.set(0,0,1);var r=new THREE.SpriteMaterial({map:this.bgShape,color:this.plainColor}),o=new THREE.Sprite(r);o.scale.set(this.bgSize,this.bgSize,1),o.position.set(0,0,1);var a=new THREE.SpriteMaterial({map:this.bgShape,color:this.highlightColor}),s=new THREE.Sprite(a);s.scale.set(this.highlightSize,this.highlightSize,1),o.position.set(0,0,1),s.visible=!1;var l=new THREE.Group;l.add(n),l.add(o),l.add(s),l.isHighlighted=!1,l.name=e,this.menu.add(l)},GZ3D.RadialMenu.prototype.setNumberOfItems=function(e){this.numberOfItems=e,this.offset=this.numberOfItems-1-Math.floor(this.numberOfItems/2)},GZ3D.Scene=function(e){this.emitter=globalEmitter||new EventEmitter2({verboseMemoryLeak:!0}),this.shaders=e,this.init()},GZ3D.Scene.prototype.init=function(){this.name="default",this.scene=new THREE.Scene,this.meshes={},this.heightmap=null,this.selectedEntity=null,this.manipulationMode="view",this.pointerOnMenu=!1,this.textureLoader=new THREE.TextureLoader,this.textureLoader.crossOrigin="",this.colladaLoader=new THREE.ColladaLoader,this.objLoader=new THREE.OBJLoader,this.stlLoader=new THREE.STLLoader,this.renderer=new THREE.WebGLRenderer({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setClearColor(11711154,1),this.renderer.autoClear=!1,this.ambient=new THREE.AmbientLight(6710886),this.scene.add(this.ambient);var e=this.getDomElement().width,t=this.getDomElement().height;this.camera=new THREE.PerspectiveCamera(60,e/t,.1,1e3),this.defaultCameraPosition=new THREE.Vector3(0,-5,5),this.resetView(),"function"==typeof GZ3D.RadialMenu&&(this.cameraOrtho=new THREE.OrthographicCamera(.5*-e,.5*e,.5*t,.5*-t,1,10),this.cameraOrtho.position.z=10,this.sceneOrtho=new THREE.Scene,this.radialMenu=new GZ3D.RadialMenu(this.getDomElement()),this.sceneOrtho.add(this.radialMenu.menu)),this.grid=new THREE.GridHelper(20,20,13421772,5066061),this.grid.name="grid",this.grid.position.z=.05,this.grid.rotation.x=.5*Math.PI,this.grid.castShadow=!1,this.grid.material.transparent=!0,this.grid.material.opacity=.5,this.grid.visible=!1,this.scene.add(this.grid),this.showCollisions=!1,this.spawnModel=new GZ3D.SpawnModel(this,this.getDomElement()),this.simpleShapesMaterial=new THREE.MeshPhongMaterial({color:16777215,shading:THREE.SmoothShading});var i=this;this.getDomElement().addEventListener("mouseup",function(e){i.onPointerUp(e)},!1),this.getDomElement().addEventListener("mousedown",function(e){i.onPointerDown(e)},!1),this.getDomElement().addEventListener("DOMMouseScroll",function(e){i.onMouseScroll(e)},!1),this.getDomElement().addEventListener("mousewheel",function(e){i.onMouseScroll(e)},!1),this.getDomElement().addEventListener("touchstart",function(e){i.onPointerDown(e)},!1),this.getDomElement().addEventListener("touchend",function(e){i.onPointerUp(e)},!1),this.modelManipulator=new GZ3D.Manipulator(this.camera,isTouchDevice,this.getDomElement()),this.timeDown=null,this.controls=new THREE.OrbitControls(this.camera,this.getDomElement()),this.scene.add(this.controls.targetIndicator);var n,r,o,a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new Float32Array(24),l=new THREE.BufferGeometry;l.setIndex(new THREE.BufferAttribute(a,1)),l.addAttribute("position",new THREE.BufferAttribute(s,3)),this.boundingBox=new THREE.LineSegments(l,new THREE.LineBasicMaterial({color:16777215})),this.boundingBox.visible=!1,this.jointTypes={REVOLUTE:1,REVOLUTE2:2,PRISMATIC:3,UNIVERSAL:4,BALL:5,SCREW:6,GEARBOX:7,FIXED:8},this.jointAxis=new THREE.Object3D,this.jointAxis.name="JOINT_VISUAL";var c=new THREE.Object3D;n=new THREE.CylinderGeometry(.01,.01,.3,10,1,!1),r=new THREE.MeshBasicMaterial({color:new THREE.Color(16711680)}),(o=new THREE.Mesh(n,r)).position.x=.15,o.rotation.z=-Math.PI/2,o.name="JOINT_VISUAL",c.add(o),r=new THREE.MeshBasicMaterial({color:new THREE.Color(65280)}),(o=new THREE.Mesh(n,r)).position.y=.15,o.name="JOINT_VISUAL",c.add(o),r=new THREE.MeshBasicMaterial({color:new THREE.Color(255)}),(o=new THREE.Mesh(n,r)).position.z=.15,o.rotation.x=Math.PI/2,o.name="JOINT_VISUAL",c.add(o),n=new THREE.CylinderGeometry(0,.03,.1,10,1,!0),r=new THREE.MeshBasicMaterial({color:new THREE.Color(16711680)}),(o=new THREE.Mesh(n,r)).position.x=.3,o.rotation.z=-Math.PI/2,o.name="JOINT_VISUAL",c.add(o),r=new THREE.MeshBasicMaterial({color:new THREE.Color(65280)}),(o=new THREE.Mesh(n,r)).position.y=.3,o.name="JOINT_VISUAL",c.add(o),r=new THREE.MeshBasicMaterial({color:new THREE.Color(255)}),(o=new THREE.Mesh(n,r)).position.z=.3,o.rotation.x=Math.PI/2,o.name="JOINT_VISUAL",c.add(o),this.jointAxis.XYZaxes=c;var h=new THREE.Object3D;(r=new THREE.MeshLambertMaterial).color=new THREE.Color(16776960);n=new THREE.CylinderGeometry(.015,.015,.3,36,1,!1),(o=new THREE.Mesh(n,r)).position.z=.15,o.rotation.x=Math.PI/2,o.name="JOINT_VISUAL",h.add(o),n=new THREE.CylinderGeometry(0,.035,.1,36,1,!1),(o=new THREE.Mesh(n,r)).position.z=.3,o.rotation.x=Math.PI/2,o.name="JOINT_VISUAL",h.add(o),this.jointAxis.mainAxis=h;var u=new THREE.Object3D;n=new THREE.TorusGeometry(.04,.006,10,36,3*Math.PI/2),(o=new THREE.Mesh(n,r)).position.z=.3,o.name="JOINT_VISUAL",u.add(o),n=new THREE.CylinderGeometry(.015,0,.025,10,1,!1),(o=new THREE.Mesh(n,r)).position.y=-.04,o.position.z=.3,o.rotation.z=Math.PI/2,o.name="JOINT_VISUAL",u.add(o),this.jointAxis.rotAxis=u;var d=new THREE.Object3D;n=new THREE.CylinderGeometry(.01,.01,.1,10,1,!0),(o=new THREE.Mesh(n,r)).position.x=.03,o.position.y=.03,o.position.z=.15,o.rotation.x=Math.PI/2,o.name="JOINT_VISUAL",d.add(o),n=new THREE.CylinderGeometry(.02,0,.0375,10,1,!1),(o=new THREE.Mesh(n,r)).position.x=.03,o.position.y=.03,o.position.z=.2,o.rotation.x=-Math.PI/2,o.name="JOINT_VISUAL",d.add(o),(o=new THREE.Mesh(n,r)).position.x=.03,o.position.y=.03,o.position.z=.15-.05,o.rotation.x=Math.PI/2,o.name="JOINT_VISUAL",d.add(o),this.jointAxis.transAxis=d;var p=new THREE.Object3D;(o=new THREE.Mesh(n,r)).position.x=-.04,o.position.z=.19,o.rotation.z=-Math.PI/4,o.rotation.x=-Math.PI/10,o.name="JOINT_VISUAL",p.add(o);var f=new THREE.CatmullRomCurve3([new THREE.Vector3(.04,0,0),new THREE.Vector3(0,.04,.02),new THREE.Vector3(-.04,0,.04),new THREE.Vector3(0,-.04,.06),new THREE.Vector3(.04,0,.08),new THREE.Vector3(0,.04,.1),new THREE.Vector3(-.04,0,.12)]);n=new THREE.TubeGeometry(f,36,.01,10,!1),(o=new THREE.Mesh(n,r)).position.z=.3-.23,o.name="JOINT_VISUAL",p.add(o),this.jointAxis.screwAxis=p;var m=new THREE.Object3D;n=new THREE.SphereGeometry(.06),(o=new THREE.Mesh(n,r)).name="JOINT_VISUAL",m.add(o),this.jointAxis.ballVisual=m,this.COMvisual=new THREE.Object3D,this.COMvisual.name="COM_VISUAL",n=new THREE.SphereGeometry(1,32,32),o=new THREE.Mesh(n),this.setMaterial(o,{ambient:[.5,.5,.5,1],texture:"assets/media/materials/textures/com.png"}),o.name="COM_VISUAL",o.rotation.z=-Math.PI/2,this.COMvisual.add(o)},GZ3D.Scene.prototype.initScene=function(){this.emitter.emit("show_grid","show");var e=this.createLight(3,new THREE.Color(.8,.8,.8),.9,{position:{x:0,y:0,z:10},orientation:{x:0,y:0,z:0,w:1}},null,!0,"sun",{x:.5,y:.1,z:-.9});this.add(e)},GZ3D.Scene.prototype.setSDFParser=function(e){this.spawnModel.sdfParser=e},GZ3D.Scene.prototype.onPointerDown=function(e){if(e.preventDefault(),!this.spawnModel.active){var t,i=!0;if(e.touches)if(1===e.touches.length)t=new THREE.Vector2(e.touches[0].clientX,e.touches[0].clientY);else{if(2!==e.touches.length)return;t=new THREE.Vector2((e.touches[0].clientX+e.touches[1].clientX)/2,(e.touches[0].clientY+e.touches[1].clientY)/2)}else t=new THREE.Vector2(e.clientX,e.clientY),1!==e.which&&(i=!1);var n=new THREE.Vector3,r=this.getRayCastModel(t,n);n&&(this.controls.target=n),e.touches&&1!==e.touches.length||(r?"plane"===r.name?this.timeDown=(new Date).getTime():0<=this.modelManipulator.pickerNames.indexOf(r.name)||(""!==r.name?i&&r.parent===this.scene&&this.selectEntity(r):this.modelManipulator.hovered?(this.modelManipulator.update(),this.modelManipulator.object.updateMatrixWorld()):this.timeDown=(new Date).getTime()):this.timeDown=(new Date).getTime())}},GZ3D.Scene.prototype.onPointerUp=function(e){e.preventDefault(),(new Date).getTime()-this.timeDown<150&&(this.setManipulationMode("view"),"function"==typeof GZ3D.Gui&&($("#view-mode").click(),$('input[type="radio"]').checkboxradio("refresh"))),this.timeDown=null},GZ3D.Scene.prototype.onMouseScroll=function(e){e.preventDefault();var t=new THREE.Vector2(e.clientX,e.clientY),i=new THREE.Vector3;this.getRayCastModel(t,i);i&&(this.controls.target=i)},GZ3D.Scene.prototype.onKeyDown=function(e){if(e.shiftKey&&(187===e.keyCode||189===e.keyCode)){var t=new THREE.Vector2(this.getDomElement().width/2,this.getDomElement().height/2),i=new THREE.Vector3;this.getRayCastModel(t,i);i&&(this.controls.target=i),187===e.keyCode?this.controls.dollyOut():this.controls.dollyIn()}46===e.keyCode&&this.selectedEntity&&this.emitter.emit("delete_entity"),113===e.keyCode&&(this.effectsEnabled=!this.effectsEnabled),"function"==typeof GZ3D.Gui&&(27===e.keyCode&&($("#view-mode").click(),$('input[type="radio"]').checkboxradio("refresh")),82===e.keyCode&&($("#rotate-mode").click(),$('input[type="radio"]').checkboxradio("refresh")),84===e.keyCode&&($("#translate-mode").click(),$('input[type="radio"]').checkboxradio("refresh")))},GZ3D.Scene.prototype.getRayCastModel=function(e,t){var i=new THREE.Vector3((e.x-this.getDomElement().offsetLeft)/this.getDomElement().width*2-1,-(e.y-this.getDomElement().offsetTop)/this.getDomElement().height*2+1,1);i.unproject(this.camera);var n=new THREE.Raycaster(this.camera.position,i.sub(this.camera.position).normalize()),r=[];this.scene.getDescendants(r);var o,a,s=n.intersectObjects(r);if(0<s.length)e:for(var l=0;l<s.length;++l){if(0<=(o=s[l].object).name.indexOf("_lightHelper")){o=o.parent;break}if(!this.modelManipulator.hovered&&"plane"===o.name){a=s[l].point;break}if("grid"!==o.name&&"boundingBox"!==o.name&&"JOINT_VISUAL"!==o.name&&"INERTIA_VISUAL"!==o.name&&"COM_VISUAL"!==o.name){for(;o.parent!==this.scene;){if(o.parent.parent===this.modelManipulator.gizmo&&("translate"===this.manipulationMode&&0<=o.name.indexOf("T")||"rotate"===this.manipulationMode&&0<=o.name.indexOf("R")))break e;o=o.parent}if(!this.radialMenu||o!==this.radialMenu.menu)if(0<=o.name.indexOf("COLLISION_VISUAL"))o=null;else if(this.modelManipulator.hovered){if(o===this.modelManipulator.gizmo)break}else if(""!==o.name){a=s[l].point;break}}else a=s[l].point,o=null}return a&&(t.x=a.x,t.y=a.y,t.z=a.z),o},GZ3D.Scene.prototype.getDomElement=function(){return this.renderer.domElement},GZ3D.Scene.prototype.render=function(){this.modelManipulator.hovered||this.radialMenu&&this.radialMenu.showing||this.pointerOnMenu||this.spawnModel.active?this.controls.enabled=!1:this.controls.enabled=!0,this.controls.update(),this.modelManipulator.update(),this.radialMenu&&this.radialMenu.update(),this.renderer.clear(),this.renderer.render(this.scene,this.camera),this.renderer.clearDepth(),this.sceneOrtho&&this.cameraOrtho&&this.renderer.render(this.sceneOrtho,this.cameraOrtho)},GZ3D.Scene.prototype.setSize=function(e,t){this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.cameraOrtho&&(this.cameraOrtho.left=-e/2,this.cameraOrtho.right=e/2,this.cameraOrtho.top=t/2,this.cameraOrtho.bottom=-t/2,this.cameraOrtho.updateProjectionMatrix()),this.renderer.setSize(e,t),this.render()},GZ3D.Scene.prototype.add=function(e){e.viewAs="normal",this.scene.add(e)},GZ3D.Scene.prototype.remove=function(e){this.scene.remove(e)},GZ3D.Scene.prototype.getByName=function(e){return this.scene.getObjectByName(e)},GZ3D.Scene.prototype.updatePose=function(e,t,i){this.modelManipulator&&this.modelManipulator.object&&this.modelManipulator.hovered||this.setPose(e,t,i)},GZ3D.Scene.prototype.setPose=function(e,t,i){e.position.x=t.x,e.position.y=t.y,e.position.z=t.z,e.quaternion.w=i.w,e.quaternion.x=i.x,e.quaternion.y=i.y,e.quaternion.z=i.z},GZ3D.Scene.prototype.removeAll=function(){for(;0<this.scene.children.length;)this.scene.remove(this.scene.children[0])},GZ3D.Scene.prototype.createPlane=function(e,t,i,n,r){var o=new THREE.PlaneGeometry(n,r,1,1),a=new THREE.MeshPhongMaterial,s=new THREE.Mesh(o,a),l=new THREE.Vector3(e,t,i),c=l.crossVectors(l,s.up);return s.rotation=l.applyAxisAngle(c,-l.angleTo(s.up)),s.name="plane",s.receiveShadow=!0,s},GZ3D.Scene.prototype.createSphere=function(e){var t=new THREE.SphereGeometry(e,32,32);return new THREE.Mesh(t,this.simpleShapesMaterial)},GZ3D.Scene.prototype.createCylinder=function(e,t){var i=new THREE.CylinderGeometry(e,e,t,32,1,!1),n=new THREE.Mesh(i,this.simpleShapesMaterial);return n.rotation.x=.5*Math.PI,n},GZ3D.Scene.prototype.createBox=function(e,t,i){var n=new THREE.BoxGeometry(e,t,i,1,1,1);n.dynamic=!0;for(var r=[1,4,5],o=[0],a=0;a<r.length;++a){var s=2*r[a],l=n.faceVertexUvs[0][s][0];n.faceVertexUvs[0][s][0]=n.faceVertexUvs[0][s][1],n.faceVertexUvs[0][s][1]=n.faceVertexUvs[0][s+1][1],n.faceVertexUvs[0][s][2]=l,n.faceVertexUvs[0][s+1][0]=n.faceVertexUvs[0][s+1][1],n.faceVertexUvs[0][s+1][1]=n.faceVertexUvs[0][s+1][2],n.faceVertexUvs[0][s+1][2]=n.faceVertexUvs[0][s][2]}for(var c=0;c<o.length;++c){var h=2*o[c],u=n.faceVertexUvs[0][h][0];n.faceVertexUvs[0][h][0]=n.faceVertexUvs[0][h][2],n.faceVertexUvs[0][h][1]=u,n.faceVertexUvs[0][h][2]=n.faceVertexUvs[0][h+1][1],n.faceVertexUvs[0][h+1][2]=n.faceVertexUvs[0][h][2],n.faceVertexUvs[0][h+1][1]=n.faceVertexUvs[0][h+1][0],n.faceVertexUvs[0][h+1][0]=n.faceVertexUvs[0][h][1]}n.uvsNeedUpdate=!0;var d=new THREE.Mesh(n,this.simpleShapesMaterial);return d.castShadow=!0,d},GZ3D.Scene.prototype.createLight=function(e,t,i,n,r,o,a,s,l,c,h,u){var d,p=new THREE.Object3D,f=new THREE.Color;void 0===t?t=16777215:typeof t!==THREE.Color?(f.r=t.r,f.g=t.g,f.b=t.b,t=f.clone()):typeof l!==THREE.Color&&(f.r=l.r,f.g=l.g,f.b=l.b,l=f.clone()),n&&(this.setPose(p,n.position,n.orientation),p.matrixWorldNeedsUpdate=!0),1===e?d=this.createPointLight(p,t,i,r,o):2===e?d=this.createSpotLight(p,t,i,r,o):3===e&&(d=this.createDirectionalLight(p,t,i,o));var m=d[0],g=d[1];a&&(m.name=a,p.name=a,g.name=a+"_lightHelper");var v=new THREE.Vector3(0,0,-1);s&&(v.x=s.x,v.y=s.y,v.z=s.z),p.direction=new THREE.Vector3(v.x,v.y,v.z);var y=new THREE.Object3D;return m.add(y),y.position.copy(v),y.matrixWorldNeedsUpdate=!0,m.target=y,p.serverProperties={},p.serverProperties.specular=l,p.serverProperties.attenuation_constant=c,p.serverProperties.attenuation_linear=h,p.serverProperties.attenuation_quadratic=u,p.add(m),p.add(g),p},GZ3D.Scene.prototype.createPointLight=function(e,t,i,n,r){void 0===i&&(i=.5);var o=new THREE.PointLight(t,i);n&&(o.distance=n),r&&(o.castShadow=r);var a=new THREE.OctahedronGeometry(.25,0);a.applyMatrix((new THREE.Matrix4).makeRotationX(Math.PI/2));var s=new THREE.MeshBasicMaterial({wireframe:!0,color:65280});return[o,new THREE.Mesh(a,s)]},GZ3D.Scene.prototype.createSpotLight=function(e,t,i,n,r){void 0===i&&(i=1),void 0===n&&(n=20);var o=new THREE.SpotLight(t,i);o.distance=n,o.position.set(0,0,0),r&&(o.castShadow=r);var a=new THREE.CylinderGeometry(0,.3,.2,4,1,!0);a.applyMatrix((new THREE.Matrix4).makeRotationX(Math.PI/2)),a.applyMatrix((new THREE.Matrix4).makeRotationZ(Math.PI/4));var s=new THREE.MeshBasicMaterial({wireframe:!0,color:65280});return[o,new THREE.Mesh(a,s)]},GZ3D.Scene.prototype.createDirectionalLight=function(e,t,i,n){void 0===i&&(i=1);var r=new THREE.DirectionalLight(t,i);r.shadow.camera.near=1,r.shadow.camera.far=50,r.shadow.mapSize.width=4094,r.shadow.mapSize.height=4094,r.shadow.camera.bottom=-100,r.shadow.camera.feft=-100,r.shadow.camera.right=100,r.shadow.camera.top=100,r.shadow.bias=1e-4,r.position.set(0,0,0),n&&(r.castShadow=n);var o=new THREE.Geometry;o.vertices.push(new THREE.Vector3(-.5,-.5,0)),o.vertices.push(new THREE.Vector3(-.5,.5,0)),o.vertices.push(new THREE.Vector3(-.5,.5,0)),o.vertices.push(new THREE.Vector3(.5,.5,0)),o.vertices.push(new THREE.Vector3(.5,.5,0)),o.vertices.push(new THREE.Vector3(.5,-.5,0)),o.vertices.push(new THREE.Vector3(.5,-.5,0)),o.vertices.push(new THREE.Vector3(-.5,-.5,0)),o.vertices.push(new THREE.Vector3(0,0,0)),o.vertices.push(new THREE.Vector3(0,0,-.5));var a=new THREE.LineBasicMaterial({color:65280});return[r,new THREE.Line(o,a,THREE.LineSegments)]},GZ3D.Scene.prototype.createRoads=function(e,t,i){var n=new THREE.Geometry;n.dynamic=!0;for(var r,o,a=0,s=t,l=1,c=0,h=new THREE.Vector3(0,0,0),u=new THREE.Vector3(0,0,0),d=[],p=0,f=0;f<e.length;++f){var m,g=new THREE.Vector3(e[f].x,e[f].y,e[f].z);if(f!==e.length-1&&(m=new THREE.Vector3(e[f+1].x,e[f+1].y,e[f+1].z)),l=1,0<f&&(c+=g.distanceTo(u)),a=c/s,0===f)h.x=m.x,h.y=m.y,h.z=m.z,h.sub(g),h.normalize();else if(f===e.length-1)h.x=g.x,h.y=g.y,h.z=g.z,h.sub(u),h.normalize();else{var v=new THREE.Vector3(0,0,0),y=new THREE.Vector3(0,0,0);v.x=g.x,v.y=g.y,v.z=g.z,v.sub(u),v.normalize(),y.x=m.x,y.y=m.y,y.z=m.z,y.sub(g),y.normalize();var b=v.dot(-1*y);h.x=m.x,h.y=m.y,h.z=m.z,h.sub(u),h.normalize(),-.97<b&&b<.97&&(l=1/Math.sin(.5*Math.acos(b)))}var x=Math.atan2(h.x,-h.y);r=new THREE.Vector3(g.x,g.y,g.z),o=new THREE.Vector3(g.x,g.y,g.z);var w=t*l*.5;r.x+=Math.cos(x)*w,r.y+=Math.sin(x)*w,o.x-=Math.cos(x)*w,o.y-=Math.sin(x)*w,n.vertices.push(r),n.vertices.push(o),d.push([0,a]),d.push([1,a]),0<f&&(n.faces.push(new THREE.Face3(p,p+1,p+2,new THREE.Vector3(0,0,1))),n.faceVertexUvs[0].push([new THREE.Vector2(d[p][0],d[p][1]),new THREE.Vector2(d[p+1][0],d[p+1][1]),new THREE.Vector2(d[p+2][0],d[p+2][1])]),p++,n.faces.push(new THREE.Face3(p,p+2,p+1,new THREE.Vector3(0,0,1))),n.faceVertexUvs[0].push([new THREE.Vector2(d[p][0],d[p][1]),new THREE.Vector2(d[p+2][0],d[p+2][1]),new THREE.Vector2(d[p+1][0],d[p+1][1])]),p++),u.x=g.x,u.y=g.y,u.z=g.z,a}n.computeFaceNormals(),n.verticesNeedUpdate=!0,n.uvsNeedUpdate=!0;var _=new THREE.MeshPhongMaterial;if(i){var E=this.textureLoader.load(i);E.wrapS=E.wrapT=THREE.RepeatWrapping,_.map=E}var T=new THREE.Mesh(n,_);return T.castShadow=!1,T},GZ3D.Scene.prototype.loadHeightmap=function(e,t,i,n,r,o,a,s,l){if(this.heightmap)console.log("Only one heightmap can be loaded at a time");else if(void 0!==l){var c=1;256<n-1&&(c=256/(n-1));var h=new THREE.PlaneGeometry(t,i,(n-1)*c,(r-1)*c);h.dynamic=!0;for(var u=[],d=r-1;0<=d;--d)for(var p=0;p<n;++p)u[(r-d-1)*n+p]=e[d*n+p];for(var f,m=(n-1)*c,g=(r-1)*c,v=0;v<g;++v)for(var y=0;y<m;++y){var b=v*m*1/(c*c)+y*(1/c);h.vertices[v*m+y].z=u[b]}if(h.computeFaceNormals(),h.computeVertexNormals(),a&&0<a.length){for(var x=[],w=[],_=0;_<a.length;++_)x[_]=this.textureLoader.load(a[_].diffuse),x[_].wrapS=THREE.RepeatWrapping,x[_].wrapT=THREE.RepeatWrapping,w[_]=t/a[_].size;for(var E=a.length;E<3;++E)x[E]=x[E-1];for(var T=s.length;T<2;++T)s[T]=s[T-1];for(var M=w.length;M<3;++M)w[M]=w[M-1];var S=new THREE.Vector3(0,0,1),C=new THREE.Color(16777215),R=[];this.scene.getDescendants(R);for(var A=0;A<R.length;++A)if(R[A]instanceof THREE.DirectionalLight){S=R[A].target.position,C=R[A].color;break}var P={uniforms:{texture0:{type:"t",value:x[0]},texture1:{type:"t",value:x[1]},texture2:{type:"t",value:x[2]},repeat0:{type:"f",value:w[0]},repeat1:{type:"f",value:w[1]},repeat2:{type:"f",value:w[2]},minHeight1:{type:"f",value:s[0].min_height},fadeDist1:{type:"f",value:s[0].fade_dist},minHeight2:{type:"f",value:s[1].min_height},fadeDist2:{type:"f",value:s[1].fade_dist},ambient:{type:"c",value:this.ambient.color},lightDiffuse:{type:"c",value:C},lightDir:{type:"v3",value:S}}};void 0!==this.shaders?(P.vertexShader=this.shaders.heightmapVS,P.fragmentShader=this.shaders.heightmapFS):console.log("Warning: heightmap shaders not provided."),f=new THREE.ShaderMaterial(P)}else f=new THREE.MeshPhongMaterial({color:5592405});var L=new THREE.Mesh(h,f);L.position.x=o.x,L.position.y=o.y,L.position.z=o.z,l.add(L),this.heightmap=l}else console.error("Missing parent, heightmap won't be loaded.")},GZ3D.Scene.prototype.loadMeshFromUri=function(e,t,i,n){e.substring(0,e.lastIndexOf("/"));var r=e.substring(e.lastIndexOf("/")+1);if(this.meshes[e]){var o=this.meshes[e];return o=o.clone(),this.useSubMesh(o,t,i),void n(o)}return".dae"===r.substr(-4).toLowerCase()?this.loadCollada(e,t,i,n):".obj"===r.substr(-4).toLowerCase()?this.loadOBJ(e,t,i,n):".stl"===r.substr(-4).toLowerCase()?this.loadSTL(e,t,i,n):void r.substr(-5).toLowerCase()},GZ3D.Scene.prototype.loadMeshFromString=function(e,t,i,n,r){e.substring(0,e.lastIndexOf("/"));var o=e.substring(e.lastIndexOf("/")+1);if(this.meshes[e]){var a=this.meshes[e];return a=a.clone(),this.useSubMesh(a,t,i),void n(a)}return".dae"===o.substr(-4).toLowerCase()?this.loadCollada(e,t,i,n,r[0]):".obj"===o.substr(-4).toLowerCase()?this.loadOBJ(e,t,i,n,r):void 0},GZ3D.Scene.prototype.loadCollada=function(t,i,n,r,e){var o,a=this;function s(e){(o=e.scene).updateMatrix(),a.prepareColladaMesh(o),o=(a.meshes[t]=o).clone(),a.useSubMesh(o,i,n),o.name=t,r(o)}e?this.colladaLoader.parse(e,function(e){s(e)},void 0):this.colladaLoader.load(t,function(e){s(e)})},GZ3D.Scene.prototype.prepareColladaMesh=function(e){var t=[];e.getDescendants(t);for(var i=0;i<t.length;++i)t[i]instanceof THREE.Light&&t[i].parent.remove(t[i])},GZ3D.Scene.prototype.useSubMesh=function(e,t,i){if(!t)return null;var n,r=[];e.getDescendants(r);for(var o=0;o<r.length;++o)if(r[o]instanceof THREE.Mesh)if(r[o].name===t||r[o].geometry.name===t){if(i)if(r[o].geometry instanceof THREE.BufferGeometry){var a=r[o].geometry.attributes.position,s=a.itemSize,l=[],c=[],h=[],u=0;for(u=0;u<s;++u)l[u]=a.array[u],c[u]=l[u];var d=0;for(d=s;d<a.count*s;d+=s)for(u=0;u<s;++u)l[u]=Math.min(l[u],a.array[d+u]),c[u]=Math.max(c[u],a.array[d+u]);for(u=0;u<s;++u)h[u]=l[u]+.5*(c[u]-l[u]);for(d=0;d<a.count*s;d+=s)for(u=0;u<s;++u)a.array[d+u]-=h[u];r[o].geometry.attributes.position.needsUpdate=!0}else{var p=r[o].geometry.vertices,f=new THREE.Vector3,m=new THREE.Vector3;f.x=p[0].x,f.y=p[0].y,f.z=p[0].z,m.x=f.x,m.y=f.y,m.z=f.z;for(var g=1;g<p.length;++g)f.x=Math.min(f.x,p[g].x),f.y=Math.min(f.y,p[g].y),f.z=Math.min(f.z,p[g].z),m.x=Math.max(m.x,p[g].x),m.y=Math.max(m.y,p[g].y),m.z=Math.max(m.z,p[g].z);var v=new THREE.Vector3;v.x=f.x+.5*(m.x-f.x),v.y=f.y+.5*(m.y-f.y),v.z=f.z+.5*(m.z-f.z);for(var y=0;y<p.length;++y)p[y].x-=v.x,p[y].y-=v.y,p[y].z-=v.z;r[o].geometry.verticesNeedUpdate=!0;for(var b=r[o].parent;b;)b.position.set(0,0,0),b=b.parent}n=r[o]}else r[o].parent.remove(r[o]);return n},GZ3D.Scene.prototype.loadOBJ=function(r,o,a,c,e){var h=null,t=r.substr(0,r.lastIndexOf("/")+1),u=new THREE.MTLLoader;u.setCrossOrigin("");var d=this,i=function(s){var l=function(){h=s,h=(d.meshes[r]=h).clone(),d.useSubMesh(h,o,a),h.name=r,c(h)};0===s.materialLibraries.length&&l();for(var e=function(e){if(0<e.indexOf("model://")){if(u.path.indexOf("/meshes/")<0)return console.error("Failed to resolve texture URI. MTL file directory ["+u.path+"] not supported, it should be in a /meshes directory"),void console.error(e);var t=u.path;t=(t=t.substr(0,t.lastIndexOf("/meshes"))).substr(0,t.lastIndexOf("/")+1),e=e.replace(/model:\/\//g,t)}var i,n=e.split("\n");for(var r in n){var o=n[r];if(void 0!==o)if(o.indexOf("map_Ka")<0&&o.indexOf("map_Kd")<0)i+=o+="\n";else if(0<o.indexOf("/materials/textures"))i+=o+="\n";else{var a=u.path;a=a.substr(0,a.lastIndexOf("meshes")),o=(o=o.replace("map_Ka ","map_Ka "+a+"materials/textures/")).replace("map_Kd ","map_Kd "+a+"materials/textures/"),i+=o+="\n"}}!function(e){var t=[];s.getDescendants(t);for(var i=0;i<t.length;++i){var n=t[i];if(n&&n.material)if(n.material.name)n.material=e.create(n.material.name);else if(Array.isArray(n.material))for(var r=0;r<n.material.length;++r)n.material[r]=e.create(n.material[r].name)}l()}(u.parse(i))},t=0;t<s.materialLibraries.length;++t){var i=s.materialLibraries[t],n=new THREE.FileLoader(u.manager);n.setPath(u.path),n.load(i,e)}};if(e){if(e[0]){var n=this.objLoader.parse(e[0]);h=n,h=(this.meshes[r]=h).clone(),this.useSubMesh(h,o,a),h.name=r,c(h)}}else this.objLoader.load(r,function(e){u.setPath(t),i(e)})},GZ3D.Scene.prototype.loadSTL=function(t,i,n,r){var o=null,a=this;this.stlLoader.load(t,function(e){(o=new THREE.Mesh(e)).castShadow=!0,o.receiveShadow=!0,o=(a.meshes[t]=o).clone(),a.useSubMesh(o,i,n),o.name=t,r(o)})},GZ3D.Scene.prototype.setMaterial=function(e,t){if(e&&t){e.material=new THREE.MeshPhongMaterial;var i=t.ambient,n=t.diffuse;if(n){var r=[];if(r[0]=n[0],r[1]=n[1],r[2]=n[2],i){r[0]=.4*i[0]+.6*n[0],r[1]=.4*i[1]+.6*n[1],r[2]=.4*i[2]+.6*n[2]}e.material.color.setRGB(r[0],r[1],r[2])}var o=t.specular;o&&e.material.specular.setRGB(o[0],o[1],o[2]);var a=t.opacity;if(a&&a<1&&(e.material.transparent=!0,e.material.opacity=a),t.texture){var s=this.textureLoader.load(t.texture);t.scale&&(s.wrapS=s.wrapT=THREE.RepeatWrapping,s.repeat.x=1/t.scale[0],s.repeat.y=1/t.scale[1]),e.material.map=s}t.normalMap&&(e.material.normalMap=this.textureLoader.load(t.normalMap))}},GZ3D.Scene.prototype.setManipulationMode=function(e){"view"===(this.manipulationMode=e)?(this.modelManipulator.object&&this.emitter.emit("entityChanged",this.modelManipulator.object),this.selectEntity(null)):(this.modelManipulator.mode===this.manipulationMode&&(this.modelManipulator.space="world"===this.modelManipulator.space?"local":"world"),this.modelManipulator.mode=this.manipulationMode,this.modelManipulator.setMode(this.modelManipulator.mode),this.selectedEntity&&this.selectEntity(this.selectedEntity))},GZ3D.Scene.prototype.showCollision=function(e){if(e!==this.showCollisions){var t=[];this.scene.getDescendants(t);for(var i=0;i<t.length;++i)if(t[i]instanceof THREE.Object3D&&0<=t[i].name.indexOf("COLLISION_VISUAL")){var n=[];t[i].getDescendants(n);for(var r=0;r<n.length;++r)n[r]instanceof THREE.Mesh&&(n[r].visible=e)}this.showCollisions=e}},GZ3D.Scene.prototype.attachManipulator=function(e,t){this.modelManipulator.object&&this.emitter.emit("entityChanged",this.modelManipulator.object),"view"!==t&&(this.modelManipulator.attach(e),this.modelManipulator.mode=t,this.modelManipulator.setMode(this.modelManipulator.mode),this.scene.add(this.modelManipulator.gizmo))},GZ3D.Scene.prototype.resetView=function(){this.camera.position.copy(this.defaultCameraPosition),this.camera.up=new THREE.Vector3(0,0,1),this.camera.lookAt(new THREE.Vector3(0,0,0)),this.camera.updateMatrix()},GZ3D.Scene.prototype.showRadialMenu=function(e){if(this.radialMenu){var t=e.originalEvent,i=t.touches?t.touches[0]:t,n=new THREE.Vector2(i.clientX,i.clientY),r=new THREE.Vector3,o=this.getRayCastModel(n,r);o&&""!==o.name&&"plane"!==o.name&&-1===this.modelManipulator.pickerNames.indexOf(o.name)&&(this.radialMenu.show(t,o),this.selectEntity(o))}},GZ3D.Scene.prototype.setFromObject=function(t,e){t.min.x=t.min.y=t.min.z=1/0,t.max.x=t.max.y=t.max.z=-1/0;var a=new THREE.Vector3;function s(e){t.min.min(e),t.max.max(e)}e.updateMatrixWorld(!0),e.traverse(function(e){var t,i,n=e.geometry;if(void 0!==n&&"INERTIA_VISUAL"!==e.name&&"COM_VISUAL"!==e.name)if(n.isGeometry){var r=n.vertices;for(t=0,i=r.length;t<i;t++)a.copy(r[t]),a.applyMatrix4(e.matrixWorld),s(a)}else if(n.isBufferGeometry){var o=n.attributes.position;if(void 0!==o)for(t=0,i=o.count;t<i;t++)a.fromBufferAttribute(o,t).applyMatrix4(e.matrixWorld),s(a)}})},GZ3D.Scene.prototype.showBoundingBox=function(e){if("string"==typeof e&&(e=this.scene.getObjectByName(e)),this.boundingBox.visible){if(this.boundingBox.parent===e)return;this.hideBoundingBox()}var t=new THREE.Box3;this.setFromObject(t,e),t.min.x=t.min.x-e.position.x,t.min.y=t.min.y-e.position.y,t.min.z=t.min.z-e.position.z,t.max.x=t.max.x-e.position.x,t.max.y=t.max.y-e.position.y,t.max.z=t.max.z-e.position.z;var i=this.boundingBox.geometry.attributes.position,n=i.array;n[0]=t.max.x,n[1]=t.max.y,n[2]=t.max.z,n[3]=t.min.x,n[4]=t.max.y,n[5]=t.max.z,n[6]=t.min.x,n[7]=t.min.y,n[8]=t.max.z,n[9]=t.max.x,n[10]=t.min.y,n[11]=t.max.z,n[12]=t.max.x,n[13]=t.max.y,n[14]=t.min.z,n[15]=t.min.x,n[16]=t.max.y,n[17]=t.min.z,n[18]=t.min.x,n[19]=t.min.y,n[20]=t.min.z,n[21]=t.max.x,n[22]=t.min.y,n[23]=t.min.z,i.needsUpdate=!0,this.boundingBox.geometry.computeBoundingSphere();var r=new THREE.Matrix4;r.extractRotation(e.matrixWorld);var o=new THREE.Matrix4;o.getInverse(r),this.boundingBox.quaternion.setFromRotationMatrix(o),this.boundingBox.name="boundingBox",this.boundingBox.visible=!0,e.add(this.boundingBox)},GZ3D.Scene.prototype.hideBoundingBox=function(){this.boundingBox.parent&&this.boundingBox.parent.remove(this.boundingBox),this.boundingBox.visible=!1},GZ3D.Scene.prototype.onRightClick=function(e,t){var i=new THREE.Vector2(e.clientX,e.clientY),n=this.getRayCastModel(i,new THREE.Vector3);n&&""!==n.name&&"plane"!==n.name&&-1===this.modelManipulator.pickerNames.indexOf(n.name)&&t(n)},GZ3D.Scene.prototype.setViewAs=function(e,t){e.viewAs===t&&(t="normal");var i="wireframe"===t;function n(e){-1===o.indexOf(e.id)&&(o.push(e.id),"transparent"===t?(e.opacity?e.originalOpacity=e.opacity:e.originalOpacity=1,e.opacity=.25,e.transparent=!0):(e.opacity=e.originalOpacity?e.originalOpacity:1,1<=e.opacity&&(e.transparent=!1)),e.wireframe=i)}var r=[],o=[];e.getDescendants(r);for(var a=0;a<r.length;++a)if(r[a].material&&-1===r[a].name.indexOf("boundingBox")&&-1===r[a].name.indexOf("COLLISION_VISUAL")&&!this.getParentByPartialName(r[a],"COLLISION_VISUAL")&&-1===r[a].name.indexOf("wireframe")&&-1===r[a].name.indexOf("JOINT_VISUAL")&&-1===r[a].name.indexOf("COM_VISUAL")&&-1===r[a].name.indexOf("INERTIA_VISUAL"))if(r[a].material instanceof THREE.MultiMaterial)for(var s=0;s<r[a].material.materials.length;++s)n(r[a].material.materials[s]);else if(Array.isArray(r[a].material))for(var l=0;l<r[a].material.length;++l)n(r[a].material[l]);else n(r[a].material);e.viewAs=t},GZ3D.Scene.prototype.getParentByPartialName=function(e,t){for(var i=e.parent;i&&i!==this.scene;){if(-1!==i.name.indexOf(t))return i;i=i.parent}return null},GZ3D.Scene.prototype.selectEntity=function(e){e?(e!==this.selectedEntity&&(this.showBoundingBox(e),this.selectedEntity=e),this.attachManipulator(e,this.manipulationMode),this.emitter.emit("setTreeSelected",e.name)):(this.modelManipulator.object&&(this.modelManipulator.detach(),this.scene.remove(this.modelManipulator.gizmo)),this.hideBoundingBox(),this.selectedEntity=null,this.emitter.emit("setTreeDeselected"))},GZ3D.Scene.prototype.viewJoints=function(e){var t;if(void 0!==e.joint&&0!==e.joint.length)if(e.jointVisuals)if(void 0!==e.jointVisuals[0].parent&&null!==e.jointVisuals[0].parent)for(var i=0;i<e.jointVisuals.length;++i)e.jointVisuals[i].parent.remove(e.jointVisuals[i]);else for(var n=0;n<e.joint.length;++n)(t=e.getObjectByName(e.joint[n].child))&&t.add(e.jointVisuals[n]);else{e.jointVisuals=[];for(var r=0;r<e.joint.length;++r)if(t=e.getObjectByName(e.joint[r].child)){var o=this.jointAxis.XYZaxes.clone();t.add(o),e.jointVisuals.push(o),o.scale.set(.7,.7,.7),this.setPose(o,e.joint[r].pose.position,e.joint[r].pose.orientation);var a=null;e.joint[r].type!==this.jointTypes.BALL&&e.joint[r].type!==this.jointTypes.FIXED&&(a=this.jointAxis.mainAxis.clone(),o.add(a));var s,l,c,h=null;e.joint[r].type!==this.jointTypes.REVOLUTE2&&e.joint[r].type!==this.jointTypes.UNIVERSAL||(h=this.jointAxis.mainAxis.clone(),o.add(h)),e.joint[r].type===this.jointTypes.REVOLUTE||e.joint[r].type===this.jointTypes.GEARBOX?a.add(this.jointAxis.rotAxis.clone()):e.joint[r].type===this.jointTypes.REVOLUTE2||e.joint[r].type===this.jointTypes.UNIVERSAL?(a.add(this.jointAxis.rotAxis.clone()),h.add(this.jointAxis.rotAxis.clone())):e.joint[r].type===this.jointTypes.BALL?o.add(this.jointAxis.ballVisual.clone()):e.joint[r].type===this.jointTypes.PRISMATIC?a.add(this.jointAxis.transAxis.clone()):e.joint[r].type===this.jointTypes.SCREW&&a.add(this.jointAxis.screwAxis.clone()),a&&(e.joint[r].axis1||console.log("no joint axis "+e.joint[r].type+"vs "+this.jointTypes.FIXED),void 0===e.joint[r].axis1.use_parent_model_frame&&(e.joint[r].axis1.use_parent_model_frame=!0),(s=new THREE.Vector3(e.joint[r].axis1.xyz.x,e.joint[r].axis1.xyz.y,e.joint[r].axis1.xyz.z)).normalize(),l=new THREE.Matrix4,e.joint[r].axis1.use_parent_model_frame&&(l.extractRotation(o.matrix),l.getInverse(l),s.applyMatrix4(l),l.extractRotation(t.matrix),l.getInverse(l),s.applyMatrix4(l)),(c=new THREE.Matrix4).lookAt(s,new THREE.Vector3(0,0,0),a.up),a.quaternion.setFromRotationMatrix(c)),h&&(void 0===e.joint[r].axis2.use_parent_model_frame&&(e.joint[r].axis2.use_parent_model_frame=!0),(s=new THREE.Vector3(e.joint[r].axis2.xyz.x,e.joint[r].axis2.xyz.y,e.joint[r].axis2.xyz.z)).normalize(),l=new THREE.Matrix4,e.joint[r].axis2.use_parent_model_frame&&(l.extractRotation(o.matrix),l.getInverse(l),s.applyMatrix4(l),l.extractRotation(t.matrix),l.getInverse(l),s.applyMatrix4(l)),h.position=s.multiplyScalar(.3),(c=new THREE.Matrix4).lookAt(s,new THREE.Vector3(0,0,0),h.up),h.quaternion.setFromRotationMatrix(c))}}},GZ3D.Scene.prototype.viewCOM=function(e){var t;if(null!=e&&0!==e.children.length)if(e.COMVisuals)if(void 0!==e.COMVisuals[0].parent&&null!==e.COMVisuals[0].parent)for(var i=0;i<e.COMVisuals.length;++i){for(var n=0;n<3;n++)e.COMVisuals[i].parent.remove(e.COMVisuals[i].crossLines[n]);e.COMVisuals[i].parent.remove(e.COMVisuals[i])}else for(var r=0;r<e.children.length;++r)(t=e.getObjectByName(e.children[r].name))&&"boundingBox"!==t.name&&(t.add(e.COMVisuals[r].crossLines[0]),t.add(e.COMVisuals[r].crossLines[1]),t.add(e.COMVisuals[r].crossLines[2]),t.add(e.COMVisuals[r]));else{e.COMVisuals=[];for(var o,a,s,l,c,h,u,d,p,f=new Array(6),m=0;m<e.children.length;++m)if((t=e.getObjectByName(e.children[m].name))&&t.userData.inertial){var g,v,y,b={},x=t.userData.inertial;y=t.userData.inertial.pose,v=x.mass,g=Math.cbrt(.75*v/(11340*Math.PI)),a=this.COMvisual.clone(),t.add(a),e.COMVisuals.push(a),a.scale.set(g,g,g);var w=new THREE.Vector3(0,0,0),_=new THREE.Quaternion,E=new THREE.Euler(0,0,0,"XYZ");_.setFromEuler(E),b={position:w,orientation:_},void 0!==y&&(this.setPose(a,y.position,y.orientation),b=y),a.crossLines=[];var T=new THREE.Euler;T.copy(t.rotation),t.setRotationFromMatrix((new THREE.Matrix4).getInverse(t.parent.matrixWorld)),(o=new THREE.Box3).setFromObject(t),t.setRotationFromEuler(T);var M=new THREE.Matrix4;M.getInverse(t.matrixWorld),o.applyMatrix4(M),f[0]=new THREE.Vector3(o.min.x,b.position.y,b.position.z),f[1]=new THREE.Vector3(o.max.x,b.position.y,b.position.z),f[2]=new THREE.Vector3(b.position.x,o.min.y,b.position.z),f[3]=new THREE.Vector3(b.position.x,o.max.y,b.position.z),f[4]=new THREE.Vector3(b.position.x,b.position.y,o.min.z),f[5]=new THREE.Vector3(b.position.x,b.position.y,o.max.z),(h=new THREE.Geometry).vertices.push(f[0]),h.vertices.push(f[1]),(u=new THREE.Geometry).vertices.push(f[2]),u.vertices.push(f[3]),(d=new THREE.Geometry).vertices.push(f[4]),d.vertices.push(f[5]),p=new THREE.LineBasicMaterial({color:65280}),s=new THREE.Line(h,p,THREE.LineSegments),l=new THREE.Line(u,p,THREE.LineSegments),c=new THREE.Line(d,p,THREE.LineSegments),s.name="COM_VISUAL",l.name="COM_VISUAL",c.name="COM_VISUAL",a.crossLines.push(s),a.crossLines.push(l),a.crossLines.push(c),t.add(s),t.add(l),t.add(c)}}},GZ3D.Scene.prototype.viewInertia=function(e){var t;if(null!=e&&0!==e.children.length)if(e.inertiaVisuals)if(void 0!==e.inertiaVisuals[0].parent&&null!==e.inertiaVisuals[0].parent)for(var i=0;i<e.inertiaVisuals.length;++i){for(var n=0;n<3;n++)e.inertiaVisuals[i].parent.remove(e.inertiaVisuals[i].crossLines[n]);e.inertiaVisuals[i].parent.remove(e.inertiaVisuals[i])}else for(var r=0;r<e.children.length;++r)(t=e.getObjectByName(e.children[r].name))&&"boundingBox"!==t.name&&(t.add(e.inertiaVisuals[r].crossLines[0]),t.add(e.inertiaVisuals[r].crossLines[1]),t.add(e.inertiaVisuals[r].crossLines[2]),t.add(e.inertiaVisuals[r]));else{e.inertiaVisuals=[];for(var o,a,s,l,c,h,u,d,p,f=new Array(6),m=0;m<e.children.length;++m)if((t=e.getObjectByName(e.children[m].name))&&(d=t.userData.inertial)){var g,v,y,b,x,w,_,E,T={};if(d.pose)T=t.userData.inertial.pose;else{if(!t.position){console.log("Link pose not found!");continue}T.position=t.position,T.orientation=t.quaternion}w=d.mass,y=(_=d.inertia).ixx,b=_.iyy,x=_.izz,v=new THREE.Vector3,w<0||y<0||b<0||x<0||y+b<x||b+x<y||x+y<b?console.log("The link "+t.name+" has unrealistic inertia, unable to visualize box of equivalent inertia."):(v.x=Math.sqrt(6*(x+b-y)/w),v.y=Math.sqrt(6*(x+y-b)/w),v.z=Math.sqrt(6*(y+b-x)/w),(p=new THREE.Object3D).name="INERTIA_VISUAL",E={ambient:[1,0,1,1],diffuse:[1,0,1,1],depth_write:!((g=this.createBox(1,1,1)).name="INERTIA_VISUAL"),opacity:.5},this.setMaterial(g,E),p.add(g),p.name="INERTIA_VISUAL",t.add(p),e.inertiaVisuals.push(p),p.scale.set(v.x,v.y,v.z),p.crossLines=[],this.setPose(p,T.position,T.orientation),(new THREE.Box3).setFromObject(t),f[0]=new THREE.Vector3(T.position.x,T.position.y,-2*v.z+T.position.z),f[1]=new THREE.Vector3(T.position.x,T.position.y,2*v.z+T.position.z),f[2]=new THREE.Vector3(T.position.x,-2*v.y+T.position.y,T.position.z),f[3]=new THREE.Vector3(T.position.x,2*v.y+T.position.y,T.position.z),f[4]=new THREE.Vector3(-2*v.x+T.position.x,T.position.y,T.position.z),f[5]=new THREE.Vector3(2*v.x+T.position.x,T.position.y,T.position.z),(l=new THREE.Geometry).vertices.push(f[0]),l.vertices.push(f[1]),(c=new THREE.Geometry).vertices.push(f[2]),c.vertices.push(f[3]),(h=new THREE.Geometry).vertices.push(f[4]),h.vertices.push(f[5]),u=new THREE.LineBasicMaterial({color:65280}),o=new THREE.Line(l,u,THREE.LineSegments),a=new THREE.Line(c,u,THREE.LineSegments),s=new THREE.Line(h,u,THREE.LineSegments),o.name="INERTIA_VISUAL",a.name="INERTIA_VISUAL",s.name="INERTIA_VISUAL",p.crossLines.push(o),p.crossLines.push(a),p.crossLines.push(s),t.add(o),t.add(a),t.add(s))}}},GZ3D.Scene.prototype.updateLight=function(e,t){var i,n=e.children[0],r=new THREE.Color;t.diffuse&&(r.r=t.diffuse.r,r.g=t.diffuse.g,r.b=t.diffuse.b,n.color=r.clone()),t.specular&&(r.r=t.specular.r,r.g=t.specular.g,r.b=t.specular.b,e.serverProperties.specular=r.clone()),t.pose&&(this.setPose(e,t.pose.position,t.pose.orientation),e.matrixWorldNeedsUpdate=!0),t.range&&(n.distance=t.range),t.cast_shadows&&(n.castShadow=t.cast_shadows),t.attenuation_constant&&(e.serverProperties.attenuation_constant=t.attenuation_constant),t.attenuation_linear&&(e.serverProperties.attenuation_linear=t.attenuation_linear,n.intensity=n.intensity/(1+t.attenuation_linear)),t.attenuation_quadratic&&(e.serverProperties.attenuation_quadratic=t.attenuation_quadratic,n.intensity=n.intensity/(1+t.attenuation_quadratic)),t.direction&&(i=new THREE.Vector3(t.direction.x,t.direction.y,t.direction.z),e.direction=new THREE.Vector3,e.direction.copy(i),n.target&&n.target.position.copy(i))},GZ3D.Scene.prototype.createFromSdf=function(e){if(void 0!==e){var t=new THREE.Object3D,i=xml2json(this.spawnModel.sdfParser.parseXML(e),"\t"),n=(JSON.parse(i).sdf,this.spawnModel.sdfParser.spawnFromSDF(e));return t.name=n.name,t.add(n),t}console.log(" No argument provided ")},GZ3D.SdfParser=function(e,t,i){this.emitter=globalEmitter||new EventEmitter2({verboseMemoryLeak:!0}),this.SDF_VERSION=1.5,this.MATERIAL_ROOT=i?"http://"+i.url+"/assets":"assets",this.usingFilesUrls=!1,this.parseXML=function(e){return(new window.DOMParser).parseFromString(e,"text/xml")},this.scene=e,this.scene.setSDFParser(this),this.gui=t,this.gziface=i,this.init(),this.materials=[],this.entityMaterial={},this.meshes={},this.mtls={},this.textures={},this.customUrls=[]},GZ3D.SdfParser.prototype.init=function(){if(this.gziface){this.usingFilesUrls=!0;var t=this;this.emitter.on("connectionError",function(){t.emitter.emit("notification_popup","GzWeb is currently runningwithout a server, and materials could not be loaded.When connected scene will be reinitialized",5e3),t.onConnectionError()}),this.emitter.on("material",function(e){t.materials=e}),this.emitter.on("gzstatus",function(e){"error"===e&&(t.emitter.emit("notification_popup","GzWeb is currently running without a GzServer,and Scene is reinitialized.",5e3),t.onConnectionError())})}else this.scene.initScene()},GZ3D.SdfParser.prototype.addUrl=function(e){void 0!==e&&0===e.indexOf("http")?this.customUrls.push(e):console.log("Trying to add invalid URL")},GZ3D.SdfParser.prototype.onConnectionError=function(){this.scene.initScene();var n=this;this.emitter.on("entityCreated",function(e,t){n.gziface.isConnected||n.addModelByType(e,t)});this.emitter.on("deleteEntity",function(e){var t=e.name,i=n.scene.getByName(t);void 0!==i&&(i.children[0]instanceof THREE.Light?n.emitter.emit("setLightStats",{name:t},"delete"):n.gui.setModelStats({name:t},"delete"),n.scene.remove(i))})},GZ3D.SdfParser.prototype.parseColor=function(e){var t={},i=e.split(/\s+/);return t.r=parseFloat(i[0]),t.g=parseFloat(i[1]),t.b=parseFloat(i[2]),t.a=parseFloat(i[3]),t},GZ3D.SdfParser.prototype.parse3DVector=function(e){var t={},i=e.split(/\s+/);return t.x=parseFloat(i[0]),t.y=parseFloat(i[1]),t.z=parseFloat(i[2]),t},GZ3D.SdfParser.prototype.spawnLightFromSDF=function(e){var t,i=e.light,n=new THREE.Color,r=this.parseColor(i.diffuse);if(n.r=r.r,n.g=r.g,n.b=r.b,"point"===i["@type"]&&((t=new THREE.AmbientLight(n.getHex())).distance=i.range,this.scene.setPose(t,i.pose.position,i.pose.orientation)),"spot"===i["@type"])(t=new THREE.SpotLight(n.getHex())).distance=i.range,this.scene.setPose(t,i.pose.position,i.pose.orientation);else if("directional"===i["@type"]){t=new THREE.DirectionalLight(n.getHex());var o=this.parse3DVector(i.direction),a=new THREE.Vector3(o.x,o.y,o.z),s=a,l=a.negate();l.normalize();var c=this.parsePose(i.pose);c.position.x+=10*l.x,c.position.y+=10*l.y,c.position.z+=10*l.z,s.x-=c.position.x,s.y-=c.position.y,s.z-=c.position.z,t.target.position=s,t.shadow.camera.near=1,t.shadow.camera.far=50,t.shadow.mapSize.width=4094,t.shadow.mapSize.height=4094,t.shadow.camera.bottom=-100,t.shadow.camera.left=-100,t.shadow.camera.right=100,t.shadow.cameraTop=100,t.shadow.bias=1e-4,t.position.set(l.x,l.y,l.z),this.scene.setPose(t,c.position,c.orientation)}return t.intensity=parseFloat(i.attenuation.constant),t.castShadow=this.parseBool(i.cast_shadows),t.name=i["@name"],t},GZ3D.SdfParser.prototype.parsePose=function(e){var t={position:new THREE.Vector3,orientation:new THREE.Quaternion};if("string"!=typeof e&&!(e instanceof String))return t;var i=e.split(/\s+/),n=new THREE.Vector3(parseFloat(i[0]),parseFloat(i[1]),parseFloat(i[2])),r=new THREE.Quaternion,o=new THREE.Euler(parseFloat(i[3]),parseFloat(i[4]),parseFloat(i[5]),"ZYX");return r.setFromEuler(o),t.position=n,t.orientation=r,t},GZ3D.SdfParser.prototype.parseScale=function(e){var t=e.split(/\s+/);return new THREE.Vector3(parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2]))},GZ3D.SdfParser.prototype.parseBool=function(e){return JSON.parse(e)},GZ3D.SdfParser.prototype.createMaterial=function(e){var t,i,n,r,o,a,s,l,c;if(!e)return null;var h,u=e.script;if(u&&(u.uri||(u.uri=["file://media/materials/scripts/gazebo.material"]),u.uri instanceof Array||(u.uri=[u.uri]),u.name))if(n=this.materials[u.name]){if(r=n.ambient,o=n.diffuse,a=n.specular,s=n.opacity,c=n.scale,n.texture){for(var d=0;d<u.uri.length;++d){var p=u.uri[d].substring(0,u.uri[d].indexOf("://"));if("model"===p){if(0<u.uri[d].indexOf("textures")){t=u.uri[d].substring(u.uri[d].indexOf("://")+3);break}}else if("file"===p&&0<u.uri[d].indexOf("materials")){t=u.uri[d].substring(u.uri[d].indexOf("://")+3,u.uri[d].indexOf("materials")+9)+"/textures";break}}if(this.usingFilesUrls)if(0!==this.customUrls.length){for(var f=0;f<this.customUrls.length;f++)if(-1<this.customUrls[f].indexOf(n.texture)){i=this.customUrls[f],this.customUrls.splice(f,1);break}}else i=this.MATERIAL_ROOT+"/"+t+"/"+n.texture;else i=this.textures[n.texture]}}else console.log(u.name+" is not cached!!!");if(e.normal_map&&(h=0<e.normal_map.indexOf("://")?e.normal_map.substring(e.normal_map.indexOf("://")+3,e.normal_map.lastIndexOf("/")):t)){var m=e.normal_map.lastIndexOf("/")+1;m<0&&(m=0);var g=e.normal_map.substr(m,e.normal_map.lastIndexOf(".")-m);if(this.usingFilesUrls)if(0!==this.customUrls.length){for(var v=0;v<this.customUrls.length;v++)if(-1<this.customUrls[v].indexOf(g+".png")){l=this.customUrls[v],this.customUrls.splice(v,1);break}}else l=this.MATERIAL_ROOT+"/"+h+"/"+g+".png";else l=this.textures[g+".png"]}return{texture:i,normalMap:l,ambient:r,diffuse:o,specular:a,opacity:s,scale:c}},GZ3D.SdfParser.prototype.parseSize=function(e){var t=e.split(/\s+/);return{x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2])}},GZ3D.SdfParser.prototype.createGeom=function(e,t,n){var i,r,o,a=this,s=this.createMaterial(t);if(e.box)r=this.parseSize(e.box.size),i=this.scene.createBox(r.x,r.y,r.z);else if(e.cylinder)i=this.scene.createCylinder(e.cylinder.radius,e.cylinder.length);else if(e.sphere)i=this.scene.createSphere(e.sphere.radius);else if(e.plane)o=this.parseSize(e.plane.normal),r=this.parseSize(e.plane.size),i=this.scene.createPlane(o.x,o.y,o.z,r.x,r.y);else if(e.mesh){var l,c,h=e.mesh.uri;e.mesh.submesh&&(l=e.mesh.submesh.name,c=this.parseBool(e.mesh.submesh.center));var u=h.substring(0,h.indexOf("://"));if("file"===u||"model"===u){var d=h.substring(h.indexOf("://")+3);if(e.mesh.scale){var p=this.parseScale(e.mesh.scale);n.scale.x=p.x,n.scale.y=p.y,n.scale.z=p.z}var f=this.MATERIAL_ROOT+"/"+d,m=f.substr(-4).toLowerCase(),g=n.name+"::"+f;this.entityMaterial[g]=s;var v=h.substring(h.lastIndexOf("/")+1);if(this.usingFilesUrls){if(0!==this.customUrls.length)for(var y=0;y<this.customUrls.length;y++)if(-1<this.customUrls[y].indexOf(v)){f=this.customUrls[y],this.customUrls.splice(y,1);break}this.scene.loadMeshFromUri(f,l,c,function(e){if(s)if(".stl"!==m){var t=[];e.getDescendants(t);for(var i=0;i<t.length;++i)if(t[i]instanceof THREE.Mesh){a.scene.setMaterial(t[i],s);break}}else a.scene.setMaterial(e,s);else".stl"===m&&a.scene.setMaterial(e,{ambient:[1,1,1,1]});n.add(e),w(n)})}else{var b=this.meshes[v];if(".obj"===m){var x=this.mtls[v.split(".")[0]+".mtl"];a.scene.loadMeshFromString(f,l,c,function(e){n.add(e),w(n)},[b,x])}else".dae"===m&&a.scene.loadMeshFromString(f,l,c,function(e){if(s){var t=[];e.getDescendants(t);for(var i=0;i<t.length;++i)if(t[i]instanceof THREE.Mesh){a.scene.setMaterial(t[i],s);break}}n.add(e),w(n)},[b])}}}function w(e){var t=[];e.getDescendants(t);for(var i=0;i<t.length;++i)if(t[i]instanceof THREE.Mesh){t[i].castShadow=!0,t[i].receiveShadow=!0,e.castShadows&&(t[i].castShadow=e.castShadows),e.receiveShadows&&(t[i].receiveShadow=e.receiveShadows),0<=e.name.indexOf("COLLISION_VISUAL")&&(t[i].castShadow=!1,t[i].receiveShadow=!1,t[i].visible=this.scene.showCollisions);break}}i&&(s&&this.scene.setMaterial(i,s),i.updateMatrix(),n.add(i),w(n))},GZ3D.SdfParser.prototype.createVisual=function(e){if(e.geometry){var t=new THREE.Object3D;if(t.name=e["@name"],e.pose){var i=this.parsePose(e.pose);this.scene.setPose(t,i.position,i.orientation)}return this.createGeom(e.geometry,e.material,t),t}return null},GZ3D.SdfParser.prototype.spawnFromSDF=function(e){var t=xml2json("string"==typeof e?this.parseXML(e):e,"\t"),i=JSON.parse(t).sdf;return i.model?this.spawnModelFromSDF(i):i.light?this.spawnLightFromSDF(i):void 0},GZ3D.SdfParser.prototype.loadSDF=function(e){var t=this.loadModel(e);if(t)return this.spawnFromSDF(t)},GZ3D.SdfParser.prototype.spawnModelFromSDF=function(e){var t,i,n,r=new THREE.Object3D;for(r.name=e.model["@name"],e.model.pose&&(t=this.parsePose(e.model.pose),this.scene.setPose(r,t.position,t.orientation)),e.model.link instanceof Array||(e.model.link=[e.model.link]),i=0;i<e.model.link.length;++i)n=this.createLink(e.model.link[i]),r.add(n);return r},GZ3D.SdfParser.prototype.createLink=function(e){var t,i,n=new THREE.Object3D;if(n.name=e["@name"],e.inertial){var r,o,a={};n.userData.inertial={},r=e.inertial.pose,o=e.inertial.mass,a.ixx=e.inertial.ixx,a.ixy=e.inertial.ixy,a.ixz=e.inertial.ixz,a.iyy=e.inertial.iyy,a.iyz=e.inertial.iyz,a.izz=e.inertial.izz,n.userData.inertial.inertia=a,o&&(n.userData.inertial.mass=o),r&&(n.userData.inertial.pose=r)}if(e.pose&&(t=this.parsePose(e.pose),this.scene.setPose(n,t.position,t.orientation)),e.visual){e.visual instanceof Array||(e.visual=[e.visual]);for(var s=0;s<e.visual.length;++s)(i=this.createVisual(e.visual[s]))&&!i.parent&&n.add(i)}if(e.collision&&e.collision.visual){e.collision.visual instanceof Array||(e.collision.visual=[e.collision.visual]);for(var l=0;l<e.collision.visual.length;++l)(i=this.createVisual(e.collision.visual[l]))&&!i.parent&&n.add(i)}return n},GZ3D.SdfParser.prototype.addModelByType=function(e,t){var i,n,r,o,a=new THREE.Quaternion;if(e.matrixWorld){var s=e.matrixWorld;n=new THREE.Vector3,r=new THREE.Euler;var l=new THREE.Vector3;s.decompose(n,r,l),a.setFromEuler(r)}if("box"===t)i=this.createBoxSDF(n,r),o=this.spawnFromSDF(i);else if("sphere"===t)i=this.createSphereSDF(n,r),o=this.spawnFromSDF(i);else if("cylinder"===t)i=this.createCylinderSDF(n,r),o=this.spawnFromSDF(i);else if("spotlight"===t)o=this.scene.createLight(2),this.scene.setPose(o,n,a);else if("directionallight"===t)o=this.scene.createLight(3),this.scene.setPose(o,n,a);else if("pointlight"===t)o=this.scene.createLight(1),this.scene.setPose(o,n,a);else{var c=this.loadSDF(t);(o=new THREE.Object3D).add(c),o.name=e.name,this.scene.setPose(o,n,a)}var h,u=this;h=function(){void 0===u.scene.getByName(o.name)?(u.scene.add(o),u.gui.setModelStats(o,"update")):setTimeout(h,100)},setTimeout(h,100)},GZ3D.SdfParser.prototype.createSimpleShapeSDF=function(e,t,i,n){return'<sdf version="'+this.SDF_VERSION+'"><model name="'+e+'"><pose>'+t.x+" "+t.y+" "+t.z+" "+i.x+" "+i.y+" "+i.z+'</pose><link name="link"><inertial><mass>1.0</mass></inertial><collision name="collision"><geometry>'+n+'</geometry></collision><visual name="visual"><geometry>'+n+"</geometry><material><script><uri>file://media/materials/scripts/gazebo.material</uri><name>Gazebo/Grey</name><\/script></material></visual></link></model></sdf>"},GZ3D.SdfParser.prototype.createBoxSDF=function(e,t){return this.createSimpleShapeSDF("box",e,t,"<box><size>1.0 1.0 1.0</size></box>")},GZ3D.SdfParser.prototype.createSphereSDF=function(e,t){return this.createSimpleShapeSDF("sphere",e,t,"<sphere><radius>0.5</radius></sphere>")},GZ3D.SdfParser.prototype.createCylinderSDF=function(e,t){return this.createSimpleShapeSDF("cylinder",e,t,"<cylinder><radius>0.5</radius><length>1.0</length></cylinder>")},GZ3D.SdfParser.prototype.loadModel=function(e){var t="";if(void 0!==e){t=0===e.indexOf("http")&&e.indexOf(".sdf")===e.length-4?e:this.MATERIAL_ROOT+"/"+e+"/model.sdf";var i=new XMLHttpRequest;i.overrideMimeType("text/xml"),i.open("GET",t,!1);try{i.send()}catch(e){return void console.log("Failed to get URL ["+t+"]: "+e.message)}if(200===i.status)return i.responseXML;console.log("Failed to get URL ["+t+"]")}else console.log("Must provide either a model name or the URL of an SDF file")},GZ3D.Shaders=function(){this.init()},GZ3D.Shaders.prototype.init=function(){this.heightmapVS="varying vec2 vUv;varying vec3 vPosition;varying vec3 vNormal;void main( void ) {  vUv = uv;  vPosition = position;  vNormal = -normal;  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}",this.heightmapFS="uniform sampler2D texture0;uniform sampler2D texture1;uniform sampler2D texture2;uniform float repeat0;uniform float repeat1;uniform float repeat2;uniform float minHeight1;uniform float minHeight2;uniform float fadeDist1;uniform float fadeDist2;uniform vec3 ambient;uniform vec3 lightDiffuse;uniform vec3 lightDir;varying vec2 vUv;varying vec3 vPosition;varying vec3 vNormal;float blend(float distance, float fadeDist) {  float alpha = distance / fadeDist;  if (alpha < 0.0) {    alpha = 0.0;  }  if (alpha > 1.0) {    alpha = 1.0;  }  return alpha;}void main(){  vec3 diffuse0 = texture2D( texture0, vUv*repeat0 ).rgb;  vec3 diffuse1 = texture2D( texture1, vUv*repeat1 ).rgb;  vec3 diffuse2 = texture2D( texture2, vUv*repeat2 ).rgb;  vec3 fragcolor = diffuse0;  if (fadeDist1 > 0.0)  {    fragcolor = mix(      fragcolor,      diffuse1,      blend(vPosition.z - minHeight1, fadeDist1)    );  }  if (fadeDist2 > 0.0)  {    fragcolor = mix(      fragcolor,      diffuse2,      blend(vPosition.z - (minHeight1 + minHeight2), fadeDist2)    );  }  vec3 lightDirNorm = normalize(lightDir);  float intensity = max(dot(vNormal, lightDirNorm), 0.0);  vec3 vLightFactor = ambient + lightDiffuse * intensity;  gl_FragColor = vec4(fragcolor.rgb * vLightFactor, 1.0);}"},GZ3D.SpawnModel=function(e,t){this.scene=e,this.domElement=void 0!==t?t:document,this.init(),this.obj=void 0,this.callback=void 0,this.sdfParser=void 0,this.spawnedShapeMaterial=new THREE.MeshPhongMaterial({color:16777215,shading:THREE.SmoothShading}),this.spawnedShapeMaterial.transparent=!0,this.spawnedShapeMaterial.opacity=.5},GZ3D.SpawnModel.prototype.init=function(){this.plane=new THREE.Plane(new THREE.Vector3(0,0,1),0),this.ray=new THREE.Ray,this.obj=null,this.active=!1,this.snapDist=null},GZ3D.SpawnModel.prototype.start=function(e,t){var i;this.active&&this.finish(),this.callback=t,this.obj=new THREE.Object3D,"box"===e?(i=this.scene.createBox(1,1,1)).material=this.spawnedShapeMaterial:"sphere"===e?(i=this.scene.createSphere(.5)).material=this.spawnedShapeMaterial:"cylinder"===e?(i=this.scene.createCylinder(.5,1)).material=this.spawnedShapeMaterial:i="pointlight"===e?this.scene.createLight(1):"spotlight"===e?this.scene.createLight(2):"directionallight"===e?this.scene.createLight(3):this.sdfParser.loadSDF(e),this.obj.name=this.generateUniqueName(e),this.obj.add(i);var n=new THREE.Vector2(window.window.innerWidth/2,window.innerHeight/2),r=new THREE.Vector3;this.scene.getRayCastModel(n,r),this.obj.position.x=r.x,this.obj.position.y=r.y,this.obj.position.z+=.5,this.scene.add(this.obj);var o=[];this.scene.scene.getDescendants(o);for(var a=0;a<o.length;++a)o[a].material&&(o[a].material.needsUpdate=!0);var s=this;this.mouseDown=function(e){s.onMouseDown(e)},this.mouseUp=function(e){s.onMouseUp(e)},this.mouseMove=function(e){s.onMouseMove(e)},this.keyDown=function(e){s.onKeyDown(e)},this.touchMove=function(e){s.onTouchMove(e,!0)},this.touchEnd=function(e){s.onTouchEnd(e)},this.domElement.addEventListener("mousedown",s.mouseDown,!1),this.domElement.addEventListener("mouseup",s.mouseUp,!1),this.domElement.addEventListener("mousemove",s.mouseMove,!1),document.addEventListener("keydown",s.keyDown,!1),this.domElement.addEventListener("touchmove",s.touchMove,!1),this.domElement.addEventListener("touchend",s.touchEnd,!1),this.active=!0},GZ3D.SpawnModel.prototype.finish=function(){this.domElement.removeEventListener("mousedown",this.mouseDown,!1),this.domElement.removeEventListener("mouseup",this.mouseUp,!1),this.domElement.removeEventListener("mousemove",this.mouseMove,!1),document.removeEventListener("keydown",this.keyDown,!1),this.scene.remove(this.obj),this.obj=void 0,this.active=!1},GZ3D.SpawnModel.prototype.onMouseDown=function(e){e.preventDefault(),e.stopImmediatePropagation()},GZ3D.SpawnModel.prototype.onMouseMove=function(e){this.active&&(e.preventDefault(),this.moveSpawnedModel(e.clientX,e.clientY))},GZ3D.SpawnModel.prototype.onTouchMove=function(e,t){var i;this.active&&((i=t?e:e.originalEvent).preventDefault(),1===i.touches.length&&this.moveSpawnedModel(i.touches[0].pageX,i.touches[0].pageY))},GZ3D.SpawnModel.prototype.onTouchEnd=function(){this.active&&(this.callback(this.obj),this.finish())},GZ3D.SpawnModel.prototype.onMouseUp=function(e){this.active&&(this.callback(this.obj),this.finish())},GZ3D.SpawnModel.prototype.onKeyDown=function(e){27===e.keyCode&&this.finish()},GZ3D.SpawnModel.prototype.moveSpawnedModel=function(e,t){var i=new THREE.Vector3(e/window.innerWidth*2-1,-t/window.innerHeight*2+1,.5);i.unproject(this.scene.camera),this.ray.set(this.scene.camera.position,i.sub(this.scene.camera.position).normalize());var n=this.ray.intersectPlane(this.plane);if(n&&(n.z=this.obj.position.z,this.snapDist&&(n.x=Math.round(n.x/this.snapDist)*this.snapDist,n.y=Math.round(n.y/this.snapDist)*this.snapDist),this.scene.setPose(this.obj,n,new THREE.Quaternion),this.obj.children[0].children[0]&&(this.obj.children[0].children[0]instanceof THREE.SpotLight||this.obj.children[0].children[0]instanceof THREE.DirectionalLight))){var r=this.obj.children[0].children[0];r.direction&&r.target&&r.target.position.copy(r.direction)}},GZ3D.SpawnModel.prototype.generateUniqueName=function(e){for(var t=0;t<1e3;){if(!this.scene.getByName(e+"_"+t))return e+"_"+t;++t}};